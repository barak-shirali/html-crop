{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///webpack/bootstrap 2efb3a34e4b7a3b13b7a","webpack:///./src/index.js","webpack:///./~/html2canvas/dist/html2canvas.js","webpack:///./src/base-object.js","webpack:///./src/canvas-state.js","webpack:///./src/rect.js"],"names":["HtmlCrop","doc","options","_document","Object","assign","_debugMode","debug","log","html","then","canvas","_canvas","selectionCanvas","createElement","_selectionCanvas","width","height","style","position","left","top","body","appendChild","_canvasState","attachButton","button","textNode","createTextNode","right","bottom","onclick","onCapture","bind","ctx","getContext","selection","getSelection","imgData","getImageData","x","y","w","h","newCanvas","newCtx","putImageData","dataURL","toDataURL","window","location","href","f","exports","module","g","global","self","html2canvas","define","e","t","n","r","s","o","u","a","require","i","Error","code","l","call","length","_dereq_","root","freeExports","nodeType","freeModule","freeGlobal","punycode","maxInt","base","tMin","tMax","skew","damp","initialBias","initialN","delimiter","regexPunycode","regexNonASCII","regexSeparators","errors","baseMinusTMin","floor","Math","stringFromCharCode","String","fromCharCode","key","error","type","RangeError","map","array","fn","result","mapDomain","string","parts","split","replace","labels","encoded","join","ucs2decode","output","counter","value","extra","charCodeAt","push","ucs2encode","basicToDigit","codePoint","digitToBasic","digit","flag","adapt","delta","numPoints","firstTime","k","decode","input","inputLength","out","bias","basic","j","index","oldi","baseMinusT","lastIndexOf","splice","encode","handledCPCount","basicLength","m","q","currentValue","handledCPCountPlusOne","qMinusT","toUnicode","test","slice","toLowerCase","toASCII","amd","hasOwnProperty","restoreOwnerScroll","ownerDocument","defaultView","pageXOffset","pageYOffset","scrollTo","cloneCanvasContents","clonedCanvas","cloneNode","node","javascriptEnabled","clone","document","nodeValue","child","firstChild","nodeName","nextSibling","_scrollTop","scrollTop","_scrollLeft","scrollLeft","initNode","containerDocument","documentElement","container","className","visibility","border","scrolling","Promise","resolve","documentClone","contentWindow","onload","interval","setInterval","childNodes","clearInterval","navigator","userAgent","scrollY","scrollX","open","write","replaceChild","adoptNode","close","Color","b","fromArray","namedColor","rgb","rgba","hex6","hex3","prototype","darken","amount","round","isTransparent","isBlack","Array","isArray","min","_hex3","match","parseInt","_hex6","substring","_rgb","Number","_rgba","toString","color","colors","isColor","Support","CanvasRenderer","ImageLoader","NodeParser","NodeContainer","utils","createWindowClone","loadUrlDocument","getBounds","html2canvasNodeAttribute","html2canvasCloneIndex","nodeList","logging","start","Date","now","async","allowTaint","removeContainer","imageTimeout","renderer","strict","proxy","reject","innerWidth","innerHeight","absoluteUrl","renderWindow","undefined","setAttribute","renderDocument","onrendered","html2canvasExport","create","windowWidth","windowHeight","html2canvasIndex","attributeName","selector","querySelector","removeAttribute","clonedWindow","oncloneHandler","onclone","support","imageLoader","bounds","documentWidth","documentHeight","parser","ready","crop","cleanupContainer","parentNode","removeChild","croppedCanvas","x1","max","x2","y1","y2","drawImage","scrollWidth","offsetWidth","clientWidth","scrollHeight","offsetHeight","clientHeight","url","link","smallImage","DummyImageContainer","src","promise","image","Image","onerror","complete","Font","family","size","img","span","sampleText","baseline","middle","fontFamily","fontSize","margin","padding","verticalAlign","offsetTop","lineHeight","lineWidth","FontMetrics","data","getMetrics","FrameContainer","sameOrigin","proxyLoad","URL","GradientContainer","imageData","colorStops","x0","y0","TYPES","LINEAR","RADIAL","REGEXP_COLORSTOP","ImageContainer","cors","tainted","crossOrigin","ProxyImageContainer","SVGContainer","SVGNodeContainer","LinearGradientContainer","WebkitGradientContainer","origin","getOrigin","findImages","nodes","images","reduce","imageNodes","concat","args","method","forEach","addImage","loadImage","findBackgroundImage","parseBackgroundImages","filter","hasImageBackground","callback","newImage","imageExists","isSVG","svg","isSameOrigin","useCORS","isInline","some","protocol","hostname","port","getPromise","timeout","dummy","get","found","fetch","all","timer","race","res","setTimeout","clearTimeout","apply","arguments","hasDirection","REGEXP_DIRECTION","reverse","ratio","parseFloat","isNaN","colorStop","colorStopMatch","unit","stop","find","count","logger","console","Function","parseBackgrounds","offsetBounds","parent","stack","borders","clip","backgroundClip","visible","computedStyles","styles","backgroundImages","transformData","transformMatrix","isPseudoElement","opacity","cloneTo","getOpacity","cssFloat","assignStack","children","isElementVisible","Node","TEXT_NODE","css","hasAttribute","getAttribute","attribute","computedStyle","before","prefixedCss","prefixes","prefix","substr","toUpperCase","getComputedStyle","cssInt","fontWeight","weight","parseClip","matches","CLIP","cssList","property","trim","isPercentage","parseBackgroundSize","targetRatio","currentRatio","parseBackgroundPosition","backgroundSize","parseBackgroundRepeat","parseTextShadows","textShadow","results","shadows","TEXT_SHADOW_PROPERTY","TEXT_SHADOW_VALUES","offsetX","offsetY","blur","parseTransform","hasTransform","offset","parseBounds","removePx","asFloat","matrix","parseTransformMatrix","transform","parseMatrix","MATRIX_PROPERTY","getValue","tagName","selectionValue","placeholder","option","selectedIndex","text","matrix3d","indexOf","str","TextContainer","PseudoElementContainer","StackingContext","element","range","renderQueue","background","rectangle","canvasBackground","visibile","createPseudoHideStyles","disableAnimations","flatten","getChildren","getPseudoElements","fontMetrics","calculateOverflowClips","isElement","createStackingContexts","sortStackingContexts","parse","paint","renderIndex","asyncRenderer","appendToDOM","parseBorders","cssClip","hasParentClip","cleanDOM","isTextNode","queue","asyncTimer","createStyles","PSEUDO_HIDE_ELEMENT_CLASS_BEFORE","PSEUDO_HIDE_ELEMENT_CLASS_AFTER","hidePseudoElements","innerHTML","ELEMENT_NODE","getPseudoElement","after","toCamelCase","content","display","stripQuotes","isImage","pseudoNode","pseudoContainer","item","parentContainer","renderableNode","nonIgnoredElement","newStackingContext","hasOwnStacking","parentStack","getParentStack","contexts","isRootElement","hasOpacity","isPositionedForStacking","isBodyWithTransparentRoot","isPositioned","zIndex0","isInlineBlock","isFloating","sort","zIndexSort","parseTextBounds","textList","rangeBounds","getRangeBounds","replacementNode","splitText","getWrapperBounds","wrapper","backupText","createRange","setStart","setEnd","getBoundingClientRect","ClearTransform","negativeZindex","negativeZIndex","descendantElements","descendantNonFloats","not","nonInlineNonPositionedDescendants","inlineLevel","nonPositionedFloats","inFlow","stackLevel0","hasText","positiveZindex","positiveZIndex","isStackingContext","restore","paintText","paintNode","setOpacity","save","setTransform","paintCheckbox","paintRadio","paintElement","renderBackground","getWidth","renderBorders","imgContainer","renderImage","imageContainer","paintFormValue","radius","borderPoints","calculateCurvePoints","calculateBorders","checked","font","circleStroke","circle","ceil","properties","message","textContent","applyTextTransform","characters","ucs2","letterRendering","noLetterSpacing","hasUnicode","getWords","character","fontShadow","clearShadow","renderTextDecoration","metrics","borderColorTransforms","inset","nodeBounds","getBorderRadiusData","side","colorTransform","parseBackgroundClip","borderSide","bx","by","bw","bh","drawSide","c1","c2","c3","c4","topLeftOuter","topLeftInner","topRightOuter","topRightInner","bottomRightOuter","bottomRightInner","bottomLeftOuter","bottomLeftInner","borderArgs","parseCorner","getCurvePoints","r1","r2","kappa","sqrt","ox","oy","xm","ym","topLeft","bezierCurve","topRight","bottomRight","bottomLeft","borderRadius","tlh","tlv","trh","trv","brh","brv","blh","blv","topWidth","rightHeight","bottomWidth","leftHeight","subdivide","startControl","endControl","end","lerp","ab","bc","cd","abbc","bccd","dest","curveTo","curveToReversed","borderData","radius1","radius2","outer1","inner1","outer2","inner2","corner1","corner2","arr","asInt","zIndex","context","nodeContainer","arrays","first","words","onWordBoundary","word","isWordBoundary","characterCode","XHR","decode64","Proxy","proxyUrl","supportsCORS","XMLHttpRequest","createCallback","createProxyUrl","jsonp","response","proxyCount","ProxyURL","supportsCORSImage","cleanup","random","encodeURIComponent","documentFromHTML","DOMParser","parseFromString","implementation","createHTMLDocument","ee","host","head","insertBefore","getHideClass","Renderer","paddingLeft","paddingTop","paddingRight","paddingBottom","renderBackgroundColor","renderBackgroundImage","renderBorder","drawShape","backgroundImage","renderBackgroundRepeating","gradientImage","renderBackgroundGradient","repeat","backgroundRepeatShape","renderBackgroundRepeat","taintCtx","textBaseline","variables","setFillStyle","fillStyle","fillRect","beginPath","arc","PI","closePath","fill","stroke","strokeColor","strokeStyle","shape","taints","sx","sy","sw","sh","dx","dy","dw","dh","shapes","hasEntries","point","rect","variant","setVariable","globalAlpha","translate","fillText","backgroundPosition","borderLeft","borderTop","createPattern","resizeImage","gradient","createLinearGradient","addColorStop","ownStacking","testRangeBounds","testCORS","testSVG","testElement","rangeHeight","selectNode","hasFabric","inlineFormatting","fabric","loadSVGFromString","createCanvas","removeContentType","objects","StaticCanvas","lowerCanvasEl","setWidth","setHeight","add","util","groupSVGElements","renderAll","atob","_native","XMLSerializer","serializeToString","parseSVGDocument","capitalize","p1","p2","base64","chars","len","encoded1","encoded2","encoded3","encoded4","byte1","byte2","byte3","clientRect","offsetParent","offsetLeft","whitespace","definition","prefix_i","block","mode","numParen","quote","appendResult","c","xhr","status","responseText","statusText","send","BaseObject","isDebug","getName","CanvasState","debugMode","_width","_height","_ctx","_htmlTop","_htmlLeft","_valid","_shape","_dragging","_dragoffx","_dragoffy","_initRect","_initEvents","_interval","draw","addEventListener","preventDefault","mouse","getMouse","mx","my","contains","_x","_y","_currentHandle","getHoverSelectionHandle","oldx","oldy","handleIndex","cursor","_w","_h","clearRect","clear","el","pageX","pageY","Rect","_selectionHandles","_selectionBoxSize","_fill","setLineDash","strokeRect","half","cur","handle"],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD,O;ACVA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,uBAAe;AACf;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;;;;;;;;;;;;;;ACtCA;;;;AACA;;;;AACA;;;;;;;;;;;;KAEqBA,Q;;;AACnB;;;;;AAKA,qBAAYC,GAAZ,EAA+B;AAAA,SAAdC,OAAc,yDAAJ,EAAI;;AAAA;;AAAA;;AAG7B,WAAKC,SAAL,GAAiBF,GAAjB;AACA,WAAKC,OAAL,GAAeE,OAAOC,MAAP,CAAc,EAAd,EAAkBH,OAAlB,CAAf;AACA,WAAKI,UAAL,GAAkBJ,QAAQK,KAA1B;AACA,WAAKC,GAAL,CAAS,aAAT;;AAEA,gCAAY,MAAKL,SAAL,CAAeM,IAA3B,EAAiCC,IAAjC,CAAsC,UAACC,MAAD,EAAY;AAChD;AACA;;AAEA,aAAKC,OAAL,GAAeD,MAAf;;AAEA,WAAME,kBAAkBZ,IAAIa,aAAJ,CAAkB,QAAlB,CAAxB;AACA,aAAKC,gBAAL,GAAwBF,eAAxB;AACAA,uBAAgBG,KAAhB,GAAwBL,OAAOK,KAA/B;AACAH,uBAAgBI,MAAhB,GAAyBN,OAAOM,MAAhC;AACAJ,uBAAgBK,KAAhB,CAAsBC,QAAtB,GAAiC,OAAjC;AACAN,uBAAgBK,KAAhB,CAAsBE,IAAtB,GAA6B,GAA7B;AACAP,uBAAgBK,KAAhB,CAAsBG,GAAtB,GAA4B,GAA5B;AACAR,uBAAgBK,KAAhB,CAAsB,SAAtB,IAAmC,OAAnC;;AAEA,aAAKf,SAAL,CAAemB,IAAf,CAAoBC,WAApB,CAAgCV,eAAhC;AACA,aAAKW,YAAL,GAAoB,0BAAgBvB,GAAhB,EAAqBY,eAArB,EAAsC,MAAKP,UAA3C,CAApB;;AAEA,aAAKmB,YAAL;AACD,MAnBD;AAR6B;AA4B9B;;AAED;;;;;;;oCAGe;AAAA,WACLtB,SADK,GACS,IADT,CACLA,SADK;;AAEb,WAAMuB,SAASvB,UAAUW,aAAV,CAAwB,QAAxB,CAAf;AACA,WAAMa,WAAWxB,UAAUyB,cAAV,CAAyB,SAAzB,CAAjB;AACAF,cAAOH,WAAP,CAAmBI,QAAnB;AACAD,cAAOR,KAAP,CAAaC,QAAb,GAAwB,OAAxB;AACAO,cAAOR,KAAP,CAAaW,KAAb,GAAqB,MAArB;AACAH,cAAOR,KAAP,CAAaY,MAAb,GAAsB,MAAtB;AACAJ,cAAOR,KAAP,CAAa,SAAb,IAA0B,OAA1B;AACAQ,cAAOK,OAAP,GAAiB,KAAKC,SAAL,CAAeC,IAAf,CAAoB,IAApB,CAAjB;;AAEA9B,iBAAUmB,IAAV,CAAeC,WAAf,CAA2BG,MAA3B;AACD;;AAED;;;;;;iCAGY;AACV,WAAMQ,MAAM,KAAKtB,OAAL,CAAauB,UAAb,CAAwB,IAAxB,CAAZ;AACA,WAAMC,YAAY,KAAKZ,YAAL,CAAkBa,YAAlB,EAAlB;AACA,WAAMC,UAAUJ,IAAIK,YAAJ,CAAiBH,UAAUI,CAA3B,EAA8BJ,UAAUK,CAAxC,EAA2CL,UAAUM,CAArD,EAAwDN,UAAUO,CAAlE,CAAhB;;AAEA,WAAMC,YAAY,KAAKzC,SAAL,CAAeW,aAAf,CAA6B,QAA7B,CAAlB;AACA8B,iBAAU5B,KAAV,GAAkBoB,UAAUM,CAA5B;AACAE,iBAAU3B,MAAV,GAAmBmB,UAAUO,CAA7B;AACA,WAAME,SAASD,UAAUT,UAAV,CAAqB,IAArB,CAAf;AACAU,cAAOC,YAAP,CAAoBR,OAApB,EAA6B,CAA7B,EAAgC,CAAhC;;AAEA,WAAMS,UAAUH,UAAUI,SAAV,CAAoB,WAApB,CAAhB;AACA;AACAC,cAAOC,QAAP,CAAgBC,IAAhB,GAAuBJ,OAAvB,CAbU,CAasB;AACjC;;AAED;;;;;;;+BAIU;AACR,cAAO,UAAP;AACD;;;;;;mBA9EkB/C,Q;;;;;;;qYCJrB;;;;;GAOA,CAAC,SAASoD,CAAT,CAAW,CAAC,GAAG,4BAAOC,OAAP,KAAiB,QAAjB,EAA2B,MAAOC,OAAP,GAAgB,WAA9C,CAA0D,CAACA,OAAOD,OAAP,CAAeD,GAAf,CAAmB,CAA9E,IAAmF,IAAG,IAAH,CAA0C,CAAC,iCAAO,EAAP,oCAAUA,CAAV,6SAAa,CAAxD,IAA4D,CAAC,GAAIG,EAAJ,CAAM,GAAG,MAAON,OAAP,GAAgB,WAAnB,CAA+B,CAACM,EAAEN,MAAF,CAAS,CAAzC,IAA8C,IAAG,MAAOO,OAAP,GAAgB,WAAnB,CAA+B,CAACD,EAAEC,MAAF,CAAS,CAAzC,IAA8C,IAAG,MAAOC,KAAP,GAAc,WAAjB,CAA6B,CAACF,EAAEE,IAAF,CAAO,CAArC,IAAyC,CAACF,EAAE,IAAF,CAAO,GAAEG,WAAF,CAAgBN,GAAhB,CAAoB,CAAC,CAArU,EAAuU,UAAU,CAAC,GAAIO,OAAJ,CAAWL,MAAX,CAAkBD,OAAlB,CAA0B,MAAQ,SAASO,EAAT,CAAWC,CAAX,CAAaC,CAAb,CAAeC,CAAf,CAAiB,CAAC,QAASC,EAAT,CAAWC,CAAX,CAAaC,CAAb,CAAe,CAAC,GAAG,CAACJ,EAAEG,CAAF,CAAJ,CAAS,CAAC,GAAG,CAACJ,EAAEI,CAAF,CAAJ,CAAS,CAAC,GAAIE,GAAE,MAAOC,QAAP,EAAgB,UAAhB,EAA4BA,OAAlC,CAA0C,GAAG,CAACF,CAAD,EAAIC,CAAP,CAAS,MAAOA,CAAA,OAAAA,CAAEF,CAAF,CAAI,CAAC,CAAL,CAAP,CAAe,GAAGI,CAAH,CAAK,MAAOA,GAAEJ,CAAF,CAAI,CAAC,CAAL,CAAP,CAAe,GAAIb,GAAE,GAAIkB,MAAJ,CAAU,uBAAuBL,CAAvB,CAAyB,GAAnC,CAAN,CAA8C,KAAMb,GAAEmB,IAAF,CAAO,kBAAP,CAA0BnB,CAAhC,CAAkC,IAAIoB,GAAEV,EAAEG,CAAF,EAAK,CAACZ,QAAQ,EAAT,CAAX,CAAwBQ,EAAEI,CAAF,EAAK,CAAL,EAAQQ,IAAR,CAAaD,EAAEnB,OAAf,CAAuB,SAASO,CAAT,CAAW,CAAC,GAAIE,GAAED,EAAEI,CAAF,EAAK,CAAL,EAAQL,CAAR,CAAN,CAAiB,MAAOI,GAAEF,EAAEA,CAAF,CAAIF,CAAN,CAAP,CAAgB,CAApE,CAAqEY,CAArE,CAAuEA,EAAEnB,OAAzE,CAAiFO,CAAjF,CAAmFC,CAAnF,CAAqFC,CAArF,CAAuFC,CAAvF,EAA0F,OAAOD,GAAEG,CAAF,EAAKZ,OAAZ,CAAoB,IAAIgB,GAAE,MAAOD,QAAP,EAAgB,UAAhB,EAA4BA,OAAlC,CAA0C,IAAI,GAAIH,GAAE,CAAV,CAAYA,EAAEF,EAAEW,MAAhB,CAAuBT,GAAvB,EAA2BD,EAAED,EAAEE,CAAF,CAAF,EAA3B,CAAmC,MAAOD,EAAP,CAAS,CAAzb,CAA2b,CAAC,EAAE,CAAC,SAASW,OAAT,CAAiBrB,MAAjB,CAAwBD,OAAxB,CAAgC,CACl1B,CAAC,SAAUG,MAAV,CAAiB,CAClB,kDACA,CAAE,UAASoB,IAAT,CAAe,CAEhB,4BACA,GAAIC,aAAc,OAAOxB,QAAP,mCAAOA,OAAP,IAAkB,QAAlB,EAA8BA,OAA9B,EACjB,CAACA,QAAQyB,QADQ,EACIzB,OADtB,CAEA,GAAI0B,YAAa,OAAOzB,OAAP,mCAAOA,MAAP,IAAiB,QAAjB,EAA6BA,MAA7B,EAChB,CAACA,OAAOwB,QADQ,EACIxB,MADrB,CAEA,GAAI0B,YAAa,OAAOxB,OAAP,mCAAOA,MAAP,IAAiB,QAAjB,EAA6BA,MAA9C,CACA,GACCwB,WAAWxB,MAAX,GAAsBwB,UAAtB,EACAA,WAAW/B,MAAX,GAAsB+B,UADtB,EAEAA,WAAWvB,IAAX,GAAoBuB,UAHrB,CAIE,CACDJ,KAAOI,UAAP,CACA,CAED;;;;KAKA,GAAIC,SAAJ,CAEA,iDACAC,OAAS,UAHT,CAGqB;AAErB,6BACAC,KAAO,EANP,CAOAC,KAAO,CAPP,CAQAC,KAAO,EARP,CASAC,KAAO,EATP,CAUAC,KAAO,GAVP,CAWAC,YAAc,EAXd,CAYAC,SAAW,GAZX,CAYgB;AAChBC,WAAY,GAbZ,CAaiB;AAEjB,2BACAC,cAAgB,OAhBhB,CAiBAC,cAAgB,cAjBhB,CAiBgC;AAChCC,iBAAkB,2BAlBlB,CAkB+C;AAE/C,sBACAC,OAAS,CACR,WAAY,iDADJ,CAER,YAAa,gDAFL,CAGR,gBAAiB,eAHT,CArBT,CA2BA,4BACAC,cAAgBZ,KAAOC,IA5BvB,CA6BAY,MAAQC,KAAKD,KA7Bb,CA8BAE,mBAAqBC,OAAOC,YA9B5B,CAgCA,yBACAC,GAjCA,CAmCA,8EAEA;;;;;KAMA,QAASC,MAAT,CAAeC,IAAf,CAAqB,CACpB,KAAM,IAAIC,WAAJ,CAAeV,OAAOS,IAAP,CAAf,CAAN,CACA,CAED;;;;;;;KAQA,QAASE,IAAT,CAAaC,KAAb,CAAoBC,EAApB,CAAwB,CACvB,GAAIjC,QAASgC,MAAMhC,MAAnB,CACA,GAAIkC,QAAS,EAAb,CACA,MAAOlC,QAAP,CAAiB,CAChBkC,OAAOlC,MAAP,EAAiBiC,GAAGD,MAAMhC,MAAN,CAAH,CAAjB,CACA,CACD,MAAOkC,OAAP,CACA,CAED;;;;;;;;;KAUA,QAASC,UAAT,CAAmBC,MAAnB,CAA2BH,EAA3B,CAA+B,CAC9B,GAAII,OAAQD,OAAOE,KAAP,CAAa,GAAb,CAAZ,CACA,GAAIJ,QAAS,EAAb,CACA,GAAIG,MAAMrC,MAAN,CAAe,CAAnB,CAAsB,CACrB;AACA;AACAkC,QAASG,MAAM,CAAN,EAAW,GAApB,CACAD,OAASC,MAAM,CAAN,CAAT,CACA,CACD;AACAD,QAASA,OAAOG,OAAP,CAAepB,eAAf,CAAgC,MAAhC,CAAT,CACA,GAAIqB,QAASJ,OAAOE,KAAP,CAAa,GAAb,CAAb,CACA,GAAIG,SAAUV,IAAIS,MAAJ,CAAYP,EAAZ,EAAgBS,IAAhB,CAAqB,GAArB,CAAd,CACA,MAAOR,QAASO,OAAhB,CACA,CAED;;;;;;;;;;;;KAaA,QAASE,WAAT,CAAoBP,MAApB,CAA4B,CAC3B,GAAIQ,QAAS,EAAb,CACIC,QAAU,CADd,CAEI7C,OAASoC,OAAOpC,MAFpB,CAGI8C,KAHJ,CAIIC,KAJJ,CAKA,MAAOF,QAAU7C,MAAjB,CAAyB,CACxB8C,MAAQV,OAAOY,UAAP,CAAkBH,SAAlB,CAAR,CACA,GAAIC,OAAS,MAAT,EAAmBA,OAAS,MAA5B,EAAsCD,QAAU7C,MAApD,CAA4D,CAC3D;AACA+C,OAAQX,OAAOY,UAAP,CAAkBH,SAAlB,CAAR,CACA,GAAI,CAACE,MAAQ,MAAT,GAAoB,MAAxB,CAAgC,CAAE;AACjCH,QAAOK,IAAP,CAAY,CAAC,CAACH,MAAQ,KAAT,GAAmB,EAApB,GAA2BC,MAAQ,KAAnC,EAA4C,OAAxD,EACA,CAFD,IAEO,CACN;AACA;AACAH,QAAOK,IAAP,CAAYH,KAAZ,EACAD,UACA,CACD,CAXD,IAWO,CACND,OAAOK,IAAP,CAAYH,KAAZ,EACA,CACD,CACD,MAAOF,OAAP,CACA,CAED;;;;;;;KAQA,QAASM,WAAT,CAAoBlB,KAApB,CAA2B,CAC1B,MAAOD,KAAIC,KAAJ,CAAW,SAASc,KAAT,CAAgB,CACjC,GAAIF,QAAS,EAAb,CACA,GAAIE,MAAQ,MAAZ,CAAoB,CACnBA,OAAS,OAAT,CACAF,QAAUpB,mBAAmBsB,QAAU,EAAV,CAAe,KAAf,CAAuB,MAA1C,CAAV,CACAA,MAAQ,OAASA,MAAQ,KAAzB,CACA,CACDF,QAAUpB,mBAAmBsB,KAAnB,CAAV,CACA,MAAOF,OAAP,CACA,CATM,EASJF,IATI,CASC,EATD,CAAP,CAUA,CAED;;;;;;;;KASA,QAASS,aAAT,CAAsBC,SAAtB,CAAiC,CAChC,GAAIA,UAAY,EAAZ,CAAiB,EAArB,CAAyB,CACxB,MAAOA,WAAY,EAAnB,CACA,CACD,GAAIA,UAAY,EAAZ,CAAiB,EAArB,CAAyB,CACxB,MAAOA,WAAY,EAAnB,CACA,CACD,GAAIA,UAAY,EAAZ,CAAiB,EAArB,CAAyB,CACxB,MAAOA,WAAY,EAAnB,CACA,CACD,MAAO3C,KAAP,CACA,CAED;;;;;;;;;;KAWA,QAAS4C,aAAT,CAAsBC,KAAtB,CAA6BC,IAA7B,CAAmC,CAClC;AACA;AACA,OAAOD,OAAQ,EAAR,CAAa,IAAMA,MAAQ,EAAd,CAAb,EAAkC,CAACC,MAAQ,CAAT,GAAe,CAAjD,CAAP,CACA,CAED;;;;KAKA,QAASC,MAAT,CAAeC,KAAf,CAAsBC,SAAtB,CAAiCC,SAAjC,CAA4C,CAC3C,GAAIC,GAAI,CAAR,CACAH,MAAQE,UAAYrC,MAAMmC,MAAQ5C,IAAd,CAAZ,CAAkC4C,OAAS,CAAnD,CACAA,OAASnC,MAAMmC,MAAQC,SAAd,CAAT,CACA,KAAK,uBAAyBD,MAAQpC,cAAgBV,IAAhB,EAAwB,CAA9D,CAAiEiD,GAAKnD,IAAtE,CAA4E,CAC3EgD,MAAQnC,MAAMmC,MAAQpC,aAAd,CAAR,CACA,CACD,MAAOC,OAAMsC,EAAI,CAACvC,cAAgB,CAAjB,EAAsBoC,KAAtB,EAA+BA,MAAQ7C,IAAvC,CAAV,CAAP,CACA,CAED;;;;;;KAOA,QAASiD,OAAT,CAAgBC,KAAhB,CAAuB,CACtB;AACA,IAAIlB,QAAS,EAAb,CACImB,YAAcD,MAAM9D,MADxB,CAEIgE,GAFJ,CAGIrE,EAAI,CAHR,CAIIP,EAAI2B,QAJR,CAKIkD,KAAOnD,WALX,CAMIoD,KANJ,CAOIC,CAPJ,CAQIC,KARJ,CASIC,IATJ,CAUIrG,CAVJ,CAWI4F,CAXJ,CAYIN,KAZJ,CAaInE,CAbJ,CAcI,iCACAmF,UAfJ,CAiBA;AACA;AACA;AAEAJ,OAAQJ,MAAMS,WAAN,CAAkBvD,SAAlB,CAAR,CACA,GAAIkD,MAAQ,CAAZ,CAAe,CACdA,MAAQ,CAAR,CACA,CAED,IAAKC,EAAI,CAAT,CAAYA,EAAID,KAAhB,CAAuB,EAAEC,CAAzB,CAA4B,CAC3B;AACA,IAAIL,MAAMd,UAAN,CAAiBmB,CAAjB,GAAuB,IAA3B,CAAiC,CAChCvC,MAAM,WAAN,EACA,CACDgB,OAAOK,IAAP,CAAYa,MAAMd,UAAN,CAAiBmB,CAAjB,CAAZ,EACA,CAED;AACA;AAEA,KAAKC,MAAQF,MAAQ,CAAR,CAAYA,MAAQ,CAApB,CAAwB,CAArC,CAAwCE,MAAQL,WAAhD,EAA6D,yBAA2B,CAEvF;AACA;AACA;AACA;AACA;AACA,KAAKM,KAAO1E,CAAP,CAAU3B,EAAI,CAAd,CAAiB4F,EAAInD,IAA1B,EAAgC,kBAAoBmD,GAAKnD,IAAzD,CAA+D,CAE9D,GAAI2D,OAASL,WAAb,CAA0B,CACzBnC,MAAM,eAAN,EACA,CAED0B,MAAQH,aAAaW,MAAMd,UAAN,CAAiBoB,OAAjB,CAAb,CAAR,CAEA,GAAId,OAAS7C,IAAT,EAAiB6C,MAAQhC,MAAM,CAACd,OAASb,CAAV,EAAe3B,CAArB,CAA7B,CAAsD,CACrD4D,MAAM,UAAN,EACA,CAEDjC,GAAK2D,MAAQtF,CAAb,CACAmB,EAAIyE,GAAKK,IAAL,CAAYvD,IAAZ,CAAoBkD,GAAKK,KAAOtD,IAAZ,CAAmBA,IAAnB,CAA0BiD,EAAIK,IAAtD,CAEA,GAAIX,MAAQnE,CAAZ,CAAe,CACd,MACA,CAEDmF,WAAa7D,KAAOtB,CAApB,CACA,GAAInB,EAAIsD,MAAMd,OAAS8D,UAAf,CAAR,CAAoC,CACnC1C,MAAM,UAAN,EACA,CAED5D,GAAKsG,UAAL,CAEA,CAEDN,IAAMpB,OAAO5C,MAAP,CAAgB,CAAtB,CACAiE,KAAOT,MAAM7D,EAAI0E,IAAV,CAAgBL,GAAhB,CAAqBK,MAAQ,CAA7B,CAAP,CAEA;AACA;AACA,IAAI/C,MAAM3B,EAAIqE,GAAV,EAAiBxD,OAASpB,CAA9B,CAAiC,CAChCwC,MAAM,UAAN,EACA,CAEDxC,GAAKkC,MAAM3B,EAAIqE,GAAV,CAAL,CACArE,GAAKqE,GAAL,CAEA;AACApB,QAAO4B,MAAP,CAAc7E,GAAd,CAAmB,CAAnB,CAAsBP,CAAtB,EAEA,CAED,MAAO8D,YAAWN,MAAX,CAAP,CACA,CAED;;;;;;KAOA,QAAS6B,OAAT,CAAgBX,KAAhB,CAAuB,CACtB,GAAI1E,EAAJ,CACIqE,KADJ,CAEIiB,cAFJ,CAGIC,WAHJ,CAIIV,IAJJ,CAKIE,CALJ,CAMIS,CANJ,CAOIC,CAPJ,CAQIjB,CARJ,CASIzE,CATJ,CAUI2F,YAVJ,CAWIlC,OAAS,EAXb,CAYI,oEACAmB,WAbJ,CAcI,iCACAgB,qBAfJ,CAgBIT,UAhBJ,CAiBIU,OAjBJ,CAmBA;AACAlB,OAAQnB,WAAWmB,KAAX,CAAR,CAEA;AACAC,aAAcD,MAAM9D,MAApB,CAEA;AACAZ,GAAI2B,QAAJ,CACA0C,MAAQ,CAAR,CACAQ,KAAOnD,WAAP,CAEA;AACA,KAAKqD,EAAI,CAAT,CAAYA,EAAIJ,WAAhB,CAA6B,EAAEI,CAA/B,CAAkC,CACjCW,aAAehB,MAAMK,CAAN,CAAf,CACA,GAAIW,aAAe,IAAnB,CAAyB,CACxBlC,OAAOK,IAAP,CAAYzB,mBAAmBsD,YAAnB,CAAZ,EACA,CACD,CAEDJ,eAAiBC,YAAc/B,OAAO5C,MAAtC,CAEA;AACA;AAEA;AACA,IAAI2E,WAAJ,CAAiB,CAChB/B,OAAOK,IAAP,CAAYjC,SAAZ,EACA,CAED;AACA,OAAO0D,eAAiBX,WAAxB,CAAqC,CAEpC;AACA;AACA,KAAKa,EAAIpE,MAAJ,CAAY2D,EAAI,CAArB,CAAwBA,EAAIJ,WAA5B,CAAyC,EAAEI,CAA3C,CAA8C,CAC7CW,aAAehB,MAAMK,CAAN,CAAf,CACA,GAAIW,cAAgB1F,CAAhB,EAAqB0F,aAAeF,CAAxC,CAA2C,CAC1CA,EAAIE,YAAJ,CACA,CACD,CAED;AACA;AACAC,uBAAwBL,eAAiB,CAAzC,CACA,GAAIE,EAAIxF,CAAJ,CAAQkC,MAAM,CAACd,OAASiD,KAAV,EAAmBsB,qBAAzB,CAAZ,CAA6D,CAC5DnD,MAAM,UAAN,EACA,CAED6B,OAAS,CAACmB,EAAIxF,CAAL,EAAU2F,qBAAnB,CACA3F,EAAIwF,CAAJ,CAEA,IAAKT,EAAI,CAAT,CAAYA,EAAIJ,WAAhB,CAA6B,EAAEI,CAA/B,CAAkC,CACjCW,aAAehB,MAAMK,CAAN,CAAf,CAEA,GAAIW,aAAe1F,CAAf,EAAoB,EAAEqE,KAAF,CAAUjD,MAAlC,CAA0C,CACzCoB,MAAM,UAAN,EACA,CAED,GAAIkD,cAAgB1F,CAApB,CAAuB,CACtB;AACA,KAAKyF,EAAIpB,KAAJ,CAAWG,EAAInD,IAApB,EAA0B,kBAAoBmD,GAAKnD,IAAnD,CAAyD,CACxDtB,EAAIyE,GAAKK,IAAL,CAAYvD,IAAZ,CAAoBkD,GAAKK,KAAOtD,IAAZ,CAAmBA,IAAnB,CAA0BiD,EAAIK,IAAtD,CACA,GAAIY,EAAI1F,CAAR,CAAW,CACV,MACA,CACD6F,QAAUH,EAAI1F,CAAd,CACAmF,WAAa7D,KAAOtB,CAApB,CACAyD,OAAOK,IAAP,CACCzB,mBAAmB6B,aAAalE,EAAI6F,QAAUV,UAA3B,CAAuC,CAAvC,CAAnB,CADD,EAGAO,EAAIvD,MAAM0D,QAAUV,UAAhB,CAAJ,CACA,CAED1B,OAAOK,IAAP,CAAYzB,mBAAmB6B,aAAawB,CAAb,CAAgB,CAAhB,CAAnB,CAAZ,EACAZ,KAAOT,MAAMC,KAAN,CAAasB,qBAAb,CAAoCL,gBAAkBC,WAAtD,CAAP,CACAlB,MAAQ,CAAR,CACA,EAAEiB,cAAF,CACA,CACD,CAED,EAAEjB,KAAF,CACA,EAAErE,CAAF,CAEA,CACD,MAAOwD,QAAOF,IAAP,CAAY,EAAZ,CAAP,CACA,CAED;;;;;;;;;;KAWA,QAASuC,UAAT,CAAmBnB,KAAnB,CAA0B,CACzB,MAAO3B,WAAU2B,KAAV,CAAiB,SAAS1B,MAAT,CAAiB,CACxC,MAAOnB,eAAciE,IAAd,CAAmB9C,MAAnB,EACJyB,OAAOzB,OAAO+C,KAAP,CAAa,CAAb,EAAgBC,WAAhB,EAAP,CADI,CAEJhD,MAFH,CAGA,CAJM,CAAP,CAKA,CAED;;;;;;;;;;KAWA,QAASiD,QAAT,CAAiBvB,KAAjB,CAAwB,CACvB,MAAO3B,WAAU2B,KAAV,CAAiB,SAAS1B,MAAT,CAAiB,CACxC,MAAOlB,eAAcgE,IAAd,CAAmB9C,MAAnB,EACJ,OAASqC,OAAOrC,MAAP,CADL,CAEJA,MAFH,CAGA,CAJM,CAAP,CAKA,CAED,8EAEA,4BACA7B,SAAW,CACV;;;;MAKA,UAAW,OAND,CAOV;;;;;;MAOA,OAAQ,CACP,SAAUoC,UADH,CAEP,SAAUO,UAFH,CAdE,CAkBV,SAAUW,MAlBA,CAmBV,SAAUY,MAnBA,CAoBV,UAAWY,OApBD,CAqBV,YAAaJ,SArBH,CAAX,CAwBA,wBACA;AACA;AACA,IACC,MAAOhG,OAAP,EAAiB,UAAjB,EACA,QAAOA,OAAOqG,GAAd,GAAqB,QADrB,EAEArG,OAAOqG,GAHR,CAIE,CACDrG,OAAO,UAAP,CAAmB,UAAW,CAC7B,MAAOsB,SAAP,CACA,CAFD,EAGA,CARD,IAQO,IAAIJ,aAAeE,UAAnB,CAA+B,CACrC,GAAIzB,OAAOD,OAAP,EAAkBwB,WAAtB,CAAmC,CAClC;AACAE,YAAW1B,OAAX,CAAqB4B,QAArB,CACA,CAHD,IAGO,CACN;AACA,KAAKoB,GAAL,GAAYpB,SAAZ,CAAsB,CACrBA,SAASgF,cAAT,CAAwB5D,GAAxB,IAAiCxB,YAAYwB,GAAZ,EAAmBpB,SAASoB,GAAT,CAApD,EACA,CACD,CACD,CAVM,IAUA,CACN;AACAzB,MAAKK,QAAL,CAAgBA,QAAhB,CACA,CAED,CAnhBC,EAmhBA,IAnhBA,CAAD,CAqhBA,CAvhBD,EAuhBGR,IAvhBH,CAuhBQ,IAvhBR,CAuhBa,MAAOjB,OAAP,GAAkB,WAAlB,CAAgCA,MAAhC,CAAyC,MAAOC,KAAP,GAAgB,WAAhB,CAA8BA,IAA9B,CAAqC,MAAOR,OAAP,GAAkB,WAAlB,CAAgCA,MAAhC,CAAyC,EAvhBpI,EAwhBC,CAzhBgzB,CAyhB/yB,EAzhB+yB,CAAH,CAyhBxyB,EAAE,CAAC,SAAS0B,OAAT,CAAiBrB,MAAjB,CAAwBD,OAAxB,CAAgC,CACzC,GAAI7C,KAAMmE,QAAQ,OAAR,CAAV,CAEA,QAASuF,mBAAT,CAA4BC,aAA5B,CAA2C3H,CAA3C,CAA8CC,CAA9C,CAAiD,CAC7C,GAAI0H,cAAcC,WAAd,GAA8B5H,IAAM2H,cAAcC,WAAd,CAA0BC,WAAhC,EAA+C5H,IAAM0H,cAAcC,WAAd,CAA0BE,WAA7G,CAAJ,CAA+H,CAC3HH,cAAcC,WAAd,CAA0BG,QAA1B,CAAmC/H,CAAnC,CAAsCC,CAAtC,EACH,CACJ,CAED,QAAS+H,oBAAT,CAA6B7J,MAA7B,CAAqC8J,YAArC,CAAmD,CAC/C,GAAI,CACA,GAAIA,YAAJ,CAAkB,CACdA,aAAazJ,KAAb,CAAqBL,OAAOK,KAA5B,CACAyJ,aAAaxJ,MAAb,CAAsBN,OAAOM,MAA7B,CACAwJ,aAAatI,UAAb,CAAwB,IAAxB,EAA8BW,YAA9B,CAA2CnC,OAAOwB,UAAP,CAAkB,IAAlB,EAAwBI,YAAxB,CAAqC,CAArC,CAAwC,CAAxC,CAA2C5B,OAAOK,KAAlD,CAAyDL,OAAOM,MAAhE,CAA3C,CAAoH,CAApH,CAAuH,CAAvH,EACH,CACJ,CAAC,MAAM2C,CAAN,CAAS,CACPpD,IAAI,oCAAJ,CAA0CG,MAA1C,CAAkDiD,CAAlD,EACH,CACJ,CAED,QAAS8G,UAAT,CAAmBC,IAAnB,CAAyBC,iBAAzB,CAA4C,CACxC,GAAIC,OAAQF,KAAK7F,QAAL,GAAkB,CAAlB,CAAsBgG,SAASlJ,cAAT,CAAwB+I,KAAKI,SAA7B,CAAtB,CAAgEJ,KAAKD,SAAL,CAAe,KAAf,CAA5E,CAEA,GAAIM,OAAQL,KAAKM,UAAjB,CACA,MAAMD,KAAN,CAAa,CACT,GAAIJ,oBAAsB,IAAtB,EAA8BI,MAAMlG,QAAN,GAAmB,CAAjD,EAAsDkG,MAAME,QAAN,GAAmB,QAA7E,CAAuF,CACnFL,MAAMtJ,WAAN,CAAkBmJ,UAAUM,KAAV,CAAiBJ,iBAAjB,CAAlB,EACH,CACDI,MAAQA,MAAMG,WAAd,CACH,CAED,GAAIR,KAAK7F,QAAL,GAAkB,CAAtB,CAAyB,CACrB+F,MAAMO,UAAN,CAAmBT,KAAKU,SAAxB,CACAR,MAAMS,WAAN,CAAoBX,KAAKY,UAAzB,CACA,GAAIZ,KAAKO,QAAL,GAAkB,QAAtB,CAAgC,CAC5BV,oBAAoBG,IAApB,CAA0BE,KAA1B,EACH,CAFD,IAEO,IAAIF,KAAKO,QAAL,GAAkB,UAAlB,EAAgCP,KAAKO,QAAL,GAAkB,QAAtD,CAAgE,CACnEL,MAAMrD,KAAN,CAAcmD,KAAKnD,KAAnB,CACH,CACJ,CAED,MAAOqD,MAAP,CACH,CAED,QAASW,SAAT,CAAkBb,IAAlB,CAAwB,CACpB,GAAIA,KAAK7F,QAAL,GAAkB,CAAtB,CAAyB,CACrB6F,KAAKU,SAAL,CAAiBV,KAAKS,UAAtB,CACAT,KAAKY,UAAL,CAAkBZ,KAAKW,WAAvB,CAEA,GAAIN,OAAQL,KAAKM,UAAjB,CACA,MAAMD,KAAN,CAAa,CACTQ,SAASR,KAAT,EACAA,MAAQA,MAAMG,WAAd,CACH,CACJ,CACJ,CAED7H,OAAOD,OAAP,CAAiB,SAAS8G,aAAT,CAAwBsB,iBAAxB,CAA2CzK,KAA3C,CAAkDC,MAAlD,CAA0Df,OAA1D,CAAmEsC,CAAnE,CAAsEC,CAAtE,CAAyE,CACtF,GAAIiJ,iBAAkBhB,UAAUP,cAAcuB,eAAxB,CAAyCxL,QAAQ0K,iBAAjD,CAAtB,CACA,GAAIe,WAAYF,kBAAkB3K,aAAlB,CAAgC,QAAhC,CAAhB,CAEA6K,UAAUC,SAAV,CAAsB,uBAAtB,CACAD,UAAUzK,KAAV,CAAgB2K,UAAhB,CAA6B,QAA7B,CACAF,UAAUzK,KAAV,CAAgBC,QAAhB,CAA2B,OAA3B,CACAwK,UAAUzK,KAAV,CAAgBE,IAAhB,CAAuB,UAAvB,CACAuK,UAAUzK,KAAV,CAAgBG,GAAhB,CAAsB,KAAtB,CACAsK,UAAUzK,KAAV,CAAgB4K,MAAhB,CAAyB,GAAzB,CACAH,UAAU3K,KAAV,CAAkBA,KAAlB,CACA2K,UAAU1K,MAAV,CAAmBA,MAAnB,CACA0K,UAAUI,SAAV,CAAsB,IAAtB,CAA4B;AAC5BN,mBAAkBnK,IAAlB,CAAuBC,WAAvB,CAAmCoK,SAAnC,EAEA,MAAO,IAAIK,QAAJ,CAAY,SAASC,OAAT,CAAkB,CACjC,GAAIC,eAAgBP,UAAUQ,aAAV,CAAwBrB,QAA5C,CAEA;;YAGAa,UAAUQ,aAAV,CAAwBC,MAAxB,CAAiCT,UAAUS,MAAV,CAAmB,UAAW,CAC3D,GAAIC,UAAWC,YAAY,UAAW,CAClC,GAAIJ,cAAc5K,IAAd,CAAmBiL,UAAnB,CAA8B7H,MAA9B,CAAuC,CAA3C,CAA8C,CAC1C8G,SAASU,cAAcR,eAAvB,EACAc,cAAcH,QAAd,EACA,GAAInM,QAAQqG,IAAR,GAAiB,MAArB,CAA6B,CACzBoF,UAAUQ,aAAV,CAAwB5B,QAAxB,CAAiC/H,CAAjC,CAAoCC,CAApC,EACA,GAAK,qBAAD,CAAwBmH,IAAxB,CAA6B6C,UAAUC,SAAvC,IAAsDf,UAAUQ,aAAV,CAAwBQ,OAAxB,GAAoClK,CAApC,EAAyCkJ,UAAUQ,aAAV,CAAwBS,OAAxB,GAAoCpK,CAAnI,CAAJ,CAA2I,CACvI0J,cAAcR,eAAd,CAA8BxK,KAA9B,CAAoCG,GAApC,CAA2C,CAACoB,CAAF,CAAO,IAAjD,CACAyJ,cAAcR,eAAd,CAA8BxK,KAA9B,CAAoCE,IAApC,CAA4C,CAACoB,CAAF,CAAO,IAAlD,CACA0J,cAAcR,eAAd,CAA8BxK,KAA9B,CAAoCC,QAApC,CAA+C,UAA/C,CACH,CACJ,CACD8K,QAAQN,SAAR,EACH,CACJ,CAdc,CAcZ,EAdY,CAAf,CAeH,CAhBD,CAkBAO,cAAcW,IAAd,GACAX,cAAcY,KAAd,CAAoB,8BAApB,EACA;AACA5C,oBAAmBC,aAAnB,CAAkC3H,CAAlC,CAAqCC,CAArC,EACAyJ,cAAca,YAAd,CAA2Bb,cAAcc,SAAd,CAAwBtB,eAAxB,CAA3B,CAAqEQ,cAAcR,eAAnF,EACAQ,cAAce,KAAd,GACH,CA9BM,CAAP,CA+BH,CA9CD,CAgDC,CA1GO,CA0GN,CAAC,QAAQ,EAAT,CA1GM,CAzhBsyB,CAmoB9xB,EAAE,CAAC,SAAStI,OAAT,CAAiBrB,MAAjB,CAAwBD,OAAxB,CAAgC,CACnD;AAEA,SAAS6J,MAAT,CAAe1F,KAAf,CAAsB,CAClB,KAAKzD,CAAL,CAAS,CAAT,CACA,KAAKR,CAAL,CAAS,CAAT,CACA,KAAK4J,CAAL,CAAS,CAAT,CACA,KAAKhJ,CAAL,CAAS,IAAT,CACA,GAAIyC,QAAS,KAAKwG,SAAL,CAAe5F,KAAf,GACT,KAAK6F,UAAL,CAAgB7F,KAAhB,CADS,EAET,KAAK8F,GAAL,CAAS9F,KAAT,CAFS,EAGT,KAAK+F,IAAL,CAAU/F,KAAV,CAHS,EAIT,KAAKgG,IAAL,CAAUhG,KAAV,CAJS,EAKT,KAAKiG,IAAL,CAAUjG,KAAV,CALJ,CAMH,CAED0F,MAAMQ,SAAN,CAAgBC,MAAhB,CAAyB,SAASC,MAAT,CAAiB,CACtC,GAAIzJ,GAAI,EAAIyJ,MAAZ,CACA,MAAQ,IAAIV,MAAJ,CAAU,CACdjH,KAAK4H,KAAL,CAAW,KAAK9J,CAAL,CAASI,CAApB,CADc,CAEd8B,KAAK4H,KAAL,CAAW,KAAKtK,CAAL,CAASY,CAApB,CAFc,CAGd8B,KAAK4H,KAAL,CAAW,KAAKV,CAAL,CAAShJ,CAApB,CAHc,CAId,KAAKA,CAJS,CAAV,CAAR,CAMH,CARD,CAUA+I,MAAMQ,SAAN,CAAgBI,aAAhB,CAAgC,UAAW,CACvC,MAAO,MAAK3J,CAAL,GAAW,CAAlB,CACH,CAFD,CAIA+I,MAAMQ,SAAN,CAAgBK,OAAhB,CAA0B,UAAW,CACjC,MAAO,MAAKhK,CAAL,GAAW,CAAX,EAAgB,KAAKR,CAAL,GAAW,CAA3B,EAAgC,KAAK4J,CAAL,GAAW,CAAlD,CACH,CAFD,CAIAD,MAAMQ,SAAN,CAAgBN,SAAhB,CAA4B,SAAS1G,KAAT,CAAgB,CACxC,GAAIsH,MAAMC,OAAN,CAAcvH,KAAd,CAAJ,CAA0B,CACtB,KAAK3C,CAAL,CAASkC,KAAKiI,GAAL,CAASxH,MAAM,CAAN,CAAT,CAAmB,GAAnB,CAAT,CACA,KAAKnD,CAAL,CAAS0C,KAAKiI,GAAL,CAASxH,MAAM,CAAN,CAAT,CAAmB,GAAnB,CAAT,CACA,KAAKyG,CAAL,CAASlH,KAAKiI,GAAL,CAASxH,MAAM,CAAN,CAAT,CAAmB,GAAnB,CAAT,CACA,GAAIA,MAAMhC,MAAN,CAAe,CAAnB,CAAsB,CAClB,KAAKP,CAAL,CAASuC,MAAM,CAAN,CAAT,CACH,CACJ,CAED,MAAQsH,OAAMC,OAAN,CAAcvH,KAAd,CAAR,CACH,CAXD,CAaA,GAAIyH,OAAQ,mBAAZ,CAEAjB,MAAMQ,SAAN,CAAgBD,IAAhB,CAAuB,SAASjG,KAAT,CAAgB,CACnC,GAAI4G,OAAQ,IAAZ,CACA,GAAI,CAACA,MAAQ5G,MAAM4G,KAAN,CAAYD,KAAZ,CAAT,IAAiC,IAArC,CAA2C,CACvC,KAAKpK,CAAL,CAASsK,SAASD,MAAM,CAAN,EAAS,CAAT,EAAcA,MAAM,CAAN,EAAS,CAAT,CAAvB,CAAoC,EAApC,CAAT,CACA,KAAK7K,CAAL,CAAS8K,SAASD,MAAM,CAAN,EAAS,CAAT,EAAcA,MAAM,CAAN,EAAS,CAAT,CAAvB,CAAoC,EAApC,CAAT,CACA,KAAKjB,CAAL,CAASkB,SAASD,MAAM,CAAN,EAAS,CAAT,EAAcA,MAAM,CAAN,EAAS,CAAT,CAAvB,CAAoC,EAApC,CAAT,CACH,CACD,MAAOA,SAAU,IAAjB,CACH,CARD,CAUA,GAAIE,OAAQ,mBAAZ,CAEApB,MAAMQ,SAAN,CAAgBF,IAAhB,CAAuB,SAAShG,KAAT,CAAgB,CACnC,GAAI4G,OAAQ,IAAZ,CACA,GAAI,CAACA,MAAQ5G,MAAM4G,KAAN,CAAYE,KAAZ,CAAT,IAAiC,IAArC,CAA2C,CACvC,KAAKvK,CAAL,CAASsK,SAASD,MAAM,CAAN,EAASG,SAAT,CAAmB,CAAnB,CAAsB,CAAtB,CAAT,CAAmC,EAAnC,CAAT,CACA,KAAKhL,CAAL,CAAS8K,SAASD,MAAM,CAAN,EAASG,SAAT,CAAmB,CAAnB,CAAsB,CAAtB,CAAT,CAAmC,EAAnC,CAAT,CACA,KAAKpB,CAAL,CAASkB,SAASD,MAAM,CAAN,EAASG,SAAT,CAAmB,CAAnB,CAAsB,CAAtB,CAAT,CAAmC,EAAnC,CAAT,CACH,CACD,MAAOH,SAAU,IAAjB,CACH,CARD,CAWA,GAAII,MAAO,0DAAX,CAEAtB,MAAMQ,SAAN,CAAgBJ,GAAhB,CAAsB,SAAS9F,KAAT,CAAgB,CAClC,GAAI4G,OAAQ,IAAZ,CACA,GAAI,CAACA,MAAQ5G,MAAM4G,KAAN,CAAYI,IAAZ,CAAT,IAAgC,IAApC,CAA0C,CACtC,KAAKzK,CAAL,CAAS0K,OAAOL,MAAM,CAAN,CAAP,CAAT,CACA,KAAK7K,CAAL,CAASkL,OAAOL,MAAM,CAAN,CAAP,CAAT,CACA,KAAKjB,CAAL,CAASsB,OAAOL,MAAM,CAAN,CAAP,CAAT,CACH,CACD,MAAOA,SAAU,IAAjB,CACH,CARD,CAUA,GAAIM,OAAQ,6EAAZ,CAEAxB,MAAMQ,SAAN,CAAgBH,IAAhB,CAAuB,SAAS/F,KAAT,CAAgB,CACnC,GAAI4G,OAAQ,IAAZ,CACA,GAAI,CAACA,MAAQ5G,MAAM4G,KAAN,CAAYM,KAAZ,CAAT,IAAiC,IAArC,CAA2C,CACvC,KAAK3K,CAAL,CAAS0K,OAAOL,MAAM,CAAN,CAAP,CAAT,CACA,KAAK7K,CAAL,CAASkL,OAAOL,MAAM,CAAN,CAAP,CAAT,CACA,KAAKjB,CAAL,CAASsB,OAAOL,MAAM,CAAN,CAAP,CAAT,CACA,KAAKjK,CAAL,CAASsK,OAAOL,MAAM,CAAN,CAAP,CAAT,CACH,CACD,MAAOA,SAAU,IAAjB,CACH,CATD,CAWAlB,MAAMQ,SAAN,CAAgBiB,QAAhB,CAA2B,UAAW,CAClC,MAAO,MAAKxK,CAAL,GAAW,IAAX,EAAmB,KAAKA,CAAL,GAAW,CAA9B,CACP,QAAU,CAAC,KAAKJ,CAAN,CAAS,KAAKR,CAAd,CAAiB,KAAK4J,CAAtB,CAAyB,KAAKhJ,CAA9B,EAAiCiD,IAAjC,CAAsC,GAAtC,CAAV,CAAuD,GADhD,CAEP,OAAS,CAAC,KAAKrD,CAAN,CAAS,KAAKR,CAAd,CAAiB,KAAK4J,CAAtB,EAAyB/F,IAAzB,CAA8B,GAA9B,CAAT,CAA8C,GAF9C,CAGH,CAJD,CAMA8F,MAAMQ,SAAN,CAAgBL,UAAhB,CAA6B,SAAS7F,KAAT,CAAgB,CACzCA,MAAQA,MAAMsC,WAAN,EAAR,CACA,GAAI8E,OAAQC,OAAOrH,KAAP,CAAZ,CACA,GAAIoH,KAAJ,CAAW,CACP,KAAK7K,CAAL,CAAS6K,MAAM,CAAN,CAAT,CACA,KAAKrL,CAAL,CAASqL,MAAM,CAAN,CAAT,CACA,KAAKzB,CAAL,CAASyB,MAAM,CAAN,CAAT,CACH,CAJD,IAIO,IAAIpH,QAAU,aAAd,CAA6B,CAChC,KAAKzD,CAAL,CAAS,KAAKR,CAAL,CAAS,KAAK4J,CAAL,CAAS,KAAKhJ,CAAL,CAAS,CAApC,CACA,MAAO,KAAP,CACH,CAED,MAAO,CAAC,CAACyK,KAAT,CACH,CAbD,CAeA1B,MAAMQ,SAAN,CAAgBoB,OAAhB,CAA0B,IAA1B,CAEA;AACA,IAAID,QAAS,CACT,YAAa,CAAC,GAAD,CAAM,GAAN,CAAW,GAAX,CADJ,CAET,eAAgB,CAAC,GAAD,CAAM,GAAN,CAAW,GAAX,CAFP,CAGT,OAAQ,CAAC,CAAD,CAAI,GAAJ,CAAS,GAAT,CAHC,CAIT,aAAc,CAAC,GAAD,CAAM,GAAN,CAAW,GAAX,CAJL,CAKT,QAAS,CAAC,GAAD,CAAM,GAAN,CAAW,GAAX,CALA,CAMT,QAAS,CAAC,GAAD,CAAM,GAAN,CAAW,GAAX,CANA,CAOT,SAAU,CAAC,GAAD,CAAM,GAAN,CAAW,GAAX,CAPD,CAQT,QAAS,CAAC,CAAD,CAAI,CAAJ,CAAO,CAAP,CARA,CAST,iBAAkB,CAAC,GAAD,CAAM,GAAN,CAAW,GAAX,CATT,CAUT,OAAQ,CAAC,CAAD,CAAI,CAAJ,CAAO,GAAP,CAVC,CAWT,aAAc,CAAC,GAAD,CAAM,EAAN,CAAU,GAAV,CAXL,CAYT,QAAS,CAAC,GAAD,CAAM,EAAN,CAAU,EAAV,CAZA,CAaT,YAAa,CAAC,GAAD,CAAM,GAAN,CAAW,GAAX,CAbJ,CAcT,YAAa,CAAC,EAAD,CAAK,GAAL,CAAU,GAAV,CAdJ,CAeT,aAAc,CAAC,GAAD,CAAM,GAAN,CAAW,CAAX,CAfL,CAgBT,YAAa,CAAC,GAAD,CAAM,GAAN,CAAW,EAAX,CAhBJ,CAiBT,QAAS,CAAC,GAAD,CAAM,GAAN,CAAW,EAAX,CAjBA,CAkBT,iBAAkB,CAAC,GAAD,CAAM,GAAN,CAAW,GAAX,CAlBT,CAmBT,WAAY,CAAC,GAAD,CAAM,GAAN,CAAW,GAAX,CAnBH,CAoBT,UAAW,CAAC,GAAD,CAAM,EAAN,CAAU,EAAV,CApBF,CAqBT,OAAQ,CAAC,CAAD,CAAI,GAAJ,CAAS,GAAT,CArBC,CAsBT,WAAY,CAAC,CAAD,CAAI,CAAJ,CAAO,GAAP,CAtBH,CAuBT,WAAY,CAAC,CAAD,CAAI,GAAJ,CAAS,GAAT,CAvBH,CAwBT,gBAAiB,CAAC,GAAD,CAAM,GAAN,CAAW,EAAX,CAxBR,CAyBT,WAAY,CAAC,GAAD,CAAM,GAAN,CAAW,GAAX,CAzBH,CA0BT,YAAa,CAAC,CAAD,CAAI,GAAJ,CAAS,CAAT,CA1BJ,CA2BT,WAAY,CAAC,GAAD,CAAM,GAAN,CAAW,GAAX,CA3BH,CA4BT,YAAa,CAAC,GAAD,CAAM,GAAN,CAAW,GAAX,CA5BJ,CA6BT,cAAe,CAAC,GAAD,CAAM,CAAN,CAAS,GAAT,CA7BN,CA8BT,iBAAkB,CAAC,EAAD,CAAK,GAAL,CAAU,EAAV,CA9BT,CA+BT,aAAc,CAAC,GAAD,CAAM,GAAN,CAAW,CAAX,CA/BL,CAgCT,aAAc,CAAC,GAAD,CAAM,EAAN,CAAU,GAAV,CAhCL,CAiCT,UAAW,CAAC,GAAD,CAAM,CAAN,CAAS,CAAT,CAjCF,CAkCT,aAAc,CAAC,GAAD,CAAM,GAAN,CAAW,GAAX,CAlCL,CAmCT,eAAgB,CAAC,GAAD,CAAM,GAAN,CAAW,GAAX,CAnCP,CAoCT,gBAAiB,CAAC,EAAD,CAAK,EAAL,CAAS,GAAT,CApCR,CAqCT,gBAAiB,CAAC,EAAD,CAAK,EAAL,CAAS,EAAT,CArCR,CAsCT,gBAAiB,CAAC,EAAD,CAAK,EAAL,CAAS,EAAT,CAtCR,CAuCT,gBAAiB,CAAC,CAAD,CAAI,GAAJ,CAAS,GAAT,CAvCR,CAwCT,aAAc,CAAC,GAAD,CAAM,CAAN,CAAS,GAAT,CAxCL,CAyCT,WAAY,CAAC,GAAD,CAAM,EAAN,CAAU,GAAV,CAzCH,CA0CT,cAAe,CAAC,CAAD,CAAI,GAAJ,CAAS,GAAT,CA1CN,CA2CT,UAAW,CAAC,GAAD,CAAM,GAAN,CAAW,GAAX,CA3CF,CA4CT,UAAW,CAAC,GAAD,CAAM,GAAN,CAAW,GAAX,CA5CF,CA6CT,aAAc,CAAC,EAAD,CAAK,GAAL,CAAU,GAAV,CA7CL,CA8CT,YAAa,CAAC,GAAD,CAAM,EAAN,CAAU,EAAV,CA9CJ,CA+CT,cAAe,CAAC,GAAD,CAAM,GAAN,CAAW,GAAX,CA/CN,CAgDT,cAAe,CAAC,EAAD,CAAK,GAAL,CAAU,EAAV,CAhDN,CAiDT,UAAW,CAAC,GAAD,CAAM,CAAN,CAAS,GAAT,CAjDF,CAkDT,YAAa,CAAC,GAAD,CAAM,GAAN,CAAW,GAAX,CAlDJ,CAmDT,aAAc,CAAC,GAAD,CAAM,GAAN,CAAW,GAAX,CAnDL,CAoDT,OAAQ,CAAC,GAAD,CAAM,GAAN,CAAW,CAAX,CApDC,CAqDT,YAAa,CAAC,GAAD,CAAM,GAAN,CAAW,EAAX,CArDJ,CAsDT,OAAQ,CAAC,GAAD,CAAM,GAAN,CAAW,GAAX,CAtDC,CAuDT,QAAS,CAAC,CAAD,CAAI,GAAJ,CAAS,CAAT,CAvDA,CAwDT,cAAe,CAAC,GAAD,CAAM,GAAN,CAAW,EAAX,CAxDN,CAyDT,OAAQ,CAAC,GAAD,CAAM,GAAN,CAAW,GAAX,CAzDC,CA0DT,WAAY,CAAC,GAAD,CAAM,GAAN,CAAW,GAAX,CA1DH,CA2DT,UAAW,CAAC,GAAD,CAAM,GAAN,CAAW,GAAX,CA3DF,CA4DT,YAAa,CAAC,GAAD,CAAM,EAAN,CAAU,EAAV,CA5DJ,CA6DT,SAAU,CAAC,EAAD,CAAK,CAAL,CAAQ,GAAR,CA7DD,CA8DT,QAAS,CAAC,GAAD,CAAM,GAAN,CAAW,GAAX,CA9DA,CA+DT,QAAS,CAAC,GAAD,CAAM,GAAN,CAAW,GAAX,CA/DA,CAgET,WAAY,CAAC,GAAD,CAAM,GAAN,CAAW,GAAX,CAhEH,CAiET,gBAAiB,CAAC,GAAD,CAAM,GAAN,CAAW,GAAX,CAjER,CAkET,YAAa,CAAC,GAAD,CAAM,GAAN,CAAW,CAAX,CAlEJ,CAmET,eAAgB,CAAC,GAAD,CAAM,GAAN,CAAW,GAAX,CAnEP,CAoET,YAAa,CAAC,GAAD,CAAM,GAAN,CAAW,GAAX,CApEJ,CAqET,aAAc,CAAC,GAAD,CAAM,GAAN,CAAW,GAAX,CArEL,CAsET,YAAa,CAAC,GAAD,CAAM,GAAN,CAAW,GAAX,CAtEJ,CAuET,uBAAwB,CAAC,GAAD,CAAM,GAAN,CAAW,GAAX,CAvEf,CAwET,YAAa,CAAC,GAAD,CAAM,GAAN,CAAW,GAAX,CAxEJ,CAyET,aAAc,CAAC,GAAD,CAAM,GAAN,CAAW,GAAX,CAzEL,CA0ET,YAAa,CAAC,GAAD,CAAM,GAAN,CAAW,GAAX,CA1EJ,CA2ET,YAAa,CAAC,GAAD,CAAM,GAAN,CAAW,GAAX,CA3EJ,CA4ET,cAAe,CAAC,GAAD,CAAM,GAAN,CAAW,GAAX,CA5EN,CA6ET,gBAAiB,CAAC,EAAD,CAAK,GAAL,CAAU,GAAV,CA7ER,CA8ET,eAAgB,CAAC,GAAD,CAAM,GAAN,CAAW,GAAX,CA9EP,CA+ET,iBAAkB,CAAC,GAAD,CAAM,GAAN,CAAW,GAAX,CA/ET,CAgFT,iBAAkB,CAAC,GAAD,CAAM,GAAN,CAAW,GAAX,CAhFT,CAiFT,iBAAkB,CAAC,GAAD,CAAM,GAAN,CAAW,GAAX,CAjFT,CAkFT,cAAe,CAAC,GAAD,CAAM,GAAN,CAAW,GAAX,CAlFN,CAmFT,OAAQ,CAAC,CAAD,CAAI,GAAJ,CAAS,CAAT,CAnFC,CAoFT,YAAa,CAAC,EAAD,CAAK,GAAL,CAAU,EAAV,CApFJ,CAqFT,QAAS,CAAC,GAAD,CAAM,GAAN,CAAW,GAAX,CArFA,CAsFT,UAAW,CAAC,GAAD,CAAM,CAAN,CAAS,GAAT,CAtFF,CAuFT,SAAU,CAAC,GAAD,CAAM,CAAN,CAAS,CAAT,CAvFD,CAwFT,mBAAoB,CAAC,GAAD,CAAM,GAAN,CAAW,GAAX,CAxFX,CAyFT,aAAc,CAAC,CAAD,CAAI,CAAJ,CAAO,GAAP,CAzFL,CA0FT,eAAgB,CAAC,GAAD,CAAM,EAAN,CAAU,GAAV,CA1FP,CA2FT,eAAgB,CAAC,GAAD,CAAM,GAAN,CAAW,GAAX,CA3FP,CA4FT,iBAAkB,CAAC,EAAD,CAAK,GAAL,CAAU,GAAV,CA5FT,CA6FT,kBAAmB,CAAC,GAAD,CAAM,GAAN,CAAW,GAAX,CA7FV,CA8FT,oBAAqB,CAAC,CAAD,CAAI,GAAJ,CAAS,GAAT,CA9FZ,CA+FT,kBAAmB,CAAC,EAAD,CAAK,GAAL,CAAU,GAAV,CA/FV,CAgGT,kBAAmB,CAAC,GAAD,CAAM,EAAN,CAAU,GAAV,CAhGV,CAiGT,eAAgB,CAAC,EAAD,CAAK,EAAL,CAAS,GAAT,CAjGP,CAkGT,YAAa,CAAC,GAAD,CAAM,GAAN,CAAW,GAAX,CAlGJ,CAmGT,YAAa,CAAC,GAAD,CAAM,GAAN,CAAW,GAAX,CAnGJ,CAoGT,WAAY,CAAC,GAAD,CAAM,GAAN,CAAW,GAAX,CApGH,CAqGT,cAAe,CAAC,GAAD,CAAM,GAAN,CAAW,GAAX,CArGN,CAsGT,OAAQ,CAAC,CAAD,CAAI,CAAJ,CAAO,GAAP,CAtGC,CAuGT,UAAW,CAAC,GAAD,CAAM,GAAN,CAAW,GAAX,CAvGF,CAwGT,QAAS,CAAC,GAAD,CAAM,GAAN,CAAW,CAAX,CAxGA,CAyGT,YAAa,CAAC,GAAD,CAAM,GAAN,CAAW,EAAX,CAzGJ,CA0GT,SAAU,CAAC,GAAD,CAAM,GAAN,CAAW,CAAX,CA1GD,CA2GT,YAAa,CAAC,GAAD,CAAM,EAAN,CAAU,CAAV,CA3GJ,CA4GT,SAAU,CAAC,GAAD,CAAM,GAAN,CAAW,GAAX,CA5GD,CA6GT,gBAAiB,CAAC,GAAD,CAAM,GAAN,CAAW,GAAX,CA7GR,CA8GT,YAAa,CAAC,GAAD,CAAM,GAAN,CAAW,GAAX,CA9GJ,CA+GT,gBAAiB,CAAC,GAAD,CAAM,GAAN,CAAW,GAAX,CA/GR,CAgHT,gBAAiB,CAAC,GAAD,CAAM,GAAN,CAAW,GAAX,CAhHR,CAiHT,aAAc,CAAC,GAAD,CAAM,GAAN,CAAW,GAAX,CAjHL,CAkHT,YAAa,CAAC,GAAD,CAAM,GAAN,CAAW,GAAX,CAlHJ,CAmHT,OAAQ,CAAC,GAAD,CAAM,GAAN,CAAW,EAAX,CAnHC,CAoHT,OAAQ,CAAC,GAAD,CAAM,GAAN,CAAW,GAAX,CApHC,CAqHT,OAAQ,CAAC,GAAD,CAAM,GAAN,CAAW,GAAX,CArHC,CAsHT,aAAc,CAAC,GAAD,CAAM,GAAN,CAAW,GAAX,CAtHL,CAuHT,SAAU,CAAC,GAAD,CAAM,CAAN,CAAS,GAAT,CAvHD,CAwHT,gBAAiB,CAAC,GAAD,CAAM,EAAN,CAAU,GAAV,CAxHR,CAyHT,MAAO,CAAC,GAAD,CAAM,CAAN,CAAS,CAAT,CAzHE,CA0HT,YAAa,CAAC,GAAD,CAAM,GAAN,CAAW,GAAX,CA1HJ,CA2HT,YAAa,CAAC,EAAD,CAAK,GAAL,CAAU,GAAV,CA3HJ,CA4HT,cAAe,CAAC,GAAD,CAAM,EAAN,CAAU,EAAV,CA5HN,CA6HT,SAAU,CAAC,GAAD,CAAM,GAAN,CAAW,GAAX,CA7HD,CA8HT,aAAc,CAAC,GAAD,CAAM,GAAN,CAAW,EAAX,CA9HL,CA+HT,WAAY,CAAC,EAAD,CAAK,GAAL,CAAU,EAAV,CA/HH,CAgIT,WAAY,CAAC,GAAD,CAAM,GAAN,CAAW,GAAX,CAhIH,CAiIT,SAAU,CAAC,GAAD,CAAM,EAAN,CAAU,EAAV,CAjID,CAkIT,SAAU,CAAC,GAAD,CAAM,GAAN,CAAW,GAAX,CAlID,CAmIT,UAAW,CAAC,GAAD,CAAM,GAAN,CAAW,GAAX,CAnIF,CAoIT,YAAa,CAAC,GAAD,CAAM,EAAN,CAAU,GAAV,CApIJ,CAqIT,YAAa,CAAC,GAAD,CAAM,GAAN,CAAW,GAAX,CArIJ,CAsIT,YAAa,CAAC,GAAD,CAAM,GAAN,CAAW,GAAX,CAtIJ,CAuIT,OAAQ,CAAC,GAAD,CAAM,GAAN,CAAW,GAAX,CAvIC,CAwIT,cAAe,CAAC,CAAD,CAAI,GAAJ,CAAS,GAAT,CAxIN,CAyIT,YAAa,CAAC,EAAD,CAAK,GAAL,CAAU,GAAV,CAzIJ,CA0IT,MAAO,CAAC,GAAD,CAAM,GAAN,CAAW,GAAX,CA1IE,CA2IT,OAAQ,CAAC,CAAD,CAAI,GAAJ,CAAS,GAAT,CA3IC,CA4IT,UAAW,CAAC,GAAD,CAAM,GAAN,CAAW,GAAX,CA5IF,CA6IT,SAAU,CAAC,GAAD,CAAM,EAAN,CAAU,EAAV,CA7ID,CA8IT,YAAa,CAAC,EAAD,CAAK,GAAL,CAAU,GAAV,CA9IJ,CA+IT,SAAU,CAAC,GAAD,CAAM,GAAN,CAAW,GAAX,CA/ID,CAgJT,QAAS,CAAC,GAAD,CAAM,GAAN,CAAW,GAAX,CAhJA,CAiJT,QAAS,CAAC,GAAD,CAAM,GAAN,CAAW,GAAX,CAjJA,CAkJT,aAAc,CAAC,GAAD,CAAM,GAAN,CAAW,GAAX,CAlJL,CAmJT,SAAU,CAAC,GAAD,CAAM,GAAN,CAAW,CAAX,CAnJD,CAoJT,cAAe,CAAC,GAAD,CAAM,GAAN,CAAW,EAAX,CApJN,CAAb,CAuJAvL,OAAOD,OAAP,CAAiB6J,KAAjB,CAEC,CAlRiB,CAkRhB,EAlRgB,CAnoB4xB,CAq5BxyB,EAAE,CAAC,SAASvI,OAAT,CAAiBrB,MAAjB,CAAwBD,OAAxB,CAAgC,CACzC,GAAI0L,SAAUpK,QAAQ,WAAR,CAAd,CACA,GAAIqK,gBAAiBrK,QAAQ,oBAAR,CAArB,CACA,GAAIsK,aAActK,QAAQ,eAAR,CAAlB,CACA,GAAIuK,YAAavK,QAAQ,cAAR,CAAjB,CACA,GAAIwK,eAAgBxK,QAAQ,iBAAR,CAApB,CACA,GAAInE,KAAMmE,QAAQ,OAAR,CAAV,CACA,GAAIyK,OAAQzK,QAAQ,SAAR,CAAZ,CACA,GAAI0K,mBAAoB1K,QAAQ,SAAR,CAAxB,CACA,GAAI2K,iBAAkB3K,QAAQ,SAAR,EAAmB2K,eAAzC,CACA,GAAIC,WAAYH,MAAMG,SAAtB,CAEA,GAAIC,0BAA2B,uBAA/B,CACA,GAAIC,uBAAwB,CAA5B,CAEA,QAAS/L,YAAT,CAAqBgM,QAArB,CAA+BxP,OAA/B,CAAwC,CACpC,GAAI4I,OAAQ2G,uBAAZ,CACAvP,QAAUA,SAAW,EAArB,CACA,GAAIA,QAAQyP,OAAZ,CAAqB,CACjBnP,IAAIN,OAAJ,CAAYyP,OAAZ,CAAsB,IAAtB,CACAnP,IAAIN,OAAJ,CAAY0P,KAAZ,CAAoBC,KAAKC,GAAL,EAApB,CACH,CAED5P,QAAQ6P,KAAR,CAAgB,MAAO7P,SAAQ6P,KAAf,GAA0B,WAA1B,CAAwC,IAAxC,CAA+C7P,QAAQ6P,KAAvE,CACA7P,QAAQ8P,UAAR,CAAqB,MAAO9P,SAAQ8P,UAAf,GAA+B,WAA/B,CAA6C,KAA7C,CAAqD9P,QAAQ8P,UAAlF,CACA9P,QAAQ+P,eAAR,CAA0B,MAAO/P,SAAQ+P,eAAf,GAAoC,WAApC,CAAkD,IAAlD,CAAyD/P,QAAQ+P,eAA3F,CACA/P,QAAQ0K,iBAAR,CAA4B,MAAO1K,SAAQ0K,iBAAf,GAAsC,WAAtC,CAAoD,KAApD,CAA4D1K,QAAQ0K,iBAAhG,CACA1K,QAAQgQ,YAAR,CAAuB,MAAOhQ,SAAQgQ,YAAf,GAAiC,WAAjC,CAA+C,KAA/C,CAAuDhQ,QAAQgQ,YAAtF,CACAhQ,QAAQiQ,QAAR,CAAmB,MAAOjQ,SAAQiQ,QAAf,GAA6B,UAA7B,CAA0CjQ,QAAQiQ,QAAlD,CAA6DnB,cAAhF,CACA9O,QAAQkQ,MAAR,CAAiB,CAAC,CAAClQ,QAAQkQ,MAA3B,CAEA,GAAI,MAAOV,SAAP,GAAqB,QAAzB,CAAmC,CAC/B,GAAI,MAAOxP,SAAQmQ,KAAf,GAA0B,QAA9B,CAAwC,CACpC,MAAOrE,SAAQsE,MAAR,CAAe,uCAAf,CAAP,CACH,CACD,GAAItP,OAAQd,QAAQc,KAAR,EAAiB,IAAjB,CAAwBd,QAAQc,KAAhC,CAAwCiC,OAAOsN,UAA3D,CACA,GAAItP,QAASf,QAAQe,MAAR,EAAkB,IAAlB,CAAyBf,QAAQe,MAAjC,CAA0CgC,OAAOuN,WAA9D,CACA,MAAOlB,iBAAgBmB,YAAYf,QAAZ,CAAhB,CAAuCxP,QAAQmQ,KAA/C,CAAsDvF,QAAtD,CAAgE9J,KAAhE,CAAuEC,MAAvE,CAA+Ef,OAA/E,EAAwFQ,IAAxF,CAA6F,SAASiL,SAAT,CAAoB,CACpH,MAAO+E,cAAa/E,UAAUQ,aAAV,CAAwBrB,QAAxB,CAAiCY,eAA9C,CAA+DC,SAA/D,CAA0EzL,OAA1E,CAAmFc,KAAnF,CAA0FC,MAA1F,CAAP,CACH,CAFM,CAAP,CAGH,CAED,GAAI0J,MAAO,CAAE+E,WAAaiB,SAAd,CAA2B,CAAC7F,SAASY,eAAV,CAA3B,CAA0DgE,SAAShL,MAAV,CAAoBgL,QAApB,CAA+B,CAACA,QAAD,CAAzF,EAAsG,CAAtG,CAAX,CACA/E,KAAKiG,YAAL,CAAkBpB,yBAA2B1G,KAA7C,CAAoDA,KAApD,EACA,MAAO+H,gBAAelG,KAAKR,aAApB,CAAmCjK,OAAnC,CAA4CyK,KAAKR,aAAL,CAAmBC,WAAnB,CAA+BmG,UAA3E,CAAuF5F,KAAKR,aAAL,CAAmBC,WAAnB,CAA+BoG,WAAtH,CAAmI1H,KAAnI,EAA0IpI,IAA1I,CAA+I,SAASC,MAAT,CAAiB,CACnK,GAAI,MAAOT,SAAQ4Q,UAAf,GAA+B,UAAnC,CAA+C,CAC3CtQ,IAAI,uFAAJ,EACAN,QAAQ4Q,UAAR,CAAmBnQ,MAAnB,EACH,CACD,MAAOA,OAAP,CACH,CANM,CAAP,CAOH,CAED+C,YAAYsL,cAAZ,CAA6BA,cAA7B,CACAtL,YAAYyL,aAAZ,CAA4BA,aAA5B,CACAzL,YAAYlD,GAAZ,CAAkBA,GAAlB,CACAkD,YAAY0L,KAAZ,CAAoBA,KAApB,CAEA,GAAI2B,mBAAqB,MAAOjG,SAAP,GAAqB,WAArB,EAAoC,MAAO1K,QAAO4Q,MAAd,GAA0B,UAA9D,EAA4E,MAAOlG,UAAShK,aAAT,CAAuB,QAAvB,EAAiCqB,UAAxC,GAAwD,UAArI,CAAmJ,UAAW,CAClL,MAAO6J,SAAQsE,MAAR,CAAe,mBAAf,CAAP,CACH,CAFuB,CAEpB5M,WAFJ,CAIAJ,OAAOD,OAAP,CAAiB0N,iBAAjB,CAEA,GAAI,MAAOpN,OAAP,GAAmB,UAAnB,EAAiCA,OAAOqG,GAA5C,CAAiD,CAC7CrG,OAAO,aAAP,CAAsB,EAAtB,CAA0B,UAAW,CACjC,MAAOoN,kBAAP,CACH,CAFD,EAGH,CAED,QAASF,eAAT,CAAwB/F,QAAxB,CAAkC5K,OAAlC,CAA2C+Q,WAA3C,CAAwDC,YAAxD,CAAsEC,gBAAtE,CAAwF,CACpF,MAAO9B,mBAAkBvE,QAAlB,CAA4BA,QAA5B,CAAsCmG,WAAtC,CAAmDC,YAAnD,CAAiEhR,OAAjE,CAA0E4K,SAASV,WAAT,CAAqBC,WAA/F,CAA4GS,SAASV,WAAT,CAAqBE,WAAjI,EAA8I5J,IAA9I,CAAmJ,SAASiL,SAAT,CAAoB,CAC1KnL,IAAI,iBAAJ,EACA,GAAI4Q,eAAgB5B,yBAA2B2B,gBAA/C,CACA,GAAIE,UAAW,IAAMD,aAAN,CAAsB,IAAtB,CAA6BD,gBAA7B,CAAgD,IAA/D,CACArG,SAASwG,aAAT,CAAuBD,QAAvB,EAAiCE,eAAjC,CAAiDH,aAAjD,EACA,GAAII,cAAe7F,UAAUQ,aAA7B,CACA,GAAIxB,MAAO6G,aAAa1G,QAAb,CAAsBwG,aAAtB,CAAoCD,QAApC,CAAX,CACA,GAAII,gBAAkB,MAAOvR,SAAQwR,OAAf,GAA4B,UAA7B,CAA2C1F,QAAQC,OAAR,CAAgB/L,QAAQwR,OAAR,CAAgBF,aAAa1G,QAA7B,CAAhB,CAA3C,CAAqGkB,QAAQC,OAAR,CAAgB,IAAhB,CAA1H,CACA,MAAOwF,gBAAe/Q,IAAf,CAAoB,UAAW,CAClC,MAAOgQ,cAAa/F,IAAb,CAAmBgB,SAAnB,CAA8BzL,OAA9B,CAAuC+Q,WAAvC,CAAoDC,YAApD,CAAP,CACH,CAFM,CAAP,CAGH,CAXM,CAAP,CAYH,CAED,QAASR,aAAT,CAAsB/F,IAAtB,CAA4BgB,SAA5B,CAAuCzL,OAAvC,CAAgD+Q,WAAhD,CAA6DC,YAA7D,CAA2E,CACvE,GAAIM,cAAe7F,UAAUQ,aAA7B,CACA,GAAIwF,SAAU,GAAI5C,QAAJ,CAAYyC,aAAa1G,QAAzB,CAAd,CACA,GAAI8G,aAAc,GAAI3C,YAAJ,CAAgB/O,OAAhB,CAAyByR,OAAzB,CAAlB,CACA,GAAIE,QAAStC,UAAU5E,IAAV,CAAb,CACA,GAAI3J,OAAQd,QAAQqG,IAAR,GAAiB,MAAjB,CAA0B0K,WAA1B,CAAwCa,cAAcN,aAAa1G,QAA3B,CAApD,CACA,GAAI7J,QAASf,QAAQqG,IAAR,GAAiB,MAAjB,CAA0B2K,YAA1B,CAAyCa,eAAeP,aAAa1G,QAA5B,CAAtD,CACA,GAAIqF,UAAW,GAAIjQ,SAAQiQ,QAAZ,CAAqBnP,KAArB,CAA4BC,MAA5B,CAAoC2Q,WAApC,CAAiD1R,OAAjD,CAA0D4K,QAA1D,CAAf,CACA,GAAIkH,QAAS,GAAI9C,WAAJ,CAAevE,IAAf,CAAqBwF,QAArB,CAA+BwB,OAA/B,CAAwCC,WAAxC,CAAqD1R,OAArD,CAAb,CACA,MAAO8R,QAAOC,KAAP,CAAavR,IAAb,CAAkB,UAAW,CAChCF,IAAI,oBAAJ,EACA,GAAIG,OAAJ,CAEA,GAAIT,QAAQqG,IAAR,GAAiB,MAArB,CAA6B,CACzB5F,OAASuR,KAAK/B,SAASxP,MAAd,CAAsB,CAACK,MAAOmP,SAASxP,MAAT,CAAgBK,KAAxB,CAA+BC,OAAQkP,SAASxP,MAAT,CAAgBM,MAAvD,CAA+DI,IAAK,CAApE,CAAuED,KAAM,CAA7E,CAAgFoB,EAAG,CAAnF,CAAsFC,EAAG,CAAzF,CAAtB,CAAT,CACH,CAFD,IAEO,IAAIkI,OAAS6G,aAAa1G,QAAb,CAAsBxJ,IAA/B,EAAuCqJ,OAAS6G,aAAa1G,QAAb,CAAsBY,eAAtE,EAAyFxL,QAAQS,MAAR,EAAkB,IAA/G,CAAqH,CACxHA,OAASwP,SAASxP,MAAlB,CACH,CAFM,IAEA,CACHA,OAASuR,KAAK/B,SAASxP,MAAd,CAAsB,CAACK,MAAQd,QAAQc,KAAR,EAAiB,IAAjB,CAAwBd,QAAQc,KAAhC,CAAwC6Q,OAAO7Q,KAAxD,CAA+DC,OAAQf,QAAQe,MAAR,EAAkB,IAAlB,CAAyBf,QAAQe,MAAjC,CAA0C4Q,OAAO5Q,MAAxH,CAAgII,IAAKwQ,OAAOxQ,GAA5I,CAAiJD,KAAMyQ,OAAOzQ,IAA9J,CAAoKoB,EAAG,CAAvK,CAA0KC,EAAG,CAA7K,CAAtB,CAAT,CACH,CAED0P,iBAAiBxG,SAAjB,CAA4BzL,OAA5B,EACA,MAAOS,OAAP,CACH,CAdM,CAAP,CAeH,CAED,QAASwR,iBAAT,CAA0BxG,SAA1B,CAAqCzL,OAArC,CAA8C,CAC1C,GAAIA,QAAQ+P,eAAZ,CAA6B,CACzBtE,UAAUyG,UAAV,CAAqBC,WAArB,CAAiC1G,SAAjC,EACAnL,IAAI,sBAAJ,EACH,CACJ,CAED,QAAS0R,KAAT,CAAcvR,MAAd,CAAsBkR,MAAtB,CAA8B,CAC1B,GAAIS,eAAgBxH,SAAShK,aAAT,CAAuB,QAAvB,CAApB,CACA,GAAIyR,IAAKtM,KAAKiI,GAAL,CAASvN,OAAOK,KAAP,CAAe,CAAxB,CAA2BiF,KAAKuM,GAAL,CAAS,CAAT,CAAYX,OAAOzQ,IAAnB,CAA3B,CAAT,CACA,GAAIqR,IAAKxM,KAAKiI,GAAL,CAASvN,OAAOK,KAAhB,CAAuBiF,KAAKuM,GAAL,CAAS,CAAT,CAAYX,OAAOzQ,IAAP,CAAcyQ,OAAO7Q,KAAjC,CAAvB,CAAT,CACA,GAAI0R,IAAKzM,KAAKiI,GAAL,CAASvN,OAAOM,MAAP,CAAgB,CAAzB,CAA4BgF,KAAKuM,GAAL,CAAS,CAAT,CAAYX,OAAOxQ,GAAnB,CAA5B,CAAT,CACA,GAAIsR,IAAK1M,KAAKiI,GAAL,CAASvN,OAAOM,MAAhB,CAAwBgF,KAAKuM,GAAL,CAAS,CAAT,CAAYX,OAAOxQ,GAAP,CAAawQ,OAAO5Q,MAAhC,CAAxB,CAAT,CACAqR,cAActR,KAAd,CAAsB6Q,OAAO7Q,KAA7B,CACAsR,cAAcrR,MAAd,CAAwB4Q,OAAO5Q,MAA/B,CACA,GAAID,OAAQyR,GAAGF,EAAf,CACA,GAAItR,QAAS0R,GAAGD,EAAhB,CACAlS,IAAI,qBAAJ,CAA2B,OAA3B,CAAoCqR,OAAOzQ,IAA3C,CAAiD,MAAjD,CAAyDyQ,OAAOxQ,GAAhE,CAAqE,QAArE,CAA+EL,KAA/E,CAAsF,SAAtF,CAAiGC,MAAjG,EACAT,IAAI,2BAAJ,CAAiCqR,OAAO7Q,KAAxC,CAA+C,YAA/C,CAA6D6Q,OAAO5Q,MAApE,CAA4E,QAA5E,CAAsFsR,EAAtF,CAA0F,OAA1F,CAAmGG,EAAnG,EACAJ,cAAcnQ,UAAd,CAAyB,IAAzB,EAA+ByQ,SAA/B,CAAyCjS,MAAzC,CAAiD4R,EAAjD,CAAqDG,EAArD,CAAyD1R,KAAzD,CAAgEC,MAAhE,CAAwE4Q,OAAOrP,CAA/E,CAAkFqP,OAAOpP,CAAzF,CAA4FzB,KAA5F,CAAmGC,MAAnG,EACA,MAAOqR,cAAP,CACH,CAED,QAASR,cAAT,CAAwB7R,GAAxB,CAA6B,CACzB,MAAOgG,MAAKuM,GAAL,CACHvM,KAAKuM,GAAL,CAASvS,IAAIqB,IAAJ,CAASuR,WAAlB,CAA+B5S,IAAIyL,eAAJ,CAAoBmH,WAAnD,CADG,CAEH5M,KAAKuM,GAAL,CAASvS,IAAIqB,IAAJ,CAASwR,WAAlB,CAA+B7S,IAAIyL,eAAJ,CAAoBoH,WAAnD,CAFG,CAGH7M,KAAKuM,GAAL,CAASvS,IAAIqB,IAAJ,CAASyR,WAAlB,CAA+B9S,IAAIyL,eAAJ,CAAoBqH,WAAnD,CAHG,CAAP,CAKH,CAED,QAAShB,eAAT,CAAyB9R,GAAzB,CAA8B,CAC1B,MAAOgG,MAAKuM,GAAL,CACHvM,KAAKuM,GAAL,CAASvS,IAAIqB,IAAJ,CAAS0R,YAAlB,CAAgC/S,IAAIyL,eAAJ,CAAoBsH,YAApD,CADG,CAEH/M,KAAKuM,GAAL,CAASvS,IAAIqB,IAAJ,CAAS2R,YAAlB,CAAgChT,IAAIyL,eAAJ,CAAoBuH,YAApD,CAFG,CAGHhN,KAAKuM,GAAL,CAASvS,IAAIqB,IAAJ,CAAS4R,YAAlB,CAAgCjT,IAAIyL,eAAJ,CAAoBwH,YAApD,CAHG,CAAP,CAKH,CAED,QAASzC,YAAT,CAAqB0C,GAArB,CAA0B,CACtB,GAAIC,MAAOtI,SAAShK,aAAT,CAAuB,GAAvB,CAAX,CACAsS,KAAKjQ,IAAL,CAAYgQ,GAAZ,CACAC,KAAKjQ,IAAL,CAAYiQ,KAAKjQ,IAAjB,CACA,MAAOiQ,KAAP,CACH,CAEA,CA7JO,CA6JN,CAAC,UAAU,CAAX,CAAa,gBAAgB,EAA7B,CAAgC,QAAQ,EAAxC,CAA2C,kBAAkB,EAA7D,CAAgE,eAAe,EAA/E,CAAkF,UAAU,EAA5F,CAA+F,qBAAqB,EAApH,CAAuH,YAAY,EAAnI,CAAsI,UAAU,EAAhJ,CA7JM,CAr5BsyB,CAkjCvpB,EAAE,CAAC,SAASzO,OAAT,CAAiBrB,MAAjB,CAAwBD,OAAxB,CAAgC,CAC1L,GAAI7C,KAAMmE,QAAQ,OAAR,CAAV,CACA,GAAI0O,YAAa1O,QAAQ,SAAR,EAAmB0O,UAApC,CAEA,QAASC,oBAAT,CAA6BC,GAA7B,CAAkC,CAC9B,KAAKA,GAAL,CAAWA,GAAX,CACA/S,IAAI,yBAAJ,CAA+B+S,GAA/B,EACA,GAAI,CAAC,KAAKC,OAAN,EAAiB,CAAC,KAAKC,KAA3B,CAAkC,CAC9BjT,IAAI,gCAAJ,EACA8S,oBAAoB5F,SAApB,CAA8B+F,KAA9B,CAAsC,GAAIC,MAAJ,EAAtC,CACA,GAAID,OAAQ,KAAKA,KAAjB,CACAH,oBAAoB5F,SAApB,CAA8B8F,OAA9B,CAAwC,GAAIxH,QAAJ,CAAY,SAASC,OAAT,CAAkBqE,MAAlB,CAA0B,CAC1EmD,MAAMrH,MAAN,CAAeH,OAAf,CACAwH,MAAME,OAAN,CAAgBrD,MAAhB,CACAmD,MAAMF,GAAN,CAAYF,YAAZ,CACA,GAAII,MAAMG,QAAN,GAAmB,IAAvB,CAA6B,CACzB3H,QAAQwH,KAAR,EACH,CACJ,CAPuC,CAAxC,CAQH,CACJ,CAEDnQ,OAAOD,OAAP,CAAiBiQ,mBAAjB,CAEC,CAxBwJ,CAwBvJ,CAAC,QAAQ,EAAT,CAAY,UAAU,EAAtB,CAxBuJ,CAljCqpB,CA0kCjxB,EAAE,CAAC,SAAS3O,OAAT,CAAiBrB,MAAjB,CAAwBD,OAAxB,CAAgC,CAChE,GAAIgQ,YAAa1O,QAAQ,SAAR,EAAmB0O,UAApC,CAEA,QAASQ,KAAT,CAAcC,MAAd,CAAsBC,IAAtB,CAA4B,CACxB,GAAIpI,WAAYb,SAAShK,aAAT,CAAuB,KAAvB,CAAhB,CACIkT,IAAMlJ,SAAShK,aAAT,CAAuB,KAAvB,CADV,CAEImT,KAAOnJ,SAAShK,aAAT,CAAuB,MAAvB,CAFX,CAGIoT,WAAa,aAHjB,CAIIC,QAJJ,CAKIC,MALJ,CAOAzI,UAAUzK,KAAV,CAAgB2K,UAAhB,CAA6B,QAA7B,CACAF,UAAUzK,KAAV,CAAgBmT,UAAhB,CAA6BP,MAA7B,CACAnI,UAAUzK,KAAV,CAAgBoT,QAAhB,CAA2BP,IAA3B,CACApI,UAAUzK,KAAV,CAAgBqT,MAAhB,CAAyB,CAAzB,CACA5I,UAAUzK,KAAV,CAAgBsT,OAAhB,CAA0B,CAA1B,CAEA1J,SAASxJ,IAAT,CAAcC,WAAd,CAA0BoK,SAA1B,EAEAqI,IAAIT,GAAJ,CAAUF,YAAV,CACAW,IAAIhT,KAAJ,CAAY,CAAZ,CACAgT,IAAI/S,MAAJ,CAAa,CAAb,CAEA+S,IAAI9S,KAAJ,CAAUqT,MAAV,CAAmB,CAAnB,CACAP,IAAI9S,KAAJ,CAAUsT,OAAV,CAAoB,CAApB,CACAR,IAAI9S,KAAJ,CAAUuT,aAAV,CAA0B,UAA1B,CAEAR,KAAK/S,KAAL,CAAWmT,UAAX,CAAwBP,MAAxB,CACAG,KAAK/S,KAAL,CAAWoT,QAAX,CAAsBP,IAAtB,CACAE,KAAK/S,KAAL,CAAWqT,MAAX,CAAoB,CAApB,CACAN,KAAK/S,KAAL,CAAWsT,OAAX,CAAqB,CAArB,CAEAP,KAAK1S,WAAL,CAAiBuJ,SAASlJ,cAAT,CAAwBsS,UAAxB,CAAjB,EACAvI,UAAUpK,WAAV,CAAsB0S,IAAtB,EACAtI,UAAUpK,WAAV,CAAsByS,GAAtB,EACAG,SAAYH,IAAIU,SAAJ,CAAgBT,KAAKS,SAAtB,CAAmC,CAA9C,CAEA/I,UAAU0G,WAAV,CAAsB4B,IAAtB,EACAtI,UAAUpK,WAAV,CAAsBuJ,SAASlJ,cAAT,CAAwBsS,UAAxB,CAAtB,EAEAvI,UAAUzK,KAAV,CAAgByT,UAAhB,CAA6B,QAA7B,CACAX,IAAI9S,KAAJ,CAAUuT,aAAV,CAA0B,OAA1B,CAEAL,OAAUJ,IAAIU,SAAJ,CAAc/I,UAAU+I,SAAzB,CAAsC,CAA/C,CAEA5J,SAASxJ,IAAT,CAAc+Q,WAAd,CAA0B1G,SAA1B,EAEA,KAAKwI,QAAL,CAAgBA,QAAhB,CACA,KAAKS,SAAL,CAAiB,CAAjB,CACA,KAAKR,MAAL,CAAcA,MAAd,CACH,CAED9Q,OAAOD,OAAP,CAAiBwQ,IAAjB,CAEC,CAtD8B,CAsD7B,CAAC,UAAU,EAAX,CAtD6B,CA1kC+wB,CAgoC5xB,EAAE,CAAC,SAASlP,OAAT,CAAiBrB,MAAjB,CAAwBD,OAAxB,CAAgC,CACrD,GAAIwQ,MAAOlP,QAAQ,QAAR,CAAX,CAEA,QAASkQ,YAAT,EAAuB,CACnB,KAAKC,IAAL,CAAY,EAAZ,CACH,CAEDD,YAAYnH,SAAZ,CAAsBqH,UAAtB,CAAmC,SAASjB,MAAT,CAAiBC,IAAjB,CAAuB,CACtD,GAAI,KAAKe,IAAL,CAAUhB,OAAS,GAAT,CAAeC,IAAzB,IAAmCpD,SAAvC,CAAkD,CAC9C,KAAKmE,IAAL,CAAUhB,OAAS,GAAT,CAAeC,IAAzB,EAAiC,GAAIF,KAAJ,CAASC,MAAT,CAAiBC,IAAjB,CAAjC,CACH,CACD,MAAO,MAAKe,IAAL,CAAUhB,OAAS,GAAT,CAAeC,IAAzB,CAAP,CACH,CALD,CAOAzQ,OAAOD,OAAP,CAAiBwR,WAAjB,CAEC,CAhBmB,CAgBlB,CAAC,SAAS,CAAV,CAhBkB,CAhoC0xB,CAgpC9xB,EAAE,CAAC,SAASlQ,OAAT,CAAiBrB,MAAjB,CAAwBD,OAAxB,CAAgC,CACnD,GAAI+L,OAAQzK,QAAQ,SAAR,CAAZ,CACA,GAAI4K,WAAYH,MAAMG,SAAtB,CACA,GAAID,iBAAkB3K,QAAQ,SAAR,EAAmB2K,eAAzC,CAEA,QAAS0F,eAAT,CAAwBrJ,SAAxB,CAAmCsJ,UAAnC,CAA+C/U,OAA/C,CAAwD,CACpD,KAAKuT,KAAL,CAAa,IAAb,CACA,KAAKF,GAAL,CAAW5H,SAAX,CACA,GAAIlI,MAAO,IAAX,CACA,GAAIoO,QAAStC,UAAU5D,SAAV,CAAb,CACA,KAAK6H,OAAL,CAAe,CAAC,CAACyB,UAAD,CAAc,KAAKC,SAAL,CAAehV,QAAQmQ,KAAvB,CAA8BwB,MAA9B,CAAsC3R,OAAtC,CAAd,CAA+D,GAAI8L,QAAJ,CAAY,SAASC,OAAT,CAAkB,CACzG,GAAIN,UAAUQ,aAAV,CAAwBrB,QAAxB,CAAiCqK,GAAjC,GAAyC,aAAzC,EAA0DxJ,UAAUQ,aAAV,CAAwBrB,QAAxB,CAAiCY,eAAjC,EAAoD,IAAlH,CAAwH,CACpHC,UAAUQ,aAAV,CAAwBC,MAAxB,CAAiCT,UAAUS,MAAV,CAAmB,UAAW,CAC3DH,QAAQN,SAAR,EACH,CAFD,CAGH,CAJD,IAIO,CACHM,QAAQN,SAAR,EACH,CACJ,CAR8E,CAAhE,EAQXjL,IARW,CAQN,SAASiL,SAAT,CAAoB,CACzB,GAAIjI,aAAciB,QAAQ,QAAR,CAAlB,CACA,MAAOjB,aAAYiI,UAAUQ,aAAV,CAAwBrB,QAAxB,CAAiCY,eAA7C,CAA8D,CAACnF,KAAM,MAAP,CAAevF,MAAO2K,UAAU3K,KAAhC,CAAuCC,OAAQ0K,UAAU1K,MAAzD,CAAiEoP,MAAOnQ,QAAQmQ,KAAhF,CAAuFzF,kBAAmB1K,QAAQ0K,iBAAlH,CAAqIqF,gBAAiB/P,QAAQ+P,eAA9J,CAA+KD,WAAY9P,QAAQ8P,UAAnM,CAA+ME,aAAchQ,QAAQgQ,YAAR,CAAuB,CAApP,CAA9D,CAAP,CACH,CAXc,EAWZxP,IAXY,CAWP,SAASC,MAAT,CAAiB,CACrB,MAAO8C,MAAKgQ,KAAL,CAAa9S,MAApB,CACH,CAbc,CAAf,CAcH,CAEDqU,eAAetH,SAAf,CAAyBwH,SAAzB,CAAqC,SAAS7E,KAAT,CAAgBwB,MAAhB,CAAwB3R,OAAxB,CAAiC,CAClE,GAAIyL,WAAY,KAAK4H,GAArB,CACA,MAAOjE,iBAAgB3D,UAAU4H,GAA1B,CAA+BlD,KAA/B,CAAsC1E,UAAUxB,aAAhD,CAA+D0H,OAAO7Q,KAAtE,CAA6E6Q,OAAO5Q,MAApF,CAA4Ff,OAA5F,CAAP,CACH,CAHD,CAKAoD,OAAOD,OAAP,CAAiB2R,cAAjB,CAEC,CAjCiB,CAiChB,CAAC,SAAS,CAAV,CAAY,UAAU,EAAtB,CAAyB,UAAU,EAAnC,CAjCgB,CAhpC4xB,CAirCpwB,EAAE,CAAC,SAASrQ,OAAT,CAAiBrB,MAAjB,CAAwBD,OAAxB,CAAgC,CAC7E,QAAS+R,kBAAT,CAA2BC,SAA3B,CAAsC,CAClC,KAAK9B,GAAL,CAAW8B,UAAU7N,KAArB,CACA,KAAK8N,UAAL,CAAkB,EAAlB,CACA,KAAK/O,IAAL,CAAY,IAAZ,CACA,KAAKgP,EAAL,CAAU,GAAV,CACA,KAAKC,EAAL,CAAU,GAAV,CACA,KAAKjD,EAAL,CAAU,GAAV,CACA,KAAKG,EAAL,CAAU,GAAV,CACA,KAAKc,OAAL,CAAexH,QAAQC,OAAR,CAAgB,IAAhB,CAAf,CACH,CAEDmJ,kBAAkBK,KAAlB,CAA0B,CACtBC,OAAQ,CADc,CAEtBC,OAAQ,CAFc,CAA1B,CAKA;AACA;AACAP,mBAAkBQ,gBAAlB,CAAqC,2IAArC,CAEAtS,OAAOD,OAAP,CAAiB+R,iBAAjB,CAEC,CAvB2C,CAuB1C,EAvB0C,CAjrCkwB,CAwsCxyB,GAAG,CAAC,SAASzQ,OAAT,CAAiBrB,MAAjB,CAAwBD,OAAxB,CAAgC,CAC1C,QAASwS,eAAT,CAAwBtC,GAAxB,CAA6BuC,IAA7B,CAAmC,CAC/B,KAAKvC,GAAL,CAAWA,GAAX,CACA,KAAKE,KAAL,CAAa,GAAIC,MAAJ,EAAb,CACA,GAAIjQ,MAAO,IAAX,CACA,KAAKsS,OAAL,CAAe,IAAf,CACA,KAAKvC,OAAL,CAAe,GAAIxH,QAAJ,CAAY,SAASC,OAAT,CAAkBqE,MAAlB,CAA0B,CACjD7M,KAAKgQ,KAAL,CAAWrH,MAAX,CAAoBH,OAApB,CACAxI,KAAKgQ,KAAL,CAAWE,OAAX,CAAqBrD,MAArB,CACA,GAAIwF,IAAJ,CAAU,CACNrS,KAAKgQ,KAAL,CAAWuC,WAAX,CAAyB,WAAzB,CACH,CACDvS,KAAKgQ,KAAL,CAAWF,GAAX,CAAiBA,GAAjB,CACA,GAAI9P,KAAKgQ,KAAL,CAAWG,QAAX,GAAwB,IAA5B,CAAkC,CAC9B3H,QAAQxI,KAAKgQ,KAAb,EACH,CACJ,CAVc,CAAf,CAWH,CAEDnQ,OAAOD,OAAP,CAAiBwS,cAAjB,CAEC,CArBQ,CAqBP,EArBO,CAxsCqyB,CA6tCxyB,GAAG,CAAC,SAASlR,OAAT,CAAiBrB,MAAjB,CAAwBD,OAAxB,CAAgC,CAC1C,GAAI7C,KAAMmE,QAAQ,OAAR,CAAV,CACA,GAAIkR,gBAAiBlR,QAAQ,kBAAR,CAArB,CACA,GAAI2O,qBAAsB3O,QAAQ,uBAAR,CAA1B,CACA,GAAIsR,qBAAsBtR,QAAQ,uBAAR,CAA1B,CACA,GAAIqQ,gBAAiBrQ,QAAQ,kBAAR,CAArB,CACA,GAAIuR,cAAevR,QAAQ,gBAAR,CAAnB,CACA,GAAIwR,kBAAmBxR,QAAQ,oBAAR,CAAvB,CACA,GAAIyR,yBAA0BzR,QAAQ,2BAAR,CAA9B,CACA,GAAI0R,yBAA0B1R,QAAQ,2BAAR,CAA9B,CACA,GAAI1C,MAAO0C,QAAQ,SAAR,EAAmB1C,IAA9B,CAEA,QAASgN,YAAT,CAAqB/O,OAArB,CAA8ByR,OAA9B,CAAuC,CACnC,KAAKyB,IAAL,CAAY,IAAZ,CACA,KAAKlT,OAAL,CAAeA,OAAf,CACA,KAAKyR,OAAL,CAAeA,OAAf,CACA,KAAK2E,MAAL,CAAc,KAAKC,SAAL,CAAetT,OAAOC,QAAP,CAAgBC,IAA/B,CAAd,CACH,CAED8L,YAAYvB,SAAZ,CAAsB8I,UAAtB,CAAmC,SAASC,KAAT,CAAgB,CAC/C,GAAIC,QAAS,EAAb,CACAD,MAAME,MAAN,CAAa,SAASC,UAAT,CAAqBjL,SAArB,CAAgC,CACzC,OAAOA,UAAUhB,IAAV,CAAeO,QAAtB,EACA,IAAK,KAAL,CACI,MAAO0L,YAAWC,MAAX,CAAkB,CAAC,CACtBC,KAAM,CAACnL,UAAUhB,IAAV,CAAe4I,GAAhB,CADgB,CAEtBwD,OAAQ,KAFc,CAAD,CAAlB,CAAP,CAIJ,IAAK,KAAL,CACA,IAAK,QAAL,CACI,MAAOH,YAAWC,MAAX,CAAkB,CAAC,CACtBC,KAAM,CAACnL,UAAUhB,IAAX,CADgB,CAEtBoM,OAAQpL,UAAUhB,IAAV,CAAeO,QAFD,CAAD,CAAlB,CAAP,CARJ,CAaA,MAAO0L,WAAP,CACH,CAfD,CAeG,EAfH,EAeOI,OAfP,CAee,KAAKC,QAAL,CAAcP,MAAd,CAAsB,KAAKQ,SAA3B,CAff,CAesD,IAftD,EAgBA,MAAOR,OAAP,CACH,CAnBD,CAqBAzH,YAAYvB,SAAZ,CAAsByJ,mBAAtB,CAA4C,SAAST,MAAT,CAAiB/K,SAAjB,CAA4B,CACpEA,UAAUyL,qBAAV,GAAkCC,MAAlC,CAAyC,KAAKC,kBAA9C,EAAkEN,OAAlE,CAA0E,KAAKC,QAAL,CAAcP,MAAd,CAAsB,KAAKQ,SAA3B,CAA1E,CAAiH,IAAjH,EACA,MAAOR,OAAP,CACH,CAHD,CAKAzH,YAAYvB,SAAZ,CAAsBuJ,QAAtB,CAAiC,SAASP,MAAT,CAAiBa,QAAjB,CAA2B,CACxD,MAAO,UAASC,QAAT,CAAmB,CACtBA,SAASV,IAAT,CAAcE,OAAd,CAAsB,SAASvD,KAAT,CAAgB,CAClC,GAAI,CAAC,KAAKgE,WAAL,CAAiBf,MAAjB,CAAyBjD,KAAzB,CAAL,CAAsC,CAClCiD,OAAOxN,MAAP,CAAc,CAAd,CAAiB,CAAjB,CAAoBqO,SAAS9S,IAAT,CAAc,IAAd,CAAoB+S,QAApB,CAApB,EACAhX,IAAI,gBAAmBkW,OAAOhS,MAA9B,CAAuC,MAAO+O,MAAP,GAAkB,QAAlB,CAA6BA,MAAMlF,SAAN,CAAgB,CAAhB,CAAmB,GAAnB,CAA7B,CAAuDkF,KAA9F,EACH,CACJ,CALD,CAKG,IALH,EAMH,CAPD,CAQH,CATD,CAWAxE,YAAYvB,SAAZ,CAAsB4J,kBAAtB,CAA2C,SAASjC,SAAT,CAAoB,CAC3D,MAAOA,WAAU0B,MAAV,GAAqB,MAA5B,CACH,CAFD,CAIA9H,YAAYvB,SAAZ,CAAsBwJ,SAAtB,CAAkC,SAAS7B,SAAT,CAAoB,CAClD,GAAIA,UAAU0B,MAAV,GAAqB,KAAzB,CAAgC,CAC5B,GAAIxD,KAAM8B,UAAUyB,IAAV,CAAe,CAAf,CAAV,CACA,GAAI,KAAKY,KAAL,CAAWnE,GAAX,GAAmB,CAAC,KAAK5B,OAAL,CAAagG,GAAjC,EAAwC,CAAC,KAAKzX,OAAL,CAAa8P,UAA1D,CAAsE,CAClE,MAAO,IAAIkG,aAAJ,CAAiB3C,GAAjB,CAAP,CACH,CAFD,IAEO,IAAIA,IAAInF,KAAJ,CAAU,yBAAV,CAAJ,CAA0C,CAC7C,MAAO,IAAIyH,eAAJ,CAAmBtC,IAAItM,OAAJ,CAAY,6BAAZ,CAA2C,EAA3C,CAAnB,CAAmE,KAAnE,CAAP,CACH,CAFM,IAEA,IAAI,KAAK2Q,YAAL,CAAkBrE,GAAlB,GAA0B,KAAKrT,OAAL,CAAa8P,UAAb,GAA4B,IAAtD,EAA8D,KAAK0H,KAAL,CAAWnE,GAAX,CAAlE,CAAmF,CACtF,MAAO,IAAIsC,eAAJ,CAAmBtC,GAAnB,CAAwB,KAAxB,CAAP,CACH,CAFM,IAEA,IAAI,KAAK5B,OAAL,CAAamE,IAAb,EAAqB,CAAC,KAAK5V,OAAL,CAAa8P,UAAnC,EAAiD,KAAK9P,OAAL,CAAa2X,OAAlE,CAA2E,CAC9E,MAAO,IAAIhC,eAAJ,CAAmBtC,GAAnB,CAAwB,IAAxB,CAAP,CACH,CAFM,IAEA,IAAI,KAAKrT,OAAL,CAAamQ,KAAjB,CAAwB,CAC3B,MAAO,IAAI4F,oBAAJ,CAAwB1C,GAAxB,CAA6B,KAAKrT,OAAL,CAAamQ,KAA1C,CAAP,CACH,CAFM,IAEA,CACH,MAAO,IAAIiD,oBAAJ,CAAwBC,GAAxB,CAAP,CACH,CACJ,CAfD,IAeO,IAAI8B,UAAU0B,MAAV,GAAqB,iBAAzB,CAA4C,CAC/C,MAAO,IAAIX,wBAAJ,CAA4Bf,SAA5B,CAAP,CACH,CAFM,IAEA,IAAIA,UAAU0B,MAAV,GAAqB,UAAzB,CAAqC,CACxC,MAAO,IAAIV,wBAAJ,CAA4BhB,SAA5B,CAAP,CACH,CAFM,IAEA,IAAIA,UAAU0B,MAAV,GAAqB,KAAzB,CAAgC,CACnC,MAAO,IAAIZ,iBAAJ,CAAqBd,UAAUyB,IAAV,CAAe,CAAf,CAArB,CAAwC,KAAKnF,OAAL,CAAagG,GAArD,CAAP,CACH,CAFM,IAEA,IAAItC,UAAU0B,MAAV,GAAqB,QAAzB,CAAmC,CACtC,MAAO,IAAI/B,eAAJ,CAAmBK,UAAUyB,IAAV,CAAe,CAAf,CAAnB,CAAsC,KAAKc,YAAL,CAAkBvC,UAAUyB,IAAV,CAAe,CAAf,EAAkBvD,GAApC,CAAtC,CAAgF,KAAKrT,OAArF,CAAP,CACH,CAFM,IAEA,CACH,MAAO,IAAIoT,oBAAJ,CAAwB+B,SAAxB,CAAP,CACH,CACJ,CA3BD,CA6BApG,YAAYvB,SAAZ,CAAsBgK,KAAtB,CAA8B,SAASnE,GAAT,CAAc,CACxC,MAAOA,KAAIhF,SAAJ,CAAcgF,IAAI7O,MAAJ,CAAa,CAA3B,EAA8BoF,WAA9B,KAAgD,KAAhD,EAAyDoM,aAAaxI,SAAb,CAAuBoK,QAAvB,CAAgCvE,GAAhC,CAAhE,CACH,CAFD,CAIAtE,YAAYvB,SAAZ,CAAsB+J,WAAtB,CAAoC,SAASf,MAAT,CAAiBnD,GAAjB,CAAsB,CACtD,MAAOmD,QAAOqB,IAAP,CAAY,SAAStE,KAAT,CAAgB,CAC/B,MAAOA,OAAMF,GAAN,GAAcA,GAArB,CACH,CAFM,CAAP,CAGH,CAJD,CAMAtE,YAAYvB,SAAZ,CAAsBkK,YAAtB,CAAqC,SAASzE,GAAT,CAAc,CAC/C,MAAQ,MAAKoD,SAAL,CAAepD,GAAf,IAAwB,KAAKmD,MAArC,CACH,CAFD,CAIArH,YAAYvB,SAAZ,CAAsB6I,SAAtB,CAAkC,SAASpD,GAAT,CAAc,CAC5C,GAAIC,MAAO,KAAKA,IAAL,GAAc,KAAKA,IAAL,CAAYtI,SAAShK,aAAT,CAAuB,GAAvB,CAA1B,CAAX,CACAsS,KAAKjQ,IAAL,CAAYgQ,GAAZ,CACAC,KAAKjQ,IAAL,CAAYiQ,KAAKjQ,IAAjB,CAAuB;AACvB,OAAOiQ,MAAK4E,QAAL,CAAgB5E,KAAK6E,QAArB,CAAgC7E,KAAK8E,IAA5C,CACH,CALD,CAOAjJ,YAAYvB,SAAZ,CAAsByK,UAAtB,CAAmC,SAASxM,SAAT,CAAoB,CACnD,MAAO,MAAKyM,OAAL,CAAazM,SAAb,CAAwB,KAAKzL,OAAL,CAAagQ,YAArC,EAAmD,OAAnD,EAA4D,UAAW,CAC1E,GAAImI,OAAQ,GAAI/E,oBAAJ,CAAwB3H,UAAU4H,GAAlC,CAAZ,CACA,MAAO8E,OAAM7E,OAAN,CAAc9S,IAAd,CAAmB,SAAS+S,KAAT,CAAgB,CACtC9H,UAAU8H,KAAV,CAAkBA,KAAlB,CACH,CAFM,CAAP,CAGH,CALM,CAAP,CAMH,CAPD,CASAxE,YAAYvB,SAAZ,CAAsB4K,GAAtB,CAA4B,SAAS/E,GAAT,CAAc,CACtC,GAAIgF,OAAQ,IAAZ,CACA,MAAO,MAAK7B,MAAL,CAAYqB,IAAZ,CAAiB,SAAS/D,GAAT,CAAc,CAClC,MAAO,CAACuE,MAAQvE,GAAT,EAAcT,GAAd,GAAsBA,GAA7B,CACH,CAFM,EAEFgF,KAFE,CAEM,IAFb,CAGH,CALD,CAOAtJ,YAAYvB,SAAZ,CAAsB8K,KAAtB,CAA8B,SAAS/B,KAAT,CAAgB,CAC1C,KAAKC,MAAL,CAAcD,MAAME,MAAN,CAAa1U,KAAK,KAAKkV,mBAAV,CAA+B,IAA/B,CAAb,CAAmD,KAAKX,UAAL,CAAgBC,KAAhB,CAAnD,CAAd,CACA,KAAKC,MAAL,CAAYM,OAAZ,CAAoB,SAASvD,KAAT,CAAgB3K,KAAhB,CAAuB,CACvC2K,MAAMD,OAAN,CAAc9S,IAAd,CAAmB,UAAW,CAC1BF,IAAI,8BAA+BsI,MAAM,CAArC,CAAJ,CAA6C2K,KAA7C,EACH,CAFD,CAEG,SAAS7P,CAAT,CAAY,CACXpD,IAAI,0BAA2BsI,MAAM,CAAjC,CAAJ,CAAyC2K,KAAzC,CAAgD7P,CAAhD,EACH,CAJD,EAKH,CAND,EAOA,KAAKqO,KAAL,CAAajG,QAAQyM,GAAR,CAAY,KAAK/B,MAAL,CAAYjQ,GAAZ,CAAgB,KAAK0R,UAArB,CAAiC,IAAjC,CAAZ,CAAb,CACA3X,IAAI,2BAAJ,EACA,MAAO,KAAP,CACH,CAZD,CAcAyO,YAAYvB,SAAZ,CAAsB0K,OAAtB,CAAgC,SAASzM,SAAT,CAAoByM,OAApB,CAA6B,CACzD,GAAIM,MAAJ,CACA,GAAIlF,SAAUxH,QAAQ2M,IAAR,CAAa,CAAChN,UAAU6H,OAAX,CAAoB,GAAIxH,QAAJ,CAAY,SAAS4M,GAAT,CAActI,MAAd,CAAsB,CAC7EoI,MAAQG,WAAW,UAAW,CAC1BrY,IAAI,yBAAJ,CAA+BmL,SAA/B,EACA2E,OAAO3E,SAAP,EACH,CAHO,CAGLyM,OAHK,CAAR,CAIH,CAL8C,CAApB,CAAb,EAKT1X,IALS,CAKJ,SAASiL,SAAT,CAAoB,CAC1BmN,aAAaJ,KAAb,EACA,MAAO/M,UAAP,CACH,CARa,CAAd,CASA6H,QAAQ,OAAR,EAAiB,UAAW,CACxBsF,aAAaJ,KAAb,EACH,CAFD,EAGA,MAAOlF,QAAP,CACH,CAfD,CAiBAlQ,OAAOD,OAAP,CAAiB4L,WAAjB,CAEC,CA/JQ,CA+JP,CAAC,wBAAwB,CAAzB,CAA2B,mBAAmB,CAA9C,CAAgD,mBAAmB,EAAnE,CAAsE,4BAA4B,EAAlG,CAAqG,QAAQ,EAA7G,CAAgH,wBAAwB,EAAxI,CAA2I,iBAAiB,EAA5J,CAA+J,qBAAqB,EAApL,CAAuL,UAAU,EAAjM,CAAoM,4BAA4B,EAAhO,CA/JO,CA7tCqyB,CA43CvkB,GAAG,CAAC,SAAStK,OAAT,CAAiBrB,MAAjB,CAAwBD,OAAxB,CAAgC,CAC3Q,GAAI+R,mBAAoBzQ,QAAQ,qBAAR,CAAxB,CACA,GAAIuI,OAAQvI,QAAQ,SAAR,CAAZ,CAEA,QAASyR,wBAAT,CAAiCf,SAAjC,CAA4C,CACxCD,kBAAkB2D,KAAlB,CAAwB,IAAxB,CAA8BC,SAA9B,EACA,KAAKzS,IAAL,CAAY6O,kBAAkBK,KAAlB,CAAwBC,MAApC,CAEA,GAAIuD,cAAe7C,wBAAwB8C,gBAAxB,CAAyCtP,IAAzC,CAA+CyL,UAAUyB,IAAV,CAAe,CAAf,CAA/C,GACf,CAAC1B,kBAAkBQ,gBAAlB,CAAmChM,IAAnC,CAAyCyL,UAAUyB,IAAV,CAAe,CAAf,CAAzC,CADL,CAGA,GAAImC,YAAJ,CAAkB,CACd5D,UAAUyB,IAAV,CAAe,CAAf,EAAkB9P,KAAlB,CAAwB,KAAxB,EAA+BmS,OAA/B,GAAyCnC,OAAzC,CAAiD,SAAS7V,QAAT,CAAmB2H,KAAnB,CAA0B,CACvE,OAAO3H,QAAP,EACA,IAAK,MAAL,CACI,KAAKoU,EAAL,CAAU,CAAV,CACA,KAAKhD,EAAL,CAAU,CAAV,CACA,MACJ,IAAK,KAAL,CACI,KAAKiD,EAAL,CAAU,CAAV,CACA,KAAK9C,EAAL,CAAU,CAAV,CACA,MACJ,IAAK,OAAL,CACI,KAAK6C,EAAL,CAAU,CAAV,CACA,KAAKhD,EAAL,CAAU,CAAV,CACA,MACJ,IAAK,QAAL,CACI,KAAKiD,EAAL,CAAU,CAAV,CACA,KAAK9C,EAAL,CAAU,CAAV,CACA,MACJ,IAAK,IAAL,CACI,GAAI8C,IAAK,KAAKA,EAAd,CACA,GAAID,IAAK,KAAKA,EAAd,CACA,KAAKC,EAAL,CAAU,KAAK9C,EAAf,CACA,KAAK6C,EAAL,CAAU,KAAKhD,EAAf,CACA,KAAKA,EAAL,CAAUgD,EAAV,CACA,KAAK7C,EAAL,CAAU8C,EAAV,CACA,MACJ,IAAK,QAAL,CACI,MAAO;AACX;AACA;AACA,SAAS;AACL;AACA,IAAI4D,OAAQC,WAAWlY,QAAX,CAAqB,EAArB,EAA2B,IAAvC,CACA,GAAImY,MAAMF,KAAN,CAAJ,CAAkB,CAAE;AAChB,OACH,CACD,GAAItQ,QAAU,CAAd,CAAiB,CACb,KAAK0M,EAAL,CAAU4D,KAAV,CACA,KAAK1G,EAAL,CAAU,EAAI,KAAK8C,EAAnB,CACH,CAHD,IAGO,CACH,KAAKD,EAAL,CAAU6D,KAAV,CACA,KAAK7G,EAAL,CAAU,EAAI,KAAKgD,EAAnB,CACH,CACD,MA1CJ,CA4CH,CA7CD,CA6CG,IA7CH,EA8CH,CA/CD,IA+CO,CACH,KAAKC,EAAL,CAAU,CAAV,CACA,KAAK9C,EAAL,CAAU,CAAV,CACH,CAED,KAAK4C,UAAL,CAAkBD,UAAUyB,IAAV,CAAejN,KAAf,CAAqBoP,aAAe,CAAf,CAAmB,CAAxC,EAA2CxS,GAA3C,CAA+C,SAAS8S,SAAT,CAAoB,CACjF,GAAIC,gBAAiBD,UAAUnL,KAAV,CAAgBgH,kBAAkBQ,gBAAlC,CAArB,CACA,GAAIpO,OAAQ,CAACgS,eAAe,CAAf,CAAb,CACA,GAAIC,MAAOjS,QAAU,CAAV,CAAc,GAAd,CAAoBgS,eAAe,CAAf,CAA/B,CAAkD;AAClD,OAAO,CACH5K,MAAO,GAAI1B,MAAJ,CAAUsM,eAAe,CAAf,CAAV,CADJ,CAEH;AACAE,MAAMD,OAAS,GAAT,CAAejS,MAAQ,GAAvB,CAA6B,IAHhC,CAAP,CAKH,CATiB,CAAlB,CAWA,GAAI,KAAK8N,UAAL,CAAgB,CAAhB,EAAmBoE,IAAnB,GAA4B,IAAhC,CAAsC,CAClC,KAAKpE,UAAL,CAAgB,CAAhB,EAAmBoE,IAAnB,CAA0B,CAA1B,CACH,CAED,GAAI,KAAKpE,UAAL,CAAgB,KAAKA,UAAL,CAAgB5Q,MAAhB,CAAyB,CAAzC,EAA4CgV,IAA5C,GAAqD,IAAzD,CAA+D,CAC3D,KAAKpE,UAAL,CAAgB,KAAKA,UAAL,CAAgB5Q,MAAhB,CAAyB,CAAzC,EAA4CgV,IAA5C,CAAmD,CAAnD,CACH,CAED;AACA,MAAKpE,UAAL,CAAgB0B,OAAhB,CAAwB,SAASuC,SAAT,CAAoBzQ,KAApB,CAA2B,CAC/C,GAAIyQ,UAAUG,IAAV,GAAmB,IAAvB,CAA6B,CACzB,KAAKpE,UAAL,CAAgBzL,KAAhB,CAAsBf,KAAtB,EAA6BiP,IAA7B,CAAkC,SAAS4B,IAAT,CAAeC,KAAf,CAAsB,CACpD,GAAID,KAAKD,IAAL,GAAc,IAAlB,CAAwB,CACpBH,UAAUG,IAAV,CAAkB,CAACC,KAAKD,IAAL,CAAY,KAAKpE,UAAL,CAAgBxM,MAAQ,CAAxB,EAA2B4Q,IAAxC,GAAiDE,MAAQ,CAAzD,CAAD,CAAgE,KAAKtE,UAAL,CAAgBxM,MAAQ,CAAxB,EAA2B4Q,IAA5G,CACA,MAAO,KAAP,CACH,CAHD,IAGO,CACH,MAAO,MAAP,CACH,CACJ,CAPD,CAOG,IAPH,EAQH,CACJ,CAXD,CAWG,IAXH,EAYH,CAEDtD,wBAAwB1I,SAAxB,CAAoCtN,OAAO4Q,MAAP,CAAcoE,kBAAkB1H,SAAhC,CAApC,CAEA;AACA0I,yBAAwB8C,gBAAxB,CAA2C,sEAA3C,CAEA5V,OAAOD,OAAP,CAAiB+S,uBAAjB,CAEC,CAxGyO,CAwGxO,CAAC,UAAU,CAAX,CAAa,sBAAsB,CAAnC,CAxGwO,CA53CokB,CAo+CrwB,GAAG,CAAC,SAASzR,OAAT,CAAiBrB,MAAjB,CAAwBD,OAAxB,CAAgC,CAC7E,GAAIwW,QAAS,QAATA,OAAS,EAAW,CACpB,GAAIA,OAAO3Z,OAAP,CAAeyP,OAAf,EAA0B1M,OAAO6W,OAAjC,EAA4C7W,OAAO6W,OAAP,CAAetZ,GAA/D,CAAoE,CAChEuZ,SAASrM,SAAT,CAAmBzL,IAAnB,CAAwBwC,IAAxB,CAA6BxB,OAAO6W,OAAP,CAAetZ,GAA5C,CAAkDyC,OAAO6W,OAAzD,EAAmEf,KAAnE,CAAyE9V,OAAO6W,OAAhF,CAAyF,CAAEjK,KAAKC,GAAL,GAAa+J,OAAO3Z,OAAP,CAAe0P,KAA7B,CAAsC,IAAvC,CAA6C,cAA7C,EAA6DiH,MAA7D,CAAoE,GAAGhN,KAAH,CAASpF,IAAT,CAAcuU,SAAd,CAAyB,CAAzB,CAApE,CAAzF,EACH,CACJ,CAJD,CAMAa,OAAO3Z,OAAP,CAAiB,CAACyP,QAAS,KAAV,CAAjB,CACArM,OAAOD,OAAP,CAAiBwW,MAAjB,CAEC,CAV2C,CAU1C,EAV0C,CAp+CkwB,CA8+CxyB,GAAG,CAAC,SAASlV,OAAT,CAAiBrB,MAAjB,CAAwBD,OAAxB,CAAgC,CAC1C,GAAI6J,OAAQvI,QAAQ,SAAR,CAAZ,CACA,GAAIyK,OAAQzK,QAAQ,SAAR,CAAZ,CACA,GAAI4K,WAAYH,MAAMG,SAAtB,CACA,GAAIyK,kBAAmB5K,MAAM4K,gBAA7B,CACA,GAAIC,cAAe7K,MAAM6K,YAAzB,CAEA,QAAS9K,cAAT,CAAuBxE,IAAvB,CAA6BuP,MAA7B,CAAqC,CACjC,KAAKvP,IAAL,CAAYA,IAAZ,CACA,KAAKuP,MAAL,CAAcA,MAAd,CACA,KAAKC,KAAL,CAAa,IAAb,CACA,KAAKtI,MAAL,CAAc,IAAd,CACA,KAAKuI,OAAL,CAAe,IAAf,CACA,KAAKC,IAAL,CAAY,EAAZ,CACA,KAAKC,cAAL,CAAsB,EAAtB,CACA,KAAKL,YAAL,CAAoB,IAApB,CACA,KAAKM,OAAL,CAAe,IAAf,CACA,KAAKC,cAAL,CAAsB,IAAtB,CACA,KAAK3L,MAAL,CAAc,EAAd,CACA,KAAK4L,MAAL,CAAc,EAAd,CACA,KAAKC,gBAAL,CAAwB,IAAxB,CACA,KAAKC,aAAL,CAAqB,IAArB,CACA,KAAKC,eAAL,CAAuB,IAAvB,CACA,KAAKC,eAAL,CAAuB,KAAvB,CACA,KAAKC,OAAL,CAAe,IAAf,CACH,CAED3L,cAAczB,SAAd,CAAwBqN,OAAxB,CAAkC,SAASZ,KAAT,CAAgB,CAC9CA,MAAMI,OAAN,CAAgB,KAAKA,OAArB,CACAJ,MAAMC,OAAN,CAAgB,KAAKA,OAArB,CACAD,MAAMtI,MAAN,CAAe,KAAKA,MAApB,CACAsI,MAAME,IAAN,CAAa,KAAKA,IAAlB,CACAF,MAAMG,cAAN,CAAuB,KAAKA,cAA5B,CACAH,MAAMK,cAAN,CAAuB,KAAKA,cAA5B,CACAL,MAAMM,MAAN,CAAe,KAAKA,MAApB,CACAN,MAAMO,gBAAN,CAAyB,KAAKA,gBAA9B,CACAP,MAAMW,OAAN,CAAgB,KAAKA,OAArB,CACH,CAVD,CAYA3L,cAAczB,SAAd,CAAwBsN,UAAxB,CAAqC,UAAW,CAC5C,MAAO,MAAKF,OAAL,GAAiB,IAAjB,CAAyB,KAAKA,OAAL,CAAe,KAAKG,QAAL,CAAc,SAAd,CAAxC,CAAoE,KAAKH,OAAhF,CACH,CAFD,CAIA3L,cAAczB,SAAd,CAAwBwN,WAAxB,CAAsC,SAASf,KAAT,CAAgB,CAClD,KAAKA,KAAL,CAAaA,KAAb,CACAA,MAAMgB,QAAN,CAAexT,IAAf,CAAoB,IAApB,EACH,CAHD,CAKAwH,cAAczB,SAAd,CAAwB0N,gBAAxB,CAA2C,UAAW,CAClD,MAAO,MAAKzQ,IAAL,CAAU7F,QAAV,GAAuBuW,KAAKC,SAA5B,CAAwC,KAAKpB,MAAL,CAAYK,OAApD,CACH,KAAKgB,GAAL,CAAS,SAAT,IAAwB,MAAxB,EACA,KAAKA,GAAL,CAAS,YAAT,IAA2B,QAD3B,EAEA,CAAC,KAAK5Q,IAAL,CAAU6Q,YAAV,CAAuB,yBAAvB,CAFD,GAGC,KAAK7Q,IAAL,CAAUO,QAAV,GAAuB,OAAvB,EAAkC,KAAKP,IAAL,CAAU8Q,YAAV,CAAuB,MAAvB,IAAmC,QAHtE,CADJ,CAMH,CAPD,CASAtM,cAAczB,SAAd,CAAwB6N,GAAxB,CAA8B,SAASG,SAAT,CAAoB,CAC9C,GAAI,CAAC,KAAKlB,cAAV,CAA0B,CACtB,KAAKA,cAAL,CAAsB,KAAKK,eAAL,CAAuB,KAAKX,MAAL,CAAYyB,aAAZ,CAA0B,KAAKC,MAAL,CAAc,SAAd,CAA0B,QAApD,CAAvB,CAAuF,KAAKD,aAAL,CAAmB,IAAnB,CAA7G,CACH,CAED,MAAO,MAAKlB,MAAL,CAAYiB,SAAZ,IAA2B,KAAKjB,MAAL,CAAYiB,SAAZ,EAAyB,KAAKlB,cAAL,CAAoBkB,SAApB,CAApD,CAAP,CACH,CAND,CAQAvM,cAAczB,SAAd,CAAwBmO,WAAxB,CAAsC,SAASH,SAAT,CAAoB,CACtD,GAAII,UAAW,CAAC,QAAD,CAAW,KAAX,CAAkB,IAAlB,CAAwB,GAAxB,CAAf,CACA,GAAItU,OAAQ,KAAK+T,GAAL,CAASG,SAAT,CAAZ,CACA,GAAIlU,QAAUmJ,SAAd,CAAyB,CACrBmL,SAAS/D,IAAT,CAAc,SAASgE,MAAT,CAAiB,CAC3BvU,MAAQ,KAAK+T,GAAL,CAASQ,OAASL,UAAUM,MAAV,CAAiB,CAAjB,CAAoB,CAApB,EAAuBC,WAAvB,EAAT,CAAgDP,UAAUM,MAAV,CAAiB,CAAjB,CAAzD,CAAR,CACA,MAAOxU,SAAUmJ,SAAjB,CACH,CAHD,CAGG,IAHH,EAIH,CACD,MAAOnJ,SAAUmJ,SAAV,CAAsB,IAAtB,CAA6BnJ,KAApC,CACH,CAVD,CAYA2H,cAAczB,SAAd,CAAwBiO,aAAxB,CAAwC,SAASpV,IAAT,CAAe,CACnD,MAAO,MAAKoE,IAAL,CAAUR,aAAV,CAAwBC,WAAxB,CAAoC8R,gBAApC,CAAqD,KAAKvR,IAA1D,CAAgEpE,IAAhE,CAAP,CACH,CAFD,CAIA4I,cAAczB,SAAd,CAAwByO,MAAxB,CAAiC,SAAST,SAAT,CAAoB,CACjD,GAAIlU,OAAQ6G,SAAS,KAAKkN,GAAL,CAASG,SAAT,CAAT,CAA8B,EAA9B,CAAZ,CACA,MAAQpC,OAAM9R,KAAN,CAAD,CAAiB,CAAjB,CAAqBA,KAA5B,CAAmC;AACtC,EAHD,CAKA2H,cAAczB,SAAd,CAAwBkB,KAAxB,CAAgC,SAAS8M,SAAT,CAAoB,CAChD,MAAO,MAAK7M,MAAL,CAAY6M,SAAZ,IAA2B,KAAK7M,MAAL,CAAY6M,SAAZ,EAAyB,GAAIxO,MAAJ,CAAU,KAAKqO,GAAL,CAASG,SAAT,CAAV,CAApD,CAAP,CACH,CAFD,CAIAvM,cAAczB,SAAd,CAAwBuN,QAAxB,CAAmC,SAASS,SAAT,CAAoB,CACnD,GAAIlU,OAAQ6R,WAAW,KAAKkC,GAAL,CAASG,SAAT,CAAX,CAAZ,CACA,MAAQpC,OAAM9R,KAAN,CAAD,CAAiB,CAAjB,CAAqBA,KAA5B,CACH,CAHD,CAKA2H,cAAczB,SAAd,CAAwB0O,UAAxB,CAAqC,UAAW,CAC5C,GAAIC,QAAS,KAAKd,GAAL,CAAS,YAAT,CAAb,CACA,OAAOlN,SAASgO,MAAT,CAAiB,EAAjB,CAAP,EACA,IAAK,IAAL,CACIA,OAAS,MAAT,CACA,MACJ,IAAK,IAAL,CACIA,OAAS,QAAT,CACA,MANJ,CAQA,MAAOA,OAAP,CACH,CAXD,CAaAlN,cAAczB,SAAd,CAAwB4O,SAAxB,CAAoC,UAAW,CAC3C,GAAIC,SAAU,KAAKhB,GAAL,CAAS,MAAT,EAAiBnN,KAAjB,CAAuB,KAAKoO,IAA5B,CAAd,CACA,GAAID,OAAJ,CAAa,CACT,MAAO,CACHlb,IAAKgN,SAASkO,QAAQ,CAAR,CAAT,CAAqB,EAArB,CADF,CAEH1a,MAAOwM,SAASkO,QAAQ,CAAR,CAAT,CAAqB,EAArB,CAFJ,CAGHza,OAAQuM,SAASkO,QAAQ,CAAR,CAAT,CAAqB,EAArB,CAHL,CAIHnb,KAAMiN,SAASkO,QAAQ,CAAR,CAAT,CAAqB,EAArB,CAJH,CAAP,CAMH,CACD,MAAO,KAAP,CACH,CAXD,CAaApN,cAAczB,SAAd,CAAwB0J,qBAAxB,CAAgD,UAAW,CACvD,MAAO,MAAKsD,gBAAL,GAA0B,KAAKA,gBAAL,CAAwBV,iBAAiB,KAAKuB,GAAL,CAAS,iBAAT,CAAjB,CAAlD,CAAP,CACH,CAFD,CAIApM,cAAczB,SAAd,CAAwB+O,OAAxB,CAAkC,SAASC,QAAT,CAAmB5T,KAAnB,CAA0B,CACxD,GAAItB,OAAQ,CAAC,KAAK+T,GAAL,CAASmB,QAAT,GAAsB,EAAvB,EAA2B1V,KAA3B,CAAiC,GAAjC,CAAZ,CACAQ,MAAQA,MAAMsB,OAAS,CAAf,GAAqBtB,MAAM,CAAN,CAArB,EAAiC,MAAzC,CACAA,MAAQA,MAAMmV,IAAN,GAAa3V,KAAb,CAAmB,GAAnB,CAAR,CACA,GAAIQ,MAAM9C,MAAN,GAAiB,CAArB,CAAwB,CACpB8C,MAAQ,CAACA,MAAM,CAAN,CAAD,CAAWoV,aAAapV,MAAM,CAAN,CAAb,EAAyB,MAAzB,CAAkCA,MAAM,CAAN,CAA7C,CAAR,CACH,CACD,MAAOA,MAAP,CACH,CARD,CAUA2H,cAAczB,SAAd,CAAwBmP,mBAAxB,CAA8C,SAAShL,MAAT,CAAiB4B,KAAjB,CAAwB3K,KAAxB,CAA+B,CACzE,GAAIiL,MAAO,KAAK0I,OAAL,CAAa,gBAAb,CAA+B3T,KAA/B,CAAX,CACA,GAAI9H,MAAJ,CAAWC,MAAX,CAEA,GAAI2b,aAAa7I,KAAK,CAAL,CAAb,CAAJ,CAA2B,CACvB/S,MAAQ6Q,OAAO7Q,KAAP,CAAeqY,WAAWtF,KAAK,CAAL,CAAX,CAAf,CAAqC,GAA7C,CACH,CAFD,IAEO,IAAI,gBAAgBnK,IAAhB,CAAqBmK,KAAK,CAAL,CAArB,CAAJ,CAAmC,CACtC,GAAI+I,aAAcjL,OAAO7Q,KAAP,CAAe6Q,OAAO5Q,MAAxC,CAAgD8b,aAAetJ,MAAMzS,KAAN,CAAcyS,MAAMxS,MAAnF,CACA,MAAQ6b,aAAcC,YAAd,CAA6BhJ,KAAK,CAAL,IAAY,SAA1C,CAAwD,CAAC/S,MAAO6Q,OAAO5Q,MAAP,CAAgB8b,YAAxB,CAAsC9b,OAAQ4Q,OAAO5Q,MAArD,CAAxD,CAAuH,CAACD,MAAO6Q,OAAO7Q,KAAf,CAAsBC,OAAQ4Q,OAAO7Q,KAAP,CAAe+b,YAA7C,CAA9H,CACH,CAHM,IAGA,CACH/b,MAAQqN,SAAS0F,KAAK,CAAL,CAAT,CAAkB,EAAlB,CAAR,CACH,CAED,GAAIA,KAAK,CAAL,IAAY,MAAZ,EAAsBA,KAAK,CAAL,IAAY,MAAtC,CAA8C,CAC1C9S,OAASwS,MAAMxS,MAAf,CACH,CAFD,IAEO,IAAI8S,KAAK,CAAL,IAAY,MAAhB,CAAwB,CAC3B9S,OAASD,MAAQyS,MAAMzS,KAAd,CAAsByS,MAAMxS,MAArC,CACH,CAFM,IAEA,IAAI2b,aAAa7I,KAAK,CAAL,CAAb,CAAJ,CAA2B,CAC9B9S,OAAU4Q,OAAO5Q,MAAP,CAAgBoY,WAAWtF,KAAK,CAAL,CAAX,CAAhB,CAAsC,GAAhD,CACH,CAFM,IAEA,CACH9S,OAASoN,SAAS0F,KAAK,CAAL,CAAT,CAAkB,EAAlB,CAAT,CACH,CAED,GAAIA,KAAK,CAAL,IAAY,MAAhB,CAAwB,CACpB/S,MAAQC,OAASwS,MAAMxS,MAAf,CAAwBwS,MAAMzS,KAAtC,CACH,CAED,MAAO,CAACA,MAAOA,KAAR,CAAeC,OAAQA,MAAvB,CAAP,CACH,CA5BD,CA8BAkO,cAAczB,SAAd,CAAwBsP,uBAAxB,CAAkD,SAASnL,MAAT,CAAiB4B,KAAjB,CAAwB3K,KAAxB,CAA+BmU,cAA/B,CAA+C,CAC7F,GAAI9b,UAAW,KAAKsb,OAAL,CAAa,oBAAb,CAAmC3T,KAAnC,CAAf,CACA,GAAI1H,KAAJ,CAAUC,GAAV,CAEA,GAAIub,aAAazb,SAAS,CAAT,CAAb,CAAJ,CAA8B,CAC1BC,KAAO,CAACyQ,OAAO7Q,KAAP,CAAe,CAACic,gBAAkBxJ,KAAnB,EAA0BzS,KAA1C,GAAoDqY,WAAWlY,SAAS,CAAT,CAAX,EAA0B,GAA9E,CAAP,CACH,CAFD,IAEO,CACHC,KAAOiN,SAASlN,SAAS,CAAT,CAAT,CAAsB,EAAtB,CAAP,CACH,CAED,GAAIA,SAAS,CAAT,IAAgB,MAApB,CAA4B,CACxBE,IAAMD,KAAOqS,MAAMzS,KAAb,CAAqByS,MAAMxS,MAAjC,CACH,CAFD,IAEO,IAAI2b,aAAazb,SAAS,CAAT,CAAb,CAAJ,CAA8B,CACjCE,IAAO,CAACwQ,OAAO5Q,MAAP,CAAgB,CAACgc,gBAAkBxJ,KAAnB,EAA0BxS,MAA3C,EAAqDoY,WAAWlY,SAAS,CAAT,CAAX,CAArD,CAA+E,GAAtF,CACH,CAFM,IAEA,CACHE,IAAMgN,SAASlN,SAAS,CAAT,CAAT,CAAsB,EAAtB,CAAN,CACH,CAED,GAAIA,SAAS,CAAT,IAAgB,MAApB,CAA4B,CACxBC,KAAOC,IAAMoS,MAAMxS,MAAZ,CAAqBwS,MAAMzS,KAAlC,CACH,CAED,MAAO,CAACI,KAAMA,IAAP,CAAaC,IAAKA,GAAlB,CAAP,CACH,CAvBD,CAyBA8N,cAAczB,SAAd,CAAwBwP,qBAAxB,CAAgD,SAASpU,KAAT,CAAgB,CAC5D,MAAO,MAAK2T,OAAL,CAAa,kBAAb,CAAiC3T,KAAjC,EAAwC,CAAxC,CAAP,CACH,CAFD,CAIAqG,cAAczB,SAAd,CAAwByP,gBAAxB,CAA2C,UAAW,CAClD,GAAIC,YAAa,KAAK7B,GAAL,CAAS,YAAT,CAAjB,CACA,GAAI8B,SAAU,EAAd,CAEA,GAAID,YAAcA,aAAe,MAAjC,CAAyC,CACrC,GAAIE,SAAUF,WAAWhP,KAAX,CAAiB,KAAKmP,oBAAtB,CAAd,CACA,IAAK,GAAIlZ,GAAI,CAAb,CAAgBiZ,SAAYjZ,EAAIiZ,QAAQ5Y,MAAxC,CAAiDL,GAAjD,CAAsD,CAClD,GAAIL,GAAIsZ,QAAQjZ,CAAR,EAAW+J,KAAX,CAAiB,KAAKoP,kBAAtB,CAAR,CACAH,QAAQ1V,IAAR,CAAa,CACTiH,MAAO,GAAI1B,MAAJ,CAAUlJ,EAAE,CAAF,CAAV,CADE,CAETyZ,QAASzZ,EAAE,CAAF,EAAOqV,WAAWrV,EAAE,CAAF,EAAKiD,OAAL,CAAa,IAAb,CAAmB,EAAnB,CAAX,CAAP,CAA4C,CAF5C,CAGTyW,QAAS1Z,EAAE,CAAF,EAAOqV,WAAWrV,EAAE,CAAF,EAAKiD,OAAL,CAAa,IAAb,CAAmB,EAAnB,CAAX,CAAP,CAA4C,CAH5C,CAIT0W,KAAM3Z,EAAE,CAAF,EAAOA,EAAE,CAAF,EAAKiD,OAAL,CAAa,IAAb,CAAmB,EAAnB,CAAP,CAAgC,CAJ7B,CAAb,EAMH,CACJ,CACD,MAAOoW,QAAP,CACH,CAjBD,CAmBAlO,cAAczB,SAAd,CAAwBkQ,cAAxB,CAAyC,UAAW,CAChD,GAAI,CAAC,KAAKjD,aAAV,CAAyB,CACrB,GAAI,KAAKkD,YAAL,EAAJ,CAAyB,CACrB,GAAIC,QAAS,KAAKC,WAAL,EAAb,CACA,GAAIzH,QAAS,KAAKuF,WAAL,CAAiB,iBAAjB,EAAoC7U,KAApC,CAA0C,GAA1C,EAA+CP,GAA/C,CAAmDuX,QAAnD,EAA6DvX,GAA7D,CAAiEwX,OAAjE,CAAb,CACA3H,OAAO,CAAP,GAAawH,OAAO1c,IAApB,CACAkV,OAAO,CAAP,GAAawH,OAAOzc,GAApB,CACA,KAAKsZ,aAAL,CAAqB,CACjBrE,OAAQA,MADS,CAEjB4H,OAAQ,KAAKC,oBAAL,EAFS,CAArB,CAIH,CATD,IASO,CACH,KAAKxD,aAAL,CAAqB,CACjBrE,OAAQ,CAAC,CAAD,CAAI,CAAJ,CADS,CAEjB4H,OAAQ,CAAC,CAAD,CAAI,CAAJ,CAAO,CAAP,CAAU,CAAV,CAAa,CAAb,CAAgB,CAAhB,CAFS,CAArB,CAIH,CACJ,CACD,MAAO,MAAKvD,aAAZ,CACH,CAnBD,CAqBAxL,cAAczB,SAAd,CAAwByQ,oBAAxB,CAA+C,UAAW,CACtD,GAAI,CAAC,KAAKvD,eAAV,CAA2B,CACvB,GAAIwD,WAAY,KAAKvC,WAAL,CAAiB,WAAjB,CAAhB,CACA,GAAIqC,QAASE,UAAYC,YAAYD,UAAUhQ,KAAV,CAAgB,KAAKkQ,eAArB,CAAZ,CAAZ,CAAiE,IAA9E,CACA,KAAK1D,eAAL,CAAuBsD,OAASA,MAAT,CAAkB,CAAC,CAAD,CAAI,CAAJ,CAAO,CAAP,CAAU,CAAV,CAAa,CAAb,CAAgB,CAAhB,CAAzC,CACH,CACD,MAAO,MAAKtD,eAAZ,CACH,CAPD,CASAzL,cAAczB,SAAd,CAAwBqQ,WAAxB,CAAsC,UAAW,CAC7C,MAAO,MAAKlM,MAAL,GAAgB,KAAKA,MAAL,CAAc,KAAKgM,YAAL,GAAsB5D,aAAa,KAAKtP,IAAlB,CAAtB,CAAgD4E,UAAU,KAAK5E,IAAf,CAA9E,CAAP,CACH,CAFD,CAIAwE,cAAczB,SAAd,CAAwBmQ,YAAxB,CAAuC,UAAW,CAC9C,MAAO,MAAKM,oBAAL,GAA4B/W,IAA5B,CAAiC,GAAjC,IAA0C,aAA1C,EAA4D,KAAK8S,MAAL,EAAe,KAAKA,MAAL,CAAY2D,YAAZ,EAAlF,CACH,CAFD,CAIA1O,cAAczB,SAAd,CAAwB6Q,QAAxB,CAAmC,UAAW,CAC1C,GAAI/W,OAAQ,KAAKmD,IAAL,CAAUnD,KAAV,EAAmB,EAA/B,CACA,GAAI,KAAKmD,IAAL,CAAU6T,OAAV,GAAsB,QAA1B,CAAoC,CAChChX,MAAQiX,eAAe,KAAK9T,IAApB,CAAR,CACH,CAFD,IAEO,IAAI,KAAKA,IAAL,CAAUpE,IAAV,GAAmB,UAAvB,CAAmC,CACtCiB,MAAQwG,MAAMxG,MAAM9C,MAAN,CAAe,CAArB,EAAwB0C,IAAxB,CAA6B,GAA7B,CAAR,CAAgD;AACnD,EACD,MAAOI,OAAM9C,MAAN,GAAiB,CAAjB,CAAsB,KAAKiG,IAAL,CAAU+T,WAAV,EAAyB,EAA/C,CAAqDlX,KAA5D,CACH,CARD,CAUA2H,cAAczB,SAAd,CAAwB4Q,eAAxB,CAA0C,2BAA1C,CACAnP,cAAczB,SAAd,CAAwB6P,oBAAxB,CAA+C,wCAA/C,CACApO,cAAczB,SAAd,CAAwB8P,kBAAxB,CAA6C,2CAA7C,CACArO,cAAczB,SAAd,CAAwB8O,IAAxB,CAA+B,iDAA/B,CAEA,QAASiC,eAAT,CAAwB9T,IAAxB,CAA8B,CAC1B,GAAIgU,QAAShU,KAAKzK,OAAL,CAAayK,KAAKiU,aAAL,EAAsB,CAAnC,CAAb,CACA,MAAOD,QAAUA,OAAOE,IAAP,EAAe,EAAzB,CAA+B,EAAtC,CACH,CAED,QAASR,YAAT,CAAqBjQ,KAArB,CAA4B,CACxB,GAAIA,OAASA,MAAM,CAAN,IAAa,QAA1B,CAAoC,CAChC,MAAOA,OAAM,CAAN,EAASpH,KAAT,CAAe,GAAf,EAAoBP,GAApB,CAAwB,SAASzC,CAAT,CAAY,CACvC,MAAOqV,YAAWrV,EAAE2Y,IAAF,EAAX,CAAP,CACH,CAFM,CAAP,CAGH,CAJD,IAIO,IAAIvO,OAASA,MAAM,CAAN,IAAa,UAA1B,CAAsC,CACzC,GAAI0Q,UAAW1Q,MAAM,CAAN,EAASpH,KAAT,CAAe,GAAf,EAAoBP,GAApB,CAAwB,SAASzC,CAAT,CAAY,CACjD,MAAOqV,YAAWrV,EAAE2Y,IAAF,EAAX,CAAP,CACD,CAFc,CAAf,CAGA,MAAO,CAACmC,SAAS,CAAT,CAAD,CAAcA,SAAS,CAAT,CAAd,CAA2BA,SAAS,CAAT,CAA3B,CAAwCA,SAAS,CAAT,CAAxC,CAAqDA,SAAS,EAAT,CAArD,CAAmEA,SAAS,EAAT,CAAnE,CAAP,CACH,CACJ,CAED,QAASlC,aAAT,CAAsBpV,KAAtB,CAA6B,CACzB,MAAOA,OAAMmH,QAAN,GAAiBoQ,OAAjB,CAAyB,GAAzB,IAAkC,CAAC,CAA1C,CACH,CAED,QAASf,SAAT,CAAkBgB,GAAlB,CAAuB,CACnB,MAAOA,KAAI/X,OAAJ,CAAY,IAAZ,CAAkB,EAAlB,CAAP,CACH,CAED,QAASgX,QAAT,CAAiBe,GAAjB,CAAsB,CAClB,MAAO3F,YAAW2F,GAAX,CAAP,CACH,CAED1b,OAAOD,OAAP,CAAiB8L,aAAjB,CAEC,CA1SQ,CA0SP,CAAC,UAAU,CAAX,CAAa,UAAU,EAAvB,CA1SO,CA9+CqyB,CAwxDhxB,GAAG,CAAC,SAASxK,OAAT,CAAiBrB,MAAjB,CAAwBD,OAAxB,CAAgC,CAClE,GAAI7C,KAAMmE,QAAQ,OAAR,CAAV,CACA,GAAIM,UAAWN,QAAQ,UAAR,CAAf,CACA,GAAIwK,eAAgBxK,QAAQ,iBAAR,CAApB,CACA,GAAIsa,eAAgBta,QAAQ,iBAAR,CAApB,CACA,GAAIua,wBAAyBva,QAAQ,0BAAR,CAA7B,CACA,GAAIkQ,aAAclQ,QAAQ,eAAR,CAAlB,CACA,GAAIuI,OAAQvI,QAAQ,SAAR,CAAZ,CACA,GAAIwa,iBAAkBxa,QAAQ,mBAAR,CAAtB,CACA,GAAIyK,OAAQzK,QAAQ,SAAR,CAAZ,CACA,GAAI1C,MAAOmN,MAAMnN,IAAjB,CACA,GAAIsN,WAAYH,MAAMG,SAAtB,CACA,GAAIyK,kBAAmB5K,MAAM4K,gBAA7B,CACA,GAAIC,cAAe7K,MAAM6K,YAAzB,CAEA,QAAS/K,WAAT,CAAoBkQ,OAApB,CAA6BjP,QAA7B,CAAuCwB,OAAvC,CAAgDC,WAAhD,CAA6D1R,OAA7D,CAAsE,CAClEM,IAAI,qBAAJ,EACA,KAAK2P,QAAL,CAAgBA,QAAhB,CACA,KAAKjQ,OAAL,CAAeA,OAAf,CACA,KAAKmf,KAAL,CAAa,IAAb,CACA,KAAK1N,OAAL,CAAeA,OAAf,CACA,KAAK2N,WAAL,CAAmB,EAAnB,CACA,KAAKnF,KAAL,CAAa,GAAIgF,gBAAJ,CAAoB,IAApB,CAA0B,CAA1B,CAA6BC,QAAQjV,aAArC,CAAoD,IAApD,CAAb,CACA,GAAI+P,QAAS,GAAI/K,cAAJ,CAAkBiQ,OAAlB,CAA2B,IAA3B,CAAb,CACA,GAAIlf,QAAQqf,UAAZ,CAAwB,CACpBpP,SAASqP,SAAT,CAAmB,CAAnB,CAAsB,CAAtB,CAAyBrP,SAASnP,KAAlC,CAAyCmP,SAASlP,MAAlD,CAA0D,GAAIiM,MAAJ,CAAUhN,QAAQqf,UAAlB,CAA1D,EACH,CACD,GAAIH,UAAYA,QAAQjV,aAAR,CAAsBuB,eAAtC,CAAuD,CACnD;AACA,IAAI+T,kBAAmB,GAAItQ,cAAJ,CAAkB+K,OAAOtL,KAAP,CAAa,iBAAb,EAAgCd,aAAhC,GAAkDsR,QAAQjV,aAAR,CAAsB7I,IAAxE,CAA+E8d,QAAQjV,aAAR,CAAsBuB,eAAvH,CAAwI,IAAxI,CAAvB,CACAyE,SAASqP,SAAT,CAAmB,CAAnB,CAAsB,CAAtB,CAAyBrP,SAASnP,KAAlC,CAAyCmP,SAASlP,MAAlD,CAA0Dwe,iBAAiB7Q,KAAjB,CAAuB,iBAAvB,CAA1D,EACH,CACDsL,OAAOwF,QAAP,CAAkBxF,OAAOkB,gBAAP,EAAlB,CACA,KAAKuE,sBAAL,CAA4BP,QAAQjV,aAApC,EACA,KAAKyV,iBAAL,CAAuBR,QAAQjV,aAA/B,EACA,KAAKsM,KAAL,CAAaoJ,QAAQ,CAAC3F,MAAD,EAASrD,MAAT,CAAgB,KAAKiJ,WAAL,CAAiB5F,MAAjB,CAAhB,EAA0C7C,MAA1C,CAAiD,SAAS1L,SAAT,CAAoB,CACtF,MAAOA,WAAU4O,OAAV,CAAoB5O,UAAUyP,gBAAV,EAA3B,CACH,CAFoB,EAElB3U,GAFkB,CAEd,KAAKsZ,iBAFS,CAEU,IAFV,CAAR,CAAb,CAGA,KAAKC,WAAL,CAAmB,GAAInL,YAAJ,EAAnB,CACArU,IAAI,uBAAJ,CAA6B,KAAKiW,KAAL,CAAW/R,MAAxC,EACAlE,IAAI,0BAAJ,EACA,KAAKyf,sBAAL,GACAzf,IAAI,uBAAJ,EACA,KAAKkW,MAAL,CAAc9E,YAAY4G,KAAZ,CAAkB,KAAK/B,KAAL,CAAWY,MAAX,CAAkB6I,SAAlB,CAAlB,CAAd,CACA,KAAKjO,KAAL,CAAa,KAAKyE,MAAL,CAAYzE,KAAZ,CAAkBvR,IAAlB,CAAuBuB,KAAK,UAAW,CAChDzB,IAAI,iCAAJ,EACAA,IAAI,4BAAJ,EACA,KAAK2f,sBAAL,GACA3f,IAAI,2BAAJ,EACA,KAAK4f,oBAAL,CAA0B,KAAKjG,KAA/B,EACA,KAAKkG,KAAL,CAAW,KAAKlG,KAAhB,EACA3Z,IAAI,6BAA+B,KAAK8e,WAAL,CAAiB5a,MAAhD,CAAyD,QAA7D,EACA,MAAO,IAAIsH,QAAJ,CAAY/J,KAAK,SAASgK,OAAT,CAAkB,CACtC,GAAI,CAAC/L,QAAQ6P,KAAb,CAAoB,CAChB,KAAKuP,WAAL,CAAiBtI,OAAjB,CAAyB,KAAKsJ,KAA9B,CAAqC,IAArC,EACArU,UACH,CAHD,IAGO,IAAI,MAAO/L,SAAQ6P,KAAf,GAA0B,UAA9B,CAA0C,CAC7C7P,QAAQ6P,KAAR,CAActL,IAAd,CAAmB,IAAnB,CAAyB,KAAK6a,WAA9B,CAA2CrT,OAA3C,EACH,CAFM,IAEA,IAAI,KAAKqT,WAAL,CAAiB5a,MAAjB,CAA0B,CAA9B,CAAgC,CACnC,KAAK6b,WAAL,CAAmB,CAAnB,CACA,KAAKC,aAAL,CAAmB,KAAKlB,WAAxB,CAAqCrT,OAArC,EACH,CAHM,IAGA,CACHA,UACH,CACJ,CAZkB,CAYhB,IAZgB,CAAZ,CAAP,CAaH,CArBmC,CAqBjC,IArBiC,CAAvB,CAAb,CAsBH,CAEDiD,WAAWxB,SAAX,CAAqBuS,sBAArB,CAA8C,UAAW,CACrD,KAAKxJ,KAAL,CAAWO,OAAX,CAAmB,SAASrL,SAAT,CAAoB,CACnC,GAAIuU,UAAUvU,SAAV,CAAJ,CAA0B,CACtB,GAAIkP,gBAAgBlP,SAAhB,CAAJ,CAAgC,CAC5BA,UAAU8U,WAAV,GACH,CACD9U,UAAUyO,OAAV,CAAoB,KAAKsG,YAAL,CAAkB/U,SAAlB,CAApB,CACA,GAAI0O,MAAQ1O,UAAU4P,GAAV,CAAc,UAAd,IAA8B,QAA/B,CAA2C,CAAC5P,UAAUyO,OAAV,CAAkBC,IAAnB,CAA3C,CAAsE,EAAjF,CACA,GAAIsG,SAAUhV,UAAU2Q,SAAV,EAAd,CACA,GAAIqE,SAAW,CAAC,UAAD,CAAa,OAAb,EAAsB5B,OAAtB,CAA8BpT,UAAU4P,GAAV,CAAc,UAAd,CAA9B,IAA6D,CAAC,CAA7E,CAAgF,CAC5ElB,KAAK1S,IAAL,CAAU,CAAC,CAAC,MAAD,CACHgE,UAAUkG,MAAV,CAAiBzQ,IAAjB,CAAwBuf,QAAQvf,IAD7B,CAEHuK,UAAUkG,MAAV,CAAiBxQ,GAAjB,CAAuBsf,QAAQtf,GAF5B,CAGHsf,QAAQ9e,KAAR,CAAgB8e,QAAQvf,IAHrB,CAIHuf,QAAQ7e,MAAR,CAAiB6e,QAAQtf,GAJtB,CAAD,CAAV,EAMH,CACDsK,UAAU0O,IAAV,CAAiBuG,cAAcjV,SAAd,EAA2BA,UAAUuO,MAAV,CAAiBG,IAAjB,CAAsBxD,MAAtB,CAA6BwD,IAA7B,CAA3B,CAAgEA,IAAjF,CACA1O,UAAU2O,cAAV,CAA4B3O,UAAU4P,GAAV,CAAc,UAAd,IAA8B,QAA/B,CAA2C5P,UAAU0O,IAAV,CAAexD,MAAf,CAAsB,CAAClL,UAAUyO,OAAV,CAAkBC,IAAnB,CAAtB,CAA3C,CAA6F1O,UAAU0O,IAAlI,CACA,GAAIQ,gBAAgBlP,SAAhB,CAAJ,CAAgC,CAC5BA,UAAUkV,QAAV,GACH,CACJ,CApBD,IAoBO,IAAIC,WAAWnV,SAAX,CAAJ,CAA2B,CAC9BA,UAAU0O,IAAV,CAAiBuG,cAAcjV,SAAd,EAA2BA,UAAUuO,MAAV,CAAiBG,IAA5C,CAAmD,EAApE,CACH,CACD,GAAI,CAACQ,gBAAgBlP,SAAhB,CAAL,CAAiC,CAC7BA,UAAUkG,MAAV,CAAmB,IAAnB,CACH,CACJ,CA3BD,CA2BG,IA3BH,EA4BH,CA7BD,CA+BA,QAAS+O,cAAT,CAAuBjV,SAAvB,CAAkC,CAC9B,MAAOA,WAAUuO,MAAV,EAAoBvO,UAAUuO,MAAV,CAAiBG,IAAjB,CAAsB3V,MAAjD,CACH,CAEDwK,WAAWxB,SAAX,CAAqB8S,aAArB,CAAqC,SAASO,KAAT,CAAgB9U,OAAhB,CAAyB+U,UAAzB,CAAqC,CACtEA,WAAaA,YAAcnR,KAAKC,GAAL,EAA3B,CACA,KAAKwQ,KAAL,CAAWS,MAAM,KAAKR,WAAL,EAAN,CAAX,EACA,GAAIQ,MAAMrc,MAAN,GAAiB,KAAK6b,WAA1B,CAAuC,CACnCtU,UACH,CAFD,IAEO,IAAI+U,WAAa,EAAb,CAAkBnR,KAAKC,GAAL,EAAtB,CAAkC,CACrC,KAAK0Q,aAAL,CAAmBO,KAAnB,CAA0B9U,OAA1B,CAAmC+U,UAAnC,EACH,CAFM,IAEA,CACHnI,WAAW5W,KAAK,UAAW,CACvB,KAAKue,aAAL,CAAmBO,KAAnB,CAA0B9U,OAA1B,EACH,CAFU,CAER,IAFQ,CAAX,CAEU,CAFV,EAGH,CACJ,CAZD,CAcAiD,WAAWxB,SAAX,CAAqBiS,sBAArB,CAA8C,SAAS7U,QAAT,CAAmB,CAC7D,KAAKmW,YAAL,CAAkBnW,QAAlB,CAA4B,IAAMoU,uBAAuBxR,SAAvB,CAAiCwT,gCAAvC,CAA0E,+DAA1E,CACxB,GADwB,CAClBhC,uBAAuBxR,SAAvB,CAAiCyT,+BADf,CACiD,8DAD7E,EAEH,CAHD,CAKAjS,WAAWxB,SAAX,CAAqBkS,iBAArB,CAAyC,SAAS9U,QAAT,CAAmB,CACxD,KAAKmW,YAAL,CAAkBnW,QAAlB,CAA4B,uIACxB,sIADJ,EAEH,CAHD,CAKAoE,WAAWxB,SAAX,CAAqBuT,YAArB,CAAoC,SAASnW,QAAT,CAAmB2P,MAAnB,CAA2B,CAC3D,GAAI2G,oBAAqBtW,SAAShK,aAAT,CAAuB,OAAvB,CAAzB,CACAsgB,mBAAmBC,SAAnB,CAA+B5G,MAA/B,CACA3P,SAASxJ,IAAT,CAAcC,WAAd,CAA0B6f,kBAA1B,EACH,CAJD,CAMAlS,WAAWxB,SAAX,CAAqBqS,iBAArB,CAAyC,SAASpU,SAAT,CAAoB,CACzD,GAAI8K,OAAQ,CAAC,CAAC9K,SAAD,CAAD,CAAZ,CACA,GAAIA,UAAUhB,IAAV,CAAe7F,QAAf,GAA4BuW,KAAKiG,YAArC,CAAmD,CAC/C,GAAI1F,QAAS,KAAK2F,gBAAL,CAAsB5V,SAAtB,CAAiC,SAAjC,CAAb,CACA,GAAI6V,OAAQ,KAAKD,gBAAL,CAAsB5V,SAAtB,CAAiC,QAAjC,CAAZ,CAEA,GAAIiQ,MAAJ,CAAY,CACRnF,MAAM9O,IAAN,CAAWiU,MAAX,EACH,CAED,GAAI4F,KAAJ,CAAW,CACP/K,MAAM9O,IAAN,CAAW6Z,KAAX,EACH,CACJ,CACD,MAAO3B,SAAQpJ,KAAR,CAAP,CACH,CAfD,CAiBA,QAASgL,YAAT,CAAqBzC,GAArB,CAA0B,CACtB,MAAOA,KAAI/X,OAAJ,CAAY,YAAZ,CAA0B,SAASmH,KAAT,CAAe,CAC5C,MAAOA,OAAM6N,WAAN,GAAoBhV,OAApB,CAA4B,GAA5B,CAAgC,EAAhC,CAAP,CACH,CAFM,CAAP,CAGH,CAEDiI,WAAWxB,SAAX,CAAqB6T,gBAArB,CAAwC,SAAS5V,SAAT,CAAoBpF,IAApB,CAA0B,CAC9D,GAAIrF,OAAQyK,UAAUgQ,aAAV,CAAwBpV,IAAxB,CAAZ,CACA,GAAG,CAACrF,KAAD,EAAU,CAACA,MAAMwgB,OAAjB,EAA4BxgB,MAAMwgB,OAAN,GAAkB,MAA9C,EAAwDxgB,MAAMwgB,OAAN,GAAkB,kBAA1E,EAAgGxgB,MAAMygB,OAAN,GAAkB,MAArH,CAA6H,CACzH,MAAO,KAAP,CACH,CAED,GAAID,SAAUE,YAAY1gB,MAAMwgB,OAAlB,CAAd,CACA,GAAIG,SAAUH,QAAQ1F,MAAR,CAAe,CAAf,CAAkB,CAAlB,IAAyB,KAAvC,CACA,GAAI8F,YAAahX,SAAShK,aAAT,CAAuB+gB,QAAU,KAAV,CAAkB,0BAAzC,CAAjB,CACA,GAAIE,iBAAkB,GAAI7C,uBAAJ,CAA2B4C,UAA3B,CAAuCnW,SAAvC,CAAkDpF,IAAlD,CAAtB,CAEA,IAAK,GAAIlC,GAAInD,MAAMwD,MAAN,CAAa,CAA1B,CAA6BL,GAAK,CAAlC,CAAqCA,GAArC,CAA0C,CACtC,GAAIqY,UAAW+E,YAAYvgB,MAAM8gB,IAAN,CAAW3d,CAAX,CAAZ,CAAf,CACAyd,WAAW5gB,KAAX,CAAiBwb,QAAjB,EAA6Bxb,MAAMwb,QAAN,CAA7B,CACH,CAEDoF,WAAWlW,SAAX,CAAuBsT,uBAAuBxR,SAAvB,CAAiCwT,gCAAjC,CAAoE,GAApE,CAA0EhC,uBAAuBxR,SAAvB,CAAiCyT,+BAAlI,CAEA,GAAIU,OAAJ,CAAa,CACTC,WAAWvO,GAAX,CAAiByG,iBAAiB0H,OAAjB,EAA0B,CAA1B,EAA6B5K,IAA7B,CAAkC,CAAlC,CAAjB,CACA,MAAO,CAACiL,eAAD,CAAP,CACH,CAHD,IAGO,CACH,GAAIlD,MAAO/T,SAASlJ,cAAT,CAAwB8f,OAAxB,CAAX,CACAI,WAAWvgB,WAAX,CAAuBsd,IAAvB,EACA,MAAO,CAACkD,eAAD,CAAkB,GAAI9C,cAAJ,CAAkBJ,IAAlB,CAAwBkD,eAAxB,CAAlB,CAAP,CACH,CACJ,CA1BD,CA6BA7S,WAAWxB,SAAX,CAAqBoS,WAArB,CAAmC,SAASmC,eAAT,CAA0B,CACzD,MAAOpC,SAAQ,GAAGxI,MAAH,CAAU5S,IAAV,CAAewd,gBAAgBtX,IAAhB,CAAqB4B,UAApC,CAAgD2V,cAAhD,EAAgEzb,GAAhE,CAAoE,SAASkE,IAAT,CAAe,CAC9F,GAAIgB,WAAY,CAAChB,KAAK7F,QAAL,GAAkBuW,KAAKC,SAAvB,CAAmC,GAAI2D,cAAJ,CAAkBtU,IAAlB,CAAwBsX,eAAxB,CAAnC,CAA8E,GAAI9S,cAAJ,CAAkBxE,IAAlB,CAAwBsX,eAAxB,CAA/E,EAAyH5K,MAAzH,CAAgI8K,iBAAhI,CAAhB,CACA,MAAOxX,MAAK7F,QAAL,GAAkBuW,KAAKiG,YAAvB,EAAuC3V,UAAUjH,MAAjD,EAA2DiG,KAAK6T,OAAL,GAAiB,UAA5E,CAA0F7S,UAAU,CAAV,EAAayP,gBAAb,GAAkCzP,UAAUkL,MAAV,CAAiB,KAAKiJ,WAAL,CAAiBnU,UAAU,CAAV,CAAjB,CAAjB,CAAlC,CAAqF,EAA/K,CAAqLA,SAA5L,CACH,CAHc,CAGZ,IAHY,CAAR,CAAP,CAIH,CALD,CAOAuD,WAAWxB,SAAX,CAAqB0U,kBAArB,CAA0C,SAASzW,SAAT,CAAoB0W,cAApB,CAAoC,CAC1E,GAAIlI,OAAQ,GAAIgF,gBAAJ,CAAoBkD,cAApB,CAAoC1W,UAAUqP,UAAV,EAApC,CAA4DrP,UAAUhB,IAAtE,CAA4EgB,UAAUuO,MAAtF,CAAZ,CACAvO,UAAUoP,OAAV,CAAkBZ,KAAlB,EACA,GAAImI,aAAcD,eAAiBlI,MAAMoI,cAAN,CAAqB,IAArB,CAAjB,CAA8CpI,MAAMD,MAAN,CAAaC,KAA7E,CACAmI,YAAYE,QAAZ,CAAqB7a,IAArB,CAA0BwS,KAA1B,EACAxO,UAAUwO,KAAV,CAAkBA,KAAlB,CACH,CAND,CAQAjL,WAAWxB,SAAX,CAAqByS,sBAArB,CAA8C,UAAW,CACrD,KAAK1J,KAAL,CAAWO,OAAX,CAAmB,SAASrL,SAAT,CAAoB,CACnC,GAAIuU,UAAUvU,SAAV,IAAyB,KAAK8W,aAAL,CAAmB9W,SAAnB,GAAiC+W,WAAW/W,SAAX,CAAjC,EAA0DgX,wBAAwBhX,SAAxB,CAA1D,EAAgG,KAAKiX,yBAAL,CAA+BjX,SAA/B,CAAhG,EAA6IA,UAAUkS,YAAV,EAAtK,CAAJ,CAAqM,CACjM,KAAKuE,kBAAL,CAAwBzW,SAAxB,CAAmC,IAAnC,EACH,CAFD,IAEO,IAAIuU,UAAUvU,SAAV,IAA0BkX,aAAalX,SAAb,GAA2BmX,QAAQnX,SAAR,CAA5B,EAAmDoX,cAAcpX,SAAd,CAAnD,EAA+EqX,WAAWrX,SAAX,CAAxG,CAAJ,CAAoI,CACvI,KAAKyW,kBAAL,CAAwBzW,SAAxB,CAAmC,KAAnC,EACH,CAFM,IAEA,CACHA,UAAUuP,WAAV,CAAsBvP,UAAUuO,MAAV,CAAiBC,KAAvC,EACH,CACJ,CARD,CAQG,IARH,EASH,CAVD,CAYAjL,WAAWxB,SAAX,CAAqBkV,yBAArB,CAAiD,SAASjX,SAAT,CAAoB,CACjE,MAAOA,WAAUhB,IAAV,CAAeO,QAAf,GAA4B,MAA5B,EAAsCS,UAAUuO,MAAV,CAAiBtL,KAAjB,CAAuB,iBAAvB,EAA0Cd,aAA1C,EAA7C,CACH,CAFD,CAIAoB,WAAWxB,SAAX,CAAqB+U,aAArB,CAAqC,SAAS9W,SAAT,CAAoB,CACrD,MAAOA,WAAUuO,MAAV,GAAqB,IAA5B,CACH,CAFD,CAIAhL,WAAWxB,SAAX,CAAqB0S,oBAArB,CAA4C,SAASjG,KAAT,CAAgB,CACxDA,MAAMqI,QAAN,CAAeS,IAAf,CAAoBC,WAAW/I,MAAMqI,QAAN,CAAe3Y,KAAf,CAAqB,CAArB,CAAX,CAApB,EACAsQ,MAAMqI,QAAN,CAAexL,OAAf,CAAuB,KAAKoJ,oBAA5B,CAAkD,IAAlD,EACH,CAHD,CAKAlR,WAAWxB,SAAX,CAAqByV,eAArB,CAAuC,SAASxX,SAAT,CAAoB,CACvD,MAAO,UAASkT,IAAT,CAAe/V,KAAf,CAAsBsa,QAAtB,CAAgC,CACnC,GAAIzX,UAAUuO,MAAV,CAAiBqB,GAAjB,CAAqB,gBAArB,EAAuCS,MAAvC,CAA8C,CAA9C,CAAiD,CAAjD,IAAwD,MAAxD,EAAkE6C,KAAKlC,IAAL,GAAYjY,MAAZ,GAAuB,CAA7F,CAAgG,CAC5F,GAAI,KAAKiN,OAAL,CAAa0R,WAAb,EAA4B,CAAC1X,UAAUuO,MAAV,CAAiB2D,YAAjB,EAAjC,CAAkE,CAC9D,GAAIC,QAASsF,SAASvZ,KAAT,CAAe,CAAf,CAAkBf,KAAlB,EAAyB1B,IAAzB,CAA8B,EAA9B,EAAkC1C,MAA/C,CACA,MAAO,MAAK4e,cAAL,CAAoB3X,UAAUhB,IAA9B,CAAoCmT,MAApC,CAA4Ce,KAAKna,MAAjD,CAAP,CACH,CAHD,IAGO,IAAIiH,UAAUhB,IAAV,EAAkB,MAAOgB,WAAUhB,IAAV,CAAemK,IAAtB,GAAgC,QAAtD,CAAgE,CACnE,GAAIyO,iBAAkB5X,UAAUhB,IAAV,CAAe6Y,SAAf,CAAyB3E,KAAKna,MAA9B,CAAtB,CACA,GAAImN,QAAS,KAAK4R,gBAAL,CAAsB9X,UAAUhB,IAAhC,CAAsCgB,UAAUuO,MAAV,CAAiB2D,YAAjB,EAAtC,CAAb,CACAlS,UAAUhB,IAAV,CAAiB4Y,eAAjB,CACA,MAAO1R,OAAP,CACH,CACJ,CAVD,IAUO,IAAG,CAAC,KAAKF,OAAL,CAAa0R,WAAd,EAA6B1X,UAAUuO,MAAV,CAAiB2D,YAAjB,EAAhC,CAAgE,CACnElS,UAAUhB,IAAV,CAAiBgB,UAAUhB,IAAV,CAAe6Y,SAAf,CAAyB3E,KAAKna,MAA9B,CAAjB,CACH,CACD,MAAO,EAAP,CACH,CAfD,CAgBH,CAjBD,CAmBAwK,WAAWxB,SAAX,CAAqB+V,gBAArB,CAAwC,SAAS9Y,IAAT,CAAeyT,SAAf,CAA0B,CAC9D,GAAIsF,SAAU/Y,KAAKR,aAAL,CAAmBrJ,aAAnB,CAAiC,oBAAjC,CAAd,CACA,GAAIoZ,QAASvP,KAAKyH,UAAlB,CACIuR,WAAahZ,KAAKD,SAAL,CAAe,IAAf,CADjB,CAGAgZ,QAAQniB,WAAR,CAAoBoJ,KAAKD,SAAL,CAAe,IAAf,CAApB,EACAwP,OAAOnN,YAAP,CAAoB2W,OAApB,CAA6B/Y,IAA7B,EACA,GAAIkH,QAASuM,UAAYnE,aAAayJ,OAAb,CAAZ,CAAoCnU,UAAUmU,OAAV,CAAjD,CACAxJ,OAAOnN,YAAP,CAAoB4W,UAApB,CAAgCD,OAAhC,EACA,MAAO7R,OAAP,CACH,CAVD,CAYA3C,WAAWxB,SAAX,CAAqB4V,cAArB,CAAsC,SAAS3Y,IAAT,CAAemT,MAAf,CAAuBpZ,MAAvB,CAA+B,CACjE,GAAI2a,OAAQ,KAAKA,KAAL,GAAe,KAAKA,KAAL,CAAa1U,KAAKR,aAAL,CAAmByZ,WAAnB,EAA5B,CAAZ,CACAvE,MAAMwE,QAAN,CAAelZ,IAAf,CAAqBmT,MAArB,EACAuB,MAAMyE,MAAN,CAAanZ,IAAb,CAAmBmT,OAASpZ,MAA5B,EACA,MAAO2a,OAAM0E,qBAAN,EAAP,CACH,CALD,CAOA,QAASC,eAAT,EAA0B,CAAE,CAE5B9U,WAAWxB,SAAX,CAAqB2S,KAArB,CAA6B,SAASlG,KAAT,CAAgB,CACzC;AACA,IAAI8J,gBAAiB9J,MAAMqI,QAAN,CAAenL,MAAf,CAAsB6M,cAAtB,CAArB,CAA4D;AAC5D,IAAIC,oBAAqBhK,MAAMgB,QAAN,CAAe9D,MAAf,CAAsB6I,SAAtB,CAAzB,CACA,GAAIkE,qBAAsBD,mBAAmB9M,MAAnB,CAA0BgN,IAAIrB,UAAJ,CAA1B,CAA1B,CACA,GAAIsB,mCAAoCF,oBAAoB/M,MAApB,CAA2BgN,IAAIxB,YAAJ,CAA3B,EAA8CxL,MAA9C,CAAqDgN,IAAIE,WAAJ,CAArD,CAAxC,CAAgH;AAChH,IAAIC,qBAAsBL,mBAAmB9M,MAAnB,CAA0BgN,IAAIxB,YAAJ,CAA1B,EAA6CxL,MAA7C,CAAoD2L,UAApD,CAA1B,CAA2F;AAC3F,IAAIyB,QAASL,oBAAoB/M,MAApB,CAA2BgN,IAAIxB,YAAJ,CAA3B,EAA8CxL,MAA9C,CAAqDkN,WAArD,CAAb,CAAgF;AAChF,IAAIG,aAAcvK,MAAMqI,QAAN,CAAe3L,MAAf,CAAsBuN,oBAAoB/M,MAApB,CAA2BwL,YAA3B,CAAtB,EAAgExL,MAAhE,CAAuEyL,OAAvE,CAAlB,CAAmG;AACnG,IAAIjE,MAAO1E,MAAMgB,QAAN,CAAe9D,MAAf,CAAsByJ,UAAtB,EAAkCzJ,MAAlC,CAAyCsN,OAAzC,CAAX,CACA,GAAIC,gBAAiBzK,MAAMqI,QAAN,CAAenL,MAAf,CAAsBwN,cAAtB,CAArB,CAA4D;AAC5DZ,gBAAepN,MAAf,CAAsByN,iCAAtB,EAAyDzN,MAAzD,CAAgE2N,mBAAhE,EACK3N,MADL,CACY4N,MADZ,EACoB5N,MADpB,CAC2B6N,WAD3B,EACwC7N,MADxC,CAC+CgI,IAD/C,EACqDhI,MADrD,CAC4D+N,cAD5D,EAC4E5N,OAD5E,CACoF,SAASrL,SAAT,CAAoB,CAChG,KAAK2T,WAAL,CAAiB3X,IAAjB,CAAsBgE,SAAtB,EACA,GAAImZ,kBAAkBnZ,SAAlB,CAAJ,CAAkC,CAC9B,KAAK0U,KAAL,CAAW1U,SAAX,EACA,KAAK2T,WAAL,CAAiB3X,IAAjB,CAAsB,GAAIqc,eAAJ,EAAtB,EACH,CACJ,CAPL,CAOO,IAPP,EAQH,CAnBD,CAqBA9U,WAAWxB,SAAX,CAAqB4S,KAArB,CAA6B,SAAS3U,SAAT,CAAoB,CAC7C,GAAI,CACA,GAAIA,oBAAqBqY,eAAzB,CAAyC,CACrC,KAAK7T,QAAL,CAAcjO,GAAd,CAAkB6iB,OAAlB,GACH,CAFD,IAEO,IAAIjE,WAAWnV,SAAX,CAAJ,CAA2B,CAC9B,GAAIkP,gBAAgBlP,UAAUuO,MAA1B,CAAJ,CAAuC,CACnCvO,UAAUuO,MAAV,CAAiBuG,WAAjB,GACH,CACD,KAAKuE,SAAL,CAAerZ,SAAf,EACA,GAAIkP,gBAAgBlP,UAAUuO,MAA1B,CAAJ,CAAuC,CACnCvO,UAAUuO,MAAV,CAAiB2G,QAAjB,GACH,CACJ,CARM,IAQA,CACH,KAAKoE,SAAL,CAAetZ,SAAf,EACH,CACJ,CAAC,MAAM/H,CAAN,CAAS,CACPpD,IAAIoD,CAAJ,EACA,GAAI,KAAK1D,OAAL,CAAakQ,MAAjB,CAAyB,CACrB,KAAMxM,EAAN,CACH,CACJ,CACJ,CArBD,CAuBAsL,WAAWxB,SAAX,CAAqBuX,SAArB,CAAiC,SAAStZ,SAAT,CAAoB,CACjD,GAAImZ,kBAAkBnZ,SAAlB,CAAJ,CAAkC,CAC9B,KAAKwE,QAAL,CAAc+U,UAAd,CAAyBvZ,UAAUmP,OAAnC,EACA,KAAK3K,QAAL,CAAcjO,GAAd,CAAkBijB,IAAlB,GACA,GAAIxZ,UAAUkS,YAAV,EAAJ,CAA8B,CAC1B,KAAK1N,QAAL,CAAciV,YAAd,CAA2BzZ,UAAUiS,cAAV,EAA3B,EACH,CACJ,CAED,GAAIjS,UAAUhB,IAAV,CAAeO,QAAf,GAA4B,OAA5B,EAAuCS,UAAUhB,IAAV,CAAepE,IAAf,GAAwB,UAAnE,CAA+E,CAC3E,KAAK8e,aAAL,CAAmB1Z,SAAnB,EACH,CAFD,IAEO,IAAIA,UAAUhB,IAAV,CAAeO,QAAf,GAA4B,OAA5B,EAAuCS,UAAUhB,IAAV,CAAepE,IAAf,GAAwB,OAAnE,CAA4E,CAC/E,KAAK+e,UAAL,CAAgB3Z,SAAhB,EACH,CAFM,IAEA,CACH,KAAK4Z,YAAL,CAAkB5Z,SAAlB,EACH,CACJ,CAhBD,CAkBAuD,WAAWxB,SAAX,CAAqB6X,YAArB,CAAoC,SAAS5Z,SAAT,CAAoB,CACpD,GAAIkG,QAASlG,UAAUoS,WAAV,EAAb,CACA,KAAK5N,QAAL,CAAckK,IAAd,CAAmB1O,UAAU2O,cAA7B,CAA6C,UAAW,CACpD,KAAKnK,QAAL,CAAcqV,gBAAd,CAA+B7Z,SAA/B,CAA0CkG,MAA1C,CAAkDlG,UAAUyO,OAAV,CAAkBA,OAAlB,CAA0B3T,GAA1B,CAA8Bgf,QAA9B,CAAlD,EACH,CAFD,CAEG,IAFH,EAIA,KAAKtV,QAAL,CAAckK,IAAd,CAAmB1O,UAAU0O,IAA7B,CAAmC,UAAW,CAC1C,KAAKlK,QAAL,CAAcuV,aAAd,CAA4B/Z,UAAUyO,OAAV,CAAkBA,OAA9C,EACH,CAFD,CAEG,IAFH,EAIA,KAAKjK,QAAL,CAAckK,IAAd,CAAmB1O,UAAU2O,cAA7B,CAA6C,UAAW,CACpD,OAAQ3O,UAAUhB,IAAV,CAAeO,QAAvB,EACA,IAAK,KAAL,CACA,IAAK,QAAL,CACI,GAAIya,cAAe,KAAKjP,MAAL,CAAY4B,GAAZ,CAAgB3M,UAAUhB,IAA1B,CAAnB,CACA,GAAIgb,YAAJ,CAAkB,CACd,KAAKxV,QAAL,CAAcyV,WAAd,CAA0Bja,SAA1B,CAAqCkG,MAArC,CAA6ClG,UAAUyO,OAAvD,CAAgEuL,YAAhE,EACH,CAFD,IAEO,CACHnlB,IAAI,kBAAoBmL,UAAUhB,IAAV,CAAeO,QAAnC,CAA8C,GAAlD,CAAuDS,UAAUhB,IAAjE,EACH,CACD,MACJ,IAAK,KAAL,CACI,GAAIkb,gBAAiB,KAAKnP,MAAL,CAAY4B,GAAZ,CAAgB3M,UAAUhB,IAAV,CAAe4I,GAA/B,CAArB,CACA,GAAIsS,cAAJ,CAAoB,CAChB,KAAK1V,QAAL,CAAcyV,WAAd,CAA0Bja,SAA1B,CAAqCkG,MAArC,CAA6ClG,UAAUyO,OAAvD,CAAgEyL,cAAhE,EACH,CAFD,IAEO,CACHrlB,IAAI,qBAAJ,CAA2BmL,UAAUhB,IAAV,CAAe4I,GAA1C,EACH,CACD,MACJ,IAAK,QAAL,CACI,KAAKpD,QAAL,CAAcyV,WAAd,CAA0Bja,SAA1B,CAAqCkG,MAArC,CAA6ClG,UAAUyO,OAAvD,CAAgE,CAAC3G,MAAO9H,UAAUhB,IAAlB,CAAhE,EACA,MACJ,IAAK,QAAL,CACA,IAAK,OAAL,CACA,IAAK,UAAL,CACI,KAAKmb,cAAL,CAAoBna,SAApB,EACA,MAzBJ,CA2BH,CA5BD,CA4BG,IA5BH,EA6BH,CAvCD,CAyCAuD,WAAWxB,SAAX,CAAqB2X,aAArB,CAAqC,SAAS1Z,SAAT,CAAoB,CACrD,GAAIwB,GAAIxB,UAAUoS,WAAV,EAAR,CAEA,GAAIhK,MAAO9N,KAAKiI,GAAL,CAASf,EAAEnM,KAAX,CAAkBmM,EAAElM,MAApB,CAAX,CACA,GAAI4Q,QAAS,CAAC7Q,MAAO+S,KAAO,CAAf,CAAkB9S,OAAQ8S,KAAO,CAAjC,CAAoC1S,IAAK8L,EAAE9L,GAA3C,CAAgDD,KAAM+L,EAAE/L,IAAxD,CAAb,CACA,GAAI2C,GAAI,CAAC,CAAD,CAAI,CAAJ,CAAR,CACA,GAAIgiB,QAAS,CAAChiB,CAAD,CAAIA,CAAJ,CAAOA,CAAP,CAAUA,CAAV,CAAb,CACA,GAAIqW,SAAU,CAAC,CAAD,CAAG,CAAH,CAAK,CAAL,CAAO,CAAP,EAAU3T,GAAV,CAAc,SAAS/D,CAAT,CAAY,CACpC,MAAO,CAACkM,MAAO,GAAI1B,MAAJ,CAAU,SAAV,CAAR,CAA8BlM,MAAO0B,CAArC,CAAP,CACH,CAFa,CAAd,CAIA,GAAIsjB,cAAeC,qBAAqBpU,MAArB,CAA6BkU,MAA7B,CAAqC3L,OAArC,CAAnB,CAEA,KAAKjK,QAAL,CAAckK,IAAd,CAAmB1O,UAAU2O,cAA7B,CAA6C,UAAW,CACpD,KAAKnK,QAAL,CAAcqP,SAAd,CAAwB3N,OAAOzQ,IAAP,CAAc,CAAtC,CAAyCyQ,OAAOxQ,GAAP,CAAa,CAAtD,CAAyDwQ,OAAO7Q,KAAP,CAAe,CAAxE,CAA2E6Q,OAAO5Q,MAAP,CAAgB,CAA3F,CAA8F,GAAIiM,MAAJ,CAAU,SAAV,CAA9F,EACA,KAAKiD,QAAL,CAAcuV,aAAd,CAA4BQ,iBAAiB9L,OAAjB,CAA0BvI,MAA1B,CAAkCmU,YAAlC,CAAgDD,MAAhD,CAA5B,EACA,GAAIpa,UAAUhB,IAAV,CAAewb,OAAnB,CAA4B,CACxB,KAAKhW,QAAL,CAAciW,IAAd,CAAmB,GAAIlZ,MAAJ,CAAU,SAAV,CAAnB,CAAyC,QAAzC,CAAmD,QAAnD,CAA6D,MAA7D,CAAsE6G,KAAO,CAAR,CAAa,IAAlF,CAAwF,OAAxF,EACA,KAAK5D,QAAL,CAAc0O,IAAd,CAAmB,GAAnB,CAA6BhN,OAAOzQ,IAAP,CAAc2S,KAAO,CAAlD,CAAqDlC,OAAOxQ,GAAP,CAAa0S,IAAb,CAAoB,CAAzE,EACH,CACJ,CAPD,CAOG,IAPH,EAQH,CArBD,CAuBA7E,WAAWxB,SAAX,CAAqB4X,UAArB,CAAkC,SAAS3Z,SAAT,CAAoB,CAClD,GAAIkG,QAASlG,UAAUoS,WAAV,EAAb,CAEA,GAAIhK,MAAO9N,KAAKiI,GAAL,CAAS2D,OAAO7Q,KAAhB,CAAuB6Q,OAAO5Q,MAA9B,EAAwC,CAAnD,CAEA,KAAKkP,QAAL,CAAckK,IAAd,CAAmB1O,UAAU2O,cAA7B,CAA6C,UAAW,CACpD,KAAKnK,QAAL,CAAckW,YAAd,CAA2BxU,OAAOzQ,IAAP,CAAc,CAAzC,CAA4CyQ,OAAOxQ,GAAP,CAAa,CAAzD,CAA4D0S,IAA5D,CAAkE,GAAI7G,MAAJ,CAAU,SAAV,CAAlE,CAAwF,CAAxF,CAA2F,GAAIA,MAAJ,CAAU,SAAV,CAA3F,EACA,GAAIvB,UAAUhB,IAAV,CAAewb,OAAnB,CAA4B,CACxB,KAAKhW,QAAL,CAAcmW,MAAd,CAAqBrgB,KAAKsgB,IAAL,CAAU1U,OAAOzQ,IAAP,CAAc2S,KAAO,CAA/B,EAAoC,CAAzD,CAA4D9N,KAAKsgB,IAAL,CAAU1U,OAAOxQ,GAAP,CAAa0S,KAAO,CAA9B,EAAmC,CAA/F,CAAkG9N,KAAKD,KAAL,CAAW+N,KAAO,CAAlB,CAAlG,CAAwH,GAAI7G,MAAJ,CAAU,SAAV,CAAxH,EACH,CACJ,CALD,CAKG,IALH,EAMH,CAXD,CAaAgC,WAAWxB,SAAX,CAAqBoY,cAArB,CAAsC,SAASna,SAAT,CAAoB,CACtD,GAAInE,OAAQmE,UAAU4S,QAAV,EAAZ,CACA,GAAI/W,MAAM9C,MAAN,CAAe,CAAnB,CAAsB,CAClB,GAAIoG,UAAWa,UAAUhB,IAAV,CAAeR,aAA9B,CACA,GAAIuZ,SAAU5Y,SAAShK,aAAT,CAAuB,oBAAvB,CAAd,CACA,GAAI0lB,YAAa,CAAC,YAAD,CAAe,WAAf,CAA4B,YAA5B,CAA0C,YAA1C,CAAwD,UAAxD,CAAoE,OAApE,CACb,aADa,CACE,YADF,CACgB,cADhB,CACgC,eADhC,CAEb,OAFa,CAEJ,QAFI,CAEM,iBAFN,CAEyB,gBAFzB,CAE2C,iBAF3C,CAE8D,gBAF9D,CAGb,WAHa,CAGA,YAHA,CAGc,UAHd,CAAjB,CAKAA,WAAWxP,OAAX,CAAmB,SAAS0F,QAAT,CAAmB,CAClC,GAAI,CACAgH,QAAQxiB,KAAR,CAAcwb,QAAd,EAA0B/Q,UAAU4P,GAAV,CAAcmB,QAAd,CAA1B,CACH,CAAC,MAAM9Y,CAAN,CAAS,CACP;AACApD,KAAI,4DAA8DoD,EAAE6iB,OAApE,EACH,CACJ,CAPD,EAQA,GAAI5U,QAASlG,UAAUoS,WAAV,EAAb,CACA2F,QAAQxiB,KAAR,CAAcC,QAAd,CAAyB,OAAzB,CACAuiB,QAAQxiB,KAAR,CAAcE,IAAd,CAAqByQ,OAAOzQ,IAAP,CAAc,IAAnC,CACAsiB,QAAQxiB,KAAR,CAAcG,GAAd,CAAoBwQ,OAAOxQ,GAAP,CAAa,IAAjC,CACAqiB,QAAQgD,WAAR,CAAsBlf,KAAtB,CACAsD,SAASxJ,IAAT,CAAcC,WAAd,CAA0BmiB,OAA1B,EACA,KAAKsB,SAAL,CAAe,GAAI/F,cAAJ,CAAkByE,QAAQzY,UAA1B,CAAsCU,SAAtC,CAAf,EACAb,SAASxJ,IAAT,CAAc+Q,WAAd,CAA0BqR,OAA1B,EACH,CACJ,CA3BD,CA6BAxU,WAAWxB,SAAX,CAAqBsX,SAArB,CAAiC,SAASrZ,SAAT,CAAoB,CACjDA,UAAUgb,kBAAV,GACA,GAAIC,YAAa3hB,SAAS4hB,IAAT,CAActe,MAAd,CAAqBoD,UAAUhB,IAAV,CAAemK,IAApC,CAAjB,CACA,GAAIsO,UAAW,CAAC,CAAC,KAAKljB,OAAL,CAAa4mB,eAAd,EAAiCC,gBAAgBpb,SAAhB,CAAlC,GAAiE,CAACqb,WAAWrb,UAAUhB,IAAV,CAAemK,IAA1B,CAAlE,CAAoGmS,SAASL,UAAT,CAApG,CAA2HA,WAAWngB,GAAX,CAAe,SAASygB,SAAT,CAAoB,CACzK,MAAOjiB,UAAS4hB,IAAT,CAAc1d,MAAd,CAAqB,CAAC+d,SAAD,CAArB,CAAP,CACH,CAFyI,CAA1I,CAIA,GAAI7K,QAAS1Q,UAAUuO,MAAV,CAAiBkC,UAAjB,EAAb,CACA,GAAIrI,MAAOpI,UAAUuO,MAAV,CAAiBqB,GAAjB,CAAqB,UAArB,CAAX,CACA,GAAIzH,QAASnI,UAAUuO,MAAV,CAAiBqB,GAAjB,CAAqB,YAArB,CAAb,CACA,GAAI+B,SAAU3R,UAAUuO,MAAV,CAAiBiD,gBAAjB,EAAd,CAEA,KAAKhN,QAAL,CAAciW,IAAd,CAAmBza,UAAUuO,MAAV,CAAiBtL,KAAjB,CAAuB,OAAvB,CAAnB,CAAoDjD,UAAUuO,MAAV,CAAiBqB,GAAjB,CAAqB,WAArB,CAApD,CAAuF5P,UAAUuO,MAAV,CAAiBqB,GAAjB,CAAqB,aAArB,CAAvF,CAA4Hc,MAA5H,CAAoItI,IAApI,CAA0ID,MAA1I,EACA,GAAIwJ,QAAQ5Y,MAAZ,CAAoB,CAChB;AACA,MAAKyL,QAAL,CAAcgX,UAAd,CAAyB7J,QAAQ,CAAR,EAAW1O,KAApC,CAA2C0O,QAAQ,CAAR,EAAWG,OAAtD,CAA+DH,QAAQ,CAAR,EAAWI,OAA1E,CAAmFJ,QAAQ,CAAR,EAAWK,IAA9F,EACH,CAHD,IAGO,CACH,KAAKxN,QAAL,CAAciX,WAAd,GACH,CAED,KAAKjX,QAAL,CAAckK,IAAd,CAAmB1O,UAAUuO,MAAV,CAAiBG,IAApC,CAA0C,UAAW,CACjD+I,SAAS3c,GAAT,CAAa,KAAK0c,eAAL,CAAqBxX,SAArB,CAAb,CAA8C,IAA9C,EAAoDqL,OAApD,CAA4D,SAASnF,MAAT,CAAiB/I,KAAjB,CAAwB,CAChF,GAAI+I,MAAJ,CAAY,CACR,KAAK1B,QAAL,CAAc0O,IAAd,CAAmBuE,SAASta,KAAT,CAAnB,CAAoC+I,OAAOzQ,IAA3C,CAAiDyQ,OAAO/P,MAAxD,EACA,KAAKulB,oBAAL,CAA0B1b,UAAUuO,MAApC,CAA4CrI,MAA5C,CAAoD,KAAKmO,WAAL,CAAiBjL,UAAjB,CAA4BjB,MAA5B,CAAoCC,IAApC,CAApD,EACH,CACJ,CALD,CAKG,IALH,EAMH,CAPD,CAOG,IAPH,EAQH,CA5BD,CA8BA7E,WAAWxB,SAAX,CAAqB2Z,oBAArB,CAA4C,SAAS1b,SAAT,CAAoBkG,MAApB,CAA4ByV,OAA5B,CAAqC,CAC7E,OAAO3b,UAAU4P,GAAV,CAAc,gBAAd,EAAgCvU,KAAhC,CAAsC,GAAtC,EAA2C,CAA3C,CAAP,EACA,IAAK,WAAL,CACI;AACA;AACA,MAAKmJ,QAAL,CAAcqP,SAAd,CAAwB3N,OAAOzQ,IAA/B,CAAqC6E,KAAK4H,KAAL,CAAWgE,OAAOxQ,GAAP,CAAaimB,QAAQnT,QAArB,CAAgCmT,QAAQ1S,SAAnD,CAArC,CAAoG/C,OAAO7Q,KAA3G,CAAkH,CAAlH,CAAqH2K,UAAUiD,KAAV,CAAgB,OAAhB,CAArH,EACA,MACJ,IAAK,UAAL,CACI,KAAKuB,QAAL,CAAcqP,SAAd,CAAwB3N,OAAOzQ,IAA/B,CAAqC6E,KAAK4H,KAAL,CAAWgE,OAAOxQ,GAAlB,CAArC,CAA6DwQ,OAAO7Q,KAApE,CAA2E,CAA3E,CAA8E2K,UAAUiD,KAAV,CAAgB,OAAhB,CAA9E,EACA,MACJ,IAAK,cAAL,CACI;AACA,MAAKuB,QAAL,CAAcqP,SAAd,CAAwB3N,OAAOzQ,IAA/B,CAAqC6E,KAAKsgB,IAAL,CAAU1U,OAAOxQ,GAAP,CAAaimB,QAAQlT,MAArB,CAA8BkT,QAAQ1S,SAAhD,CAArC,CAAiG/C,OAAO7Q,KAAxG,CAA+G,CAA/G,CAAkH2K,UAAUiD,KAAV,CAAgB,OAAhB,CAAlH,EACA,MAZJ,CAcH,CAfD,CAiBA,GAAI2Y,uBAAwB,CACxBC,MAAO,CACH,CAAC,QAAD,CAAW,IAAX,CADG,CAEH,CAAC,QAAD,CAAW,IAAX,CAFG,CAGH,CAAC,QAAD,CAAW,IAAX,CAHG,CAIH,CAAC,QAAD,CAAW,IAAX,CAJG,CADiB,CAA5B,CASAtY,WAAWxB,SAAX,CAAqBgT,YAArB,CAAoC,SAAS/U,SAAT,CAAoB,CACpD,GAAI8b,YAAa9b,UAAUoS,WAAV,EAAjB,CACA,GAAIgI,QAAS2B,oBAAoB/b,SAApB,CAAb,CACA,GAAIyO,SAAU,CAAC,KAAD,CAAQ,OAAR,CAAiB,QAAjB,CAA2B,MAA3B,EAAmC3T,GAAnC,CAAuC,SAASkhB,IAAT,CAAe7e,KAAf,CAAsB,CACvE,GAAI5H,OAAQyK,UAAU4P,GAAV,CAAc,SAAWoM,IAAX,CAAkB,OAAhC,CAAZ,CACA,GAAI/Y,OAAQjD,UAAUiD,KAAV,CAAgB,SAAW+Y,IAAX,CAAkB,OAAlC,CAAZ,CACA,GAAIzmB,QAAU,OAAV,EAAqB0N,MAAMb,OAAN,EAAzB,CAA0C,CACtCa,MAAQ,GAAI1B,MAAJ,CAAU,CAAC,GAAD,CAAM,GAAN,CAAW,GAAX,CAAgB0B,MAAMzK,CAAtB,CAAV,CAAR,CAA6C;AAChD,EACD,GAAIyjB,gBAAiBL,sBAAsBrmB,KAAtB,EAA+BqmB,sBAAsBrmB,KAAtB,EAA6B4H,KAA7B,CAA/B,CAAqE,IAA1F,CACA,MAAO,CACH9H,MAAO2K,UAAUwQ,MAAV,CAAiB,SAAWwL,IAAX,CAAkB,OAAnC,CADJ,CAEH/Y,MAAOgZ,eAAiBhZ,MAAMgZ,eAAe,CAAf,CAAN,EAAyBA,eAAe,CAAf,CAAzB,CAAjB,CAA+DhZ,KAFnE,CAGHkI,KAAM,IAHH,CAAP,CAKH,CAZa,CAAd,CAaA,GAAIkP,cAAeC,qBAAqBwB,UAArB,CAAiC1B,MAAjC,CAAyC3L,OAAzC,CAAnB,CAEA,MAAO,CACHC,KAAM,KAAKwN,mBAAL,CAAyBlc,SAAzB,CAAoCqa,YAApC,CAAkD5L,OAAlD,CAA2D2L,MAA3D,CAAmE0B,UAAnE,CADH,CAEHrN,QAAS8L,iBAAiB9L,OAAjB,CAA0BqN,UAA1B,CAAsCzB,YAAtC,CAAoDD,MAApD,CAFN,CAAP,CAIH,CAtBD,CAwBA,QAASG,iBAAT,CAA0B9L,OAA1B,CAAmCqN,UAAnC,CAA+CzB,YAA/C,CAA6DD,MAA7D,CAAqE,CACjE,MAAO3L,SAAQ3T,GAAR,CAAY,SAASqF,MAAT,CAAiBgc,UAAjB,CAA6B,CAC5C,GAAIhc,OAAO9K,KAAP,CAAe,CAAnB,CAAsB,CAClB,GAAI+mB,IAAKN,WAAWrmB,IAApB,CACA,GAAI4mB,IAAKP,WAAWpmB,GAApB,CACA,GAAI4mB,IAAKR,WAAWzmB,KAApB,CACA,GAAIknB,IAAKT,WAAWxmB,MAAX,CAAqBmZ,QAAQ,CAAR,EAAWpZ,KAAzC,CAEA,OAAO8mB,UAAP,EACA,IAAK,EAAL,CACI;AACAI,IAAK9N,QAAQ,CAAR,EAAWpZ,KAAhB,CACA8K,OAAOgL,IAAP,CAAcqR,SAAS,CACfC,GAAI,CAACL,EAAD,CAAKC,EAAL,CADW,CAEfK,GAAI,CAACN,GAAKE,EAAN,CAAUD,EAAV,CAFW,CAGfM,GAAI,CAACP,GAAKE,EAAL,CAAU7N,QAAQ,CAAR,EAAWpZ,KAAtB,CAA6BgnB,GAAKE,EAAlC,CAHW,CAIfK,GAAI,CAACR,GAAK3N,QAAQ,CAAR,EAAWpZ,KAAjB,CAAwBgnB,GAAKE,EAA7B,CAJW,CAAT,CAKPnC,OAAO,CAAP,CALO,CAKIA,OAAO,CAAP,CALJ,CAMVC,aAAawC,YANH,CAMiBxC,aAAayC,YAN9B,CAM4CzC,aAAa0C,aANzD,CAMwE1C,aAAa2C,aANrF,CAAd,CAOA,MACJ,IAAK,EAAL,CACI;AACAZ,IAAKN,WAAWrmB,IAAX,CAAkBqmB,WAAWzmB,KAA7B,CAAsCoZ,QAAQ,CAAR,EAAWpZ,KAAtD,CACAinB,GAAK7N,QAAQ,CAAR,EAAWpZ,KAAhB,CAEA8K,OAAOgL,IAAP,CAAcqR,SAAS,CACfC,GAAI,CAACL,GAAKE,EAAN,CAAUD,EAAV,CADW,CAEfK,GAAI,CAACN,GAAKE,EAAN,CAAUD,GAAKE,EAAL,CAAU9N,QAAQ,CAAR,EAAWpZ,KAA/B,CAFW,CAGfsnB,GAAI,CAACP,EAAD,CAAKC,GAAKE,EAAV,CAHW,CAIfK,GAAI,CAACR,EAAD,CAAKC,GAAK5N,QAAQ,CAAR,EAAWpZ,KAArB,CAJW,CAAT,CAKP+kB,OAAO,CAAP,CALO,CAKIA,OAAO,CAAP,CALJ,CAMVC,aAAa0C,aANH,CAMkB1C,aAAa2C,aAN/B,CAM8C3C,aAAa4C,gBAN3D,CAM6E5C,aAAa6C,gBAN1F,CAAd,CAOA,MACJ,IAAK,EAAL,CACI;AACAb,IAAMA,GAAKP,WAAWxmB,MAAjB,CAA4BmZ,QAAQ,CAAR,EAAWpZ,KAA5C,CACAknB,GAAK9N,QAAQ,CAAR,EAAWpZ,KAAhB,CACA8K,OAAOgL,IAAP,CAAcqR,SAAS,CACfC,GAAI,CAACL,GAAKE,EAAN,CAAUD,GAAKE,EAAf,CADW,CAEfG,GAAI,CAACN,EAAD,CAAKC,GAAKE,EAAV,CAFW,CAGfI,GAAI,CAACP,GAAK3N,QAAQ,CAAR,EAAWpZ,KAAjB,CAAwBgnB,EAAxB,CAHW,CAIfO,GAAI,CAACR,GAAKE,EAAL,CAAU7N,QAAQ,CAAR,EAAWpZ,KAAtB,CAA6BgnB,EAA7B,CAJW,CAAT,CAKPjC,OAAO,CAAP,CALO,CAKIA,OAAO,CAAP,CALJ,CAMVC,aAAa4C,gBANH,CAMqB5C,aAAa6C,gBANlC,CAMoD7C,aAAa8C,eANjE,CAMkF9C,aAAa+C,eAN/F,CAAd,CAOA,MACJ,IAAK,EAAL,CACI;AACAd,IAAK7N,QAAQ,CAAR,EAAWpZ,KAAhB,CACA8K,OAAOgL,IAAP,CAAcqR,SAAS,CACfC,GAAI,CAACL,EAAD,CAAKC,GAAKE,EAAL,CAAU9N,QAAQ,CAAR,EAAWpZ,KAA1B,CADW,CAEfqnB,GAAI,CAACN,EAAD,CAAKC,EAAL,CAFW,CAGfM,GAAI,CAACP,GAAKE,EAAN,CAAUD,GAAK5N,QAAQ,CAAR,EAAWpZ,KAA1B,CAHW,CAIfunB,GAAI,CAACR,GAAKE,EAAN,CAAUD,GAAKE,EAAf,CAJW,CAAT,CAKPnC,OAAO,CAAP,CALO,CAKIA,OAAO,CAAP,CALJ,CAMVC,aAAa8C,eANH,CAMoB9C,aAAa+C,eANjC,CAMkD/C,aAAawC,YAN/D,CAM6ExC,aAAayC,YAN1F,CAAd,CAOA,MA/CJ,CAiDH,CACD,MAAO3c,OAAP,CACH,CA1DM,CAAP,CA2DH,CAEDoD,WAAWxB,SAAX,CAAqBma,mBAArB,CAA2C,SAASlc,SAAT,CAAoBqa,YAApB,CAAkC5L,OAAlC,CAA2C2L,MAA3C,CAAmDlU,MAAnD,CAA2D,CAClG,GAAIyI,gBAAiB3O,UAAU4P,GAAV,CAAc,gBAAd,CAArB,CACIyN,WAAa,EADjB,CAGA,OAAO1O,cAAP,EACA,IAAK,aAAL,CACA,IAAK,aAAL,CACI2O,YAAYD,UAAZ,CAAwBjD,OAAO,CAAP,CAAxB,CAAmCA,OAAO,CAAP,CAAnC,CAA8CC,aAAayC,YAA3D,CAAyEzC,aAAa2C,aAAtF,CAAqG9W,OAAOzQ,IAAP,CAAcgZ,QAAQ,CAAR,EAAWpZ,KAA9H,CAAqI6Q,OAAOxQ,GAAP,CAAa+Y,QAAQ,CAAR,EAAWpZ,KAA7J,EACAioB,YAAYD,UAAZ,CAAwBjD,OAAO,CAAP,CAAxB,CAAmCA,OAAO,CAAP,CAAnC,CAA8CC,aAAa2C,aAA3D,CAA0E3C,aAAa6C,gBAAvF,CAAyGhX,OAAOzQ,IAAP,CAAcyQ,OAAO7Q,KAArB,CAA6BoZ,QAAQ,CAAR,EAAWpZ,KAAjJ,CAAwJ6Q,OAAOxQ,GAAP,CAAa+Y,QAAQ,CAAR,EAAWpZ,KAAhL,EACAioB,YAAYD,UAAZ,CAAwBjD,OAAO,CAAP,CAAxB,CAAmCA,OAAO,CAAP,CAAnC,CAA8CC,aAAa6C,gBAA3D,CAA6E7C,aAAa+C,eAA1F,CAA2GlX,OAAOzQ,IAAP,CAAcyQ,OAAO7Q,KAArB,CAA6BoZ,QAAQ,CAAR,EAAWpZ,KAAnJ,CAA0J6Q,OAAOxQ,GAAP,CAAawQ,OAAO5Q,MAApB,CAA6BmZ,QAAQ,CAAR,EAAWpZ,KAAlM,EACAioB,YAAYD,UAAZ,CAAwBjD,OAAO,CAAP,CAAxB,CAAmCA,OAAO,CAAP,CAAnC,CAA8CC,aAAa+C,eAA3D,CAA4E/C,aAAayC,YAAzF,CAAuG5W,OAAOzQ,IAAP,CAAcgZ,QAAQ,CAAR,EAAWpZ,KAAhI,CAAuI6Q,OAAOxQ,GAAP,CAAawQ,OAAO5Q,MAApB,CAA6BmZ,QAAQ,CAAR,EAAWpZ,KAA/K,EACA,MAEJ,QACIioB,YAAYD,UAAZ,CAAwBjD,OAAO,CAAP,CAAxB,CAAmCA,OAAO,CAAP,CAAnC,CAA8CC,aAAawC,YAA3D,CAAyExC,aAAa0C,aAAtF,CAAqG7W,OAAOzQ,IAA5G,CAAkHyQ,OAAOxQ,GAAzH,EACA4nB,YAAYD,UAAZ,CAAwBjD,OAAO,CAAP,CAAxB,CAAmCA,OAAO,CAAP,CAAnC,CAA8CC,aAAa0C,aAA3D,CAA0E1C,aAAa4C,gBAAvF,CAAyG/W,OAAOzQ,IAAP,CAAcyQ,OAAO7Q,KAA9H,CAAqI6Q,OAAOxQ,GAA5I,EACA4nB,YAAYD,UAAZ,CAAwBjD,OAAO,CAAP,CAAxB,CAAmCA,OAAO,CAAP,CAAnC,CAA8CC,aAAa4C,gBAA3D,CAA6E5C,aAAa8C,eAA1F,CAA2GjX,OAAOzQ,IAAP,CAAcyQ,OAAO7Q,KAAhI,CAAuI6Q,OAAOxQ,GAAP,CAAawQ,OAAO5Q,MAA3J,EACAgoB,YAAYD,UAAZ,CAAwBjD,OAAO,CAAP,CAAxB,CAAmCA,OAAO,CAAP,CAAnC,CAA8CC,aAAa8C,eAA3D,CAA4E9C,aAAawC,YAAzF,CAAuG3W,OAAOzQ,IAA9G,CAAoHyQ,OAAOxQ,GAAP,CAAawQ,OAAO5Q,MAAxI,EACA,MAdJ,CAiBA,MAAO+nB,WAAP,CACH,CAtBD,CAwBA,QAASE,eAAT,CAAwB1mB,CAAxB,CAA2BC,CAA3B,CAA8B0mB,EAA9B,CAAkCC,EAAlC,CAAsC,CAClC,GAAIC,OAAQ,GAAK,CAACpjB,KAAKqjB,IAAL,CAAU,CAAV,EAAe,CAAhB,EAAqB,CAA1B,CAAZ,CACA,GAAIC,IAAMJ,EAAD,CAAOE,KAAhB,CAAuB;AACnBG,IAAMJ,EAAD,CAAOC,KADhB,CACuB;AACnBI,IAAKjnB,EAAI2mB,EAFb,CAEiB;AACbO,IAAKjnB,EAAI2mB,EAHb,CAGiB;AACjB,OAAO,CACHO,QAASC,YAAY,CAACpnB,EAAGA,CAAJ,CAAOC,EAAGinB,EAAV,CAAZ,CAA2B,CAAClnB,EAAGA,CAAJ,CAAOC,EAAGinB,GAAKF,EAAf,CAA3B,CAA+C,CAAChnB,EAAGinB,GAAKF,EAAT,CAAa9mB,EAAGA,CAAhB,CAA/C,CAAmE,CAACD,EAAGinB,EAAJ,CAAQhnB,EAAGA,CAAX,CAAnE,CADN,CAEHonB,SAAUD,YAAY,CAACpnB,EAAGA,CAAJ,CAAOC,EAAGA,CAAV,CAAZ,CAA0B,CAACD,EAAGA,EAAI+mB,EAAR,CAAW9mB,EAAGA,CAAd,CAA1B,CAA4C,CAACD,EAAGinB,EAAJ,CAAQhnB,EAAGinB,GAAKF,EAAhB,CAA5C,CAAiE,CAAChnB,EAAGinB,EAAJ,CAAQhnB,EAAGinB,EAAX,CAAjE,CAFP,CAGHI,YAAaF,YAAY,CAACpnB,EAAGinB,EAAJ,CAAQhnB,EAAGA,CAAX,CAAZ,CAA2B,CAACD,EAAGinB,EAAJ,CAAQhnB,EAAGA,EAAI+mB,EAAf,CAA3B,CAA+C,CAAChnB,EAAGA,EAAI+mB,EAAR,CAAY9mB,EAAGinB,EAAf,CAA/C,CAAmE,CAAClnB,EAAGA,CAAJ,CAAOC,EAAGinB,EAAV,CAAnE,CAHV,CAIHK,WAAYH,YAAY,CAACpnB,EAAGinB,EAAJ,CAAQhnB,EAAGinB,EAAX,CAAZ,CAA4B,CAAClnB,EAAGinB,GAAKF,EAAT,CAAa9mB,EAAGinB,EAAhB,CAA5B,CAAiD,CAAClnB,EAAGA,CAAJ,CAAOC,EAAGA,EAAI+mB,EAAd,CAAjD,CAAoE,CAAChnB,EAAGA,CAAJ,CAAOC,EAAEA,CAAT,CAApE,CAJT,CAAP,CAMH,CAED,QAASwjB,qBAAT,CAA8BpU,MAA9B,CAAsCmY,YAAtC,CAAoD5P,OAApD,CAA6D,CACzD,GAAI5X,GAAIqP,OAAOzQ,IAAf,CACIqB,EAAIoP,OAAOxQ,GADf,CAEIL,MAAQ6Q,OAAO7Q,KAFnB,CAGIC,OAAS4Q,OAAO5Q,MAHpB,CAKIgpB,IAAMD,aAAa,CAAb,EAAgB,CAAhB,EAAqBhpB,MAAQ,CAA7B,CAAiCgpB,aAAa,CAAb,EAAgB,CAAhB,CAAjC,CAAsDhpB,MAAQ,CALxE,CAMIkpB,IAAMF,aAAa,CAAb,EAAgB,CAAhB,EAAqB/oB,OAAS,CAA9B,CAAkC+oB,aAAa,CAAb,EAAgB,CAAhB,CAAlC,CAAuD/oB,OAAS,CAN1E,CAOIkpB,IAAMH,aAAa,CAAb,EAAgB,CAAhB,EAAqBhpB,MAAQ,CAA7B,CAAiCgpB,aAAa,CAAb,EAAgB,CAAhB,CAAjC,CAAsDhpB,MAAQ,CAPxE,CAQIopB,IAAMJ,aAAa,CAAb,EAAgB,CAAhB,EAAqB/oB,OAAS,CAA9B,CAAkC+oB,aAAa,CAAb,EAAgB,CAAhB,CAAlC,CAAuD/oB,OAAS,CAR1E,CASIopB,IAAML,aAAa,CAAb,EAAgB,CAAhB,EAAqBhpB,MAAQ,CAA7B,CAAiCgpB,aAAa,CAAb,EAAgB,CAAhB,CAAjC,CAAsDhpB,MAAQ,CATxE,CAUIspB,IAAMN,aAAa,CAAb,EAAgB,CAAhB,EAAqB/oB,OAAS,CAA9B,CAAkC+oB,aAAa,CAAb,EAAgB,CAAhB,CAAlC,CAAuD/oB,OAAS,CAV1E,CAWIspB,IAAMP,aAAa,CAAb,EAAgB,CAAhB,EAAqBhpB,MAAQ,CAA7B,CAAiCgpB,aAAa,CAAb,EAAgB,CAAhB,CAAjC,CAAsDhpB,MAAQ,CAXxE,CAYIwpB,IAAMR,aAAa,CAAb,EAAgB,CAAhB,EAAqB/oB,OAAS,CAA9B,CAAkC+oB,aAAa,CAAb,EAAgB,CAAhB,CAAlC,CAAuD/oB,OAAS,CAZ1E,CAcA,GAAIwpB,UAAWzpB,MAAQmpB,GAAvB,CACIO,YAAczpB,OAASqpB,GAD3B,CAEIK,YAAc3pB,MAAQqpB,GAF1B,CAGIO,WAAa3pB,OAASupB,GAH1B,CAKA,MAAO,CACHhC,aAAcU,eAAe1mB,CAAf,CAAkBC,CAAlB,CAAqBwnB,GAArB,CAA0BC,GAA1B,EAA+BP,OAA/B,CAAuCkB,SAAvC,CAAiD,GAAjD,CADX,CAEHpC,aAAcS,eAAe1mB,EAAI4X,QAAQ,CAAR,EAAWpZ,KAA9B,CAAqCyB,EAAI2X,QAAQ,CAAR,EAAWpZ,KAApD,CAA2DiF,KAAKuM,GAAL,CAAS,CAAT,CAAYyX,IAAM7P,QAAQ,CAAR,EAAWpZ,KAA7B,CAA3D,CAAgGiF,KAAKuM,GAAL,CAAS,CAAT,CAAY0X,IAAM9P,QAAQ,CAAR,EAAWpZ,KAA7B,CAAhG,EAAqI2oB,OAArI,CAA6IkB,SAA7I,CAAuJ,GAAvJ,CAFX,CAGHnC,cAAeQ,eAAe1mB,EAAIioB,QAAnB,CAA6BhoB,CAA7B,CAAgC0nB,GAAhC,CAAqCC,GAArC,EAA0CP,QAA1C,CAAmDgB,SAAnD,CAA6D,GAA7D,CAHZ,CAIHlC,cAAeO,eAAe1mB,EAAIyD,KAAKiI,GAAL,CAASuc,QAAT,CAAmBzpB,MAAQoZ,QAAQ,CAAR,EAAWpZ,KAAtC,CAAnB,CAAiEyB,EAAI2X,QAAQ,CAAR,EAAWpZ,KAAhF,CAAwFypB,SAAWzpB,MAAQoZ,QAAQ,CAAR,EAAWpZ,KAA/B,CAAwC,CAAxC,CAA2CmpB,IAAM/P,QAAQ,CAAR,EAAWpZ,KAAnJ,CAA0JopB,IAAMhQ,QAAQ,CAAR,EAAWpZ,KAA3K,EAAkL6oB,QAAlL,CAA2LgB,SAA3L,CAAqM,GAArM,CAJZ,CAKHjC,iBAAkBM,eAAe1mB,EAAImoB,WAAnB,CAAgCloB,EAAIioB,WAApC,CAAiDL,GAAjD,CAAsDC,GAAtD,EAA2DR,WAA3D,CAAuEe,SAAvE,CAAiF,GAAjF,CALf,CAMHhC,iBAAkBK,eAAe1mB,EAAIyD,KAAKiI,GAAL,CAASyc,WAAT,CAAsB3pB,MAAQoZ,QAAQ,CAAR,EAAWpZ,KAAzC,CAAnB,CAAoEyB,EAAIwD,KAAKiI,GAAL,CAASwc,WAAT,CAAsBzpB,OAASmZ,QAAQ,CAAR,EAAWpZ,KAA1C,CAAxE,CAA0HiF,KAAKuM,GAAL,CAAS,CAAT,CAAY6X,IAAMjQ,QAAQ,CAAR,EAAWpZ,KAA7B,CAA1H,CAAgKspB,IAAMlQ,QAAQ,CAAR,EAAWpZ,KAAjL,EAAwL8oB,WAAxL,CAAoMe,SAApM,CAA8M,GAA9M,CANf,CAOH/B,gBAAiBI,eAAe1mB,CAAf,CAAkBC,EAAImoB,UAAtB,CAAkCL,GAAlC,CAAuCC,GAAvC,EAA4CT,UAA5C,CAAuDc,SAAvD,CAAiE,GAAjE,CAPd,CAQH9B,gBAAiBG,eAAe1mB,EAAI4X,QAAQ,CAAR,EAAWpZ,KAA9B,CAAqCyB,EAAImoB,UAAzC,CAAqD3kB,KAAKuM,GAAL,CAAS,CAAT,CAAY+X,IAAMnQ,QAAQ,CAAR,EAAWpZ,KAA7B,CAArD,CAA0FwpB,IAAMpQ,QAAQ,CAAR,EAAWpZ,KAA3G,EAAkH+oB,UAAlH,CAA6Hc,SAA7H,CAAuI,GAAvI,CARd,CAAP,CAUH,CAED,QAASjB,YAAT,CAAqBha,KAArB,CAA4Bkb,YAA5B,CAA0CC,UAA1C,CAAsDC,GAAtD,CAA2D,CACvD,GAAIC,MAAO,QAAPA,KAAO,CAAU9mB,CAAV,CAAagJ,CAAb,CAAgBtJ,CAAhB,CAAmB,CAC1B,MAAO,CACHrB,EAAG2B,EAAE3B,CAAF,CAAM,CAAC2K,EAAE3K,CAAF,CAAM2B,EAAE3B,CAAT,EAAcqB,CADpB,CAEHpB,EAAG0B,EAAE1B,CAAF,CAAM,CAAC0K,EAAE1K,CAAF,CAAM0B,EAAE1B,CAAT,EAAcoB,CAFpB,CAAP,CAIH,CALD,CAOA,MAAO,CACH+L,MAAOA,KADJ,CAEHkb,aAAcA,YAFX,CAGHC,WAAYA,UAHT,CAIHC,IAAKA,GAJF,CAKHH,UAAW,mBAAShnB,CAAT,CAAY,CACnB,GAAIqnB,IAAKD,KAAKrb,KAAL,CAAYkb,YAAZ,CAA0BjnB,CAA1B,CAAT,CACIsnB,GAAKF,KAAKH,YAAL,CAAmBC,UAAnB,CAA+BlnB,CAA/B,CADT,CAEIunB,GAAKH,KAAKF,UAAL,CAAiBC,GAAjB,CAAsBnnB,CAAtB,CAFT,CAGIwnB,KAAOJ,KAAKC,EAAL,CAASC,EAAT,CAAatnB,CAAb,CAHX,CAIIynB,KAAOL,KAAKE,EAAL,CAASC,EAAT,CAAavnB,CAAb,CAJX,CAKI0nB,KAAON,KAAKI,IAAL,CAAWC,IAAX,CAAiBznB,CAAjB,CALX,CAMA,MAAO,CAAC+lB,YAAYha,KAAZ,CAAmBsb,EAAnB,CAAuBG,IAAvB,CAA6BE,IAA7B,CAAD,CAAqC3B,YAAY2B,IAAZ,CAAkBD,IAAlB,CAAwBF,EAAxB,CAA4BJ,GAA5B,CAArC,CAAP,CACH,CAbE,CAcHQ,QAAS,iBAASxC,UAAT,CAAqB,CAC1BA,WAAWrhB,IAAX,CAAgB,CAAC,aAAD,CAAgBmjB,aAAatoB,CAA7B,CAAgCsoB,aAAaroB,CAA7C,CAAgDsoB,WAAWvoB,CAA3D,CAA8DuoB,WAAWtoB,CAAzE,CAA4EuoB,IAAIxoB,CAAhF,CAAmFwoB,IAAIvoB,CAAvF,CAAhB,EACH,CAhBE,CAiBHgpB,gBAAiB,yBAASzC,UAAT,CAAqB,CAClCA,WAAWrhB,IAAX,CAAgB,CAAC,aAAD,CAAgBojB,WAAWvoB,CAA3B,CAA8BuoB,WAAWtoB,CAAzC,CAA4CqoB,aAAatoB,CAAzD,CAA4DsoB,aAAaroB,CAAzE,CAA4EmN,MAAMpN,CAAlF,CAAqFoN,MAAMnN,CAA3F,CAAhB,EACH,CAnBE,CAAP,CAqBH,CAED,QAAS0lB,SAAT,CAAkBuD,UAAlB,CAA8BC,OAA9B,CAAuCC,OAAvC,CAAgDC,MAAhD,CAAwDC,MAAxD,CAAgEC,MAAhE,CAAwEC,MAAxE,CAAgF,CAC5E,GAAIhD,YAAa,EAAjB,CAEA,GAAI2C,QAAQ,CAAR,EAAa,CAAb,EAAkBA,QAAQ,CAAR,EAAa,CAAnC,CAAsC,CAClC3C,WAAWrhB,IAAX,CAAgB,CAAC,MAAD,CAASkkB,OAAO,CAAP,EAAUjc,KAAV,CAAgBpN,CAAzB,CAA4BqpB,OAAO,CAAP,EAAUjc,KAAV,CAAgBnN,CAA5C,CAAhB,EACAopB,OAAO,CAAP,EAAUL,OAAV,CAAkBxC,UAAlB,EACH,CAHD,IAGO,CACHA,WAAWrhB,IAAX,CAAgB,CAAE,MAAF,CAAU+jB,WAAWtD,EAAX,CAAc,CAAd,CAAV,CAA4BsD,WAAWtD,EAAX,CAAc,CAAd,CAA5B,CAAhB,EACH,CAED,GAAIwD,QAAQ,CAAR,EAAa,CAAb,EAAkBA,QAAQ,CAAR,EAAa,CAAnC,CAAsC,CAClC5C,WAAWrhB,IAAX,CAAgB,CAAC,MAAD,CAASokB,OAAO,CAAP,EAAUnc,KAAV,CAAgBpN,CAAzB,CAA4BupB,OAAO,CAAP,EAAUnc,KAAV,CAAgBnN,CAA5C,CAAhB,EACAspB,OAAO,CAAP,EAAUP,OAAV,CAAkBxC,UAAlB,EACAA,WAAWrhB,IAAX,CAAgB,CAAC,MAAD,CAASqkB,OAAO,CAAP,EAAUhB,GAAV,CAAcxoB,CAAvB,CAA0BwpB,OAAO,CAAP,EAAUhB,GAAV,CAAcvoB,CAAxC,CAAhB,EACAupB,OAAO,CAAP,EAAUP,eAAV,CAA0BzC,UAA1B,EACH,CALD,IAKO,CACHA,WAAWrhB,IAAX,CAAgB,CAAC,MAAD,CAAS+jB,WAAWrD,EAAX,CAAc,CAAd,CAAT,CAA2BqD,WAAWrD,EAAX,CAAc,CAAd,CAA3B,CAAhB,EACAW,WAAWrhB,IAAX,CAAgB,CAAC,MAAD,CAAS+jB,WAAWpD,EAAX,CAAc,CAAd,CAAT,CAA2BoD,WAAWpD,EAAX,CAAc,CAAd,CAA3B,CAAhB,EACH,CAED,GAAIqD,QAAQ,CAAR,EAAa,CAAb,EAAkBA,QAAQ,CAAR,EAAa,CAAnC,CAAsC,CAClC3C,WAAWrhB,IAAX,CAAgB,CAAC,MAAD,CAASmkB,OAAO,CAAP,EAAUd,GAAV,CAAcxoB,CAAvB,CAA0BspB,OAAO,CAAP,EAAUd,GAAV,CAAcvoB,CAAxC,CAAhB,EACAqpB,OAAO,CAAP,EAAUL,eAAV,CAA0BzC,UAA1B,EACH,CAHD,IAGO,CACHA,WAAWrhB,IAAX,CAAgB,CAAC,MAAD,CAAS+jB,WAAWnD,EAAX,CAAc,CAAd,CAAT,CAA2BmD,WAAWnD,EAAX,CAAc,CAAd,CAA3B,CAAhB,EACH,CAED,MAAOS,WAAP,CACH,CAED,QAASC,YAAT,CAAqBD,UAArB,CAAiC2C,OAAjC,CAA0CC,OAA1C,CAAmDK,OAAnD,CAA4DC,OAA5D,CAAqE1pB,CAArE,CAAwEC,CAAxE,CAA2E,CACvE,GAAIkpB,QAAQ,CAAR,EAAa,CAAb,EAAkBA,QAAQ,CAAR,EAAa,CAAnC,CAAsC,CAClC3C,WAAWrhB,IAAX,CAAgB,CAAC,MAAD,CAASskB,QAAQ,CAAR,EAAWrc,KAAX,CAAiBpN,CAA1B,CAA6BypB,QAAQ,CAAR,EAAWrc,KAAX,CAAiBnN,CAA9C,CAAhB,EACAwpB,QAAQ,CAAR,EAAWT,OAAX,CAAmBxC,UAAnB,EACAiD,QAAQ,CAAR,EAAWT,OAAX,CAAmBxC,UAAnB,EACH,CAJD,IAIO,CACHA,WAAWrhB,IAAX,CAAgB,CAAC,MAAD,CAASnF,CAAT,CAAYC,CAAZ,CAAhB,EACH,CAED,GAAImpB,QAAQ,CAAR,EAAa,CAAb,EAAkBA,QAAQ,CAAR,EAAa,CAAnC,CAAsC,CAClC5C,WAAWrhB,IAAX,CAAgB,CAAC,MAAD,CAASukB,QAAQ,CAAR,EAAWtc,KAAX,CAAiBpN,CAA1B,CAA6B0pB,QAAQ,CAAR,EAAWtc,KAAX,CAAiBnN,CAA9C,CAAhB,EACH,CACJ,CAED,QAASyhB,eAAT,CAAwBvY,SAAxB,CAAmC,CAC/B,MAAOA,WAAUwQ,MAAV,CAAiB,QAAjB,EAA6B,CAApC,CACH,CAED,QAAS0I,eAAT,CAAwBlZ,SAAxB,CAAmC,CAC/B,MAAOA,WAAUwQ,MAAV,CAAiB,QAAjB,EAA6B,CAApC,CACH,CAED,QAAS2G,QAAT,CAAiBnX,SAAjB,CAA4B,CACxB,MAAOA,WAAUwQ,MAAV,CAAiB,QAAjB,IAA+B,CAAtC,CACH,CAED,QAASoI,YAAT,CAAqB5Y,SAArB,CAAgC,CAC5B,MAAO,CAAC,QAAD,CAAW,cAAX,CAA2B,cAA3B,EAA2CoT,OAA3C,CAAmDpT,UAAU4P,GAAV,CAAc,SAAd,CAAnD,IAAiF,CAAC,CAAzF,CACH,CAED,QAASuJ,kBAAT,CAA2BnZ,SAA3B,CAAsC,CAClC,MAAQA,qBAAqBwT,gBAA7B,CACH,CAED,QAASwF,QAAT,CAAiBhZ,SAAjB,CAA4B,CACxB,MAAOA,WAAUhB,IAAV,CAAemK,IAAf,CAAoB6H,IAApB,GAA2BjY,MAA3B,CAAoC,CAA3C,CACH,CAED,QAASqiB,gBAAT,CAAyBpb,SAAzB,CAAoC,CAChC,MAAQ,uBAAsB/B,IAAtB,CAA2B+B,UAAUuO,MAAV,CAAiBqB,GAAjB,CAAqB,eAArB,CAA3B,CAAR,CACH,CAED,QAASmM,oBAAT,CAA6B/b,SAA7B,CAAwC,CACpC,MAAO,CAAC,SAAD,CAAY,UAAZ,CAAwB,aAAxB,CAAuC,YAAvC,EAAqDlF,GAArD,CAAyD,SAASkhB,IAAT,CAAe,CAC3E,GAAIngB,OAAQmE,UAAU4P,GAAV,CAAc,SAAWoM,IAAX,CAAkB,QAAhC,CAAZ,CACA,GAAIwE,KAAM3kB,MAAMR,KAAN,CAAY,GAAZ,CAAV,CACA,GAAImlB,IAAIznB,MAAJ,EAAc,CAAlB,CAAqB,CACjBynB,IAAI,CAAJ,EAASA,IAAI,CAAJ,CAAT,CACH,CACD,MAAOA,KAAI1lB,GAAJ,CAAQ2lB,KAAR,CAAP,CACH,CAPM,CAAP,CAQH,CAED,QAASlK,eAAT,CAAwBvX,IAAxB,CAA8B,CAC1B,MAAQA,MAAK7F,QAAL,GAAkBuW,KAAKC,SAAvB,EAAoC3Q,KAAK7F,QAAL,GAAkBuW,KAAKiG,YAAnE,CACH,CAED,QAASqB,wBAAT,CAAiChX,SAAjC,CAA4C,CACxC,GAAIxK,UAAWwK,UAAU4P,GAAV,CAAc,UAAd,CAAf,CACA,GAAI8Q,QAAU,CAAC,UAAD,CAAa,UAAb,CAAyB,OAAzB,EAAkCtN,OAAlC,CAA0C5d,QAA1C,IAAwD,CAAC,CAA1D,CAA+DwK,UAAU4P,GAAV,CAAc,QAAd,CAA/D,CAAyF,MAAtG,CACA,MAAO8Q,UAAW,MAAlB,CACH,CAED,QAASxJ,aAAT,CAAsBlX,SAAtB,CAAiC,CAC7B,MAAOA,WAAU4P,GAAV,CAAc,UAAd,IAA8B,QAArC,CACH,CAED,QAASyH,WAAT,CAAoBrX,SAApB,CAA+B,CAC3B,MAAOA,WAAU4P,GAAV,CAAc,OAAd,IAA2B,MAAlC,CACH,CAED,QAASwH,cAAT,CAAuBpX,SAAvB,CAAkC,CAC9B,MAAO,CAAC,cAAD,CAAiB,cAAjB,EAAiCoT,OAAjC,CAAyCpT,UAAU4P,GAAV,CAAc,SAAd,CAAzC,IAAuE,CAAC,CAA/E,CACH,CAED,QAAS8I,IAAT,CAAa9M,QAAb,CAAuB,CACnB,GAAI+U,SAAU,IAAd,CACA,MAAO,WAAW,CACd,MAAO,CAAC/U,SAASwB,KAAT,CAAeuT,OAAf,CAAwBtT,SAAxB,CAAR,CACH,CAFD,CAGH,CAED,QAASkH,UAAT,CAAmBvU,SAAnB,CAA8B,CAC1B,MAAOA,WAAUhB,IAAV,CAAe7F,QAAf,GAA4BuW,KAAKiG,YAAxC,CACH,CAED,QAASzG,gBAAT,CAAyBlP,SAAzB,CAAoC,CAChC,MAAOA,WAAUkP,eAAV,GAA8B,IAArC,CACH,CAED,QAASiG,WAAT,CAAoBnV,SAApB,CAA+B,CAC3B,MAAOA,WAAUhB,IAAV,CAAe7F,QAAf,GAA4BuW,KAAKC,SAAxC,CACH,CAED,QAAS4H,WAAT,CAAoBV,QAApB,CAA8B,CAC1B,MAAO,UAASre,CAAT,CAAYgJ,CAAZ,CAAe,CAClB,MAAQhJ,GAAEgY,MAAF,CAAS,QAAT,EAAsBqG,SAASzD,OAAT,CAAiB5a,CAAjB,EAAsBqe,SAAS9d,MAAtD,EAAkEyI,EAAEgP,MAAF,CAAS,QAAT,EAAsBqG,SAASzD,OAAT,CAAiB5R,CAAjB,EAAsBqV,SAAS9d,MAAvH,CAAP,CACH,CAFD,CAGH,CAED,QAASge,WAAT,CAAoB/W,SAApB,CAA+B,CAC3B,MAAOA,WAAUqP,UAAV,GAAyB,CAAhC,CACH,CAED,QAASoR,MAAT,CAAe5kB,KAAf,CAAsB,CAClB,MAAO6G,UAAS7G,KAAT,CAAgB,EAAhB,CAAP,CACH,CAED,QAASie,SAAT,CAAkB3Z,MAAlB,CAA0B,CACtB,MAAOA,QAAO9K,KAAd,CACH,CAED,QAASmhB,kBAAT,CAA2BoK,aAA3B,CAA0C,CACtC,MAAQA,eAAc5hB,IAAd,CAAmB7F,QAAnB,GAAgCuW,KAAKiG,YAArC,EAAqD,CAAC,QAAD,CAAW,MAAX,CAAmB,OAAnB,CAA4B,QAA5B,CAAsC,IAAtC,CAA4C,QAA5C,EAAsDvC,OAAtD,CAA8DwN,cAAc5hB,IAAd,CAAmBO,QAAjF,IAA+F,CAAC,CAA7J,CACH,CAED,QAAS2U,QAAT,CAAiB2M,MAAjB,CAAyB,CACrB,MAAO,GAAG3V,MAAH,CAAUkC,KAAV,CAAgB,EAAhB,CAAoByT,MAApB,CAAP,CACH,CAED,QAAS5K,YAAT,CAAqBF,OAArB,CAA8B,CAC1B,GAAI+K,OAAQ/K,QAAQ1F,MAAR,CAAe,CAAf,CAAkB,CAAlB,CAAZ,CACA,MAAQyQ,SAAU/K,QAAQ1F,MAAR,CAAe0F,QAAQhd,MAAR,CAAiB,CAAhC,CAAV,EAAgD+nB,MAAMre,KAAN,CAAY,KAAZ,CAAjD,CAAuEsT,QAAQ1F,MAAR,CAAe,CAAf,CAAkB0F,QAAQhd,MAAR,CAAiB,CAAnC,CAAvE,CAA+Ggd,OAAtH,CACH,CAED,QAASuF,SAAT,CAAkBL,UAAlB,CAA8B,CAC1B,GAAI8F,OAAQ,EAAZ,CAAgBroB,EAAI,CAApB,CAAuBsoB,eAAiB,KAAxC,CAA+CC,IAA/C,CACA,MAAMhG,WAAWliB,MAAjB,CAAyB,CACrB,GAAImoB,eAAejG,WAAWviB,CAAX,CAAf,IAAkCsoB,cAAtC,CAAsD,CAClDC,KAAOhG,WAAW1d,MAAX,CAAkB,CAAlB,CAAqB7E,CAArB,CAAP,CACA,GAAIuoB,KAAKloB,MAAT,CAAiB,CACbgoB,MAAM/kB,IAAN,CAAW1C,SAAS4hB,IAAT,CAAc1d,MAAd,CAAqByjB,IAArB,CAAX,EACH,CACDD,eAAgB,CAAEA,cAAlB,CACAtoB,EAAI,CAAJ,CACH,CAPD,IAOO,CACHA,IACH,CAED,GAAIA,GAAKuiB,WAAWliB,MAApB,CAA4B,CACxBkoB,KAAOhG,WAAW1d,MAAX,CAAkB,CAAlB,CAAqB7E,CAArB,CAAP,CACA,GAAIuoB,KAAKloB,MAAT,CAAiB,CACbgoB,MAAM/kB,IAAN,CAAW1C,SAAS4hB,IAAT,CAAc1d,MAAd,CAAqByjB,IAArB,CAAX,EACH,CACJ,CACJ,CACD,MAAOF,MAAP,CACH,CAED,QAASG,eAAT,CAAwBC,aAAxB,CAAuC,CACnC,MAAO,CACH,EADG,CACC;AACJ,GAFG,CAEC;AACJ,GAHG,CAGC;AACJ,EAJG,CAIA;AACH,GAAG;AALA,GAML/N,OANK,CAMG+N,aANH,IAMsB,CAAC,CAN9B,CAOH,CAED,QAAS9F,WAAT,CAAoBlgB,MAApB,CAA4B,CACxB,MAAQ,mBAAD,CAAqB8C,IAArB,CAA0B9C,MAA1B,CAAP,CACH,CAEDxD,OAAOD,OAAP,CAAiB6L,UAAjB,CAEC,CAv2BgC,CAu2B/B,CAAC,UAAU,CAAX,CAAa,gBAAgB,CAA7B,CAA+B,QAAQ,EAAvC,CAA0C,kBAAkB,EAA5D,CAA+D,2BAA2B,EAA1F,CAA6F,oBAAoB,EAAjH,CAAoH,kBAAkB,EAAtI,CAAyI,UAAU,EAAnJ,CAAsJ,WAAW,CAAjK,CAv2B+B,CAxxD6wB,CA+nFvoB,GAAG,CAAC,SAASvK,OAAT,CAAiBrB,MAAjB,CAAwBD,OAAxB,CAAgC,CAC3M,GAAI0pB,KAAMpoB,QAAQ,OAAR,CAAV,CACA,GAAIyK,OAAQzK,QAAQ,SAAR,CAAZ,CACA,GAAInE,KAAMmE,QAAQ,OAAR,CAAV,CACA,GAAI0K,mBAAoB1K,QAAQ,SAAR,CAAxB,CACA,GAAIqoB,UAAW5d,MAAM4d,QAArB,CAEA,QAASC,MAAT,CAAe1Z,GAAf,CAAoB2Z,QAApB,CAA8BpiB,QAA9B,CAAwC,CACpC,GAAIqiB,cAAgB,mBAAqB,IAAIC,eAAJ,EAAzC,CACA,GAAI,CAACF,QAAL,CAAe,CACX,MAAOlhB,SAAQsE,MAAR,CAAe,qBAAf,CAAP,CACH,CACD,GAAIiH,UAAW8V,eAAeF,YAAf,CAAf,CACA,GAAIha,KAAMma,eAAeJ,QAAf,CAAyB3Z,GAAzB,CAA8BgE,QAA9B,CAAV,CAEA,MAAO4V,cAAeJ,IAAI5Z,GAAJ,CAAf,CAA2Boa,MAAMziB,QAAN,CAAgBqI,GAAhB,CAAqBoE,QAArB,EAA+B7W,IAA/B,CAAoC,SAAS8sB,QAAT,CAAmB,CACrF,MAAOR,UAASQ,SAAS9L,OAAlB,CAAP,CACH,CAFiC,CAAlC,CAGH,CACD,GAAI+L,YAAa,CAAjB,CAEA,QAASC,SAAT,CAAkBna,GAAlB,CAAuB2Z,QAAvB,CAAiCpiB,QAAjC,CAA2C,CACvC,GAAI6iB,mBAAqB,eAAiB,IAAIja,MAAJ,EAA1C,CACA,GAAI6D,UAAW8V,eAAeM,iBAAf,CAAf,CACA,GAAIxa,KAAMma,eAAeJ,QAAf,CAAyB3Z,GAAzB,CAA8BgE,QAA9B,CAAV,CACA,MAAQoW,mBAAoB3hB,QAAQC,OAAR,CAAgBkH,GAAhB,CAApB,CAA2Coa,MAAMziB,QAAN,CAAgBqI,GAAhB,CAAqBoE,QAArB,EAA+B7W,IAA/B,CAAoC,SAAS8sB,QAAT,CAAmB,CACtG,MAAO,QAAUA,SAASjnB,IAAnB,CAA0B,UAA1B,CAAuCinB,SAAS9L,OAAvD,CACH,CAFkD,CAAnD,CAGH,CAED,QAAS6L,MAAT,CAAeziB,QAAf,CAAyBqI,GAAzB,CAA8BoE,QAA9B,CAAwC,CACpC,MAAO,IAAIvL,QAAJ,CAAY,SAASC,OAAT,CAAkBqE,MAAlB,CAA0B,CACzC,GAAItM,GAAI8G,SAAShK,aAAT,CAAuB,QAAvB,CAAR,CACA,GAAI8sB,SAAU,QAAVA,QAAU,EAAW,CACrB,MAAO3qB,QAAOS,WAAP,CAAmB2M,KAAnB,CAAyBkH,QAAzB,CAAP,CACAzM,SAASxJ,IAAT,CAAc+Q,WAAd,CAA0BrO,CAA1B,EACH,CAHD,CAIAf,OAAOS,WAAP,CAAmB2M,KAAnB,CAAyBkH,QAAzB,EAAqC,SAASiW,QAAT,CAAmB,CACpDI,UACA3hB,QAAQuhB,QAAR,EACH,CAHD,CAIAxpB,EAAEuP,GAAF,CAAQJ,GAAR,CACAnP,EAAE2P,OAAF,CAAY,SAAS/P,CAAT,CAAY,CACpBgqB,UACAtd,OAAO1M,CAAP,EACH,CAHD,CAIAkH,SAASxJ,IAAT,CAAcC,WAAd,CAA0ByC,CAA1B,EACH,CAhBM,CAAP,CAiBH,CAED,QAASqpB,eAAT,CAAwBxV,OAAxB,CAAiC,CAC7B,MAAO,CAACA,OAAD,CAAW,eAAiBhI,KAAKC,GAAL,EAAjB,CAA8B,GAA9B,CAAqC,GAAE2d,UAAvC,CAAqD,GAArD,CAA2DxnB,KAAK4H,KAAL,CAAW5H,KAAK4nB,MAAL,GAAgB,MAA3B,CAAtE,CAA2G,EAAlH,CACH,CAED,QAASP,eAAT,CAAwBJ,QAAxB,CAAkC3Z,GAAlC,CAAuCgE,QAAvC,CAAiD,CAC7C,MAAO2V,UAAW,OAAX,CAAqBY,mBAAmBva,GAAnB,CAArB,EAAgDgE,SAAS7S,MAAT,CAAkB,+BAAiC6S,QAAnD,CAA8D,EAA9G,CAAP,CACH,CAED,QAASwW,iBAAT,CAA0Bxa,GAA1B,CAA+B,CAC3B,MAAO,UAAS9S,IAAT,CAAe,CAClB,GAAIuR,QAAS,GAAIgc,UAAJ,EAAb,CAA8B/tB,GAA9B,CACA,GAAI,CACAA,IAAM+R,OAAOic,eAAP,CAAuBxtB,IAAvB,CAA6B,WAA7B,CAAN,CACH,CAAC,MAAMmD,CAAN,CAAS,CACPpD,IAAI,6DAAJ,EACAP,IAAM6K,SAASojB,cAAT,CAAwBC,kBAAxB,CAA2C,EAA3C,CAAN,CACA,GAAI,CACAluB,IAAI4M,IAAJ,GACA5M,IAAI6M,KAAJ,CAAUrM,IAAV,EACAR,IAAIgN,KAAJ,GACH,CAAC,MAAMmhB,EAAN,CAAU,CACR5tB,IAAI,iFAAJ,EACAP,IAAIqB,IAAJ,CAAS+f,SAAT,CAAqB5gB,IAArB,CAA2B;AAC9B,EACJ,CAED,GAAI0M,GAAIlN,IAAIqR,aAAJ,CAAkB,MAAlB,CAAR,CACA,GAAI,CAACnE,CAAD,EAAM,CAACA,EAAEhK,IAAF,CAAOkrB,IAAlB,CAAwB,CACpB,GAAIlpB,MAAOlF,IAAIa,aAAJ,CAAkB,MAAlB,CAAX,CACAqE,KAAKhC,IAAL,CAAYoQ,GAAZ,CACAtT,IAAIquB,IAAJ,CAASC,YAAT,CAAsBppB,IAAtB,CAA4BlF,IAAIquB,IAAJ,CAASrjB,UAArC,EACH,CAED,MAAOhL,IAAP,CACH,CAzBD,CA0BH,CAED,QAASqP,gBAAT,CAAyBiE,GAAzB,CAA8BlD,KAA9B,CAAqCvF,QAArC,CAA+C9J,KAA/C,CAAsDC,MAAtD,CAA8Df,OAA9D,CAAuE,CACnE,MAAO,IAAI+sB,MAAJ,CAAU1Z,GAAV,CAAelD,KAAf,CAAsBpN,OAAO6H,QAA7B,EAAuCpK,IAAvC,CAA4CqtB,iBAAiBxa,GAAjB,CAA5C,EAAmE7S,IAAnE,CAAwE,SAAST,GAAT,CAAc,CACzF,MAAOoP,mBAAkBpP,GAAlB,CAAuB6K,QAAvB,CAAiC9J,KAAjC,CAAwCC,MAAxC,CAAgDf,OAAhD,CAAyD,CAAzD,CAA4D,CAA5D,CAAP,CACH,CAFM,CAAP,CAGH,CAEDmD,QAAQ4pB,KAAR,CAAgBA,KAAhB,CACA5pB,QAAQqqB,QAAR,CAAmBA,QAAnB,CACArqB,QAAQiM,eAAR,CAA0BA,eAA1B,CAEC,CAjGyK,CAiGxK,CAAC,UAAU,CAAX,CAAa,QAAQ,EAArB,CAAwB,UAAU,EAAlC,CAAqC,QAAQ,EAA7C,CAjGwK,CA/nFooB,CAguF1vB,GAAG,CAAC,SAAS3K,OAAT,CAAiBrB,MAAjB,CAAwBD,OAAxB,CAAgC,CACxF,GAAIqqB,UAAW/oB,QAAQ,SAAR,EAAmB+oB,QAAlC,CAEA,QAASzX,oBAAT,CAA6B1C,GAA7B,CAAkClD,KAAlC,CAAyC,CACrC,GAAI+C,MAAOtI,SAAShK,aAAT,CAAuB,GAAvB,CAAX,CACAsS,KAAKjQ,IAAL,CAAYoQ,GAAZ,CACAA,IAAMH,KAAKjQ,IAAX,CACA,KAAKoQ,GAAL,CAAWA,GAAX,CACA,KAAKE,KAAL,CAAa,GAAIC,MAAJ,EAAb,CACA,GAAIjQ,MAAO,IAAX,CACA,KAAK+P,OAAL,CAAe,GAAIxH,QAAJ,CAAY,SAASC,OAAT,CAAkBqE,MAAlB,CAA0B,CACjD7M,KAAKgQ,KAAL,CAAWuC,WAAX,CAAyB,WAAzB,CACAvS,KAAKgQ,KAAL,CAAWrH,MAAX,CAAoBH,OAApB,CACAxI,KAAKgQ,KAAL,CAAWE,OAAX,CAAqBrD,MAArB,CAEA,GAAIod,SAAJ,CAAana,GAAb,CAAkBlD,KAAlB,CAAyBvF,QAAzB,EAAmCpK,IAAnC,CAAwC,SAASyS,GAAT,CAAc,CAClD1P,KAAKgQ,KAAL,CAAWF,GAAX,CAAiBJ,GAAjB,CACH,CAFD,EAEG,OAFH,EAEY7C,MAFZ,EAGH,CARc,CAAf,CASH,CAEDhN,OAAOD,OAAP,CAAiB4S,mBAAjB,CAEC,CAvBsD,CAuBrD,CAAC,UAAU,EAAX,CAvBqD,CAhuFuvB,CAuvF5xB,GAAG,CAAC,SAAStR,OAAT,CAAiBrB,MAAjB,CAAwBD,OAAxB,CAAgC,CACtD,GAAI8L,eAAgBxK,QAAQ,iBAAR,CAApB,CAEA,QAASua,uBAAT,CAAgCvU,IAAhC,CAAsCuP,MAAtC,CAA8C3T,IAA9C,CAAoD,CAChD4I,cAAc1K,IAAd,CAAmB,IAAnB,CAAyBkG,IAAzB,CAA+BuP,MAA/B,EACA,KAAKW,eAAL,CAAuB,IAAvB,CACA,KAAKe,MAAL,CAAcrV,OAAS,SAAvB,CACH,CAED2Y,uBAAuBxR,SAAvB,CAAiCqN,OAAjC,CAA2C,SAASZ,KAAT,CAAgB,CACvD+E,uBAAuBxR,SAAvB,CAAiCqN,OAAjC,CAAyCtW,IAAzC,CAA8C,IAA9C,CAAoD0V,KAApD,EACAA,MAAMU,eAAN,CAAwB,IAAxB,CACAV,MAAMyB,MAAN,CAAe,KAAKA,MAApB,CACH,CAJD,CAMAsD,uBAAuBxR,SAAvB,CAAmCtN,OAAO4Q,MAAP,CAAc7B,cAAczB,SAA5B,CAAnC,CAEAwR,uBAAuBxR,SAAvB,CAAiC+S,WAAjC,CAA+C,UAAW,CACtD,GAAI,KAAK7E,MAAT,CAAiB,CACb,KAAK1B,MAAL,CAAYvP,IAAZ,CAAiB4jB,YAAjB,CAA8B,KAAK5jB,IAAnC,CAAyC,KAAKuP,MAAL,CAAYvP,IAAZ,CAAiBM,UAA1D,EACH,CAFD,IAEO,CACH,KAAKiP,MAAL,CAAYvP,IAAZ,CAAiBpJ,WAAjB,CAA6B,KAAKoJ,IAAlC,EACH,CACD,KAAKuP,MAAL,CAAYvP,IAAZ,CAAiBiB,SAAjB,EAA8B,IAAM,KAAK4iB,YAAL,EAApC,CACH,CAPD,CASAtP,uBAAuBxR,SAAvB,CAAiCmT,QAAjC,CAA4C,UAAW,CACnD,KAAKlW,IAAL,CAAUyH,UAAV,CAAqBC,WAArB,CAAiC,KAAK1H,IAAtC,EACA,KAAKuP,MAAL,CAAYvP,IAAZ,CAAiBiB,SAAjB,CAA6B,KAAKsO,MAAL,CAAYvP,IAAZ,CAAiBiB,SAAjB,CAA2B3E,OAA3B,CAAmC,KAAKunB,YAAL,EAAnC,CAAwD,EAAxD,CAA7B,CACH,CAHD,CAKAtP,uBAAuBxR,SAAvB,CAAiC8gB,YAAjC,CAAgD,UAAW,CACvD,MAAO,MAAK,8BAAgC,KAAK5S,MAAL,CAAc,QAAd,CAAyB,OAAzD,CAAL,CAAP,CACH,CAFD,CAIAsD,uBAAuBxR,SAAvB,CAAiCwT,gCAAjC,CAAoE,uCAApE,CACAhC,uBAAuBxR,SAAvB,CAAiCyT,+BAAjC,CAAmE,sCAAnE,CAEA7d,OAAOD,OAAP,CAAiB6b,sBAAjB,CAEC,CAxCoB,CAwCnB,CAAC,kBAAkB,EAAnB,CAxCmB,CAvvFyxB,CA+xFpxB,GAAG,CAAC,SAASva,OAAT,CAAiBrB,MAAjB,CAAwBD,OAAxB,CAAgC,CAC9D,GAAI7C,KAAMmE,QAAQ,OAAR,CAAV,CAEA,QAAS8pB,SAAT,CAAkBztB,KAAlB,CAAyBC,MAAzB,CAAiCyV,MAAjC,CAAyCxW,OAAzC,CAAkD4K,QAAlD,CAA4D,CACxD,KAAK9J,KAAL,CAAaA,KAAb,CACA,KAAKC,MAAL,CAAcA,MAAd,CACA,KAAKyV,MAAL,CAAcA,MAAd,CACA,KAAKxW,OAAL,CAAeA,OAAf,CACA,KAAK4K,QAAL,CAAgBA,QAAhB,CACH,CAED2jB,SAAS/gB,SAAT,CAAmBkY,WAAnB,CAAiC,SAASja,SAAT,CAAoBkG,MAApB,CAA4B6Z,UAA5B,CAAwC7F,cAAxC,CAAwD,CACrF,GAAI6I,aAAc/iB,UAAUwQ,MAAV,CAAiB,aAAjB,CAAlB,CACIwS,WAAahjB,UAAUwQ,MAAV,CAAiB,YAAjB,CADjB,CAEIyS,aAAejjB,UAAUwQ,MAAV,CAAiB,cAAjB,CAFnB,CAGI0S,cAAgBljB,UAAUwQ,MAAV,CAAiB,eAAjB,CAHpB,CAII/B,QAAUsR,WAAWtR,OAJzB,CAMA,GAAIpZ,OAAQ6Q,OAAO7Q,KAAP,EAAgBoZ,QAAQ,CAAR,EAAWpZ,KAAX,CAAmBoZ,QAAQ,CAAR,EAAWpZ,KAA9B,CAAsC0tB,WAAtC,CAAoDE,YAApE,CAAZ,CACA,GAAI3tB,QAAS4Q,OAAO5Q,MAAP,EAAiBmZ,QAAQ,CAAR,EAAWpZ,KAAX,CAAmBoZ,QAAQ,CAAR,EAAWpZ,KAA9B,CAAsC2tB,UAAtC,CAAmDE,aAApE,CAAb,CACA,KAAKjc,SAAL,CACIiT,cADJ,CAEI,CAFJ,CAGI,CAHJ,CAIIA,eAAepS,KAAf,CAAqBzS,KAArB,EAA8BA,KAJlC,CAKI6kB,eAAepS,KAAf,CAAqBxS,MAArB,EAA+BA,MALnC,CAMI4Q,OAAOzQ,IAAP,CAAcstB,WAAd,CAA4BtU,QAAQ,CAAR,EAAWpZ,KAN3C,CAOI6Q,OAAOxQ,GAAP,CAAastB,UAAb,CAA0BvU,QAAQ,CAAR,EAAWpZ,KAPzC,CAQIA,KARJ,CASIC,MATJ,EAWH,CApBD,CAsBAwtB,SAAS/gB,SAAT,CAAmB8X,gBAAnB,CAAsC,SAAS7Z,SAAT,CAAoBkG,MAApB,CAA4B6Z,UAA5B,CAAwC,CAC1E,GAAI7Z,OAAO5Q,MAAP,CAAgB,CAAhB,EAAqB4Q,OAAO7Q,KAAP,CAAe,CAAxC,CAA2C,CACvC,KAAK8tB,qBAAL,CAA2BnjB,SAA3B,CAAsCkG,MAAtC,EACA,KAAKkd,qBAAL,CAA2BpjB,SAA3B,CAAsCkG,MAAtC,CAA8C6Z,UAA9C,EACH,CACJ,CALD,CAOA+C,SAAS/gB,SAAT,CAAmBohB,qBAAnB,CAA2C,SAASnjB,SAAT,CAAoBkG,MAApB,CAA4B,CACnE,GAAIjD,OAAQjD,UAAUiD,KAAV,CAAgB,iBAAhB,CAAZ,CACA,GAAI,CAACA,MAAMd,aAAN,EAAL,CAA4B,CACxB,KAAK0R,SAAL,CAAe3N,OAAOzQ,IAAtB,CAA4ByQ,OAAOxQ,GAAnC,CAAwCwQ,OAAO7Q,KAA/C,CAAsD6Q,OAAO5Q,MAA7D,CAAqE2N,KAArE,EACH,CACJ,CALD,CAOA6f,SAAS/gB,SAAT,CAAmBgY,aAAnB,CAAmC,SAAStL,OAAT,CAAkB,CACjDA,QAAQpD,OAAR,CAAgB,KAAKgY,YAArB,CAAmC,IAAnC,EACH,CAFD,CAIAP,SAAS/gB,SAAT,CAAmBshB,YAAnB,CAAkC,SAASla,IAAT,CAAe,CAC7C,GAAI,CAACA,KAAKlG,KAAL,CAAWd,aAAX,EAAD,EAA+BgH,KAAKgC,IAAL,GAAc,IAAjD,CAAuD,CACnD,KAAKmY,SAAL,CAAena,KAAKgC,IAApB,CAA0BhC,KAAKlG,KAA/B,EACH,CACJ,CAJD,CAMA6f,SAAS/gB,SAAT,CAAmBqhB,qBAAnB,CAA2C,SAASpjB,SAAT,CAAoBkG,MAApB,CAA4B6Z,UAA5B,CAAwC,CAC/E,GAAIhR,kBAAmB/O,UAAUyL,qBAAV,EAAvB,CACAsD,iBAAiBvB,OAAjB,GAA2BnC,OAA3B,CAAmC,SAASkY,eAAT,CAA0BpmB,KAA1B,CAAiCqjB,GAAjC,CAAsC,CACrE,OAAO+C,gBAAgBnY,MAAvB,EACA,IAAK,KAAL,CACI,GAAItD,OAAQ,KAAKiD,MAAL,CAAY4B,GAAZ,CAAgB4W,gBAAgBpY,IAAhB,CAAqB,CAArB,CAAhB,CAAZ,CACA,GAAIrD,KAAJ,CAAW,CACP,KAAK0b,yBAAL,CAA+BxjB,SAA/B,CAA0CkG,MAA1C,CAAkD4B,KAAlD,CAAyD0Y,IAAIznB,MAAJ,EAAcoE,MAAM,CAApB,CAAzD,CAAiF4iB,UAAjF,EACH,CAFD,IAEO,CACHlrB,IAAI,gCAAJ,CAAsC0uB,gBAAgBpY,IAAhB,CAAqB,CAArB,CAAtC,EACH,CACD,MACJ,IAAK,iBAAL,CACA,IAAK,UAAL,CACI,GAAIsY,eAAgB,KAAK1Y,MAAL,CAAY4B,GAAZ,CAAgB4W,gBAAgB1nB,KAAhC,CAApB,CACA,GAAI4nB,aAAJ,CAAmB,CACf,KAAKC,wBAAL,CAA8BD,aAA9B,CAA6Cvd,MAA7C,CAAqD6Z,UAArD,EACH,CAFD,IAEO,CACHlrB,IAAI,gCAAJ,CAAsC0uB,gBAAgBpY,IAAhB,CAAqB,CAArB,CAAtC,EACH,CACD,MACJ,IAAK,MAAL,CACI,MACJ,QACItW,IAAI,+BAAJ,CAAqC0uB,gBAAgBpY,IAAhB,CAAqB,CAArB,CAArC,EArBJ,CAuBH,CAxBD,CAwBG,IAxBH,EAyBH,CA3BD,CA6BA2X,SAAS/gB,SAAT,CAAmByhB,yBAAnB,CAA+C,SAASxjB,SAAT,CAAoBkG,MAApB,CAA4BgU,cAA5B,CAA4C/c,KAA5C,CAAmD4iB,UAAnD,CAA+D,CAC1G,GAAI3X,MAAOpI,UAAUkR,mBAAV,CAA8BhL,MAA9B,CAAsCgU,eAAepS,KAArD,CAA4D3K,KAA5D,CAAX,CACA,GAAI3H,UAAWwK,UAAUqR,uBAAV,CAAkCnL,MAAlC,CAA0CgU,eAAepS,KAAzD,CAAgE3K,KAAhE,CAAuEiL,IAAvE,CAAf,CACA,GAAIub,QAAS3jB,UAAUuR,qBAAV,CAAgCpU,KAAhC,CAAb,CACA,OAAQwmB,MAAR,EACA,IAAK,UAAL,CACA,IAAK,kBAAL,CACI,KAAKC,qBAAL,CAA2B1J,cAA3B,CAA2C1kB,QAA3C,CAAqD4S,IAArD,CAA2DlC,MAA3D,CAAmEA,OAAOzQ,IAAP,CAAcsqB,WAAW,CAAX,CAAjF,CAAgG7Z,OAAOxQ,GAAP,CAAaF,SAASE,GAAtB,CAA4BqqB,WAAW,CAAX,CAA5H,CAA2I,KAA3I,CAAkJ3X,KAAK9S,MAAvJ,CAA+JyqB,UAA/J,EACA,MACJ,IAAK,UAAL,CACA,IAAK,kBAAL,CACI,KAAK6D,qBAAL,CAA2B1J,cAA3B,CAA2C1kB,QAA3C,CAAqD4S,IAArD,CAA2DlC,MAA3D,CAAmEA,OAAOzQ,IAAP,CAAcD,SAASC,IAAvB,CAA8BsqB,WAAW,CAAX,CAAjG,CAAgH7Z,OAAOxQ,GAAP,CAAaqqB,WAAW,CAAX,CAA7H,CAA4I3X,KAAK/S,KAAjJ,CAAwJ,KAAxJ,CAA+J0qB,UAA/J,EACA,MACJ,IAAK,WAAL,CACI,KAAK6D,qBAAL,CAA2B1J,cAA3B,CAA2C1kB,QAA3C,CAAqD4S,IAArD,CAA2DlC,MAA3D,CAAmEA,OAAOzQ,IAAP,CAAcD,SAASC,IAAvB,CAA8BsqB,WAAW,CAAX,CAAjG,CAAgH7Z,OAAOxQ,GAAP,CAAaF,SAASE,GAAtB,CAA4BqqB,WAAW,CAAX,CAA5I,CAA2J3X,KAAK/S,KAAhK,CAAuK+S,KAAK9S,MAA5K,CAAoLyqB,UAApL,EACA,MACJ,QACI,KAAK8D,sBAAL,CAA4B3J,cAA5B,CAA4C1kB,QAA5C,CAAsD4S,IAAtD,CAA4D,CAAC1S,IAAKwQ,OAAOxQ,GAAb,CAAkBD,KAAMyQ,OAAOzQ,IAA/B,CAA5D,CAAkGsqB,WAAW,CAAX,CAAlG,CAAiHA,WAAW,CAAX,CAAjH,EACA,MAdJ,CAgBH,CApBD,CAsBApoB,OAAOD,OAAP,CAAiBorB,QAAjB,CAEC,CA9G4B,CA8G3B,CAAC,QAAQ,EAAT,CA9G2B,CA/xFixB,CA64F9xB,GAAG,CAAC,SAAS9pB,OAAT,CAAiBrB,MAAjB,CAAwBD,OAAxB,CAAgC,CACpD,GAAIorB,UAAW9pB,QAAQ,aAAR,CAAf,CACA,GAAIyR,yBAA0BzR,QAAQ,4BAAR,CAA9B,CACA,GAAInE,KAAMmE,QAAQ,QAAR,CAAV,CAEA,QAASqK,eAAT,CAAwBhO,KAAxB,CAA+BC,MAA/B,CAAuC,CACnCwtB,SAAS1V,KAAT,CAAe,IAAf,CAAqBC,SAArB,EACA,KAAKrY,MAAL,CAAc,KAAKT,OAAL,CAAaS,MAAb,EAAuB,KAAKmK,QAAL,CAAchK,aAAd,CAA4B,QAA5B,CAArC,CACA,GAAI,CAAC,KAAKZ,OAAL,CAAaS,MAAlB,CAA0B,CACtB,KAAKA,MAAL,CAAYK,KAAZ,CAAoBA,KAApB,CACA,KAAKL,MAAL,CAAYM,MAAZ,CAAqBA,MAArB,CACH,CACD,KAAKiB,GAAL,CAAW,KAAKvB,MAAL,CAAYwB,UAAZ,CAAuB,IAAvB,CAAX,CACA,KAAKstB,QAAL,CAAgB,KAAK3kB,QAAL,CAAchK,aAAd,CAA4B,QAA5B,EAAsCqB,UAAtC,CAAiD,IAAjD,CAAhB,CACA,KAAKD,GAAL,CAASwtB,YAAT,CAAwB,QAAxB,CACA,KAAKC,SAAL,CAAiB,EAAjB,CACAnvB,IAAI,sCAAJ,CAA4CQ,KAA5C,CAAmD,GAAnD,CAAwDC,MAAxD,EACH,CAED+N,eAAetB,SAAf,CAA2BtN,OAAO4Q,MAAP,CAAcyd,SAAS/gB,SAAvB,CAA3B,CAEAsB,eAAetB,SAAf,CAAyBkiB,YAAzB,CAAwC,SAASC,SAAT,CAAoB,CACxD,KAAK3tB,GAAL,CAAS2tB,SAAT,CAAqB,OAAOA,UAAP,mCAAOA,SAAP,KAAsB,QAAtB,EAAkC,CAAC,CAACA,UAAU/gB,OAA9C,CAAwD+gB,UAAUlhB,QAAV,EAAxD,CAA+EkhB,SAApG,CACA,MAAO,MAAK3tB,GAAZ,CACH,CAHD,CAKA8M,eAAetB,SAAf,CAAyB8R,SAAzB,CAAqC,SAASpe,IAAT,CAAeC,GAAf,CAAoBL,KAApB,CAA2BC,MAA3B,CAAmC2N,KAAnC,CAA0C,CAC3E,KAAKghB,YAAL,CAAkBhhB,KAAlB,EAAyBkhB,QAAzB,CAAkC1uB,IAAlC,CAAwCC,GAAxC,CAA6CL,KAA7C,CAAoDC,MAApD,EACH,CAFD,CAIA+N,eAAetB,SAAf,CAAyB4Y,MAAzB,CAAkC,SAASllB,IAAT,CAAeC,GAAf,CAAoB0S,IAApB,CAA0BnF,KAA1B,CAAiC,CAC/D,KAAKghB,YAAL,CAAkBhhB,KAAlB,EACA,KAAK1M,GAAL,CAAS6tB,SAAT,GACA,KAAK7tB,GAAL,CAAS8tB,GAAT,CAAa5uB,KAAO2S,KAAO,CAA3B,CAA8B1S,IAAM0S,KAAO,CAA3C,CAA8CA,KAAO,CAArD,CAAwD,CAAxD,CAA2D9N,KAAKgqB,EAAL,CAAQ,CAAnE,CAAsE,IAAtE,EACA,KAAK/tB,GAAL,CAASguB,SAAT,GACA,KAAKhuB,GAAL,CAASiuB,IAAT,GACH,CAND,CAQAnhB,eAAetB,SAAf,CAAyB2Y,YAAzB,CAAwC,SAASjlB,IAAT,CAAeC,GAAf,CAAoB0S,IAApB,CAA0BnF,KAA1B,CAAiCwhB,MAAjC,CAAyCC,WAAzC,CAAsD,CAC1F,KAAK/J,MAAL,CAAYllB,IAAZ,CAAkBC,GAAlB,CAAuB0S,IAAvB,CAA6BnF,KAA7B,EACA,KAAK1M,GAAL,CAASouB,WAAT,CAAuBD,YAAY1hB,QAAZ,EAAvB,CACA,KAAKzM,GAAL,CAASkuB,MAAT,GACH,CAJD,CAMAphB,eAAetB,SAAf,CAAyBuhB,SAAzB,CAAqC,SAASsB,KAAT,CAAgB3hB,KAAhB,CAAuB,CACxD,KAAK2hB,KAAL,CAAWA,KAAX,EACA,KAAKX,YAAL,CAAkBhhB,KAAlB,EAAyBuhB,IAAzB,GACH,CAHD,CAKAnhB,eAAetB,SAAf,CAAyB8iB,MAAzB,CAAkC,SAAS3K,cAAT,CAAyB,CACvD,GAAIA,eAAe9P,OAAf,GAA2B,IAA/B,CAAqC,CACjC,KAAK0Z,QAAL,CAAc7c,SAAd,CAAwBiT,eAAepS,KAAvC,CAA8C,CAA9C,CAAiD,CAAjD,EACA,GAAI,CACA,KAAKgc,QAAL,CAAcltB,YAAd,CAA2B,CAA3B,CAA8B,CAA9B,CAAiC,CAAjC,CAAoC,CAApC,EACAsjB,eAAe9P,OAAf,CAAyB,KAAzB,CACH,CAAC,MAAMnS,CAAN,CAAS,CACP,KAAK6rB,QAAL,CAAgB3kB,SAAShK,aAAT,CAAuB,QAAvB,EAAiCqB,UAAjC,CAA4C,IAA5C,CAAhB,CACA0jB,eAAe9P,OAAf,CAAyB,IAAzB,CACH,CACJ,CAED,MAAO8P,gBAAe9P,OAAtB,CACH,CAbD,CAeA/G,eAAetB,SAAf,CAAyBkF,SAAzB,CAAqC,SAASiT,cAAT,CAAyB4K,EAAzB,CAA6BC,EAA7B,CAAiCC,EAAjC,CAAqCC,EAArC,CAAyCC,EAAzC,CAA6CC,EAA7C,CAAiDC,EAAjD,CAAqDC,EAArD,CAAyD,CAC1F,GAAI,CAAC,KAAKR,MAAL,CAAY3K,cAAZ,CAAD,EAAgC,KAAK3lB,OAAL,CAAa8P,UAAjD,CAA6D,CACzD,KAAK9N,GAAL,CAAS0Q,SAAT,CAAmBiT,eAAepS,KAAlC,CAAyCgd,EAAzC,CAA6CC,EAA7C,CAAiDC,EAAjD,CAAqDC,EAArD,CAAyDC,EAAzD,CAA6DC,EAA7D,CAAiEC,EAAjE,CAAqEC,EAArE,EACH,CACJ,CAJD,CAMAhiB,eAAetB,SAAf,CAAyB2M,IAAzB,CAAgC,SAAS4W,MAAT,CAAiB1Z,QAAjB,CAA2B+U,OAA3B,CAAoC,CAChE,KAAKpqB,GAAL,CAASijB,IAAT,GACA8L,OAAO5Z,MAAP,CAAc6Z,UAAd,EAA0Bla,OAA1B,CAAkC,SAASuZ,KAAT,CAAgB,CAC9C,KAAKA,KAAL,CAAWA,KAAX,EAAkBlW,IAAlB,GACH,CAFD,CAEG,IAFH,EAGA9C,SAAS9S,IAAT,CAAc6nB,OAAd,EACA,KAAKpqB,GAAL,CAAS6iB,OAAT,GACH,CAPD,CASA/V,eAAetB,SAAf,CAAyB6iB,KAAzB,CAAiC,SAASA,KAAT,CAAgB,CAC7C,KAAKruB,GAAL,CAAS6tB,SAAT,GACAQ,MAAMvZ,OAAN,CAAc,SAASma,KAAT,CAAgBroB,KAAhB,CAAuB,CACjC,GAAIqoB,MAAM,CAAN,IAAa,MAAjB,CAAyB,CACrB,KAAKjvB,GAAL,CAASkvB,IAAT,CAAcrY,KAAd,CAAoB,KAAK7W,GAAzB,CAA8BivB,MAAMtnB,KAAN,CAAY,CAAZ,CAA9B,EACH,CAFD,IAEO,CACH,KAAK3H,GAAL,CAAU4G,QAAU,CAAX,CAAgB,QAAhB,CAA2BqoB,MAAM,CAAN,EAAW,IAA/C,EAAsDpY,KAAtD,CAA4D,KAAK7W,GAAjE,CAAsEivB,MAAMtnB,KAAN,CAAY,CAAZ,CAAtE,EACH,CACJ,CAND,CAMG,IANH,EAOA,KAAK3H,GAAL,CAASguB,SAAT,GACA,MAAO,MAAKhuB,GAAZ,CACH,CAXD,CAaA8M,eAAetB,SAAf,CAAyB0Y,IAAzB,CAAgC,SAASxX,KAAT,CAAgB1N,KAAhB,CAAuBmwB,OAAvB,CAAgChV,MAAhC,CAAwCtI,IAAxC,CAA8CD,MAA9C,CAAsD,CAClF,KAAK8b,YAAL,CAAkBhhB,KAAlB,EAAyBwX,IAAzB,CAAgC,CAACllB,KAAD,CAAQmwB,OAAR,CAAiBhV,MAAjB,CAAyBtI,IAAzB,CAA+BD,MAA/B,EAAuC1M,IAAvC,CAA4C,GAA5C,EAAiDJ,KAAjD,CAAuD,GAAvD,EAA4D,CAA5D,CAAhC,CACH,CAFD,CAIAgI,eAAetB,SAAf,CAAyByZ,UAAzB,CAAsC,SAASvY,KAAT,CAAgB6O,OAAhB,CAAyBC,OAAzB,CAAkCC,IAAlC,CAAwC,CAC1E,KAAK2T,WAAL,CAAiB,aAAjB,CAAgC1iB,MAAMD,QAAN,EAAhC,EACK2iB,WADL,CACiB,eADjB,CACkC7T,OADlC,EAEK6T,WAFL,CAEiB,eAFjB,CAEkC5T,OAFlC,EAGK4T,WAHL,CAGiB,YAHjB,CAG+B3T,IAH/B,EAIH,CALD,CAOA3O,eAAetB,SAAf,CAAyB0Z,WAAzB,CAAuC,UAAW,CAC9C,KAAKkK,WAAL,CAAiB,aAAjB,CAAgC,eAAhC,EACH,CAFD,CAIAtiB,eAAetB,SAAf,CAAyBwX,UAAzB,CAAsC,SAASpK,OAAT,CAAkB,CACpD,KAAK5Y,GAAL,CAASqvB,WAAT,CAAuBzW,OAAvB,CACH,CAFD,CAIA9L,eAAetB,SAAf,CAAyB0X,YAAzB,CAAwC,SAAShH,SAAT,CAAoB,CACxD,KAAKlc,GAAL,CAASsvB,SAAT,CAAmBpT,UAAU9H,MAAV,CAAiB,CAAjB,CAAnB,CAAwC8H,UAAU9H,MAAV,CAAiB,CAAjB,CAAxC,EACA,KAAKpU,GAAL,CAASkc,SAAT,CAAmBrF,KAAnB,CAAyB,KAAK7W,GAA9B,CAAmCkc,UAAUF,MAA7C,EACA,KAAKhc,GAAL,CAASsvB,SAAT,CAAmB,CAACpT,UAAU9H,MAAV,CAAiB,CAAjB,CAApB,CAAyC,CAAC8H,UAAU9H,MAAV,CAAiB,CAAjB,CAA1C,EACH,CAJD,CAMAtH,eAAetB,SAAf,CAAyB4jB,WAAzB,CAAuC,SAAS5U,QAAT,CAAmBlV,KAAnB,CAA0B,CAC7D,GAAI,KAAKmoB,SAAL,CAAejT,QAAf,IAA6BlV,KAAjC,CAAwC,CACpC,KAAKmoB,SAAL,CAAejT,QAAf,EAA2B,KAAKxa,GAAL,CAASwa,QAAT,EAAqBlV,KAAhD,CACH,CAED,MAAO,KAAP,CACH,CAND,CAQAwH,eAAetB,SAAf,CAAyBmR,IAAzB,CAAgC,SAASA,IAAT,CAAezd,IAAf,CAAqBU,MAArB,CAA6B,CACzD,KAAKI,GAAL,CAASuvB,QAAT,CAAkB5S,IAAlB,CAAwBzd,IAAxB,CAA8BU,MAA9B,EACH,CAFD,CAIAkN,eAAetB,SAAf,CAAyB6hB,qBAAzB,CAAiD,SAAS1J,cAAT,CAAyB6L,kBAAzB,CAA6C3d,IAA7C,CAAmDlC,MAAnD,CAA2DzQ,IAA3D,CAAiEC,GAAjE,CAAsEL,KAAtE,CAA6EC,MAA7E,CAAqFyqB,UAArF,CAAiG,CAC9I,GAAI6E,OAAQ,CACR,CAAC,MAAD,CAAStqB,KAAK4H,KAAL,CAAWzM,IAAX,CAAT,CAA2B6E,KAAK4H,KAAL,CAAWxM,GAAX,CAA3B,CADQ,CAER,CAAC,MAAD,CAAS4E,KAAK4H,KAAL,CAAWzM,KAAOJ,KAAlB,CAAT,CAAmCiF,KAAK4H,KAAL,CAAWxM,GAAX,CAAnC,CAFQ,CAGR,CAAC,MAAD,CAAS4E,KAAK4H,KAAL,CAAWzM,KAAOJ,KAAlB,CAAT,CAAmCiF,KAAK4H,KAAL,CAAW5M,OAASI,GAApB,CAAnC,CAHQ,CAIR,CAAC,MAAD,CAAS4E,KAAK4H,KAAL,CAAWzM,IAAX,CAAT,CAA2B6E,KAAK4H,KAAL,CAAW5M,OAASI,GAApB,CAA3B,CAJQ,CAAZ,CAMA,KAAKgZ,IAAL,CAAU,CAACkW,KAAD,CAAV,CAAmB,UAAW,CAC1B,KAAKf,sBAAL,CAA4B3J,cAA5B,CAA4C6L,kBAA5C,CAAgE3d,IAAhE,CAAsElC,MAAtE,CAA8E6Z,WAAW,CAAX,CAA9E,CAA6FA,WAAW,CAAX,CAA7F,EACH,CAFD,CAEG,IAFH,EAGH,CAVD,CAYA1c,eAAetB,SAAf,CAAyB8hB,sBAAzB,CAAkD,SAAS3J,cAAT,CAAyB6L,kBAAzB,CAA6C3d,IAA7C,CAAmDlC,MAAnD,CAA2D8f,UAA3D,CAAuEC,SAAvE,CAAkF,CAChI,GAAInU,SAAUxX,KAAK4H,KAAL,CAAWgE,OAAOzQ,IAAP,CAAcswB,mBAAmBtwB,IAAjC,CAAwCuwB,UAAnD,CAAd,CAA8EjU,QAAUzX,KAAK4H,KAAL,CAAWgE,OAAOxQ,GAAP,CAAaqwB,mBAAmBrwB,GAAhC,CAAsCuwB,SAAjD,CAAxF,CACA,KAAKhC,YAAL,CAAkB,KAAK1tB,GAAL,CAAS2vB,aAAT,CAAuB,KAAKC,WAAL,CAAiBjM,cAAjB,CAAiC9R,IAAjC,CAAvB,CAA+D,QAA/D,CAAlB,EACA,KAAK7R,GAAL,CAASsvB,SAAT,CAAmB/T,OAAnB,CAA4BC,OAA5B,EACA,KAAKxb,GAAL,CAASiuB,IAAT,GACA,KAAKjuB,GAAL,CAASsvB,SAAT,CAAmB,CAAC/T,OAApB,CAA6B,CAACC,OAA9B,EACH,CAND,CAQA1O,eAAetB,SAAf,CAAyB2hB,wBAAzB,CAAoD,SAASD,aAAT,CAAwBvd,MAAxB,CAAgC,CAChF,GAAIud,wBAAyBhZ,wBAA7B,CAAsD,CAClD,GAAI2b,UAAW,KAAK7vB,GAAL,CAAS8vB,oBAAT,CACXngB,OAAOzQ,IAAP,CAAcyQ,OAAO7Q,KAAP,CAAeouB,cAAc7Z,EADhC,CAEX1D,OAAOxQ,GAAP,CAAawQ,OAAO5Q,MAAP,CAAgBmuB,cAAc5Z,EAFhC,CAGX3D,OAAOzQ,IAAP,CAAeyQ,OAAO7Q,KAAP,CAAeouB,cAAc7c,EAHjC,CAIXV,OAAOxQ,GAAP,CAAcwQ,OAAO5Q,MAAP,CAAgBmuB,cAAc1c,EAJjC,CAAf,CAKA0c,cAAc9Z,UAAd,CAAyB0B,OAAzB,CAAiC,SAASuC,SAAT,CAAoB,CACjDwY,SAASE,YAAT,CAAsB1Y,UAAUG,IAAhC,CAAsCH,UAAU3K,KAAV,CAAgBD,QAAhB,EAAtC,EACH,CAFD,EAGA,KAAK6Q,SAAL,CAAe3N,OAAOzQ,IAAtB,CAA4ByQ,OAAOxQ,GAAnC,CAAwCwQ,OAAO7Q,KAA/C,CAAsD6Q,OAAO5Q,MAA7D,CAAqE8wB,QAArE,EACH,CACJ,CAZD,CAcA/iB,eAAetB,SAAf,CAAyBokB,WAAzB,CAAuC,SAASjM,cAAT,CAAyB9R,IAAzB,CAA+B,CAClE,GAAIN,OAAQoS,eAAepS,KAA3B,CACA,GAAGA,MAAMzS,KAAN,GAAgB+S,KAAK/S,KAArB,EAA8ByS,MAAMxS,MAAN,GAAiB8S,KAAK9S,MAAvD,CAA+D,CAC3D,MAAOwS,MAAP,CACH,CAED,GAAIvR,IAAJ,CAASvB,OAASmK,SAAShK,aAAT,CAAuB,QAAvB,CAAlB,CACAH,OAAOK,KAAP,CAAe+S,KAAK/S,KAApB,CACAL,OAAOM,MAAP,CAAgB8S,KAAK9S,MAArB,CACAiB,IAAMvB,OAAOwB,UAAP,CAAkB,IAAlB,CAAN,CACAD,IAAI0Q,SAAJ,CAAca,KAAd,CAAqB,CAArB,CAAwB,CAAxB,CAA2BA,MAAMzS,KAAjC,CAAwCyS,MAAMxS,MAA9C,CAAsD,CAAtD,CAAyD,CAAzD,CAA4D8S,KAAK/S,KAAjE,CAAwE+S,KAAK9S,MAA7E,EACA,MAAON,OAAP,CACH,CAZD,CAcA,QAASuwB,WAAT,CAAoBxqB,KAApB,CAA2B,CACvB,MAAOA,OAAMhC,MAAN,CAAe,CAAtB,CACH,CAEDpB,OAAOD,OAAP,CAAiB2L,cAAjB,CAEC,CAvLkB,CAuLjB,CAAC,6BAA6B,EAA9B,CAAiC,SAAS,EAA1C,CAA6C,cAAc,EAA3D,CAvLiB,CA74F2xB,CAokG5uB,GAAG,CAAC,SAASrK,OAAT,CAAiBrB,MAAjB,CAAwBD,OAAxB,CAAgC,CACtG,GAAI8L,eAAgBxK,QAAQ,iBAAR,CAApB,CAEA,QAASwa,gBAAT,CAAyBkD,cAAzB,CAAyCvH,OAAzC,CAAkDsE,OAAlD,CAA2DlF,MAA3D,CAAmE,CAC/D/K,cAAc1K,IAAd,CAAmB,IAAnB,CAAyB2a,OAAzB,CAAkClF,MAAlC,EACA,KAAKgY,WAAL,CAAmB7P,cAAnB,CACA,KAAKG,QAAL,CAAgB,EAAhB,CACA,KAAKrH,QAAL,CAAgB,EAAhB,CACA,KAAKL,OAAL,CAAe,CAAC,KAAKZ,MAAL,CAAc,KAAKA,MAAL,CAAYC,KAAZ,CAAkBW,OAAhC,CAA0C,CAA3C,EAAgDA,OAA/D,CACH,CAEDqE,gBAAgBzR,SAAhB,CAA4BtN,OAAO4Q,MAAP,CAAc7B,cAAczB,SAA5B,CAA5B,CAEAyR,gBAAgBzR,SAAhB,CAA0B6U,cAA1B,CAA2C,SAAS+J,OAAT,CAAkB,CACzD,GAAIhK,aAAe,KAAKpI,MAAN,CAAgB,KAAKA,MAAL,CAAYC,KAA5B,CAAoC,IAAtD,CACA,MAAOmI,aAAeA,YAAY4P,WAAZ,CAA0B5P,WAA1B,CAAwCA,YAAYC,cAAZ,CAA2B+J,OAA3B,CAAvD,CAA8FA,QAAQnS,KAA7G,CACH,CAHD,CAKA7W,OAAOD,OAAP,CAAiB8b,eAAjB,CAEC,CApBoE,CAoBnE,CAAC,kBAAkB,EAAnB,CApBmE,CApkGyuB,CAwlGpxB,GAAG,CAAC,SAASxa,OAAT,CAAiBrB,MAAjB,CAAwBD,OAAxB,CAAgC,CAC9D,QAAS0L,QAAT,CAAiBjE,QAAjB,CAA2B,CACvB,KAAKuY,WAAL,CAAmB,KAAK8O,eAAL,CAAqBrnB,QAArB,CAAnB,CACA,KAAKgL,IAAL,CAAY,KAAKsc,QAAL,EAAZ,CACA,KAAKza,GAAL,CAAW,KAAK0a,OAAL,EAAX,CACH,CAEDtjB,QAAQrB,SAAR,CAAkBykB,eAAlB,CAAoC,SAASrnB,QAAT,CAAmB,CACnD,GAAIuU,MAAJ,CAAWiT,WAAX,CAAwBjP,WAAxB,CAAqCkP,WAArC,CAAkD5gB,QAAU,KAA5D,CAEA,GAAI7G,SAAS8Y,WAAb,CAA0B,CACtBvE,MAAQvU,SAAS8Y,WAAT,EAAR,CACA,GAAIvE,MAAM0E,qBAAV,CAAiC,CAC7BuO,YAAcxnB,SAAShK,aAAT,CAAuB,WAAvB,CAAd,CACAwxB,YAAYpxB,KAAZ,CAAkBD,MAAlB,CAA2B,OAA3B,CACAqxB,YAAYpxB,KAAZ,CAAkBygB,OAAlB,CAA4B,OAA5B,CACA7W,SAASxJ,IAAT,CAAcC,WAAd,CAA0B+wB,WAA1B,EAEAjT,MAAMmT,UAAN,CAAiBF,WAAjB,EACAjP,YAAchE,MAAM0E,qBAAN,EAAd,CACAwO,YAAclP,YAAYpiB,MAA1B,CAEA,GAAIsxB,cAAgB,GAApB,CAAyB,CACrB5gB,QAAU,IAAV,CACH,CACD7G,SAASxJ,IAAT,CAAc+Q,WAAd,CAA0BigB,WAA1B,EACH,CACJ,CAED,MAAO3gB,QAAP,CACH,CAvBD,CAyBA5C,QAAQrB,SAAR,CAAkB0kB,QAAlB,CAA6B,UAAW,CACpC,MAAO,OAAQ,IAAI1e,MAAJ,EAAD,CAAcsC,WAArB,GAAsC,WAA7C,CACH,CAFD,CAIAjH,QAAQrB,SAAR,CAAkB2kB,OAAlB,CAA4B,UAAW,CACnC,GAAIre,KAAM,GAAIN,MAAJ,EAAV,CACA,GAAI/S,QAASmK,SAAShK,aAAT,CAAuB,QAAvB,CAAb,CACA,GAAIoB,KAAOvB,OAAOwB,UAAP,CAAkB,IAAlB,CAAX,CACA6R,IAAIT,GAAJ,CAAU,mEAAV,CAEA,GAAI,CACArR,IAAI0Q,SAAJ,CAAcoB,GAAd,CAAmB,CAAnB,CAAsB,CAAtB,EACArT,OAAOqC,SAAP,GACH,CAAC,MAAMY,CAAN,CAAS,CACP,MAAO,MAAP,CACH,CACD,MAAO,KAAP,CACH,CAbD,CAeAN,OAAOD,OAAP,CAAiB0L,OAAjB,CAEC,CArD4B,CAqD3B,EArD2B,CAxlGixB,CA6oGxyB,GAAG,CAAC,SAASpK,OAAT,CAAiBrB,MAAjB,CAAwBD,OAAxB,CAAgC,CAC1C,GAAI0pB,KAAMpoB,QAAQ,OAAR,CAAV,CACA,GAAIqoB,UAAWroB,QAAQ,SAAR,EAAmBqoB,QAAlC,CAEA,QAAS9W,aAAT,CAAsB3C,GAAtB,CAA2B,CACvB,KAAKA,GAAL,CAAWA,GAAX,CACA,KAAKE,KAAL,CAAa,IAAb,CACA,GAAIhQ,MAAO,IAAX,CAEA,KAAK+P,OAAL,CAAe,KAAKif,SAAL,GAAiB/xB,IAAjB,CAAsB,UAAW,CAC5C,MAAQ+C,MAAKqU,QAAL,CAAcvE,GAAd,EAAqBvH,QAAQC,OAAR,CAAgBxI,KAAKivB,gBAAL,CAAsBnf,GAAtB,CAAhB,CAArB,CAAmEwZ,IAAIxZ,GAAJ,CAA3E,CACH,CAFc,EAEZ7S,IAFY,CAEP,SAASiX,GAAT,CAAc,CAClB,MAAO,IAAI3L,QAAJ,CAAY,SAASC,OAAT,CAAkB,CACjChJ,OAAOS,WAAP,CAAmBiU,GAAnB,CAAuBgb,MAAvB,CAA8BC,iBAA9B,CAAgDjb,GAAhD,CAAqDlU,KAAKovB,YAAL,CAAkBpuB,IAAlB,CAAuBhB,IAAvB,CAA6BwI,OAA7B,CAArD,EACH,CAFM,CAAP,CAGH,CANc,CAAf,CAOH,CAEDiK,aAAaxI,SAAb,CAAuB+kB,SAAvB,CAAmC,UAAW,CAC1C,MAAO,CAACxvB,OAAOS,WAAP,CAAmBiU,GAApB,EAA2B,CAAC1U,OAAOS,WAAP,CAAmBiU,GAAnB,CAAuBgb,MAAnD,CAA4D3mB,QAAQsE,MAAR,CAAe,GAAIhM,MAAJ,CAAU,qDAAV,CAAf,CAA5D,CAA+I0H,QAAQC,OAAR,EAAtJ,CACH,CAFD,CAIAiK,aAAaxI,SAAb,CAAuBglB,gBAAvB,CAA0C,SAASnf,GAAT,CAAc,CACpD,MAAQ,iCAAgC3J,IAAhC,CAAqC2J,GAArC,CAAD,CAA8C,KAAKyZ,QAAL,CAAc,KAAK8F,iBAAL,CAAuBvf,GAAvB,CAAd,CAA9C,CAA2F,KAAKuf,iBAAL,CAAuBvf,GAAvB,CAAlG,CACH,CAFD,CAIA2C,aAAaxI,SAAb,CAAuBolB,iBAAvB,CAA2C,SAASvf,GAAT,CAAc,CACrD,MAAOA,KAAItM,OAAJ,CAAY,kCAAZ,CAA+C,EAA/C,CAAP,CACH,CAFD,CAIAiP,aAAaxI,SAAb,CAAuBoK,QAAvB,CAAkC,SAASvE,GAAT,CAAc,CAC5C,MAAQ,0BAAyB3J,IAAzB,CAA8B2J,GAA9B,CAAR,CACH,CAFD,CAIA2C,aAAaxI,SAAb,CAAuBmlB,YAAvB,CAAsC,SAAS5mB,OAAT,CAAkB,CACpD,GAAIxI,MAAO,IAAX,CACA,MAAO,UAAUsvB,OAAV,CAAmB7yB,OAAnB,CAA4B,CAC/B,GAAIS,QAAS,GAAIsC,QAAOS,WAAP,CAAmBiU,GAAnB,CAAuBgb,MAAvB,CAA8BK,YAAlC,CAA+C,GAA/C,CAAb,CACAvvB,KAAKgQ,KAAL,CAAa9S,OAAOsyB,aAApB,CACAtyB,OACKuyB,QADL,CACchzB,QAAQc,KADtB,EAEKmyB,SAFL,CAEejzB,QAAQe,MAFvB,EAGKmyB,GAHL,CAGSnwB,OAAOS,WAAP,CAAmBiU,GAAnB,CAAuBgb,MAAvB,CAA8BU,IAA9B,CAAmCC,gBAAnC,CAAoDP,OAApD,CAA6D7yB,OAA7D,CAHT,EAIKqzB,SAJL,GAKAtnB,QAAQtL,OAAOsyB,aAAf,EACH,CATD,CAUH,CAZD,CAcA/c,aAAaxI,SAAb,CAAuBsf,QAAvB,CAAkC,SAAShO,GAAT,CAAc,CAC5C,MAAQ,OAAO/b,QAAOuwB,IAAd,GAAwB,UAAzB,CAAuCvwB,OAAOuwB,IAAP,CAAYxU,GAAZ,CAAvC,CAA0DgO,SAAShO,GAAT,CAAjE,CACH,CAFD,CAIA1b,OAAOD,OAAP,CAAiB6S,YAAjB,CAEC,CAtDQ,CAsDP,CAAC,UAAU,EAAX,CAAc,QAAQ,EAAtB,CAtDO,CA7oGqyB,CAmsGjxB,GAAG,CAAC,SAASvR,OAAT,CAAiBrB,MAAjB,CAAwBD,OAAxB,CAAgC,CACjE,GAAI6S,cAAevR,QAAQ,gBAAR,CAAnB,CAEA,QAASwR,iBAAT,CAA0BxL,IAA1B,CAAgC8oB,OAAhC,CAAyC,CACrC,KAAKlgB,GAAL,CAAW5I,IAAX,CACA,KAAK8I,KAAL,CAAa,IAAb,CACA,GAAIhQ,MAAO,IAAX,CAEA,KAAK+P,OAAL,CAAeigB,QAAU,GAAIznB,QAAJ,CAAY,SAASC,OAAT,CAAkBqE,MAAlB,CAA0B,CAC3D7M,KAAKgQ,KAAL,CAAa,GAAIC,MAAJ,EAAb,CACAjQ,KAAKgQ,KAAL,CAAWrH,MAAX,CAAoBH,OAApB,CACAxI,KAAKgQ,KAAL,CAAWE,OAAX,CAAqBrD,MAArB,CACA7M,KAAKgQ,KAAL,CAAWF,GAAX,CAAiB,sBAAyB,GAAImgB,cAAJ,EAAD,CAAsBC,iBAAtB,CAAwChpB,IAAxC,CAAzC,CACA,GAAIlH,KAAKgQ,KAAL,CAAWG,QAAX,GAAwB,IAA5B,CAAkC,CAC9B3H,QAAQxI,KAAKgQ,KAAb,EACH,CACJ,CARwB,CAAV,CAQV,KAAKgf,SAAL,GAAiB/xB,IAAjB,CAAsB,UAAW,CAClC,MAAO,IAAIsL,QAAJ,CAAY,SAASC,OAAT,CAAkB,CACjChJ,OAAOS,WAAP,CAAmBiU,GAAnB,CAAuBgb,MAAvB,CAA8BiB,gBAA9B,CAA+CjpB,IAA/C,CAAqDlH,KAAKovB,YAAL,CAAkBpuB,IAAlB,CAAuBhB,IAAvB,CAA6BwI,OAA7B,CAArD,EACH,CAFM,CAAP,CAGH,CAJI,CARL,CAaH,CAEDkK,iBAAiBzI,SAAjB,CAA6BtN,OAAO4Q,MAAP,CAAckF,aAAaxI,SAA3B,CAA7B,CAEApK,OAAOD,OAAP,CAAiB8S,gBAAjB,CAEC,CA3B+B,CA2B9B,CAAC,iBAAiB,EAAlB,CA3B8B,CAnsG8wB,CA8tGrxB,GAAG,CAAC,SAASxR,OAAT,CAAiBrB,MAAjB,CAAwBD,OAAxB,CAAgC,CAC7D,GAAI8L,eAAgBxK,QAAQ,iBAAR,CAApB,CAEA,QAASsa,cAAT,CAAuBtU,IAAvB,CAA6BuP,MAA7B,CAAqC,CACjC/K,cAAc1K,IAAd,CAAmB,IAAnB,CAAyBkG,IAAzB,CAA+BuP,MAA/B,EACH,CAED+E,cAAcvR,SAAd,CAA0BtN,OAAO4Q,MAAP,CAAc7B,cAAczB,SAA5B,CAA1B,CAEAuR,cAAcvR,SAAd,CAAwBiZ,kBAAxB,CAA6C,UAAW,CACpD,KAAKhc,IAAL,CAAUmK,IAAV,CAAiB,KAAKsJ,SAAL,CAAe,KAAKlE,MAAL,CAAYqB,GAAZ,CAAgB,eAAhB,CAAf,CAAjB,CACH,CAFD,CAIA0D,cAAcvR,SAAd,CAAwB0Q,SAAxB,CAAoC,SAASA,SAAT,CAAoB,CACpD,GAAIS,MAAO,KAAKlU,IAAL,CAAUmK,IAArB,CACA,OAAOsJ,SAAP,EACI,IAAK,WAAL,CACI,MAAOS,MAAK/U,WAAL,EAAP,CACJ,IAAK,YAAL,CACI,MAAO+U,MAAK5X,OAAL,CAAa,0BAAb,CAAyC4sB,UAAzC,CAAP,CACJ,IAAK,WAAL,CACI,MAAOhV,MAAK5C,WAAL,EAAP,CACJ,QACI,MAAO4C,KAAP,CARR,CAUH,CAZD,CAcA,QAASgV,WAAT,CAAoBvqB,CAApB,CAAuBwqB,EAAvB,CAA2BC,EAA3B,CAA+B,CAC3B,GAAIzqB,EAAE5E,MAAF,CAAW,CAAf,CAAkB,CACd,MAAOovB,IAAKC,GAAG9X,WAAH,EAAZ,CACH,CACJ,CAED3Y,OAAOD,OAAP,CAAiB4b,aAAjB,CAEC,CAnC2B,CAmC1B,CAAC,kBAAkB,EAAnB,CAnC0B,CA9tGkxB,CAiwGpxB,GAAG,CAAC,SAASta,OAAT,CAAiBrB,MAAjB,CAAwBD,OAAxB,CAAgC,CAC9DA,QAAQgQ,UAAR,CAAqB,QAASA,WAAT,EAAsB,CACvC,MAAO,gFAAP,CACH,CAFD,CAIAhQ,QAAQpB,IAAR,CAAe,SAASsV,QAAT,CAAmB+U,OAAnB,CAA4B,CACvC,MAAO,WAAW,CACd,MAAO/U,UAASwB,KAAT,CAAeuT,OAAf,CAAwBtT,SAAxB,CAAP,CACH,CAFD,CAGH,CAJD,CAMA;;;;;;IAQA3V,QAAQ2pB,QAAR,CAAmB,SAASgH,MAAT,CAAiB,CAChC,GAAIC,OAAQ,kEAAZ,CACA,GAAIC,KAAMF,OAAOtvB,MAAjB,CAAyBL,CAAzB,CAA4B8vB,QAA5B,CAAsCC,QAAtC,CAAgDC,QAAhD,CAA0DC,QAA1D,CAAoEC,KAApE,CAA2EC,KAA3E,CAAkFC,KAAlF,CAEA,GAAIntB,QAAS,EAAb,CAEA,IAAKjD,EAAI,CAAT,CAAYA,EAAI6vB,GAAhB,CAAqB7vB,GAAG,CAAxB,CAA2B,CACvB8vB,SAAWF,MAAMlV,OAAN,CAAciV,OAAO3vB,CAAP,CAAd,CAAX,CACA+vB,SAAWH,MAAMlV,OAAN,CAAciV,OAAO3vB,EAAE,CAAT,CAAd,CAAX,CACAgwB,SAAWJ,MAAMlV,OAAN,CAAciV,OAAO3vB,EAAE,CAAT,CAAd,CAAX,CACAiwB,SAAWL,MAAMlV,OAAN,CAAciV,OAAO3vB,EAAE,CAAT,CAAd,CAAX,CAEAkwB,MAASJ,UAAY,CAAb,CAAmBC,UAAY,CAAvC,CACAI,MAAS,CAACJ,SAAW,EAAZ,GAAmB,CAApB,CAA0BC,UAAY,CAA9C,CACAI,MAAS,CAACJ,SAAW,CAAZ,GAAkB,CAAnB,CAAwBC,QAAhC,CACA,GAAID,WAAa,EAAjB,CAAqB,CACjB/sB,QAAUnB,OAAOC,YAAP,CAAoBmuB,KAApB,CAAV,CACH,CAFD,IAEO,IAAID,WAAa,EAAb,EAAmBA,WAAa,CAAC,CAArC,CAAwC,CAC3ChtB,QAAUnB,OAAOC,YAAP,CAAoBmuB,KAApB,CAA2BC,KAA3B,CAAV,CACH,CAFM,IAED,CACFltB,QAAUnB,OAAOC,YAAP,CAAoBmuB,KAApB,CAA2BC,KAA3B,CAAkCC,KAAlC,CAAV,CACH,CACJ,CAED,MAAOntB,OAAP,CACH,CAzBD,CA2BAjE,QAAQkM,SAAR,CAAoB,SAAS5E,IAAT,CAAe,CAC/B,GAAIA,KAAKoZ,qBAAT,CAAgC,CAC5B,GAAI2Q,YAAa/pB,KAAKoZ,qBAAL,EAAjB,CACA,GAAI/iB,OAAQ2J,KAAKmI,WAAL,EAAoB,IAApB,CAA2B4hB,WAAW1zB,KAAtC,CAA8C2J,KAAKmI,WAA/D,CACA,MAAO,CACHzR,IAAKqzB,WAAWrzB,GADb,CAEHS,OAAQ4yB,WAAW5yB,MAAX,EAAsB4yB,WAAWrzB,GAAX,CAAiBqzB,WAAWzzB,MAFvD,CAGHY,MAAO6yB,WAAWtzB,IAAX,CAAkBJ,KAHtB,CAIHI,KAAMszB,WAAWtzB,IAJd,CAKHJ,MAAQA,KALL,CAMHC,OAAQ0J,KAAKsI,YAAL,EAAqB,IAArB,CAA4ByhB,WAAWzzB,MAAvC,CAAgD0J,KAAKsI,YAN1D,CAAP,CAQH,CACD,MAAO,EAAP,CACH,CAdD,CAgBA5P,QAAQ4W,YAAR,CAAuB,SAAStP,IAAT,CAAe,CAClC,GAAIuP,QAASvP,KAAKgqB,YAAL,CAAoBtxB,QAAQ4W,YAAR,CAAqBtP,KAAKgqB,YAA1B,CAApB,CAA8D,CAACtzB,IAAK,CAAN,CAASD,KAAM,CAAf,CAA3E,CAEA,MAAO,CACHC,IAAKsJ,KAAK+J,SAAL,CAAiBwF,OAAO7Y,GAD1B,CAEHS,OAAQ6I,KAAK+J,SAAL,CAAiB/J,KAAKsI,YAAtB,CAAqCiH,OAAO7Y,GAFjD,CAGHQ,MAAO8I,KAAKiqB,UAAL,CAAkB1a,OAAO9Y,IAAzB,CAAgCuJ,KAAKmI,WAHzC,CAIH1R,KAAMuJ,KAAKiqB,UAAL,CAAkB1a,OAAO9Y,IAJ5B,CAKHJ,MAAO2J,KAAKmI,WALT,CAMH7R,OAAQ0J,KAAKsI,YANV,CAAP,CAQH,CAXD,CAaA5P,QAAQ2W,gBAAR,CAA2B,SAASkV,eAAT,CAA0B,CACjD,GAAI2F,YAAa,SAAjB,CACI9d,MADJ,CACY+d,UADZ,CACwB/Y,MADxB,CACgCgZ,QADhC,CAC0CC,KAD1C,CACiD3X,QAAU,EAD3D,CAEI4X,KAAO,CAFX,CAEcC,SAAW,CAFzB,CAE4BC,KAF5B,CAEmCre,IAFnC,CAGA,GAAIse,cAAe,QAAfA,aAAe,EAAW,CAC1B,GAAGre,MAAH,CAAW,CACP,GAAI+d,WAAW9Y,MAAX,CAAkB,CAAlB,CAAqB,CAArB,IAA4B,GAAhC,CAAqC,CACjC8Y,WAAaA,WAAW9Y,MAAX,CAAkB,CAAlB,CAAqB8Y,WAAWpwB,MAAX,CAAoB,CAAzC,CAAb,CACH,CACD,GAAIowB,UAAJ,CAAgB,CACZhe,KAAKnP,IAAL,CAAUmtB,UAAV,EACH,CACD,GAAI/d,OAAOiF,MAAP,CAAc,CAAd,CAAiB,CAAjB,IAAwB,GAAxB,EAA+B,CAAC+Y,SAAWhe,OAAOgI,OAAP,CAAe,GAAf,CAAoB,CAApB,EAA0B,CAAtC,EAA2C,CAA9E,CAAiF,CAC7EhD,OAAShF,OAAOiF,MAAP,CAAc,CAAd,CAAiB+Y,QAAjB,CAAT,CACAhe,OAASA,OAAOiF,MAAP,CAAc+Y,QAAd,CAAT,CACH,CACD1X,QAAQ1V,IAAR,CAAa,CACToU,OAAQA,MADC,CAEThF,OAAQA,OAAOjN,WAAP,EAFC,CAGTtC,MAAOwtB,KAHE,CAITle,KAAMA,IAJG,CAKTrD,MAAO,IALE,CAAb,EAOH,CACDqD,KAAO,EAAP,CACAC,OAASgF,OAAS+Y,WAAaE,MAAQ,EAAvC,CACH,CAtBD,CAuBAle,KAAO,EAAP,CACAC,OAASgF,OAAS+Y,WAAaE,MAAQ,EAAvC,CACA9F,gBAAgBloB,KAAhB,CAAsB,EAAtB,EAA0BgQ,OAA1B,CAAkC,SAASqe,CAAT,CAAY,CAC1C,GAAIJ,OAAS,CAAT,EAAcJ,WAAW9V,OAAX,CAAmBsW,CAAnB,EAAwB,CAAC,CAA3C,CAA8C,CAC1C,OACH,CACD,OAAOA,CAAP,EACA,IAAK,GAAL,CACI,GAAG,CAACF,KAAJ,CAAW,CACPA,MAAQE,CAAR,CACH,CAFD,IAEO,IAAGF,QAAUE,CAAb,CAAgB,CACnBF,MAAQ,IAAR,CACH,CACD,MACJ,IAAK,GAAL,CACI,GAAGA,KAAH,CAAU,CACN,MACH,CAFD,IAEO,IAAGF,OAAS,CAAZ,CAAe,CAClBA,KAAO,CAAP,CACAD,OAASK,CAAT,CACA,OACH,CAJM,IAIA,CACHH,WACH,CACD,MACJ,IAAK,GAAL,CACI,GAAIC,KAAJ,CAAW,CACP,MACH,CAFD,IAEO,IAAGF,OAAS,CAAZ,CAAe,CAClB,GAAGC,WAAa,CAAhB,CAAmB,CACfD,KAAO,CAAP,CACAD,OAASK,CAAT,CACAD,eACA,OACH,CALD,IAKO,CACHF,WACH,CACJ,CACD,MAEJ,IAAK,GAAL,CACI,GAAIC,KAAJ,CAAW,CACP,MACH,CAFD,IAEO,IAAGF,OAAS,CAAZ,CAAe,CAClBG,eACA,OACH,CAHM,IAGA,IAAIH,OAAS,CAAb,CAAgB,CACnB,GAAIC,WAAa,CAAb,EAAkB,CAACne,OAAO3I,KAAP,CAAa,QAAb,CAAvB,CAA+C,CAC3C0I,KAAKnP,IAAL,CAAUmtB,UAAV,EACAA,WAAa,EAAb,CACAE,OAASK,CAAT,CACA,OACH,CACJ,CACD,MAhDJ,CAmDAL,OAASK,CAAT,CACA,GAAIJ,OAAS,CAAb,CAAgB,CACZle,QAAUse,CAAV,CACH,CAFD,IAEO,CACHP,YAAcO,CAAd,CACH,CACJ,CA7DD,EA+DAD,eACA,MAAO/X,QAAP,CACH,CA9FD,CAgGC,CA3K4B,CA2K3B,EA3K2B,CAjwGixB,CA46GxyB,GAAG,CAAC,SAAS1Y,OAAT,CAAiBrB,MAAjB,CAAwBD,OAAxB,CAAgC,CAC1C,GAAI+R,mBAAoBzQ,QAAQ,qBAAR,CAAxB,CAEA,QAAS0R,wBAAT,CAAiChB,SAAjC,CAA4C,CACxCD,kBAAkB2D,KAAlB,CAAwB,IAAxB,CAA8BC,SAA9B,EACA,KAAKzS,IAAL,CAAY8O,UAAUyB,IAAV,CAAe,CAAf,IAAsB,QAAtB,CAAiC1B,kBAAkBK,KAAlB,CAAwBC,MAAzD,CAAkEN,kBAAkBK,KAAlB,CAAwBE,MAAtG,CACH,CAEDU,wBAAwB3I,SAAxB,CAAoCtN,OAAO4Q,MAAP,CAAcoE,kBAAkB1H,SAAhC,CAApC,CAEApK,OAAOD,OAAP,CAAiBgT,uBAAjB,CAEC,CAZQ,CAYP,CAAC,sBAAsB,CAAvB,CAZO,CA56GqyB,CAw7GjxB,GAAG,CAAC,SAAS1R,OAAT,CAAiBrB,MAAjB,CAAwBD,OAAxB,CAAgC,CACjE,QAAS0pB,IAAT,CAAa5Z,GAAb,CAAkB,CACd,MAAO,IAAInH,QAAJ,CAAY,SAASC,OAAT,CAAkBqE,MAAlB,CAA0B,CACzC,GAAIglB,KAAM,GAAIlI,eAAJ,EAAV,CACAkI,IAAIzoB,IAAJ,CAAS,KAAT,CAAgBsG,GAAhB,EAEAmiB,IAAIlpB,MAAJ,CAAa,UAAW,CACpB,GAAIkpB,IAAIC,MAAJ,GAAe,GAAnB,CAAwB,CACpBtpB,QAAQqpB,IAAIE,YAAZ,EACH,CAFD,IAEO,CACHllB,OAAO,GAAIhM,MAAJ,CAAUgxB,IAAIG,UAAd,CAAP,EACH,CACJ,CAND,CAQAH,IAAI3hB,OAAJ,CAAc,UAAW,CACrBrD,OAAO,GAAIhM,MAAJ,CAAU,eAAV,CAAP,EACH,CAFD,CAIAgxB,IAAII,IAAJ,GACH,CAjBM,CAAP,CAkBH,CAEDpyB,OAAOD,OAAP,CAAiB0pB,GAAjB,CAEC,CAxB+B,CAwB9B,EAxB8B,CAx7G8wB,CAA3b,CAg9G5W,EAh9G4W,CAg9GzW,CAAC,CAAD,CAh9GyW,EAg9GpW,CAh9GoW,CAAP,CAi9G3W,CAj9GD,E;;;;;;;;;;;;;;;;;ACPA;;;;KAIqB4I,U;;;;;;;;AACnB;;;;+BAIU;AACR,cAAO,EAAP;AACD;;AAED;;;;;;;+BAIU;AACR,cAAO,KAAKr1B,UAAZ;AACD;;AAED;;;;;;;;yBAKImmB,O,EAAkB;AAAA;;AACpB,WAAI,CAAC,KAAKmP,OAAL,EAAL,EAAqB;AACnB;AACD;;AAHmB,yCAAN9e,IAAM;AAANA,aAAM;AAAA;;AAKpB,4BAAQtW,GAAR,kBAAe,KAAKq1B,OAAL,EAAf,UAAkCpP,OAAlC,SAAgD3P,IAAhD;AACD;;;;;;mBA5BkB6e,U;;;;;;;;;;;;;;;ACJrB;;;;AACA;;;;;;;;;;;;AAEA;;;;KAIqBG,W;;;AACnB;;;;;AAKA,wBAAY71B,GAAZ,EAAiBU,MAAjB,EAA2C;AAAA,SAAlBo1B,SAAkB,yDAAN,IAAM;;AAAA;;AAAA;;AAGzC,WAAK51B,SAAL,GAAiBF,GAAjB;AACA,WAAKW,OAAL,GAAeD,MAAf;AACA,WAAKq1B,MAAL,GAAcr1B,OAAOK,KAArB;AACA,WAAKi1B,OAAL,GAAet1B,OAAOM,MAAtB;AACA,WAAKi1B,IAAL,GAAYv1B,OAAOwB,UAAP,CAAkB,IAAlB,CAAZ;AACA,WAAK7B,UAAL,GAAkBy1B,SAAlB;;AAEA,SAAMt1B,OAAO,MAAKN,SAAL,CAAemB,IAAf,CAAoB8Q,UAAjC;;AAEA,WAAK+jB,QAAL,GAAgB11B,KAAKiU,SAArB;AACA,WAAK0hB,SAAL,GAAiB31B,KAAKm0B,UAAtB;;AAEA,WAAKyB,MAAL,GAAc,KAAd,CAfyC,CAepB;AACrB,WAAKC,MAAL,GAAc,IAAd,CAhByC,CAgBpB;AACrB,WAAKC,SAAL,GAAiB,KAAjB,CAjByC,CAiBjB;AACxB,WAAKC,SAAL,GAAiB,CAAjB,CAlByC,CAkBrB;AACpB,WAAKC,SAAL,GAAiB,CAAjB;;AAEA,WAAKj2B,GAAL,CAAS,aAAT;;AAEA,WAAKk2B,SAAL;AACA,WAAKC,WAAL;;AAEA,WAAKC,SAAL,GAAiB,EAAjB;AACAtqB,iBAAY,YAAM;AAChB,aAAKuqB,IAAL;AACD,MAFD,EAEG,MAAKD,SAFR;AA3ByC;AA8B1C;;AAED;;;;;;;;+BAIU;AACR,cAAO,aAAP;AACD;;AAED;;;;;;;mCAIc;AAAA;;AAAA,WACJh2B,OADI,GACQ,IADR,CACJA,OADI;AAEZ;;AACAA,eAAQk2B,gBAAR,CAAyB,aAAzB,EAAwC,UAAClzB,CAAD,EAAO;AAC7CA,WAAEmzB,cAAF;AACA,gBAAO,KAAP;AACD,QAHD,EAGG,KAHH;;AAKA;AACAn2B,eAAQk2B,gBAAR,CAAyB,WAAzB,EAAsC,UAAClzB,CAAD,EAAO;AAAA,aACnC0yB,MADmC,UACnCA,MADmC;;AAE3C,aAAMU,QAAQ,OAAKC,QAAL,CAAcrzB,CAAd,CAAd;AACA,aAAMszB,KAAKF,MAAMx0B,CAAjB;AACA,aAAM20B,KAAKH,MAAMv0B,CAAjB;AACA,gBAAK4zB,MAAL,GAAc,KAAd;AACA,aAAIC,OAAOc,QAAP,CAAgBF,EAAhB,EAAoBC,EAApB,CAAJ,EAA6B;AAC3B,kBAAKX,SAAL,GAAiBU,KAAKZ,OAAOe,EAA7B;AACA,kBAAKZ,SAAL,GAAiBU,KAAKb,OAAOgB,EAA7B;AACA,kBAAKf,SAAL,GAAiB,IAAjB;;AAEA,kBAAK/1B,GAAL,CAAS,oCAAT,EAA+C02B,EAA/C,EAAmDC,EAAnD;AACD;;AAED,gBAAKI,cAAL,GAAsB,OAAKjB,MAAL,CAAYkB,uBAAZ,CAAoCR,MAAMx0B,CAA1C,EAA6Cw0B,MAAMv0B,CAAnD,CAAtB;AACD,QAfD,EAeG,IAfH;;AAiBA7B,eAAQk2B,gBAAR,CAAyB,WAAzB,EAAsC,UAAClzB,CAAD,EAAO;AAAA,aACnC0yB,MADmC,UACnCA,MADmC;;AAE3C,aAAMU,QAAQ,OAAKC,QAAL,CAAcrzB,CAAd,CAAd;AACA,aAAM6zB,OAAOnB,OAAOe,EAApB;AACA,aAAMK,OAAOpB,OAAOgB,EAApB;AACA,aAAMJ,KAAKF,MAAMx0B,CAAjB;AACA,aAAM20B,KAAKH,MAAMv0B,CAAjB;AACA,aAAMk1B,cAAcrB,OAAOkB,uBAAP,CAA+BN,EAA/B,EAAmCC,EAAnC,CAApB;AACA,iBAAQQ,WAAR;AACE,gBAAK,CAAL;AACE/2B,qBAAQM,KAAR,CAAc02B,MAAd,GAAuB,WAAvB;AACA;AACF,gBAAK,CAAL;AACEh3B,qBAAQM,KAAR,CAAc02B,MAAd,GAAuB,UAAvB;AACA;AACF,gBAAK,CAAL;AACEh3B,qBAAQM,KAAR,CAAc02B,MAAd,GAAuB,WAAvB;AACA;AACF,gBAAK,CAAL;AACEh3B,qBAAQM,KAAR,CAAc02B,MAAd,GAAuB,UAAvB;AACA;AACF,gBAAK,CAAL;AACEh3B,qBAAQM,KAAR,CAAc02B,MAAd,GAAuB,UAAvB;AACA;AACF,gBAAK,CAAL;AACEh3B,qBAAQM,KAAR,CAAc02B,MAAd,GAAuB,WAAvB;AACA;AACF,gBAAK,CAAL;AACEh3B,qBAAQM,KAAR,CAAc02B,MAAd,GAAuB,UAAvB;AACA;AACF,gBAAK,CAAL;AACEh3B,qBAAQM,KAAR,CAAc02B,MAAd,GAAuB,WAAvB;AACA;AACF;AACEh3B,qBAAQM,KAAR,CAAc02B,MAAd,GAAuB,MAAvB;AA1BJ;;AA6BA,aAAI,OAAKL,cAAL,KAAwB,KAA5B,EAAmC;AACjC;AACA,mBAAQ,OAAKA,cAAb;AACE,kBAAK,CAAL;AACEjB,sBAAOe,EAAP,GAAYH,EAAZ;AACAZ,sBAAOgB,EAAP,GAAYH,EAAZ;AACAb,sBAAOuB,EAAP,IAAaJ,OAAOP,EAApB;AACAZ,sBAAOwB,EAAP,IAAaJ,OAAOP,EAApB;AACA;AACF,kBAAK,CAAL;AACEb,sBAAOgB,EAAP,GAAYH,EAAZ;AACAb,sBAAOwB,EAAP,IAAaJ,OAAOP,EAApB;AACA;AACF,kBAAK,CAAL;AACEb,sBAAOgB,EAAP,GAAYH,EAAZ;AACAb,sBAAOuB,EAAP,GAAYX,KAAKO,IAAjB;AACAnB,sBAAOwB,EAAP,IAAaJ,OAAOP,EAApB;AACA;AACF,kBAAK,CAAL;AACEb,sBAAOe,EAAP,GAAYH,EAAZ;AACAZ,sBAAOuB,EAAP,IAAaJ,OAAOP,EAApB;AACA;AACF,kBAAK,CAAL;AACEZ,sBAAOuB,EAAP,GAAYX,KAAKO,IAAjB;AACA;AACF,kBAAK,CAAL;AACEnB,sBAAOe,EAAP,GAAYH,EAAZ;AACAZ,sBAAOuB,EAAP,IAAaJ,OAAOP,EAApB;AACAZ,sBAAOwB,EAAP,GAAYX,KAAKO,IAAjB;AACA;AACF,kBAAK,CAAL;AACEpB,sBAAOwB,EAAP,GAAYX,KAAKO,IAAjB;AACA;AACF,kBAAK,CAAL;AACEpB,sBAAOuB,EAAP,GAAYX,KAAKO,IAAjB;AACAnB,sBAAOwB,EAAP,GAAYX,KAAKO,IAAjB;AACA;AACF;AACE;AApCJ;AAsCA,kBAAKrB,MAAL,GAAc,KAAd;AACD,UAzCD,MAyCO,IAAI,OAAKE,SAAT,EAAoB;AACzB;AACA;AACA,kBAAKD,MAAL,CAAYe,EAAZ,GAAiBL,MAAMx0B,CAAN,GAAU,OAAKg0B,SAAhC;AACA,kBAAKF,MAAL,CAAYgB,EAAZ,GAAiBN,MAAMv0B,CAAN,GAAU,OAAKg0B,SAAhC;AACA,kBAAKJ,MAAL,GAAc,KAAd,CALyB,CAKJ;;AAErB;AACD;AACF,QAvFD,EAuFG,IAvFH;;AAyFAz1B,eAAQk2B,gBAAR,CAAyB,SAAzB,EAAoC,YAAM;AACxC,gBAAKP,SAAL,GAAiB,KAAjB;AACA,gBAAKgB,cAAL,GAAsB,KAAtB;AACA,gBAAK/2B,GAAL,CAAS,mBAAT;AACD,QAJD;;AAMA,YAAKA,GAAL,CAAS,oBAAT;AACD;;AAED;;;;;;;iCAIY;AACV,YAAK81B,MAAL,GAAc,mBACZ,KAAKN,MAAL,GAAc,CADF,EAEZ,KAAKC,OAAL,GAAe,CAFH,EAGZ,KAAKD,MAAL,GAAc,CAHF,EAIZ,KAAKC,OAAL,GAAe,CAJH,EAKZ,sBALY,CAAd;AAOA,YAAKI,MAAL,GAAc,KAAd;AACD;;AAED;;;;;;;oCAIe;AAAA,qBACc,KAAKC,MADnB;AAAA,WACLe,EADK,WACLA,EADK;AAAA,WACDC,EADC,WACDA,EADC;AAAA,WACGO,EADH,WACGA,EADH;AAAA,WACOC,EADP,WACOA,EADP;;AAEb,cAAO,EAAEt1B,GAAG60B,EAAL,EAAS50B,GAAG60B,EAAZ,EAAgB50B,GAAGm1B,EAAnB,EAAuBl1B,GAAGm1B,EAA1B,EAAP;AACD;;AAED;;;;;;6BAGQ;AACN,YAAK5B,IAAL,CAAU6B,SAAV,CAAoB,CAApB,EAAuB,CAAvB,EAA0B,KAAK/B,MAA/B,EAAuC,KAAKC,OAA5C;AACD;;AAED;;;;;;;4BAIO;AACL;AACA,WAAI,CAAC,KAAKI,MAAV,EAAkB;AAAA,aACRH,IADQ,GACS,IADT,CACRA,IADQ;AAAA,aACFI,MADE,GACS,IADT,CACFA,MADE;;AAEhB,cAAK0B,KAAL;;AAEA;AACA9B,cAAKrG,SAAL,GAAiB,gBAAjB;AACAqG,cAAKnG,SAAL;AACAmG,cAAK9E,IAAL,CAAUkF,OAAOe,EAAjB,EAAqBf,OAAOgB,EAA5B,EAAgChB,OAAOuB,EAAvC,EAA2CvB,OAAOwB,EAAlD;AACA5B,cAAK9E,IAAL,CAAU,KAAK4E,MAAf,EAAuB,CAAvB,EAA0B,CAAC,KAAKA,MAAhC,EAAwC,KAAKC,OAA7C;AACAC,cAAK/F,IAAL;;AAEA;AACAmG,gBAAOO,IAAP,CAAYX,IAAZ;;AAEA,cAAKG,MAAL,GAAc,IAAd;;AAEA,cAAK71B,GAAL,CAAS,YAAT,EAAuB81B,OAAOe,EAA9B,EAAkCf,OAAOgB,EAAzC,EAA6ChB,OAAOuB,EAApD,EAAwDvB,OAAOwB,EAA/D;AACD;AACF;;AAED;;;;;;;;;8BAMSl0B,C,EAAG;AACV,WAAIq0B,KAAK,KAAKr3B,OAAd;AACA,WAAI6c,UAAU,CAAd;AACA,WAAIC,UAAU,CAAd;;AAEA;AACA,WAAIua,GAAGtD,YAAH,KAAoBhkB,SAAxB,EAAmC;AACjC,YAAG;AACD8M,sBAAWwa,GAAGrD,UAAd;AACAlX,sBAAWua,GAAGvjB,SAAd;AACAujB,gBAAKA,GAAGtD,YAAR;AACD,UAJD,QAISsD,EAJT;AAKD;;AAED;AACAxa,kBAAW,KAAK2Y,SAAhB;AACA1Y,kBAAW,KAAKyY,QAAhB;;AAEA,WAAMe,KAAKtzB,EAAEs0B,KAAF,GAAUza,OAArB;AACA,WAAM0Z,KAAKvzB,EAAEu0B,KAAF,GAAUza,OAArB;;AAEA,cAAO,EAAElb,GAAG00B,EAAL,EAASz0B,GAAG00B,EAAZ,EAAP;AACD;;;;;;mBAnQkBrB,W;;;;;;;;;;;;;;;ACPrB;;;;;;;;;;;;AAEA;;;;KAIqBsC,I;;;AACnB;;;;;;;;AAQA,iBAAY51B,CAAZ,EAAeC,CAAf,EAAkBC,CAAlB,EAAqBC,CAArB,EAAwBwtB,IAAxB,EAAgD;AAAA,SAAlB4F,SAAkB,yDAAN,IAAM;;AAAA;;AAAA;;AAG9C,WAAKsC,iBAAL,GAAyB,EAAzB;AACA,WAAKC,iBAAL,GAAyB,CAAzB;AACA,UAAK,IAAIj0B,IAAI,CAAb,EAAgBA,IAAI,CAApB,EAAuBA,KAAK,CAA5B,EAA+B;AAC7B,aAAKg0B,iBAAL,CAAuB1wB,IAAvB,CAA4B,EAAEnF,GAAG,CAAL,EAAQC,GAAG,CAAX,EAA5B;AACD;;AAED,WAAK40B,EAAL,GAAU70B,KAAK,CAAf;AACA,WAAK80B,EAAL,GAAU70B,KAAK,CAAf;AACA,WAAKo1B,EAAL,GAAUn1B,KAAK,CAAf;AACA,WAAKo1B,EAAL,GAAUn1B,KAAK,CAAf;AACA,WAAK41B,KAAL,GAAapI,QAAQ,SAArB;AACA,WAAK7vB,UAAL,GAAkBy1B,SAAlB;;AAEA,WAAKv1B,GAAL,CAAS,aAAT;AAhB8C;AAiB/C;;AAED;;;;;;;;+BAIU;AACR,cAAO,MAAP;AACD;;AAED;;;;;;;0BAIK0B,G,EAAK;AAAA,WACAm1B,EADA,GACgE,IADhE,CACAA,EADA;AAAA,WACIC,EADJ,GACgE,IADhE,CACIA,EADJ;AAAA,WACQO,EADR,GACgE,IADhE,CACQA,EADR;AAAA,WACYC,EADZ,GACgE,IADhE,CACYA,EADZ;AAAA,WACgBS,KADhB,GACgE,IADhE,CACgBA,KADhB;AAAA,WACuBF,iBADvB,GACgE,IADhE,CACuBA,iBADvB;AAAA,WAC0CC,iBAD1C,GACgE,IADhE,CAC0CA,iBAD1C;;AAERp2B,WAAI2tB,SAAJ,GAAgB0I,KAAhB,CAFQ,CAEe;AACvBr2B,WAAIouB,WAAJ,GAAkB,OAAlB,CAHQ,CAGmB;AAC3BpuB,WAAI0S,SAAJ,GAAgB,CAAhB,CAJQ,CAIW;AACnB1S,WAAIs2B,WAAJ,CAAgB,CAAC,CAAD,EAAI,CAAJ,CAAhB;AACAt2B,WAAIu2B,UAAJ,CAAepB,EAAf,EAAmBC,EAAnB,EAAuBO,EAAvB,EAA2BC,EAA3B;;AAEA,WAAMY,OAAOJ,oBAAoB,CAAjC;;AAEA;AACAD,yBAAkB,CAAlB,EAAqB71B,CAArB,GAAyB60B,KAAKqB,IAA9B;AACAL,yBAAkB,CAAlB,EAAqB51B,CAArB,GAAyB60B,KAAKoB,IAA9B;;AAEAL,yBAAkB,CAAlB,EAAqB71B,CAArB,GAAyB60B,KAAKQ,KAAK,CAAV,GAAca,IAAvC;AACAL,yBAAkB,CAAlB,EAAqB51B,CAArB,GAAyB60B,KAAKoB,IAA9B;;AAEAL,yBAAkB,CAAlB,EAAqB71B,CAArB,GAAyB60B,KAAKQ,EAAL,GAAUa,IAAnC;AACAL,yBAAkB,CAAlB,EAAqB51B,CAArB,GAAyB60B,KAAKoB,IAA9B;;AAEA;AACAL,yBAAkB,CAAlB,EAAqB71B,CAArB,GAAyB60B,KAAKqB,IAA9B;AACAL,yBAAkB,CAAlB,EAAqB51B,CAArB,GAAyB60B,KAAKQ,KAAK,CAAV,GAAcY,IAAvC;;AAEA;AACAL,yBAAkB,CAAlB,EAAqB71B,CAArB,GAAyB60B,KAAKQ,EAAL,GAAUa,IAAnC;AACAL,yBAAkB,CAAlB,EAAqB51B,CAArB,GAAyB60B,KAAKQ,KAAK,CAAV,GAAcY,IAAvC;;AAEA;AACAL,yBAAkB,CAAlB,EAAqB71B,CAArB,GAAyB60B,KAAKQ,KAAK,CAAV,GAAca,IAAvC;AACAL,yBAAkB,CAAlB,EAAqB51B,CAArB,GAAyB60B,KAAKQ,EAAL,GAAUY,IAAnC;;AAEAL,yBAAkB,CAAlB,EAAqB71B,CAArB,GAAyB60B,KAAKqB,IAA9B;AACAL,yBAAkB,CAAlB,EAAqB51B,CAArB,GAAyB60B,KAAKQ,EAAL,GAAUY,IAAnC;;AAEAL,yBAAkB,CAAlB,EAAqB71B,CAArB,GAAyB60B,KAAKQ,EAAL,GAAUa,IAAnC;AACAL,yBAAkB,CAAlB,EAAqB51B,CAArB,GAAyB60B,KAAKQ,EAAL,GAAUY,IAAnC;;AAEA,YAAKl4B,GAAL,CAAS,yBAAT;AACA0B,WAAI2tB,SAAJ,GAAgB,OAAhB,CAvCQ,CAuCiB;AACzBwI,yBAAkBrhB,OAAlB,CAA0B,UAAC2hB,GAAD,EAAS;AACjCz2B,aAAI4tB,QAAJ,CAAa6I,IAAIn2B,CAAjB,EAAoBm2B,IAAIl2B,CAAxB,EAA2B61B,iBAA3B,EAA8CA,iBAA9C;AACD,QAFD;;AAIA,YAAK93B,GAAL,CAAS,uBAAT,EAAkC62B,EAAlC,EAAsCC,EAAtC,EAA0CO,EAA1C,EAA8CC,EAA9C;AACD;;AAED;;;;;;;;;8BAMSZ,E,EAAIC,E,EAAI;AAAA,WACPE,EADO,GACY,IADZ,CACPA,EADO;AAAA,WACHC,EADG,GACY,IADZ,CACHA,EADG;AAAA,WACCO,EADD,GACY,IADZ,CACCA,EADD;AAAA,WACKC,EADL,GACY,IADZ,CACKA,EADL;;AAEf,cAAQT,MAAMH,EAAP,IAAeG,KAAKQ,EAAL,IAAWX,EAA1B,IACJI,MAAMH,EADF,IACUG,KAAKQ,EAAL,IAAWX,EAD5B;AAED;;AAED;;;;;;;;;6CAMwBD,E,EAAIC,E,EAAI;AAAA,WACtBkB,iBADsB,GACmB,IADnB,CACtBA,iBADsB;AAAA,WACHC,iBADG,GACmB,IADnB,CACHA,iBADG;;AAE9B,YAAK,IAAIj0B,IAAI,CAAb,EAAgBA,IAAIg0B,kBAAkB3zB,MAAtC,EAA8CL,KAAK,CAAnD,EAAsD;AACpD,aAAMu0B,SAASP,kBAAkBh0B,CAAlB,CAAf;AACA,aACGu0B,OAAOp2B,CAAP,IAAY00B,EAAb,IACC0B,OAAOp2B,CAAP,GAAW81B,iBAAX,IAAgCpB,EADjC,IAEC0B,OAAOn2B,CAAP,IAAY00B,EAFb,IAGCyB,OAAOn2B,CAAP,GAAW61B,iBAAX,IAAgCnB,EAJnC,EAKE;AACA,kBAAO9yB,CAAP;AACD;AACF;;AAED,cAAO,KAAP;AACD;;;;;;mBAxHkB+zB,I","file":"HtmlCrop.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine(\"HtmlCrop\", [], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"HtmlCrop\"] = factory();\n\telse\n\t\troot[\"HtmlCrop\"] = factory();\n})(this, function() {\nreturn \n\n\n/** WEBPACK FOOTER **\n ** webpack/universalModuleDefinition\n **/"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n/** WEBPACK FOOTER **\n ** webpack/bootstrap 2efb3a34e4b7a3b13b7a\n **/","import html2canvas from 'html2canvas';\nimport BaseObject from './base-object';\nimport CanvasState from './canvas-state';\n\nexport default class HtmlCrop extends BaseObject {\n  /**\n   * object constructor\n   * @param {HTMLDocument} doc\n   * @param {Object} options\n   */\n  constructor(doc, options = {}) {\n    super();\n\n    this._document = doc;\n    this.options = Object.assign({}, options);\n    this._debugMode = options.debug;\n    this.log('initialized');\n\n    html2canvas(this._document.html).then((canvas) => {\n      // const dataURL = canvas.toDataURL('image/png');\n      // window.location.href = dataURL; // eslint disable-line\n\n      this._canvas = canvas;\n\n      const selectionCanvas = doc.createElement('canvas');\n      this._selectionCanvas = selectionCanvas;\n      selectionCanvas.width = canvas.width;\n      selectionCanvas.height = canvas.height;\n      selectionCanvas.style.position = 'fixed';\n      selectionCanvas.style.left = '0';\n      selectionCanvas.style.top = '0';\n      selectionCanvas.style['z-index'] = 9999998;\n\n      this._document.body.appendChild(selectionCanvas);\n      this._canvasState = new CanvasState(doc, selectionCanvas, this._debugMode);\n\n      this.attachButton();\n    });\n  }\n\n  /**\n   * attach button to capture\n   */\n  attachButton() {\n    const { _document } = this;\n    const button = _document.createElement('button');\n    const textNode = _document.createTextNode('Capture');\n    button.appendChild(textNode);\n    button.style.position = 'fixed';\n    button.style.right = '30px';\n    button.style.bottom = '30px';\n    button.style['z-index'] = 9999998;\n    button.onclick = this.onCapture.bind(this);\n\n    _document.body.appendChild(button);\n  }\n\n  /**\n   * capture handler\n   */\n  onCapture() {\n    const ctx = this._canvas.getContext('2d');\n    const selection = this._canvasState.getSelection();\n    const imgData = ctx.getImageData(selection.x, selection.y, selection.w, selection.h);\n\n    const newCanvas = this._document.createElement('canvas');\n    newCanvas.width = selection.w;\n    newCanvas.height = selection.h;\n    const newCtx = newCanvas.getContext('2d');\n    newCtx.putImageData(imgData, 0, 0);\n\n    const dataURL = newCanvas.toDataURL('image/png');\n    // @TODO save dataURL to server\n    window.location.href = dataURL; // eslint disable-line\n  }\n\n  /**\n   * returns class name\n   * @returns {string}\n   */\n  getName() {\n    return 'HtmlCrop';\n  }\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/index.js\n **/","/*\n  html2canvas 0.5.0-beta4 <http://html2canvas.hertzen.com>\n  Copyright (c) 2016 Niklas von Hertzen\n\n  Released under  License\n*/\n\n(function(f){if(typeof exports===\"object\"&&typeof module!==\"undefined\"){module.exports=f()}else if(typeof define===\"function\"&&define.amd){define([],f)}else{var g;if(typeof window!==\"undefined\"){g=window}else if(typeof global!==\"undefined\"){g=global}else if(typeof self!==\"undefined\"){g=self}else{g=this}g.html2canvas = f()}})(function(){var define,module,exports;return (function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(_dereq_,module,exports){\n(function (global){\n/*! https://mths.be/punycode v1.4.0 by @mathias */\n;(function(root) {\n\n\t/** Detect free variables */\n\tvar freeExports = typeof exports == 'object' && exports &&\n\t\t!exports.nodeType && exports;\n\tvar freeModule = typeof module == 'object' && module &&\n\t\t!module.nodeType && module;\n\tvar freeGlobal = typeof global == 'object' && global;\n\tif (\n\t\tfreeGlobal.global === freeGlobal ||\n\t\tfreeGlobal.window === freeGlobal ||\n\t\tfreeGlobal.self === freeGlobal\n\t) {\n\t\troot = freeGlobal;\n\t}\n\n\t/**\n\t * The `punycode` object.\n\t * @name punycode\n\t * @type Object\n\t */\n\tvar punycode,\n\n\t/** Highest positive signed 32-bit float value */\n\tmaxInt = 2147483647, // aka. 0x7FFFFFFF or 2^31-1\n\n\t/** Bootstring parameters */\n\tbase = 36,\n\ttMin = 1,\n\ttMax = 26,\n\tskew = 38,\n\tdamp = 700,\n\tinitialBias = 72,\n\tinitialN = 128, // 0x80\n\tdelimiter = '-', // '\\x2D'\n\n\t/** Regular expressions */\n\tregexPunycode = /^xn--/,\n\tregexNonASCII = /[^\\x20-\\x7E]/, // unprintable ASCII chars + non-ASCII chars\n\tregexSeparators = /[\\x2E\\u3002\\uFF0E\\uFF61]/g, // RFC 3490 separators\n\n\t/** Error messages */\n\terrors = {\n\t\t'overflow': 'Overflow: input needs wider integers to process',\n\t\t'not-basic': 'Illegal input >= 0x80 (not a basic code point)',\n\t\t'invalid-input': 'Invalid input'\n\t},\n\n\t/** Convenience shortcuts */\n\tbaseMinusTMin = base - tMin,\n\tfloor = Math.floor,\n\tstringFromCharCode = String.fromCharCode,\n\n\t/** Temporary variable */\n\tkey;\n\n\t/*--------------------------------------------------------------------------*/\n\n\t/**\n\t * A generic error utility function.\n\t * @private\n\t * @param {String} type The error type.\n\t * @returns {Error} Throws a `RangeError` with the applicable error message.\n\t */\n\tfunction error(type) {\n\t\tthrow new RangeError(errors[type]);\n\t}\n\n\t/**\n\t * A generic `Array#map` utility function.\n\t * @private\n\t * @param {Array} array The array to iterate over.\n\t * @param {Function} callback The function that gets called for every array\n\t * item.\n\t * @returns {Array} A new array of values returned by the callback function.\n\t */\n\tfunction map(array, fn) {\n\t\tvar length = array.length;\n\t\tvar result = [];\n\t\twhile (length--) {\n\t\t\tresult[length] = fn(array[length]);\n\t\t}\n\t\treturn result;\n\t}\n\n\t/**\n\t * A simple `Array#map`-like wrapper to work with domain name strings or email\n\t * addresses.\n\t * @private\n\t * @param {String} domain The domain name or email address.\n\t * @param {Function} callback The function that gets called for every\n\t * character.\n\t * @returns {Array} A new string of characters returned by the callback\n\t * function.\n\t */\n\tfunction mapDomain(string, fn) {\n\t\tvar parts = string.split('@');\n\t\tvar result = '';\n\t\tif (parts.length > 1) {\n\t\t\t// In email addresses, only the domain name should be punycoded. Leave\n\t\t\t// the local part (i.e. everything up to `@`) intact.\n\t\t\tresult = parts[0] + '@';\n\t\t\tstring = parts[1];\n\t\t}\n\t\t// Avoid `split(regex)` for IE8 compatibility. See #17.\n\t\tstring = string.replace(regexSeparators, '\\x2E');\n\t\tvar labels = string.split('.');\n\t\tvar encoded = map(labels, fn).join('.');\n\t\treturn result + encoded;\n\t}\n\n\t/**\n\t * Creates an array containing the numeric code points of each Unicode\n\t * character in the string. While JavaScript uses UCS-2 internally,\n\t * this function will convert a pair of surrogate halves (each of which\n\t * UCS-2 exposes as separate characters) into a single code point,\n\t * matching UTF-16.\n\t * @see `punycode.ucs2.encode`\n\t * @see <https://mathiasbynens.be/notes/javascript-encoding>\n\t * @memberOf punycode.ucs2\n\t * @name decode\n\t * @param {String} string The Unicode input string (UCS-2).\n\t * @returns {Array} The new array of code points.\n\t */\n\tfunction ucs2decode(string) {\n\t\tvar output = [],\n\t\t    counter = 0,\n\t\t    length = string.length,\n\t\t    value,\n\t\t    extra;\n\t\twhile (counter < length) {\n\t\t\tvalue = string.charCodeAt(counter++);\n\t\t\tif (value >= 0xD800 && value <= 0xDBFF && counter < length) {\n\t\t\t\t// high surrogate, and there is a next character\n\t\t\t\textra = string.charCodeAt(counter++);\n\t\t\t\tif ((extra & 0xFC00) == 0xDC00) { // low surrogate\n\t\t\t\t\toutput.push(((value & 0x3FF) << 10) + (extra & 0x3FF) + 0x10000);\n\t\t\t\t} else {\n\t\t\t\t\t// unmatched surrogate; only append this code unit, in case the next\n\t\t\t\t\t// code unit is the high surrogate of a surrogate pair\n\t\t\t\t\toutput.push(value);\n\t\t\t\t\tcounter--;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\toutput.push(value);\n\t\t\t}\n\t\t}\n\t\treturn output;\n\t}\n\n\t/**\n\t * Creates a string based on an array of numeric code points.\n\t * @see `punycode.ucs2.decode`\n\t * @memberOf punycode.ucs2\n\t * @name encode\n\t * @param {Array} codePoints The array of numeric code points.\n\t * @returns {String} The new Unicode string (UCS-2).\n\t */\n\tfunction ucs2encode(array) {\n\t\treturn map(array, function(value) {\n\t\t\tvar output = '';\n\t\t\tif (value > 0xFFFF) {\n\t\t\t\tvalue -= 0x10000;\n\t\t\t\toutput += stringFromCharCode(value >>> 10 & 0x3FF | 0xD800);\n\t\t\t\tvalue = 0xDC00 | value & 0x3FF;\n\t\t\t}\n\t\t\toutput += stringFromCharCode(value);\n\t\t\treturn output;\n\t\t}).join('');\n\t}\n\n\t/**\n\t * Converts a basic code point into a digit/integer.\n\t * @see `digitToBasic()`\n\t * @private\n\t * @param {Number} codePoint The basic numeric code point value.\n\t * @returns {Number} The numeric value of a basic code point (for use in\n\t * representing integers) in the range `0` to `base - 1`, or `base` if\n\t * the code point does not represent a value.\n\t */\n\tfunction basicToDigit(codePoint) {\n\t\tif (codePoint - 48 < 10) {\n\t\t\treturn codePoint - 22;\n\t\t}\n\t\tif (codePoint - 65 < 26) {\n\t\t\treturn codePoint - 65;\n\t\t}\n\t\tif (codePoint - 97 < 26) {\n\t\t\treturn codePoint - 97;\n\t\t}\n\t\treturn base;\n\t}\n\n\t/**\n\t * Converts a digit/integer into a basic code point.\n\t * @see `basicToDigit()`\n\t * @private\n\t * @param {Number} digit The numeric value of a basic code point.\n\t * @returns {Number} The basic code point whose value (when used for\n\t * representing integers) is `digit`, which needs to be in the range\n\t * `0` to `base - 1`. If `flag` is non-zero, the uppercase form is\n\t * used; else, the lowercase form is used. The behavior is undefined\n\t * if `flag` is non-zero and `digit` has no uppercase form.\n\t */\n\tfunction digitToBasic(digit, flag) {\n\t\t//  0..25 map to ASCII a..z or A..Z\n\t\t// 26..35 map to ASCII 0..9\n\t\treturn digit + 22 + 75 * (digit < 26) - ((flag != 0) << 5);\n\t}\n\n\t/**\n\t * Bias adaptation function as per section 3.4 of RFC 3492.\n\t * https://tools.ietf.org/html/rfc3492#section-3.4\n\t * @private\n\t */\n\tfunction adapt(delta, numPoints, firstTime) {\n\t\tvar k = 0;\n\t\tdelta = firstTime ? floor(delta / damp) : delta >> 1;\n\t\tdelta += floor(delta / numPoints);\n\t\tfor (/* no initialization */; delta > baseMinusTMin * tMax >> 1; k += base) {\n\t\t\tdelta = floor(delta / baseMinusTMin);\n\t\t}\n\t\treturn floor(k + (baseMinusTMin + 1) * delta / (delta + skew));\n\t}\n\n\t/**\n\t * Converts a Punycode string of ASCII-only symbols to a string of Unicode\n\t * symbols.\n\t * @memberOf punycode\n\t * @param {String} input The Punycode string of ASCII-only symbols.\n\t * @returns {String} The resulting string of Unicode symbols.\n\t */\n\tfunction decode(input) {\n\t\t// Don't use UCS-2\n\t\tvar output = [],\n\t\t    inputLength = input.length,\n\t\t    out,\n\t\t    i = 0,\n\t\t    n = initialN,\n\t\t    bias = initialBias,\n\t\t    basic,\n\t\t    j,\n\t\t    index,\n\t\t    oldi,\n\t\t    w,\n\t\t    k,\n\t\t    digit,\n\t\t    t,\n\t\t    /** Cached calculation results */\n\t\t    baseMinusT;\n\n\t\t// Handle the basic code points: let `basic` be the number of input code\n\t\t// points before the last delimiter, or `0` if there is none, then copy\n\t\t// the first basic code points to the output.\n\n\t\tbasic = input.lastIndexOf(delimiter);\n\t\tif (basic < 0) {\n\t\t\tbasic = 0;\n\t\t}\n\n\t\tfor (j = 0; j < basic; ++j) {\n\t\t\t// if it's not a basic code point\n\t\t\tif (input.charCodeAt(j) >= 0x80) {\n\t\t\t\terror('not-basic');\n\t\t\t}\n\t\t\toutput.push(input.charCodeAt(j));\n\t\t}\n\n\t\t// Main decoding loop: start just after the last delimiter if any basic code\n\t\t// points were copied; start at the beginning otherwise.\n\n\t\tfor (index = basic > 0 ? basic + 1 : 0; index < inputLength; /* no final expression */) {\n\n\t\t\t// `index` is the index of the next character to be consumed.\n\t\t\t// Decode a generalized variable-length integer into `delta`,\n\t\t\t// which gets added to `i`. The overflow checking is easier\n\t\t\t// if we increase `i` as we go, then subtract off its starting\n\t\t\t// value at the end to obtain `delta`.\n\t\t\tfor (oldi = i, w = 1, k = base; /* no condition */; k += base) {\n\n\t\t\t\tif (index >= inputLength) {\n\t\t\t\t\terror('invalid-input');\n\t\t\t\t}\n\n\t\t\t\tdigit = basicToDigit(input.charCodeAt(index++));\n\n\t\t\t\tif (digit >= base || digit > floor((maxInt - i) / w)) {\n\t\t\t\t\terror('overflow');\n\t\t\t\t}\n\n\t\t\t\ti += digit * w;\n\t\t\t\tt = k <= bias ? tMin : (k >= bias + tMax ? tMax : k - bias);\n\n\t\t\t\tif (digit < t) {\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\n\t\t\t\tbaseMinusT = base - t;\n\t\t\t\tif (w > floor(maxInt / baseMinusT)) {\n\t\t\t\t\terror('overflow');\n\t\t\t\t}\n\n\t\t\t\tw *= baseMinusT;\n\n\t\t\t}\n\n\t\t\tout = output.length + 1;\n\t\t\tbias = adapt(i - oldi, out, oldi == 0);\n\n\t\t\t// `i` was supposed to wrap around from `out` to `0`,\n\t\t\t// incrementing `n` each time, so we'll fix that now:\n\t\t\tif (floor(i / out) > maxInt - n) {\n\t\t\t\terror('overflow');\n\t\t\t}\n\n\t\t\tn += floor(i / out);\n\t\t\ti %= out;\n\n\t\t\t// Insert `n` at position `i` of the output\n\t\t\toutput.splice(i++, 0, n);\n\n\t\t}\n\n\t\treturn ucs2encode(output);\n\t}\n\n\t/**\n\t * Converts a string of Unicode symbols (e.g. a domain name label) to a\n\t * Punycode string of ASCII-only symbols.\n\t * @memberOf punycode\n\t * @param {String} input The string of Unicode symbols.\n\t * @returns {String} The resulting Punycode string of ASCII-only symbols.\n\t */\n\tfunction encode(input) {\n\t\tvar n,\n\t\t    delta,\n\t\t    handledCPCount,\n\t\t    basicLength,\n\t\t    bias,\n\t\t    j,\n\t\t    m,\n\t\t    q,\n\t\t    k,\n\t\t    t,\n\t\t    currentValue,\n\t\t    output = [],\n\t\t    /** `inputLength` will hold the number of code points in `input`. */\n\t\t    inputLength,\n\t\t    /** Cached calculation results */\n\t\t    handledCPCountPlusOne,\n\t\t    baseMinusT,\n\t\t    qMinusT;\n\n\t\t// Convert the input in UCS-2 to Unicode\n\t\tinput = ucs2decode(input);\n\n\t\t// Cache the length\n\t\tinputLength = input.length;\n\n\t\t// Initialize the state\n\t\tn = initialN;\n\t\tdelta = 0;\n\t\tbias = initialBias;\n\n\t\t// Handle the basic code points\n\t\tfor (j = 0; j < inputLength; ++j) {\n\t\t\tcurrentValue = input[j];\n\t\t\tif (currentValue < 0x80) {\n\t\t\t\toutput.push(stringFromCharCode(currentValue));\n\t\t\t}\n\t\t}\n\n\t\thandledCPCount = basicLength = output.length;\n\n\t\t// `handledCPCount` is the number of code points that have been handled;\n\t\t// `basicLength` is the number of basic code points.\n\n\t\t// Finish the basic string - if it is not empty - with a delimiter\n\t\tif (basicLength) {\n\t\t\toutput.push(delimiter);\n\t\t}\n\n\t\t// Main encoding loop:\n\t\twhile (handledCPCount < inputLength) {\n\n\t\t\t// All non-basic code points < n have been handled already. Find the next\n\t\t\t// larger one:\n\t\t\tfor (m = maxInt, j = 0; j < inputLength; ++j) {\n\t\t\t\tcurrentValue = input[j];\n\t\t\t\tif (currentValue >= n && currentValue < m) {\n\t\t\t\t\tm = currentValue;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Increase `delta` enough to advance the decoder's <n,i> state to <m,0>,\n\t\t\t// but guard against overflow\n\t\t\thandledCPCountPlusOne = handledCPCount + 1;\n\t\t\tif (m - n > floor((maxInt - delta) / handledCPCountPlusOne)) {\n\t\t\t\terror('overflow');\n\t\t\t}\n\n\t\t\tdelta += (m - n) * handledCPCountPlusOne;\n\t\t\tn = m;\n\n\t\t\tfor (j = 0; j < inputLength; ++j) {\n\t\t\t\tcurrentValue = input[j];\n\n\t\t\t\tif (currentValue < n && ++delta > maxInt) {\n\t\t\t\t\terror('overflow');\n\t\t\t\t}\n\n\t\t\t\tif (currentValue == n) {\n\t\t\t\t\t// Represent delta as a generalized variable-length integer\n\t\t\t\t\tfor (q = delta, k = base; /* no condition */; k += base) {\n\t\t\t\t\t\tt = k <= bias ? tMin : (k >= bias + tMax ? tMax : k - bias);\n\t\t\t\t\t\tif (q < t) {\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tqMinusT = q - t;\n\t\t\t\t\t\tbaseMinusT = base - t;\n\t\t\t\t\t\toutput.push(\n\t\t\t\t\t\t\tstringFromCharCode(digitToBasic(t + qMinusT % baseMinusT, 0))\n\t\t\t\t\t\t);\n\t\t\t\t\t\tq = floor(qMinusT / baseMinusT);\n\t\t\t\t\t}\n\n\t\t\t\t\toutput.push(stringFromCharCode(digitToBasic(q, 0)));\n\t\t\t\t\tbias = adapt(delta, handledCPCountPlusOne, handledCPCount == basicLength);\n\t\t\t\t\tdelta = 0;\n\t\t\t\t\t++handledCPCount;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t++delta;\n\t\t\t++n;\n\n\t\t}\n\t\treturn output.join('');\n\t}\n\n\t/**\n\t * Converts a Punycode string representing a domain name or an email address\n\t * to Unicode. Only the Punycoded parts of the input will be converted, i.e.\n\t * it doesn't matter if you call it on a string that has already been\n\t * converted to Unicode.\n\t * @memberOf punycode\n\t * @param {String} input The Punycoded domain name or email address to\n\t * convert to Unicode.\n\t * @returns {String} The Unicode representation of the given Punycode\n\t * string.\n\t */\n\tfunction toUnicode(input) {\n\t\treturn mapDomain(input, function(string) {\n\t\t\treturn regexPunycode.test(string)\n\t\t\t\t? decode(string.slice(4).toLowerCase())\n\t\t\t\t: string;\n\t\t});\n\t}\n\n\t/**\n\t * Converts a Unicode string representing a domain name or an email address to\n\t * Punycode. Only the non-ASCII parts of the domain name will be converted,\n\t * i.e. it doesn't matter if you call it with a domain that's already in\n\t * ASCII.\n\t * @memberOf punycode\n\t * @param {String} input The domain name or email address to convert, as a\n\t * Unicode string.\n\t * @returns {String} The Punycode representation of the given domain name or\n\t * email address.\n\t */\n\tfunction toASCII(input) {\n\t\treturn mapDomain(input, function(string) {\n\t\t\treturn regexNonASCII.test(string)\n\t\t\t\t? 'xn--' + encode(string)\n\t\t\t\t: string;\n\t\t});\n\t}\n\n\t/*--------------------------------------------------------------------------*/\n\n\t/** Define the public API */\n\tpunycode = {\n\t\t/**\n\t\t * A string representing the current Punycode.js version number.\n\t\t * @memberOf punycode\n\t\t * @type String\n\t\t */\n\t\t'version': '1.3.2',\n\t\t/**\n\t\t * An object of methods to convert from JavaScript's internal character\n\t\t * representation (UCS-2) to Unicode code points, and back.\n\t\t * @see <https://mathiasbynens.be/notes/javascript-encoding>\n\t\t * @memberOf punycode\n\t\t * @type Object\n\t\t */\n\t\t'ucs2': {\n\t\t\t'decode': ucs2decode,\n\t\t\t'encode': ucs2encode\n\t\t},\n\t\t'decode': decode,\n\t\t'encode': encode,\n\t\t'toASCII': toASCII,\n\t\t'toUnicode': toUnicode\n\t};\n\n\t/** Expose `punycode` */\n\t// Some AMD build optimizers, like r.js, check for specific condition patterns\n\t// like the following:\n\tif (\n\t\ttypeof define == 'function' &&\n\t\ttypeof define.amd == 'object' &&\n\t\tdefine.amd\n\t) {\n\t\tdefine('punycode', function() {\n\t\t\treturn punycode;\n\t\t});\n\t} else if (freeExports && freeModule) {\n\t\tif (module.exports == freeExports) {\n\t\t\t// in Node.js, io.js, or RingoJS v0.8.0+\n\t\t\tfreeModule.exports = punycode;\n\t\t} else {\n\t\t\t// in Narwhal or RingoJS v0.7.0-\n\t\t\tfor (key in punycode) {\n\t\t\t\tpunycode.hasOwnProperty(key) && (freeExports[key] = punycode[key]);\n\t\t\t}\n\t\t}\n\t} else {\n\t\t// in Rhino or a web browser\n\t\troot.punycode = punycode;\n\t}\n\n}(this));\n\n}).call(this,typeof global !== \"undefined\" ? global : typeof self !== \"undefined\" ? self : typeof window !== \"undefined\" ? window : {})\n},{}],2:[function(_dereq_,module,exports){\nvar log = _dereq_('./log');\n\nfunction restoreOwnerScroll(ownerDocument, x, y) {\n    if (ownerDocument.defaultView && (x !== ownerDocument.defaultView.pageXOffset || y !== ownerDocument.defaultView.pageYOffset)) {\n        ownerDocument.defaultView.scrollTo(x, y);\n    }\n}\n\nfunction cloneCanvasContents(canvas, clonedCanvas) {\n    try {\n        if (clonedCanvas) {\n            clonedCanvas.width = canvas.width;\n            clonedCanvas.height = canvas.height;\n            clonedCanvas.getContext(\"2d\").putImageData(canvas.getContext(\"2d\").getImageData(0, 0, canvas.width, canvas.height), 0, 0);\n        }\n    } catch(e) {\n        log(\"Unable to copy canvas content from\", canvas, e);\n    }\n}\n\nfunction cloneNode(node, javascriptEnabled) {\n    var clone = node.nodeType === 3 ? document.createTextNode(node.nodeValue) : node.cloneNode(false);\n\n    var child = node.firstChild;\n    while(child) {\n        if (javascriptEnabled === true || child.nodeType !== 1 || child.nodeName !== 'SCRIPT') {\n            clone.appendChild(cloneNode(child, javascriptEnabled));\n        }\n        child = child.nextSibling;\n    }\n\n    if (node.nodeType === 1) {\n        clone._scrollTop = node.scrollTop;\n        clone._scrollLeft = node.scrollLeft;\n        if (node.nodeName === \"CANVAS\") {\n            cloneCanvasContents(node, clone);\n        } else if (node.nodeName === \"TEXTAREA\" || node.nodeName === \"SELECT\") {\n            clone.value = node.value;\n        }\n    }\n\n    return clone;\n}\n\nfunction initNode(node) {\n    if (node.nodeType === 1) {\n        node.scrollTop = node._scrollTop;\n        node.scrollLeft = node._scrollLeft;\n\n        var child = node.firstChild;\n        while(child) {\n            initNode(child);\n            child = child.nextSibling;\n        }\n    }\n}\n\nmodule.exports = function(ownerDocument, containerDocument, width, height, options, x ,y) {\n    var documentElement = cloneNode(ownerDocument.documentElement, options.javascriptEnabled);\n    var container = containerDocument.createElement(\"iframe\");\n\n    container.className = \"html2canvas-container\";\n    container.style.visibility = \"hidden\";\n    container.style.position = \"fixed\";\n    container.style.left = \"-10000px\";\n    container.style.top = \"0px\";\n    container.style.border = \"0\";\n    container.width = width;\n    container.height = height;\n    container.scrolling = \"no\"; // ios won't scroll without it\n    containerDocument.body.appendChild(container);\n\n    return new Promise(function(resolve) {\n        var documentClone = container.contentWindow.document;\n\n        /* Chrome doesn't detect relative background-images assigned in inline <style> sheets when fetched through getComputedStyle\n         if window url is about:blank, we can assign the url to current by writing onto the document\n         */\n        container.contentWindow.onload = container.onload = function() {\n            var interval = setInterval(function() {\n                if (documentClone.body.childNodes.length > 0) {\n                    initNode(documentClone.documentElement);\n                    clearInterval(interval);\n                    if (options.type === \"view\") {\n                        container.contentWindow.scrollTo(x, y);\n                        if ((/(iPad|iPhone|iPod)/g).test(navigator.userAgent) && (container.contentWindow.scrollY !== y || container.contentWindow.scrollX !== x)) {\n                            documentClone.documentElement.style.top = (-y) + \"px\";\n                            documentClone.documentElement.style.left = (-x) + \"px\";\n                            documentClone.documentElement.style.position = 'absolute';\n                        }\n                    }\n                    resolve(container);\n                }\n            }, 50);\n        };\n\n        documentClone.open();\n        documentClone.write(\"<!DOCTYPE html><html></html>\");\n        // Chrome scrolls the parent document for some reason after the write to the cloned window???\n        restoreOwnerScroll(ownerDocument, x, y);\n        documentClone.replaceChild(documentClone.adoptNode(documentElement), documentClone.documentElement);\n        documentClone.close();\n    });\n};\n\n},{\"./log\":13}],3:[function(_dereq_,module,exports){\n// http://dev.w3.org/csswg/css-color/\n\nfunction Color(value) {\n    this.r = 0;\n    this.g = 0;\n    this.b = 0;\n    this.a = null;\n    var result = this.fromArray(value) ||\n        this.namedColor(value) ||\n        this.rgb(value) ||\n        this.rgba(value) ||\n        this.hex6(value) ||\n        this.hex3(value);\n}\n\nColor.prototype.darken = function(amount) {\n    var a = 1 - amount;\n    return  new Color([\n        Math.round(this.r * a),\n        Math.round(this.g * a),\n        Math.round(this.b * a),\n        this.a\n    ]);\n};\n\nColor.prototype.isTransparent = function() {\n    return this.a === 0;\n};\n\nColor.prototype.isBlack = function() {\n    return this.r === 0 && this.g === 0 && this.b === 0;\n};\n\nColor.prototype.fromArray = function(array) {\n    if (Array.isArray(array)) {\n        this.r = Math.min(array[0], 255);\n        this.g = Math.min(array[1], 255);\n        this.b = Math.min(array[2], 255);\n        if (array.length > 3) {\n            this.a = array[3];\n        }\n    }\n\n    return (Array.isArray(array));\n};\n\nvar _hex3 = /^#([a-f0-9]{3})$/i;\n\nColor.prototype.hex3 = function(value) {\n    var match = null;\n    if ((match = value.match(_hex3)) !== null) {\n        this.r = parseInt(match[1][0] + match[1][0], 16);\n        this.g = parseInt(match[1][1] + match[1][1], 16);\n        this.b = parseInt(match[1][2] + match[1][2], 16);\n    }\n    return match !== null;\n};\n\nvar _hex6 = /^#([a-f0-9]{6})$/i;\n\nColor.prototype.hex6 = function(value) {\n    var match = null;\n    if ((match = value.match(_hex6)) !== null) {\n        this.r = parseInt(match[1].substring(0, 2), 16);\n        this.g = parseInt(match[1].substring(2, 4), 16);\n        this.b = parseInt(match[1].substring(4, 6), 16);\n    }\n    return match !== null;\n};\n\n\nvar _rgb = /^rgb\\(\\s*(\\d{1,3})\\s*,\\s*(\\d{1,3})\\s*,\\s*(\\d{1,3})\\s*\\)$/;\n\nColor.prototype.rgb = function(value) {\n    var match = null;\n    if ((match = value.match(_rgb)) !== null) {\n        this.r = Number(match[1]);\n        this.g = Number(match[2]);\n        this.b = Number(match[3]);\n    }\n    return match !== null;\n};\n\nvar _rgba = /^rgba\\(\\s*(\\d{1,3})\\s*,\\s*(\\d{1,3})\\s*,\\s*(\\d{1,3})\\s*,\\s*(\\d?\\.?\\d+)\\s*\\)$/;\n\nColor.prototype.rgba = function(value) {\n    var match = null;\n    if ((match = value.match(_rgba)) !== null) {\n        this.r = Number(match[1]);\n        this.g = Number(match[2]);\n        this.b = Number(match[3]);\n        this.a = Number(match[4]);\n    }\n    return match !== null;\n};\n\nColor.prototype.toString = function() {\n    return this.a !== null && this.a !== 1 ?\n    \"rgba(\" + [this.r, this.g, this.b, this.a].join(\",\") + \")\" :\n    \"rgb(\" + [this.r, this.g, this.b].join(\",\") + \")\";\n};\n\nColor.prototype.namedColor = function(value) {\n    value = value.toLowerCase();\n    var color = colors[value];\n    if (color) {\n        this.r = color[0];\n        this.g = color[1];\n        this.b = color[2];\n    } else if (value === \"transparent\") {\n        this.r = this.g = this.b = this.a = 0;\n        return true;\n    }\n\n    return !!color;\n};\n\nColor.prototype.isColor = true;\n\n// JSON.stringify([].slice.call($$('.named-color-table tr'), 1).map(function(row) { return [row.childNodes[3].textContent, row.childNodes[5].textContent.trim().split(\",\").map(Number)] }).reduce(function(data, row) {data[row[0]] = row[1]; return data}, {}))\nvar colors = {\n    \"aliceblue\": [240, 248, 255],\n    \"antiquewhite\": [250, 235, 215],\n    \"aqua\": [0, 255, 255],\n    \"aquamarine\": [127, 255, 212],\n    \"azure\": [240, 255, 255],\n    \"beige\": [245, 245, 220],\n    \"bisque\": [255, 228, 196],\n    \"black\": [0, 0, 0],\n    \"blanchedalmond\": [255, 235, 205],\n    \"blue\": [0, 0, 255],\n    \"blueviolet\": [138, 43, 226],\n    \"brown\": [165, 42, 42],\n    \"burlywood\": [222, 184, 135],\n    \"cadetblue\": [95, 158, 160],\n    \"chartreuse\": [127, 255, 0],\n    \"chocolate\": [210, 105, 30],\n    \"coral\": [255, 127, 80],\n    \"cornflowerblue\": [100, 149, 237],\n    \"cornsilk\": [255, 248, 220],\n    \"crimson\": [220, 20, 60],\n    \"cyan\": [0, 255, 255],\n    \"darkblue\": [0, 0, 139],\n    \"darkcyan\": [0, 139, 139],\n    \"darkgoldenrod\": [184, 134, 11],\n    \"darkgray\": [169, 169, 169],\n    \"darkgreen\": [0, 100, 0],\n    \"darkgrey\": [169, 169, 169],\n    \"darkkhaki\": [189, 183, 107],\n    \"darkmagenta\": [139, 0, 139],\n    \"darkolivegreen\": [85, 107, 47],\n    \"darkorange\": [255, 140, 0],\n    \"darkorchid\": [153, 50, 204],\n    \"darkred\": [139, 0, 0],\n    \"darksalmon\": [233, 150, 122],\n    \"darkseagreen\": [143, 188, 143],\n    \"darkslateblue\": [72, 61, 139],\n    \"darkslategray\": [47, 79, 79],\n    \"darkslategrey\": [47, 79, 79],\n    \"darkturquoise\": [0, 206, 209],\n    \"darkviolet\": [148, 0, 211],\n    \"deeppink\": [255, 20, 147],\n    \"deepskyblue\": [0, 191, 255],\n    \"dimgray\": [105, 105, 105],\n    \"dimgrey\": [105, 105, 105],\n    \"dodgerblue\": [30, 144, 255],\n    \"firebrick\": [178, 34, 34],\n    \"floralwhite\": [255, 250, 240],\n    \"forestgreen\": [34, 139, 34],\n    \"fuchsia\": [255, 0, 255],\n    \"gainsboro\": [220, 220, 220],\n    \"ghostwhite\": [248, 248, 255],\n    \"gold\": [255, 215, 0],\n    \"goldenrod\": [218, 165, 32],\n    \"gray\": [128, 128, 128],\n    \"green\": [0, 128, 0],\n    \"greenyellow\": [173, 255, 47],\n    \"grey\": [128, 128, 128],\n    \"honeydew\": [240, 255, 240],\n    \"hotpink\": [255, 105, 180],\n    \"indianred\": [205, 92, 92],\n    \"indigo\": [75, 0, 130],\n    \"ivory\": [255, 255, 240],\n    \"khaki\": [240, 230, 140],\n    \"lavender\": [230, 230, 250],\n    \"lavenderblush\": [255, 240, 245],\n    \"lawngreen\": [124, 252, 0],\n    \"lemonchiffon\": [255, 250, 205],\n    \"lightblue\": [173, 216, 230],\n    \"lightcoral\": [240, 128, 128],\n    \"lightcyan\": [224, 255, 255],\n    \"lightgoldenrodyellow\": [250, 250, 210],\n    \"lightgray\": [211, 211, 211],\n    \"lightgreen\": [144, 238, 144],\n    \"lightgrey\": [211, 211, 211],\n    \"lightpink\": [255, 182, 193],\n    \"lightsalmon\": [255, 160, 122],\n    \"lightseagreen\": [32, 178, 170],\n    \"lightskyblue\": [135, 206, 250],\n    \"lightslategray\": [119, 136, 153],\n    \"lightslategrey\": [119, 136, 153],\n    \"lightsteelblue\": [176, 196, 222],\n    \"lightyellow\": [255, 255, 224],\n    \"lime\": [0, 255, 0],\n    \"limegreen\": [50, 205, 50],\n    \"linen\": [250, 240, 230],\n    \"magenta\": [255, 0, 255],\n    \"maroon\": [128, 0, 0],\n    \"mediumaquamarine\": [102, 205, 170],\n    \"mediumblue\": [0, 0, 205],\n    \"mediumorchid\": [186, 85, 211],\n    \"mediumpurple\": [147, 112, 219],\n    \"mediumseagreen\": [60, 179, 113],\n    \"mediumslateblue\": [123, 104, 238],\n    \"mediumspringgreen\": [0, 250, 154],\n    \"mediumturquoise\": [72, 209, 204],\n    \"mediumvioletred\": [199, 21, 133],\n    \"midnightblue\": [25, 25, 112],\n    \"mintcream\": [245, 255, 250],\n    \"mistyrose\": [255, 228, 225],\n    \"moccasin\": [255, 228, 181],\n    \"navajowhite\": [255, 222, 173],\n    \"navy\": [0, 0, 128],\n    \"oldlace\": [253, 245, 230],\n    \"olive\": [128, 128, 0],\n    \"olivedrab\": [107, 142, 35],\n    \"orange\": [255, 165, 0],\n    \"orangered\": [255, 69, 0],\n    \"orchid\": [218, 112, 214],\n    \"palegoldenrod\": [238, 232, 170],\n    \"palegreen\": [152, 251, 152],\n    \"paleturquoise\": [175, 238, 238],\n    \"palevioletred\": [219, 112, 147],\n    \"papayawhip\": [255, 239, 213],\n    \"peachpuff\": [255, 218, 185],\n    \"peru\": [205, 133, 63],\n    \"pink\": [255, 192, 203],\n    \"plum\": [221, 160, 221],\n    \"powderblue\": [176, 224, 230],\n    \"purple\": [128, 0, 128],\n    \"rebeccapurple\": [102, 51, 153],\n    \"red\": [255, 0, 0],\n    \"rosybrown\": [188, 143, 143],\n    \"royalblue\": [65, 105, 225],\n    \"saddlebrown\": [139, 69, 19],\n    \"salmon\": [250, 128, 114],\n    \"sandybrown\": [244, 164, 96],\n    \"seagreen\": [46, 139, 87],\n    \"seashell\": [255, 245, 238],\n    \"sienna\": [160, 82, 45],\n    \"silver\": [192, 192, 192],\n    \"skyblue\": [135, 206, 235],\n    \"slateblue\": [106, 90, 205],\n    \"slategray\": [112, 128, 144],\n    \"slategrey\": [112, 128, 144],\n    \"snow\": [255, 250, 250],\n    \"springgreen\": [0, 255, 127],\n    \"steelblue\": [70, 130, 180],\n    \"tan\": [210, 180, 140],\n    \"teal\": [0, 128, 128],\n    \"thistle\": [216, 191, 216],\n    \"tomato\": [255, 99, 71],\n    \"turquoise\": [64, 224, 208],\n    \"violet\": [238, 130, 238],\n    \"wheat\": [245, 222, 179],\n    \"white\": [255, 255, 255],\n    \"whitesmoke\": [245, 245, 245],\n    \"yellow\": [255, 255, 0],\n    \"yellowgreen\": [154, 205, 50]\n};\n\nmodule.exports = Color;\n\n},{}],4:[function(_dereq_,module,exports){\nvar Support = _dereq_('./support');\nvar CanvasRenderer = _dereq_('./renderers/canvas');\nvar ImageLoader = _dereq_('./imageloader');\nvar NodeParser = _dereq_('./nodeparser');\nvar NodeContainer = _dereq_('./nodecontainer');\nvar log = _dereq_('./log');\nvar utils = _dereq_('./utils');\nvar createWindowClone = _dereq_('./clone');\nvar loadUrlDocument = _dereq_('./proxy').loadUrlDocument;\nvar getBounds = utils.getBounds;\n\nvar html2canvasNodeAttribute = \"data-html2canvas-node\";\nvar html2canvasCloneIndex = 0;\n\nfunction html2canvas(nodeList, options) {\n    var index = html2canvasCloneIndex++;\n    options = options || {};\n    if (options.logging) {\n        log.options.logging = true;\n        log.options.start = Date.now();\n    }\n\n    options.async = typeof(options.async) === \"undefined\" ? true : options.async;\n    options.allowTaint = typeof(options.allowTaint) === \"undefined\" ? false : options.allowTaint;\n    options.removeContainer = typeof(options.removeContainer) === \"undefined\" ? true : options.removeContainer;\n    options.javascriptEnabled = typeof(options.javascriptEnabled) === \"undefined\" ? false : options.javascriptEnabled;\n    options.imageTimeout = typeof(options.imageTimeout) === \"undefined\" ? 10000 : options.imageTimeout;\n    options.renderer = typeof(options.renderer) === \"function\" ? options.renderer : CanvasRenderer;\n    options.strict = !!options.strict;\n\n    if (typeof(nodeList) === \"string\") {\n        if (typeof(options.proxy) !== \"string\") {\n            return Promise.reject(\"Proxy must be used when rendering url\");\n        }\n        var width = options.width != null ? options.width : window.innerWidth;\n        var height = options.height != null ? options.height : window.innerHeight;\n        return loadUrlDocument(absoluteUrl(nodeList), options.proxy, document, width, height, options).then(function(container) {\n            return renderWindow(container.contentWindow.document.documentElement, container, options, width, height);\n        });\n    }\n\n    var node = ((nodeList === undefined) ? [document.documentElement] : ((nodeList.length) ? nodeList : [nodeList]))[0];\n    node.setAttribute(html2canvasNodeAttribute + index, index);\n    return renderDocument(node.ownerDocument, options, node.ownerDocument.defaultView.innerWidth, node.ownerDocument.defaultView.innerHeight, index).then(function(canvas) {\n        if (typeof(options.onrendered) === \"function\") {\n            log(\"options.onrendered is deprecated, html2canvas returns a Promise containing the canvas\");\n            options.onrendered(canvas);\n        }\n        return canvas;\n    });\n}\n\nhtml2canvas.CanvasRenderer = CanvasRenderer;\nhtml2canvas.NodeContainer = NodeContainer;\nhtml2canvas.log = log;\nhtml2canvas.utils = utils;\n\nvar html2canvasExport = (typeof(document) === \"undefined\" || typeof(Object.create) !== \"function\" || typeof(document.createElement(\"canvas\").getContext) !== \"function\") ? function() {\n    return Promise.reject(\"No canvas support\");\n} : html2canvas;\n\nmodule.exports = html2canvasExport;\n\nif (typeof(define) === 'function' && define.amd) {\n    define('html2canvas', [], function() {\n        return html2canvasExport;\n    });\n}\n\nfunction renderDocument(document, options, windowWidth, windowHeight, html2canvasIndex) {\n    return createWindowClone(document, document, windowWidth, windowHeight, options, document.defaultView.pageXOffset, document.defaultView.pageYOffset).then(function(container) {\n        log(\"Document cloned\");\n        var attributeName = html2canvasNodeAttribute + html2canvasIndex;\n        var selector = \"[\" + attributeName + \"='\" + html2canvasIndex + \"']\";\n        document.querySelector(selector).removeAttribute(attributeName);\n        var clonedWindow = container.contentWindow;\n        var node = clonedWindow.document.querySelector(selector);\n        var oncloneHandler = (typeof(options.onclone) === \"function\") ? Promise.resolve(options.onclone(clonedWindow.document)) : Promise.resolve(true);\n        return oncloneHandler.then(function() {\n            return renderWindow(node, container, options, windowWidth, windowHeight);\n        });\n    });\n}\n\nfunction renderWindow(node, container, options, windowWidth, windowHeight) {\n    var clonedWindow = container.contentWindow;\n    var support = new Support(clonedWindow.document);\n    var imageLoader = new ImageLoader(options, support);\n    var bounds = getBounds(node);\n    var width = options.type === \"view\" ? windowWidth : documentWidth(clonedWindow.document);\n    var height = options.type === \"view\" ? windowHeight : documentHeight(clonedWindow.document);\n    var renderer = new options.renderer(width, height, imageLoader, options, document);\n    var parser = new NodeParser(node, renderer, support, imageLoader, options);\n    return parser.ready.then(function() {\n        log(\"Finished rendering\");\n        var canvas;\n\n        if (options.type === \"view\") {\n            canvas = crop(renderer.canvas, {width: renderer.canvas.width, height: renderer.canvas.height, top: 0, left: 0, x: 0, y: 0});\n        } else if (node === clonedWindow.document.body || node === clonedWindow.document.documentElement || options.canvas != null) {\n            canvas = renderer.canvas;\n        } else {\n            canvas = crop(renderer.canvas, {width:  options.width != null ? options.width : bounds.width, height: options.height != null ? options.height : bounds.height, top: bounds.top, left: bounds.left, x: 0, y: 0});\n        }\n\n        cleanupContainer(container, options);\n        return canvas;\n    });\n}\n\nfunction cleanupContainer(container, options) {\n    if (options.removeContainer) {\n        container.parentNode.removeChild(container);\n        log(\"Cleaned up container\");\n    }\n}\n\nfunction crop(canvas, bounds) {\n    var croppedCanvas = document.createElement(\"canvas\");\n    var x1 = Math.min(canvas.width - 1, Math.max(0, bounds.left));\n    var x2 = Math.min(canvas.width, Math.max(1, bounds.left + bounds.width));\n    var y1 = Math.min(canvas.height - 1, Math.max(0, bounds.top));\n    var y2 = Math.min(canvas.height, Math.max(1, bounds.top + bounds.height));\n    croppedCanvas.width = bounds.width;\n    croppedCanvas.height =  bounds.height;\n    var width = x2-x1;\n    var height = y2-y1;\n    log(\"Cropping canvas at:\", \"left:\", bounds.left, \"top:\", bounds.top, \"width:\", width, \"height:\", height);\n    log(\"Resulting crop with width\", bounds.width, \"and height\", bounds.height, \"with x\", x1, \"and y\", y1);\n    croppedCanvas.getContext(\"2d\").drawImage(canvas, x1, y1, width, height, bounds.x, bounds.y, width, height);\n    return croppedCanvas;\n}\n\nfunction documentWidth (doc) {\n    return Math.max(\n        Math.max(doc.body.scrollWidth, doc.documentElement.scrollWidth),\n        Math.max(doc.body.offsetWidth, doc.documentElement.offsetWidth),\n        Math.max(doc.body.clientWidth, doc.documentElement.clientWidth)\n    );\n}\n\nfunction documentHeight (doc) {\n    return Math.max(\n        Math.max(doc.body.scrollHeight, doc.documentElement.scrollHeight),\n        Math.max(doc.body.offsetHeight, doc.documentElement.offsetHeight),\n        Math.max(doc.body.clientHeight, doc.documentElement.clientHeight)\n    );\n}\n\nfunction absoluteUrl(url) {\n    var link = document.createElement(\"a\");\n    link.href = url;\n    link.href = link.href;\n    return link;\n}\n\n},{\"./clone\":2,\"./imageloader\":11,\"./log\":13,\"./nodecontainer\":14,\"./nodeparser\":15,\"./proxy\":16,\"./renderers/canvas\":20,\"./support\":22,\"./utils\":26}],5:[function(_dereq_,module,exports){\nvar log = _dereq_('./log');\nvar smallImage = _dereq_('./utils').smallImage;\n\nfunction DummyImageContainer(src) {\n    this.src = src;\n    log(\"DummyImageContainer for\", src);\n    if (!this.promise || !this.image) {\n        log(\"Initiating DummyImageContainer\");\n        DummyImageContainer.prototype.image = new Image();\n        var image = this.image;\n        DummyImageContainer.prototype.promise = new Promise(function(resolve, reject) {\n            image.onload = resolve;\n            image.onerror = reject;\n            image.src = smallImage();\n            if (image.complete === true) {\n                resolve(image);\n            }\n        });\n    }\n}\n\nmodule.exports = DummyImageContainer;\n\n},{\"./log\":13,\"./utils\":26}],6:[function(_dereq_,module,exports){\nvar smallImage = _dereq_('./utils').smallImage;\n\nfunction Font(family, size) {\n    var container = document.createElement('div'),\n        img = document.createElement('img'),\n        span = document.createElement('span'),\n        sampleText = 'Hidden Text',\n        baseline,\n        middle;\n\n    container.style.visibility = \"hidden\";\n    container.style.fontFamily = family;\n    container.style.fontSize = size;\n    container.style.margin = 0;\n    container.style.padding = 0;\n\n    document.body.appendChild(container);\n\n    img.src = smallImage();\n    img.width = 1;\n    img.height = 1;\n\n    img.style.margin = 0;\n    img.style.padding = 0;\n    img.style.verticalAlign = \"baseline\";\n\n    span.style.fontFamily = family;\n    span.style.fontSize = size;\n    span.style.margin = 0;\n    span.style.padding = 0;\n\n    span.appendChild(document.createTextNode(sampleText));\n    container.appendChild(span);\n    container.appendChild(img);\n    baseline = (img.offsetTop - span.offsetTop) + 1;\n\n    container.removeChild(span);\n    container.appendChild(document.createTextNode(sampleText));\n\n    container.style.lineHeight = \"normal\";\n    img.style.verticalAlign = \"super\";\n\n    middle = (img.offsetTop-container.offsetTop) + 1;\n\n    document.body.removeChild(container);\n\n    this.baseline = baseline;\n    this.lineWidth = 1;\n    this.middle = middle;\n}\n\nmodule.exports = Font;\n\n},{\"./utils\":26}],7:[function(_dereq_,module,exports){\nvar Font = _dereq_('./font');\n\nfunction FontMetrics() {\n    this.data = {};\n}\n\nFontMetrics.prototype.getMetrics = function(family, size) {\n    if (this.data[family + \"-\" + size] === undefined) {\n        this.data[family + \"-\" + size] = new Font(family, size);\n    }\n    return this.data[family + \"-\" + size];\n};\n\nmodule.exports = FontMetrics;\n\n},{\"./font\":6}],8:[function(_dereq_,module,exports){\nvar utils = _dereq_('./utils');\nvar getBounds = utils.getBounds;\nvar loadUrlDocument = _dereq_('./proxy').loadUrlDocument;\n\nfunction FrameContainer(container, sameOrigin, options) {\n    this.image = null;\n    this.src = container;\n    var self = this;\n    var bounds = getBounds(container);\n    this.promise = (!sameOrigin ? this.proxyLoad(options.proxy, bounds, options) : new Promise(function(resolve) {\n        if (container.contentWindow.document.URL === \"about:blank\" || container.contentWindow.document.documentElement == null) {\n            container.contentWindow.onload = container.onload = function() {\n                resolve(container);\n            };\n        } else {\n            resolve(container);\n        }\n    })).then(function(container) {\n        var html2canvas = _dereq_('./core');\n        return html2canvas(container.contentWindow.document.documentElement, {type: 'view', width: container.width, height: container.height, proxy: options.proxy, javascriptEnabled: options.javascriptEnabled, removeContainer: options.removeContainer, allowTaint: options.allowTaint, imageTimeout: options.imageTimeout / 2});\n    }).then(function(canvas) {\n        return self.image = canvas;\n    });\n}\n\nFrameContainer.prototype.proxyLoad = function(proxy, bounds, options) {\n    var container = this.src;\n    return loadUrlDocument(container.src, proxy, container.ownerDocument, bounds.width, bounds.height, options);\n};\n\nmodule.exports = FrameContainer;\n\n},{\"./core\":4,\"./proxy\":16,\"./utils\":26}],9:[function(_dereq_,module,exports){\nfunction GradientContainer(imageData) {\n    this.src = imageData.value;\n    this.colorStops = [];\n    this.type = null;\n    this.x0 = 0.5;\n    this.y0 = 0.5;\n    this.x1 = 0.5;\n    this.y1 = 0.5;\n    this.promise = Promise.resolve(true);\n}\n\nGradientContainer.TYPES = {\n    LINEAR: 1,\n    RADIAL: 2\n};\n\n// TODO: support hsl[a], negative %/length values\n// TODO: support <angle> (e.g. -?\\d{1,3}(?:\\.\\d+)deg, etc. : https://developer.mozilla.org/docs/Web/CSS/angle )\nGradientContainer.REGEXP_COLORSTOP = /^\\s*(rgba?\\(\\s*\\d{1,3},\\s*\\d{1,3},\\s*\\d{1,3}(?:,\\s*[0-9\\.]+)?\\s*\\)|[a-z]{3,20}|#[a-f0-9]{3,6})(?:\\s+(\\d{1,3}(?:\\.\\d+)?)(%|px)?)?(?:\\s|$)/i;\n\nmodule.exports = GradientContainer;\n\n},{}],10:[function(_dereq_,module,exports){\nfunction ImageContainer(src, cors) {\n    this.src = src;\n    this.image = new Image();\n    var self = this;\n    this.tainted = null;\n    this.promise = new Promise(function(resolve, reject) {\n        self.image.onload = resolve;\n        self.image.onerror = reject;\n        if (cors) {\n            self.image.crossOrigin = \"anonymous\";\n        }\n        self.image.src = src;\n        if (self.image.complete === true) {\n            resolve(self.image);\n        }\n    });\n}\n\nmodule.exports = ImageContainer;\n\n},{}],11:[function(_dereq_,module,exports){\nvar log = _dereq_('./log');\nvar ImageContainer = _dereq_('./imagecontainer');\nvar DummyImageContainer = _dereq_('./dummyimagecontainer');\nvar ProxyImageContainer = _dereq_('./proxyimagecontainer');\nvar FrameContainer = _dereq_('./framecontainer');\nvar SVGContainer = _dereq_('./svgcontainer');\nvar SVGNodeContainer = _dereq_('./svgnodecontainer');\nvar LinearGradientContainer = _dereq_('./lineargradientcontainer');\nvar WebkitGradientContainer = _dereq_('./webkitgradientcontainer');\nvar bind = _dereq_('./utils').bind;\n\nfunction ImageLoader(options, support) {\n    this.link = null;\n    this.options = options;\n    this.support = support;\n    this.origin = this.getOrigin(window.location.href);\n}\n\nImageLoader.prototype.findImages = function(nodes) {\n    var images = [];\n    nodes.reduce(function(imageNodes, container) {\n        switch(container.node.nodeName) {\n        case \"IMG\":\n            return imageNodes.concat([{\n                args: [container.node.src],\n                method: \"url\"\n            }]);\n        case \"svg\":\n        case \"IFRAME\":\n            return imageNodes.concat([{\n                args: [container.node],\n                method: container.node.nodeName\n            }]);\n        }\n        return imageNodes;\n    }, []).forEach(this.addImage(images, this.loadImage), this);\n    return images;\n};\n\nImageLoader.prototype.findBackgroundImage = function(images, container) {\n    container.parseBackgroundImages().filter(this.hasImageBackground).forEach(this.addImage(images, this.loadImage), this);\n    return images;\n};\n\nImageLoader.prototype.addImage = function(images, callback) {\n    return function(newImage) {\n        newImage.args.forEach(function(image) {\n            if (!this.imageExists(images, image)) {\n                images.splice(0, 0, callback.call(this, newImage));\n                log('Added image #' + (images.length), typeof(image) === \"string\" ? image.substring(0, 100) : image);\n            }\n        }, this);\n    };\n};\n\nImageLoader.prototype.hasImageBackground = function(imageData) {\n    return imageData.method !== \"none\";\n};\n\nImageLoader.prototype.loadImage = function(imageData) {\n    if (imageData.method === \"url\") {\n        var src = imageData.args[0];\n        if (this.isSVG(src) && !this.support.svg && !this.options.allowTaint) {\n            return new SVGContainer(src);\n        } else if (src.match(/data:image\\/.*;base64,/i)) {\n            return new ImageContainer(src.replace(/url\\(['\"]{0,}|['\"]{0,}\\)$/ig, ''), false);\n        } else if (this.isSameOrigin(src) || this.options.allowTaint === true || this.isSVG(src)) {\n            return new ImageContainer(src, false);\n        } else if (this.support.cors && !this.options.allowTaint && this.options.useCORS) {\n            return new ImageContainer(src, true);\n        } else if (this.options.proxy) {\n            return new ProxyImageContainer(src, this.options.proxy);\n        } else {\n            return new DummyImageContainer(src);\n        }\n    } else if (imageData.method === \"linear-gradient\") {\n        return new LinearGradientContainer(imageData);\n    } else if (imageData.method === \"gradient\") {\n        return new WebkitGradientContainer(imageData);\n    } else if (imageData.method === \"svg\") {\n        return new SVGNodeContainer(imageData.args[0], this.support.svg);\n    } else if (imageData.method === \"IFRAME\") {\n        return new FrameContainer(imageData.args[0], this.isSameOrigin(imageData.args[0].src), this.options);\n    } else {\n        return new DummyImageContainer(imageData);\n    }\n};\n\nImageLoader.prototype.isSVG = function(src) {\n    return src.substring(src.length - 3).toLowerCase() === \"svg\" || SVGContainer.prototype.isInline(src);\n};\n\nImageLoader.prototype.imageExists = function(images, src) {\n    return images.some(function(image) {\n        return image.src === src;\n    });\n};\n\nImageLoader.prototype.isSameOrigin = function(url) {\n    return (this.getOrigin(url) === this.origin);\n};\n\nImageLoader.prototype.getOrigin = function(url) {\n    var link = this.link || (this.link = document.createElement(\"a\"));\n    link.href = url;\n    link.href = link.href; // IE9, LOL! - http://jsfiddle.net/niklasvh/2e48b/\n    return link.protocol + link.hostname + link.port;\n};\n\nImageLoader.prototype.getPromise = function(container) {\n    return this.timeout(container, this.options.imageTimeout)['catch'](function() {\n        var dummy = new DummyImageContainer(container.src);\n        return dummy.promise.then(function(image) {\n            container.image = image;\n        });\n    });\n};\n\nImageLoader.prototype.get = function(src) {\n    var found = null;\n    return this.images.some(function(img) {\n        return (found = img).src === src;\n    }) ? found : null;\n};\n\nImageLoader.prototype.fetch = function(nodes) {\n    this.images = nodes.reduce(bind(this.findBackgroundImage, this), this.findImages(nodes));\n    this.images.forEach(function(image, index) {\n        image.promise.then(function() {\n            log(\"Succesfully loaded image #\"+ (index+1), image);\n        }, function(e) {\n            log(\"Failed loading image #\"+ (index+1), image, e);\n        });\n    });\n    this.ready = Promise.all(this.images.map(this.getPromise, this));\n    log(\"Finished searching images\");\n    return this;\n};\n\nImageLoader.prototype.timeout = function(container, timeout) {\n    var timer;\n    var promise = Promise.race([container.promise, new Promise(function(res, reject) {\n        timer = setTimeout(function() {\n            log(\"Timed out loading image\", container);\n            reject(container);\n        }, timeout);\n    })]).then(function(container) {\n        clearTimeout(timer);\n        return container;\n    });\n    promise['catch'](function() {\n        clearTimeout(timer);\n    });\n    return promise;\n};\n\nmodule.exports = ImageLoader;\n\n},{\"./dummyimagecontainer\":5,\"./framecontainer\":8,\"./imagecontainer\":10,\"./lineargradientcontainer\":12,\"./log\":13,\"./proxyimagecontainer\":17,\"./svgcontainer\":23,\"./svgnodecontainer\":24,\"./utils\":26,\"./webkitgradientcontainer\":27}],12:[function(_dereq_,module,exports){\nvar GradientContainer = _dereq_('./gradientcontainer');\nvar Color = _dereq_('./color');\n\nfunction LinearGradientContainer(imageData) {\n    GradientContainer.apply(this, arguments);\n    this.type = GradientContainer.TYPES.LINEAR;\n\n    var hasDirection = LinearGradientContainer.REGEXP_DIRECTION.test( imageData.args[0] ) ||\n        !GradientContainer.REGEXP_COLORSTOP.test( imageData.args[0] );\n\n    if (hasDirection) {\n        imageData.args[0].split(/\\s+/).reverse().forEach(function(position, index) {\n            switch(position) {\n            case \"left\":\n                this.x0 = 0;\n                this.x1 = 1;\n                break;\n            case \"top\":\n                this.y0 = 0;\n                this.y1 = 1;\n                break;\n            case \"right\":\n                this.x0 = 1;\n                this.x1 = 0;\n                break;\n            case \"bottom\":\n                this.y0 = 1;\n                this.y1 = 0;\n                break;\n            case \"to\":\n                var y0 = this.y0;\n                var x0 = this.x0;\n                this.y0 = this.y1;\n                this.x0 = this.x1;\n                this.x1 = x0;\n                this.y1 = y0;\n                break;\n            case \"center\":\n                break; // centered by default\n            // Firefox internally converts position keywords to percentages:\n            // http://www.w3.org/TR/2010/WD-CSS2-20101207/colors.html#propdef-background-position\n            default: // percentage or absolute length\n                // TODO: support absolute start point positions (e.g., use bounds to convert px to a ratio)\n                var ratio = parseFloat(position, 10) * 1e-2;\n                if (isNaN(ratio)) { // invalid or unhandled value\n                    break;\n                }\n                if (index === 0) {\n                    this.y0 = ratio;\n                    this.y1 = 1 - this.y0;\n                } else {\n                    this.x0 = ratio;\n                    this.x1 = 1 - this.x0;\n                }\n                break;\n            }\n        }, this);\n    } else {\n        this.y0 = 0;\n        this.y1 = 1;\n    }\n\n    this.colorStops = imageData.args.slice(hasDirection ? 1 : 0).map(function(colorStop) {\n        var colorStopMatch = colorStop.match(GradientContainer.REGEXP_COLORSTOP);\n        var value = +colorStopMatch[2];\n        var unit = value === 0 ? \"%\" : colorStopMatch[3]; // treat \"0\" as \"0%\"\n        return {\n            color: new Color(colorStopMatch[1]),\n            // TODO: support absolute stop positions (e.g., compute gradient line length & convert px to ratio)\n            stop: unit === \"%\" ? value / 100 : null\n        };\n    });\n\n    if (this.colorStops[0].stop === null) {\n        this.colorStops[0].stop = 0;\n    }\n\n    if (this.colorStops[this.colorStops.length - 1].stop === null) {\n        this.colorStops[this.colorStops.length - 1].stop = 1;\n    }\n\n    // calculates and fills-in explicit stop positions when omitted from rule\n    this.colorStops.forEach(function(colorStop, index) {\n        if (colorStop.stop === null) {\n            this.colorStops.slice(index).some(function(find, count) {\n                if (find.stop !== null) {\n                    colorStop.stop = ((find.stop - this.colorStops[index - 1].stop) / (count + 1)) + this.colorStops[index - 1].stop;\n                    return true;\n                } else {\n                    return false;\n                }\n            }, this);\n        }\n    }, this);\n}\n\nLinearGradientContainer.prototype = Object.create(GradientContainer.prototype);\n\n// TODO: support <angle> (e.g. -?\\d{1,3}(?:\\.\\d+)deg, etc. : https://developer.mozilla.org/docs/Web/CSS/angle )\nLinearGradientContainer.REGEXP_DIRECTION = /^\\s*(?:to|left|right|top|bottom|center|\\d{1,3}(?:\\.\\d+)?%?)(?:\\s|$)/i;\n\nmodule.exports = LinearGradientContainer;\n\n},{\"./color\":3,\"./gradientcontainer\":9}],13:[function(_dereq_,module,exports){\nvar logger = function() {\n    if (logger.options.logging && window.console && window.console.log) {\n        Function.prototype.bind.call(window.console.log, (window.console)).apply(window.console, [(Date.now() - logger.options.start) + \"ms\", \"html2canvas:\"].concat([].slice.call(arguments, 0)));\n    }\n};\n\nlogger.options = {logging: false};\nmodule.exports = logger;\n\n},{}],14:[function(_dereq_,module,exports){\nvar Color = _dereq_('./color');\nvar utils = _dereq_('./utils');\nvar getBounds = utils.getBounds;\nvar parseBackgrounds = utils.parseBackgrounds;\nvar offsetBounds = utils.offsetBounds;\n\nfunction NodeContainer(node, parent) {\n    this.node = node;\n    this.parent = parent;\n    this.stack = null;\n    this.bounds = null;\n    this.borders = null;\n    this.clip = [];\n    this.backgroundClip = [];\n    this.offsetBounds = null;\n    this.visible = null;\n    this.computedStyles = null;\n    this.colors = {};\n    this.styles = {};\n    this.backgroundImages = null;\n    this.transformData = null;\n    this.transformMatrix = null;\n    this.isPseudoElement = false;\n    this.opacity = null;\n}\n\nNodeContainer.prototype.cloneTo = function(stack) {\n    stack.visible = this.visible;\n    stack.borders = this.borders;\n    stack.bounds = this.bounds;\n    stack.clip = this.clip;\n    stack.backgroundClip = this.backgroundClip;\n    stack.computedStyles = this.computedStyles;\n    stack.styles = this.styles;\n    stack.backgroundImages = this.backgroundImages;\n    stack.opacity = this.opacity;\n};\n\nNodeContainer.prototype.getOpacity = function() {\n    return this.opacity === null ? (this.opacity = this.cssFloat('opacity')) : this.opacity;\n};\n\nNodeContainer.prototype.assignStack = function(stack) {\n    this.stack = stack;\n    stack.children.push(this);\n};\n\nNodeContainer.prototype.isElementVisible = function() {\n    return this.node.nodeType === Node.TEXT_NODE ? this.parent.visible : (\n        this.css('display') !== \"none\" &&\n        this.css('visibility') !== \"hidden\" &&\n        !this.node.hasAttribute(\"data-html2canvas-ignore\") &&\n        (this.node.nodeName !== \"INPUT\" || this.node.getAttribute(\"type\") !== \"hidden\")\n    );\n};\n\nNodeContainer.prototype.css = function(attribute) {\n    if (!this.computedStyles) {\n        this.computedStyles = this.isPseudoElement ? this.parent.computedStyle(this.before ? \":before\" : \":after\") : this.computedStyle(null);\n    }\n\n    return this.styles[attribute] || (this.styles[attribute] = this.computedStyles[attribute]);\n};\n\nNodeContainer.prototype.prefixedCss = function(attribute) {\n    var prefixes = [\"webkit\", \"moz\", \"ms\", \"o\"];\n    var value = this.css(attribute);\n    if (value === undefined) {\n        prefixes.some(function(prefix) {\n            value = this.css(prefix + attribute.substr(0, 1).toUpperCase() + attribute.substr(1));\n            return value !== undefined;\n        }, this);\n    }\n    return value === undefined ? null : value;\n};\n\nNodeContainer.prototype.computedStyle = function(type) {\n    return this.node.ownerDocument.defaultView.getComputedStyle(this.node, type);\n};\n\nNodeContainer.prototype.cssInt = function(attribute) {\n    var value = parseInt(this.css(attribute), 10);\n    return (isNaN(value)) ? 0 : value; // borders in old IE are throwing 'medium' for demo.html\n};\n\nNodeContainer.prototype.color = function(attribute) {\n    return this.colors[attribute] || (this.colors[attribute] = new Color(this.css(attribute)));\n};\n\nNodeContainer.prototype.cssFloat = function(attribute) {\n    var value = parseFloat(this.css(attribute));\n    return (isNaN(value)) ? 0 : value;\n};\n\nNodeContainer.prototype.fontWeight = function() {\n    var weight = this.css(\"fontWeight\");\n    switch(parseInt(weight, 10)){\n    case 401:\n        weight = \"bold\";\n        break;\n    case 400:\n        weight = \"normal\";\n        break;\n    }\n    return weight;\n};\n\nNodeContainer.prototype.parseClip = function() {\n    var matches = this.css('clip').match(this.CLIP);\n    if (matches) {\n        return {\n            top: parseInt(matches[1], 10),\n            right: parseInt(matches[2], 10),\n            bottom: parseInt(matches[3], 10),\n            left: parseInt(matches[4], 10)\n        };\n    }\n    return null;\n};\n\nNodeContainer.prototype.parseBackgroundImages = function() {\n    return this.backgroundImages || (this.backgroundImages = parseBackgrounds(this.css(\"backgroundImage\")));\n};\n\nNodeContainer.prototype.cssList = function(property, index) {\n    var value = (this.css(property) || '').split(',');\n    value = value[index || 0] || value[0] || 'auto';\n    value = value.trim().split(' ');\n    if (value.length === 1) {\n        value = [value[0], isPercentage(value[0]) ? 'auto' : value[0]];\n    }\n    return value;\n};\n\nNodeContainer.prototype.parseBackgroundSize = function(bounds, image, index) {\n    var size = this.cssList(\"backgroundSize\", index);\n    var width, height;\n\n    if (isPercentage(size[0])) {\n        width = bounds.width * parseFloat(size[0]) / 100;\n    } else if (/contain|cover/.test(size[0])) {\n        var targetRatio = bounds.width / bounds.height, currentRatio = image.width / image.height;\n        return (targetRatio < currentRatio ^ size[0] === 'contain') ?  {width: bounds.height * currentRatio, height: bounds.height} : {width: bounds.width, height: bounds.width / currentRatio};\n    } else {\n        width = parseInt(size[0], 10);\n    }\n\n    if (size[0] === 'auto' && size[1] === 'auto') {\n        height = image.height;\n    } else if (size[1] === 'auto') {\n        height = width / image.width * image.height;\n    } else if (isPercentage(size[1])) {\n        height =  bounds.height * parseFloat(size[1]) / 100;\n    } else {\n        height = parseInt(size[1], 10);\n    }\n\n    if (size[0] === 'auto') {\n        width = height / image.height * image.width;\n    }\n\n    return {width: width, height: height};\n};\n\nNodeContainer.prototype.parseBackgroundPosition = function(bounds, image, index, backgroundSize) {\n    var position = this.cssList('backgroundPosition', index);\n    var left, top;\n\n    if (isPercentage(position[0])){\n        left = (bounds.width - (backgroundSize || image).width) * (parseFloat(position[0]) / 100);\n    } else {\n        left = parseInt(position[0], 10);\n    }\n\n    if (position[1] === 'auto') {\n        top = left / image.width * image.height;\n    } else if (isPercentage(position[1])){\n        top =  (bounds.height - (backgroundSize || image).height) * parseFloat(position[1]) / 100;\n    } else {\n        top = parseInt(position[1], 10);\n    }\n\n    if (position[0] === 'auto') {\n        left = top / image.height * image.width;\n    }\n\n    return {left: left, top: top};\n};\n\nNodeContainer.prototype.parseBackgroundRepeat = function(index) {\n    return this.cssList(\"backgroundRepeat\", index)[0];\n};\n\nNodeContainer.prototype.parseTextShadows = function() {\n    var textShadow = this.css(\"textShadow\");\n    var results = [];\n\n    if (textShadow && textShadow !== 'none') {\n        var shadows = textShadow.match(this.TEXT_SHADOW_PROPERTY);\n        for (var i = 0; shadows && (i < shadows.length); i++) {\n            var s = shadows[i].match(this.TEXT_SHADOW_VALUES);\n            results.push({\n                color: new Color(s[0]),\n                offsetX: s[1] ? parseFloat(s[1].replace('px', '')) : 0,\n                offsetY: s[2] ? parseFloat(s[2].replace('px', '')) : 0,\n                blur: s[3] ? s[3].replace('px', '') : 0\n            });\n        }\n    }\n    return results;\n};\n\nNodeContainer.prototype.parseTransform = function() {\n    if (!this.transformData) {\n        if (this.hasTransform()) {\n            var offset = this.parseBounds();\n            var origin = this.prefixedCss(\"transformOrigin\").split(\" \").map(removePx).map(asFloat);\n            origin[0] += offset.left;\n            origin[1] += offset.top;\n            this.transformData = {\n                origin: origin,\n                matrix: this.parseTransformMatrix()\n            };\n        } else {\n            this.transformData = {\n                origin: [0, 0],\n                matrix: [1, 0, 0, 1, 0, 0]\n            };\n        }\n    }\n    return this.transformData;\n};\n\nNodeContainer.prototype.parseTransformMatrix = function() {\n    if (!this.transformMatrix) {\n        var transform = this.prefixedCss(\"transform\");\n        var matrix = transform ? parseMatrix(transform.match(this.MATRIX_PROPERTY)) : null;\n        this.transformMatrix = matrix ? matrix : [1, 0, 0, 1, 0, 0];\n    }\n    return this.transformMatrix;\n};\n\nNodeContainer.prototype.parseBounds = function() {\n    return this.bounds || (this.bounds = this.hasTransform() ? offsetBounds(this.node) : getBounds(this.node));\n};\n\nNodeContainer.prototype.hasTransform = function() {\n    return this.parseTransformMatrix().join(\",\") !== \"1,0,0,1,0,0\" || (this.parent && this.parent.hasTransform());\n};\n\nNodeContainer.prototype.getValue = function() {\n    var value = this.node.value || \"\";\n    if (this.node.tagName === \"SELECT\") {\n        value = selectionValue(this.node);\n    } else if (this.node.type === \"password\") {\n        value = Array(value.length + 1).join('\\u2022'); // jshint ignore:line\n    }\n    return value.length === 0 ? (this.node.placeholder || \"\") : value;\n};\n\nNodeContainer.prototype.MATRIX_PROPERTY = /(matrix|matrix3d)\\((.+)\\)/;\nNodeContainer.prototype.TEXT_SHADOW_PROPERTY = /((rgba|rgb)\\([^\\)]+\\)(\\s-?\\d+px){0,})/g;\nNodeContainer.prototype.TEXT_SHADOW_VALUES = /(-?\\d+px)|(#.+)|(rgb\\(.+\\))|(rgba\\(.+\\))/g;\nNodeContainer.prototype.CLIP = /^rect\\((\\d+)px,? (\\d+)px,? (\\d+)px,? (\\d+)px\\)$/;\n\nfunction selectionValue(node) {\n    var option = node.options[node.selectedIndex || 0];\n    return option ? (option.text || \"\") : \"\";\n}\n\nfunction parseMatrix(match) {\n    if (match && match[1] === \"matrix\") {\n        return match[2].split(\",\").map(function(s) {\n            return parseFloat(s.trim());\n        });\n    } else if (match && match[1] === \"matrix3d\") {\n        var matrix3d = match[2].split(\",\").map(function(s) {\n          return parseFloat(s.trim());\n        });\n        return [matrix3d[0], matrix3d[1], matrix3d[4], matrix3d[5], matrix3d[12], matrix3d[13]];\n    }\n}\n\nfunction isPercentage(value) {\n    return value.toString().indexOf(\"%\") !== -1;\n}\n\nfunction removePx(str) {\n    return str.replace(\"px\", \"\");\n}\n\nfunction asFloat(str) {\n    return parseFloat(str);\n}\n\nmodule.exports = NodeContainer;\n\n},{\"./color\":3,\"./utils\":26}],15:[function(_dereq_,module,exports){\nvar log = _dereq_('./log');\nvar punycode = _dereq_('punycode');\nvar NodeContainer = _dereq_('./nodecontainer');\nvar TextContainer = _dereq_('./textcontainer');\nvar PseudoElementContainer = _dereq_('./pseudoelementcontainer');\nvar FontMetrics = _dereq_('./fontmetrics');\nvar Color = _dereq_('./color');\nvar StackingContext = _dereq_('./stackingcontext');\nvar utils = _dereq_('./utils');\nvar bind = utils.bind;\nvar getBounds = utils.getBounds;\nvar parseBackgrounds = utils.parseBackgrounds;\nvar offsetBounds = utils.offsetBounds;\n\nfunction NodeParser(element, renderer, support, imageLoader, options) {\n    log(\"Starting NodeParser\");\n    this.renderer = renderer;\n    this.options = options;\n    this.range = null;\n    this.support = support;\n    this.renderQueue = [];\n    this.stack = new StackingContext(true, 1, element.ownerDocument, null);\n    var parent = new NodeContainer(element, null);\n    if (options.background) {\n        renderer.rectangle(0, 0, renderer.width, renderer.height, new Color(options.background));\n    }\n    if (element === element.ownerDocument.documentElement) {\n        // http://www.w3.org/TR/css3-background/#special-backgrounds\n        var canvasBackground = new NodeContainer(parent.color('backgroundColor').isTransparent() ? element.ownerDocument.body : element.ownerDocument.documentElement, null);\n        renderer.rectangle(0, 0, renderer.width, renderer.height, canvasBackground.color('backgroundColor'));\n    }\n    parent.visibile = parent.isElementVisible();\n    this.createPseudoHideStyles(element.ownerDocument);\n    this.disableAnimations(element.ownerDocument);\n    this.nodes = flatten([parent].concat(this.getChildren(parent)).filter(function(container) {\n        return container.visible = container.isElementVisible();\n    }).map(this.getPseudoElements, this));\n    this.fontMetrics = new FontMetrics();\n    log(\"Fetched nodes, total:\", this.nodes.length);\n    log(\"Calculate overflow clips\");\n    this.calculateOverflowClips();\n    log(\"Start fetching images\");\n    this.images = imageLoader.fetch(this.nodes.filter(isElement));\n    this.ready = this.images.ready.then(bind(function() {\n        log(\"Images loaded, starting parsing\");\n        log(\"Creating stacking contexts\");\n        this.createStackingContexts();\n        log(\"Sorting stacking contexts\");\n        this.sortStackingContexts(this.stack);\n        this.parse(this.stack);\n        log(\"Render queue created with \" + this.renderQueue.length + \" items\");\n        return new Promise(bind(function(resolve) {\n            if (!options.async) {\n                this.renderQueue.forEach(this.paint, this);\n                resolve();\n            } else if (typeof(options.async) === \"function\") {\n                options.async.call(this, this.renderQueue, resolve);\n            } else if (this.renderQueue.length > 0){\n                this.renderIndex = 0;\n                this.asyncRenderer(this.renderQueue, resolve);\n            } else {\n                resolve();\n            }\n        }, this));\n    }, this));\n}\n\nNodeParser.prototype.calculateOverflowClips = function() {\n    this.nodes.forEach(function(container) {\n        if (isElement(container)) {\n            if (isPseudoElement(container)) {\n                container.appendToDOM();\n            }\n            container.borders = this.parseBorders(container);\n            var clip = (container.css('overflow') === \"hidden\") ? [container.borders.clip] : [];\n            var cssClip = container.parseClip();\n            if (cssClip && [\"absolute\", \"fixed\"].indexOf(container.css('position')) !== -1) {\n                clip.push([[\"rect\",\n                        container.bounds.left + cssClip.left,\n                        container.bounds.top + cssClip.top,\n                        cssClip.right - cssClip.left,\n                        cssClip.bottom - cssClip.top\n                ]]);\n            }\n            container.clip = hasParentClip(container) ? container.parent.clip.concat(clip) : clip;\n            container.backgroundClip = (container.css('overflow') !== \"hidden\") ? container.clip.concat([container.borders.clip]) : container.clip;\n            if (isPseudoElement(container)) {\n                container.cleanDOM();\n            }\n        } else if (isTextNode(container)) {\n            container.clip = hasParentClip(container) ? container.parent.clip : [];\n        }\n        if (!isPseudoElement(container)) {\n            container.bounds = null;\n        }\n    }, this);\n};\n\nfunction hasParentClip(container) {\n    return container.parent && container.parent.clip.length;\n}\n\nNodeParser.prototype.asyncRenderer = function(queue, resolve, asyncTimer) {\n    asyncTimer = asyncTimer || Date.now();\n    this.paint(queue[this.renderIndex++]);\n    if (queue.length === this.renderIndex) {\n        resolve();\n    } else if (asyncTimer + 20 > Date.now()) {\n        this.asyncRenderer(queue, resolve, asyncTimer);\n    } else {\n        setTimeout(bind(function() {\n            this.asyncRenderer(queue, resolve);\n        }, this), 0);\n    }\n};\n\nNodeParser.prototype.createPseudoHideStyles = function(document) {\n    this.createStyles(document, '.' + PseudoElementContainer.prototype.PSEUDO_HIDE_ELEMENT_CLASS_BEFORE + ':before { content: \"\" !important; display: none !important; }' +\n        '.' + PseudoElementContainer.prototype.PSEUDO_HIDE_ELEMENT_CLASS_AFTER + ':after { content: \"\" !important; display: none !important; }');\n};\n\nNodeParser.prototype.disableAnimations = function(document) {\n    this.createStyles(document, '* { -webkit-animation: none !important; -moz-animation: none !important; -o-animation: none !important; animation: none !important; ' +\n        '-webkit-transition: none !important; -moz-transition: none !important; -o-transition: none !important; transition: none !important;}');\n};\n\nNodeParser.prototype.createStyles = function(document, styles) {\n    var hidePseudoElements = document.createElement('style');\n    hidePseudoElements.innerHTML = styles;\n    document.body.appendChild(hidePseudoElements);\n};\n\nNodeParser.prototype.getPseudoElements = function(container) {\n    var nodes = [[container]];\n    if (container.node.nodeType === Node.ELEMENT_NODE) {\n        var before = this.getPseudoElement(container, \":before\");\n        var after = this.getPseudoElement(container, \":after\");\n\n        if (before) {\n            nodes.push(before);\n        }\n\n        if (after) {\n            nodes.push(after);\n        }\n    }\n    return flatten(nodes);\n};\n\nfunction toCamelCase(str) {\n    return str.replace(/(\\-[a-z])/g, function(match){\n        return match.toUpperCase().replace('-','');\n    });\n}\n\nNodeParser.prototype.getPseudoElement = function(container, type) {\n    var style = container.computedStyle(type);\n    if(!style || !style.content || style.content === \"none\" || style.content === \"-moz-alt-content\" || style.display === \"none\") {\n        return null;\n    }\n\n    var content = stripQuotes(style.content);\n    var isImage = content.substr(0, 3) === 'url';\n    var pseudoNode = document.createElement(isImage ? 'img' : 'html2canvaspseudoelement');\n    var pseudoContainer = new PseudoElementContainer(pseudoNode, container, type);\n\n    for (var i = style.length-1; i >= 0; i--) {\n        var property = toCamelCase(style.item(i));\n        pseudoNode.style[property] = style[property];\n    }\n\n    pseudoNode.className = PseudoElementContainer.prototype.PSEUDO_HIDE_ELEMENT_CLASS_BEFORE + \" \" + PseudoElementContainer.prototype.PSEUDO_HIDE_ELEMENT_CLASS_AFTER;\n\n    if (isImage) {\n        pseudoNode.src = parseBackgrounds(content)[0].args[0];\n        return [pseudoContainer];\n    } else {\n        var text = document.createTextNode(content);\n        pseudoNode.appendChild(text);\n        return [pseudoContainer, new TextContainer(text, pseudoContainer)];\n    }\n};\n\n\nNodeParser.prototype.getChildren = function(parentContainer) {\n    return flatten([].filter.call(parentContainer.node.childNodes, renderableNode).map(function(node) {\n        var container = [node.nodeType === Node.TEXT_NODE ? new TextContainer(node, parentContainer) : new NodeContainer(node, parentContainer)].filter(nonIgnoredElement);\n        return node.nodeType === Node.ELEMENT_NODE && container.length && node.tagName !== \"TEXTAREA\" ? (container[0].isElementVisible() ? container.concat(this.getChildren(container[0])) : []) : container;\n    }, this));\n};\n\nNodeParser.prototype.newStackingContext = function(container, hasOwnStacking) {\n    var stack = new StackingContext(hasOwnStacking, container.getOpacity(), container.node, container.parent);\n    container.cloneTo(stack);\n    var parentStack = hasOwnStacking ? stack.getParentStack(this) : stack.parent.stack;\n    parentStack.contexts.push(stack);\n    container.stack = stack;\n};\n\nNodeParser.prototype.createStackingContexts = function() {\n    this.nodes.forEach(function(container) {\n        if (isElement(container) && (this.isRootElement(container) || hasOpacity(container) || isPositionedForStacking(container) || this.isBodyWithTransparentRoot(container) || container.hasTransform())) {\n            this.newStackingContext(container, true);\n        } else if (isElement(container) && ((isPositioned(container) && zIndex0(container)) || isInlineBlock(container) || isFloating(container))) {\n            this.newStackingContext(container, false);\n        } else {\n            container.assignStack(container.parent.stack);\n        }\n    }, this);\n};\n\nNodeParser.prototype.isBodyWithTransparentRoot = function(container) {\n    return container.node.nodeName === \"BODY\" && container.parent.color('backgroundColor').isTransparent();\n};\n\nNodeParser.prototype.isRootElement = function(container) {\n    return container.parent === null;\n};\n\nNodeParser.prototype.sortStackingContexts = function(stack) {\n    stack.contexts.sort(zIndexSort(stack.contexts.slice(0)));\n    stack.contexts.forEach(this.sortStackingContexts, this);\n};\n\nNodeParser.prototype.parseTextBounds = function(container) {\n    return function(text, index, textList) {\n        if (container.parent.css(\"textDecoration\").substr(0, 4) !== \"none\" || text.trim().length !== 0) {\n            if (this.support.rangeBounds && !container.parent.hasTransform()) {\n                var offset = textList.slice(0, index).join(\"\").length;\n                return this.getRangeBounds(container.node, offset, text.length);\n            } else if (container.node && typeof(container.node.data) === \"string\") {\n                var replacementNode = container.node.splitText(text.length);\n                var bounds = this.getWrapperBounds(container.node, container.parent.hasTransform());\n                container.node = replacementNode;\n                return bounds;\n            }\n        } else if(!this.support.rangeBounds || container.parent.hasTransform()){\n            container.node = container.node.splitText(text.length);\n        }\n        return {};\n    };\n};\n\nNodeParser.prototype.getWrapperBounds = function(node, transform) {\n    var wrapper = node.ownerDocument.createElement('html2canvaswrapper');\n    var parent = node.parentNode,\n        backupText = node.cloneNode(true);\n\n    wrapper.appendChild(node.cloneNode(true));\n    parent.replaceChild(wrapper, node);\n    var bounds = transform ? offsetBounds(wrapper) : getBounds(wrapper);\n    parent.replaceChild(backupText, wrapper);\n    return bounds;\n};\n\nNodeParser.prototype.getRangeBounds = function(node, offset, length) {\n    var range = this.range || (this.range = node.ownerDocument.createRange());\n    range.setStart(node, offset);\n    range.setEnd(node, offset + length);\n    return range.getBoundingClientRect();\n};\n\nfunction ClearTransform() {}\n\nNodeParser.prototype.parse = function(stack) {\n    // http://www.w3.org/TR/CSS21/visuren.html#z-index\n    var negativeZindex = stack.contexts.filter(negativeZIndex); // 2. the child stacking contexts with negative stack levels (most negative first).\n    var descendantElements = stack.children.filter(isElement);\n    var descendantNonFloats = descendantElements.filter(not(isFloating));\n    var nonInlineNonPositionedDescendants = descendantNonFloats.filter(not(isPositioned)).filter(not(inlineLevel)); // 3 the in-flow, non-inline-level, non-positioned descendants.\n    var nonPositionedFloats = descendantElements.filter(not(isPositioned)).filter(isFloating); // 4. the non-positioned floats.\n    var inFlow = descendantNonFloats.filter(not(isPositioned)).filter(inlineLevel); // 5. the in-flow, inline-level, non-positioned descendants, including inline tables and inline blocks.\n    var stackLevel0 = stack.contexts.concat(descendantNonFloats.filter(isPositioned)).filter(zIndex0); // 6. the child stacking contexts with stack level 0 and the positioned descendants with stack level 0.\n    var text = stack.children.filter(isTextNode).filter(hasText);\n    var positiveZindex = stack.contexts.filter(positiveZIndex); // 7. the child stacking contexts with positive stack levels (least positive first).\n    negativeZindex.concat(nonInlineNonPositionedDescendants).concat(nonPositionedFloats)\n        .concat(inFlow).concat(stackLevel0).concat(text).concat(positiveZindex).forEach(function(container) {\n            this.renderQueue.push(container);\n            if (isStackingContext(container)) {\n                this.parse(container);\n                this.renderQueue.push(new ClearTransform());\n            }\n        }, this);\n};\n\nNodeParser.prototype.paint = function(container) {\n    try {\n        if (container instanceof ClearTransform) {\n            this.renderer.ctx.restore();\n        } else if (isTextNode(container)) {\n            if (isPseudoElement(container.parent)) {\n                container.parent.appendToDOM();\n            }\n            this.paintText(container);\n            if (isPseudoElement(container.parent)) {\n                container.parent.cleanDOM();\n            }\n        } else {\n            this.paintNode(container);\n        }\n    } catch(e) {\n        log(e);\n        if (this.options.strict) {\n            throw e;\n        }\n    }\n};\n\nNodeParser.prototype.paintNode = function(container) {\n    if (isStackingContext(container)) {\n        this.renderer.setOpacity(container.opacity);\n        this.renderer.ctx.save();\n        if (container.hasTransform()) {\n            this.renderer.setTransform(container.parseTransform());\n        }\n    }\n\n    if (container.node.nodeName === \"INPUT\" && container.node.type === \"checkbox\") {\n        this.paintCheckbox(container);\n    } else if (container.node.nodeName === \"INPUT\" && container.node.type === \"radio\") {\n        this.paintRadio(container);\n    } else {\n        this.paintElement(container);\n    }\n};\n\nNodeParser.prototype.paintElement = function(container) {\n    var bounds = container.parseBounds();\n    this.renderer.clip(container.backgroundClip, function() {\n        this.renderer.renderBackground(container, bounds, container.borders.borders.map(getWidth));\n    }, this);\n\n    this.renderer.clip(container.clip, function() {\n        this.renderer.renderBorders(container.borders.borders);\n    }, this);\n\n    this.renderer.clip(container.backgroundClip, function() {\n        switch (container.node.nodeName) {\n        case \"svg\":\n        case \"IFRAME\":\n            var imgContainer = this.images.get(container.node);\n            if (imgContainer) {\n                this.renderer.renderImage(container, bounds, container.borders, imgContainer);\n            } else {\n                log(\"Error loading <\" + container.node.nodeName + \">\", container.node);\n            }\n            break;\n        case \"IMG\":\n            var imageContainer = this.images.get(container.node.src);\n            if (imageContainer) {\n                this.renderer.renderImage(container, bounds, container.borders, imageContainer);\n            } else {\n                log(\"Error loading <img>\", container.node.src);\n            }\n            break;\n        case \"CANVAS\":\n            this.renderer.renderImage(container, bounds, container.borders, {image: container.node});\n            break;\n        case \"SELECT\":\n        case \"INPUT\":\n        case \"TEXTAREA\":\n            this.paintFormValue(container);\n            break;\n        }\n    }, this);\n};\n\nNodeParser.prototype.paintCheckbox = function(container) {\n    var b = container.parseBounds();\n\n    var size = Math.min(b.width, b.height);\n    var bounds = {width: size - 1, height: size - 1, top: b.top, left: b.left};\n    var r = [3, 3];\n    var radius = [r, r, r, r];\n    var borders = [1,1,1,1].map(function(w) {\n        return {color: new Color('#A5A5A5'), width: w};\n    });\n\n    var borderPoints = calculateCurvePoints(bounds, radius, borders);\n\n    this.renderer.clip(container.backgroundClip, function() {\n        this.renderer.rectangle(bounds.left + 1, bounds.top + 1, bounds.width - 2, bounds.height - 2, new Color(\"#DEDEDE\"));\n        this.renderer.renderBorders(calculateBorders(borders, bounds, borderPoints, radius));\n        if (container.node.checked) {\n            this.renderer.font(new Color('#424242'), 'normal', 'normal', 'bold', (size - 3) + \"px\", 'arial');\n            this.renderer.text(\"\\u2714\", bounds.left + size / 6, bounds.top + size - 1);\n        }\n    }, this);\n};\n\nNodeParser.prototype.paintRadio = function(container) {\n    var bounds = container.parseBounds();\n\n    var size = Math.min(bounds.width, bounds.height) - 2;\n\n    this.renderer.clip(container.backgroundClip, function() {\n        this.renderer.circleStroke(bounds.left + 1, bounds.top + 1, size, new Color('#DEDEDE'), 1, new Color('#A5A5A5'));\n        if (container.node.checked) {\n            this.renderer.circle(Math.ceil(bounds.left + size / 4) + 1, Math.ceil(bounds.top + size / 4) + 1, Math.floor(size / 2), new Color('#424242'));\n        }\n    }, this);\n};\n\nNodeParser.prototype.paintFormValue = function(container) {\n    var value = container.getValue();\n    if (value.length > 0) {\n        var document = container.node.ownerDocument;\n        var wrapper = document.createElement('html2canvaswrapper');\n        var properties = ['lineHeight', 'textAlign', 'fontFamily', 'fontWeight', 'fontSize', 'color',\n            'paddingLeft', 'paddingTop', 'paddingRight', 'paddingBottom',\n            'width', 'height', 'borderLeftStyle', 'borderTopStyle', 'borderLeftWidth', 'borderTopWidth',\n            'boxSizing', 'whiteSpace', 'wordWrap'];\n\n        properties.forEach(function(property) {\n            try {\n                wrapper.style[property] = container.css(property);\n            } catch(e) {\n                // Older IE has issues with \"border\"\n                log(\"html2canvas: Parse: Exception caught in renderFormValue: \" + e.message);\n            }\n        });\n        var bounds = container.parseBounds();\n        wrapper.style.position = \"fixed\";\n        wrapper.style.left = bounds.left + \"px\";\n        wrapper.style.top = bounds.top + \"px\";\n        wrapper.textContent = value;\n        document.body.appendChild(wrapper);\n        this.paintText(new TextContainer(wrapper.firstChild, container));\n        document.body.removeChild(wrapper);\n    }\n};\n\nNodeParser.prototype.paintText = function(container) {\n    container.applyTextTransform();\n    var characters = punycode.ucs2.decode(container.node.data);\n    var textList = (!this.options.letterRendering || noLetterSpacing(container)) && !hasUnicode(container.node.data) ? getWords(characters) : characters.map(function(character) {\n        return punycode.ucs2.encode([character]);\n    });\n\n    var weight = container.parent.fontWeight();\n    var size = container.parent.css('fontSize');\n    var family = container.parent.css('fontFamily');\n    var shadows = container.parent.parseTextShadows();\n\n    this.renderer.font(container.parent.color('color'), container.parent.css('fontStyle'), container.parent.css('fontVariant'), weight, size, family);\n    if (shadows.length) {\n        // TODO: support multiple text shadows\n        this.renderer.fontShadow(shadows[0].color, shadows[0].offsetX, shadows[0].offsetY, shadows[0].blur);\n    } else {\n        this.renderer.clearShadow();\n    }\n\n    this.renderer.clip(container.parent.clip, function() {\n        textList.map(this.parseTextBounds(container), this).forEach(function(bounds, index) {\n            if (bounds) {\n                this.renderer.text(textList[index], bounds.left, bounds.bottom);\n                this.renderTextDecoration(container.parent, bounds, this.fontMetrics.getMetrics(family, size));\n            }\n        }, this);\n    }, this);\n};\n\nNodeParser.prototype.renderTextDecoration = function(container, bounds, metrics) {\n    switch(container.css(\"textDecoration\").split(\" \")[0]) {\n    case \"underline\":\n        // Draws a line at the baseline of the font\n        // TODO As some browsers display the line as more than 1px if the font-size is big, need to take that into account both in position and size\n        this.renderer.rectangle(bounds.left, Math.round(bounds.top + metrics.baseline + metrics.lineWidth), bounds.width, 1, container.color(\"color\"));\n        break;\n    case \"overline\":\n        this.renderer.rectangle(bounds.left, Math.round(bounds.top), bounds.width, 1, container.color(\"color\"));\n        break;\n    case \"line-through\":\n        // TODO try and find exact position for line-through\n        this.renderer.rectangle(bounds.left, Math.ceil(bounds.top + metrics.middle + metrics.lineWidth), bounds.width, 1, container.color(\"color\"));\n        break;\n    }\n};\n\nvar borderColorTransforms = {\n    inset: [\n        [\"darken\", 0.60],\n        [\"darken\", 0.10],\n        [\"darken\", 0.10],\n        [\"darken\", 0.60]\n    ]\n};\n\nNodeParser.prototype.parseBorders = function(container) {\n    var nodeBounds = container.parseBounds();\n    var radius = getBorderRadiusData(container);\n    var borders = [\"Top\", \"Right\", \"Bottom\", \"Left\"].map(function(side, index) {\n        var style = container.css('border' + side + 'Style');\n        var color = container.color('border' + side + 'Color');\n        if (style === \"inset\" && color.isBlack()) {\n            color = new Color([255, 255, 255, color.a]); // this is wrong, but\n        }\n        var colorTransform = borderColorTransforms[style] ? borderColorTransforms[style][index] : null;\n        return {\n            width: container.cssInt('border' + side + 'Width'),\n            color: colorTransform ? color[colorTransform[0]](colorTransform[1]) : color,\n            args: null\n        };\n    });\n    var borderPoints = calculateCurvePoints(nodeBounds, radius, borders);\n\n    return {\n        clip: this.parseBackgroundClip(container, borderPoints, borders, radius, nodeBounds),\n        borders: calculateBorders(borders, nodeBounds, borderPoints, radius)\n    };\n};\n\nfunction calculateBorders(borders, nodeBounds, borderPoints, radius) {\n    return borders.map(function(border, borderSide) {\n        if (border.width > 0) {\n            var bx = nodeBounds.left;\n            var by = nodeBounds.top;\n            var bw = nodeBounds.width;\n            var bh = nodeBounds.height - (borders[2].width);\n\n            switch(borderSide) {\n            case 0:\n                // top border\n                bh = borders[0].width;\n                border.args = drawSide({\n                        c1: [bx, by],\n                        c2: [bx + bw, by],\n                        c3: [bx + bw - borders[1].width, by + bh],\n                        c4: [bx + borders[3].width, by + bh]\n                    }, radius[0], radius[1],\n                    borderPoints.topLeftOuter, borderPoints.topLeftInner, borderPoints.topRightOuter, borderPoints.topRightInner);\n                break;\n            case 1:\n                // right border\n                bx = nodeBounds.left + nodeBounds.width - (borders[1].width);\n                bw = borders[1].width;\n\n                border.args = drawSide({\n                        c1: [bx + bw, by],\n                        c2: [bx + bw, by + bh + borders[2].width],\n                        c3: [bx, by + bh],\n                        c4: [bx, by + borders[0].width]\n                    }, radius[1], radius[2],\n                    borderPoints.topRightOuter, borderPoints.topRightInner, borderPoints.bottomRightOuter, borderPoints.bottomRightInner);\n                break;\n            case 2:\n                // bottom border\n                by = (by + nodeBounds.height) - (borders[2].width);\n                bh = borders[2].width;\n                border.args = drawSide({\n                        c1: [bx + bw, by + bh],\n                        c2: [bx, by + bh],\n                        c3: [bx + borders[3].width, by],\n                        c4: [bx + bw - borders[3].width, by]\n                    }, radius[2], radius[3],\n                    borderPoints.bottomRightOuter, borderPoints.bottomRightInner, borderPoints.bottomLeftOuter, borderPoints.bottomLeftInner);\n                break;\n            case 3:\n                // left border\n                bw = borders[3].width;\n                border.args = drawSide({\n                        c1: [bx, by + bh + borders[2].width],\n                        c2: [bx, by],\n                        c3: [bx + bw, by + borders[0].width],\n                        c4: [bx + bw, by + bh]\n                    }, radius[3], radius[0],\n                    borderPoints.bottomLeftOuter, borderPoints.bottomLeftInner, borderPoints.topLeftOuter, borderPoints.topLeftInner);\n                break;\n            }\n        }\n        return border;\n    });\n}\n\nNodeParser.prototype.parseBackgroundClip = function(container, borderPoints, borders, radius, bounds) {\n    var backgroundClip = container.css('backgroundClip'),\n        borderArgs = [];\n\n    switch(backgroundClip) {\n    case \"content-box\":\n    case \"padding-box\":\n        parseCorner(borderArgs, radius[0], radius[1], borderPoints.topLeftInner, borderPoints.topRightInner, bounds.left + borders[3].width, bounds.top + borders[0].width);\n        parseCorner(borderArgs, radius[1], radius[2], borderPoints.topRightInner, borderPoints.bottomRightInner, bounds.left + bounds.width - borders[1].width, bounds.top + borders[0].width);\n        parseCorner(borderArgs, radius[2], radius[3], borderPoints.bottomRightInner, borderPoints.bottomLeftInner, bounds.left + bounds.width - borders[1].width, bounds.top + bounds.height - borders[2].width);\n        parseCorner(borderArgs, radius[3], radius[0], borderPoints.bottomLeftInner, borderPoints.topLeftInner, bounds.left + borders[3].width, bounds.top + bounds.height - borders[2].width);\n        break;\n\n    default:\n        parseCorner(borderArgs, radius[0], radius[1], borderPoints.topLeftOuter, borderPoints.topRightOuter, bounds.left, bounds.top);\n        parseCorner(borderArgs, radius[1], radius[2], borderPoints.topRightOuter, borderPoints.bottomRightOuter, bounds.left + bounds.width, bounds.top);\n        parseCorner(borderArgs, radius[2], radius[3], borderPoints.bottomRightOuter, borderPoints.bottomLeftOuter, bounds.left + bounds.width, bounds.top + bounds.height);\n        parseCorner(borderArgs, radius[3], radius[0], borderPoints.bottomLeftOuter, borderPoints.topLeftOuter, bounds.left, bounds.top + bounds.height);\n        break;\n    }\n\n    return borderArgs;\n};\n\nfunction getCurvePoints(x, y, r1, r2) {\n    var kappa = 4 * ((Math.sqrt(2) - 1) / 3);\n    var ox = (r1) * kappa, // control point offset horizontal\n        oy = (r2) * kappa, // control point offset vertical\n        xm = x + r1, // x-middle\n        ym = y + r2; // y-middle\n    return {\n        topLeft: bezierCurve({x: x, y: ym}, {x: x, y: ym - oy}, {x: xm - ox, y: y}, {x: xm, y: y}),\n        topRight: bezierCurve({x: x, y: y}, {x: x + ox,y: y}, {x: xm, y: ym - oy}, {x: xm, y: ym}),\n        bottomRight: bezierCurve({x: xm, y: y}, {x: xm, y: y + oy}, {x: x + ox, y: ym}, {x: x, y: ym}),\n        bottomLeft: bezierCurve({x: xm, y: ym}, {x: xm - ox, y: ym}, {x: x, y: y + oy}, {x: x, y:y})\n    };\n}\n\nfunction calculateCurvePoints(bounds, borderRadius, borders) {\n    var x = bounds.left,\n        y = bounds.top,\n        width = bounds.width,\n        height = bounds.height,\n\n        tlh = borderRadius[0][0] < width / 2 ? borderRadius[0][0] : width / 2,\n        tlv = borderRadius[0][1] < height / 2 ? borderRadius[0][1] : height / 2,\n        trh = borderRadius[1][0] < width / 2 ? borderRadius[1][0] : width / 2,\n        trv = borderRadius[1][1] < height / 2 ? borderRadius[1][1] : height / 2,\n        brh = borderRadius[2][0] < width / 2 ? borderRadius[2][0] : width / 2,\n        brv = borderRadius[2][1] < height / 2 ? borderRadius[2][1] : height / 2,\n        blh = borderRadius[3][0] < width / 2 ? borderRadius[3][0] : width / 2,\n        blv = borderRadius[3][1] < height / 2 ? borderRadius[3][1] : height / 2;\n\n    var topWidth = width - trh,\n        rightHeight = height - brv,\n        bottomWidth = width - brh,\n        leftHeight = height - blv;\n\n    return {\n        topLeftOuter: getCurvePoints(x, y, tlh, tlv).topLeft.subdivide(0.5),\n        topLeftInner: getCurvePoints(x + borders[3].width, y + borders[0].width, Math.max(0, tlh - borders[3].width), Math.max(0, tlv - borders[0].width)).topLeft.subdivide(0.5),\n        topRightOuter: getCurvePoints(x + topWidth, y, trh, trv).topRight.subdivide(0.5),\n        topRightInner: getCurvePoints(x + Math.min(topWidth, width + borders[3].width), y + borders[0].width, (topWidth > width + borders[3].width) ? 0 :trh - borders[3].width, trv - borders[0].width).topRight.subdivide(0.5),\n        bottomRightOuter: getCurvePoints(x + bottomWidth, y + rightHeight, brh, brv).bottomRight.subdivide(0.5),\n        bottomRightInner: getCurvePoints(x + Math.min(bottomWidth, width - borders[3].width), y + Math.min(rightHeight, height + borders[0].width), Math.max(0, brh - borders[1].width),  brv - borders[2].width).bottomRight.subdivide(0.5),\n        bottomLeftOuter: getCurvePoints(x, y + leftHeight, blh, blv).bottomLeft.subdivide(0.5),\n        bottomLeftInner: getCurvePoints(x + borders[3].width, y + leftHeight, Math.max(0, blh - borders[3].width), blv - borders[2].width).bottomLeft.subdivide(0.5)\n    };\n}\n\nfunction bezierCurve(start, startControl, endControl, end) {\n    var lerp = function (a, b, t) {\n        return {\n            x: a.x + (b.x - a.x) * t,\n            y: a.y + (b.y - a.y) * t\n        };\n    };\n\n    return {\n        start: start,\n        startControl: startControl,\n        endControl: endControl,\n        end: end,\n        subdivide: function(t) {\n            var ab = lerp(start, startControl, t),\n                bc = lerp(startControl, endControl, t),\n                cd = lerp(endControl, end, t),\n                abbc = lerp(ab, bc, t),\n                bccd = lerp(bc, cd, t),\n                dest = lerp(abbc, bccd, t);\n            return [bezierCurve(start, ab, abbc, dest), bezierCurve(dest, bccd, cd, end)];\n        },\n        curveTo: function(borderArgs) {\n            borderArgs.push([\"bezierCurve\", startControl.x, startControl.y, endControl.x, endControl.y, end.x, end.y]);\n        },\n        curveToReversed: function(borderArgs) {\n            borderArgs.push([\"bezierCurve\", endControl.x, endControl.y, startControl.x, startControl.y, start.x, start.y]);\n        }\n    };\n}\n\nfunction drawSide(borderData, radius1, radius2, outer1, inner1, outer2, inner2) {\n    var borderArgs = [];\n\n    if (radius1[0] > 0 || radius1[1] > 0) {\n        borderArgs.push([\"line\", outer1[1].start.x, outer1[1].start.y]);\n        outer1[1].curveTo(borderArgs);\n    } else {\n        borderArgs.push([ \"line\", borderData.c1[0], borderData.c1[1]]);\n    }\n\n    if (radius2[0] > 0 || radius2[1] > 0) {\n        borderArgs.push([\"line\", outer2[0].start.x, outer2[0].start.y]);\n        outer2[0].curveTo(borderArgs);\n        borderArgs.push([\"line\", inner2[0].end.x, inner2[0].end.y]);\n        inner2[0].curveToReversed(borderArgs);\n    } else {\n        borderArgs.push([\"line\", borderData.c2[0], borderData.c2[1]]);\n        borderArgs.push([\"line\", borderData.c3[0], borderData.c3[1]]);\n    }\n\n    if (radius1[0] > 0 || radius1[1] > 0) {\n        borderArgs.push([\"line\", inner1[1].end.x, inner1[1].end.y]);\n        inner1[1].curveToReversed(borderArgs);\n    } else {\n        borderArgs.push([\"line\", borderData.c4[0], borderData.c4[1]]);\n    }\n\n    return borderArgs;\n}\n\nfunction parseCorner(borderArgs, radius1, radius2, corner1, corner2, x, y) {\n    if (radius1[0] > 0 || radius1[1] > 0) {\n        borderArgs.push([\"line\", corner1[0].start.x, corner1[0].start.y]);\n        corner1[0].curveTo(borderArgs);\n        corner1[1].curveTo(borderArgs);\n    } else {\n        borderArgs.push([\"line\", x, y]);\n    }\n\n    if (radius2[0] > 0 || radius2[1] > 0) {\n        borderArgs.push([\"line\", corner2[0].start.x, corner2[0].start.y]);\n    }\n}\n\nfunction negativeZIndex(container) {\n    return container.cssInt(\"zIndex\") < 0;\n}\n\nfunction positiveZIndex(container) {\n    return container.cssInt(\"zIndex\") > 0;\n}\n\nfunction zIndex0(container) {\n    return container.cssInt(\"zIndex\") === 0;\n}\n\nfunction inlineLevel(container) {\n    return [\"inline\", \"inline-block\", \"inline-table\"].indexOf(container.css(\"display\")) !== -1;\n}\n\nfunction isStackingContext(container) {\n    return (container instanceof StackingContext);\n}\n\nfunction hasText(container) {\n    return container.node.data.trim().length > 0;\n}\n\nfunction noLetterSpacing(container) {\n    return (/^(normal|none|0px)$/.test(container.parent.css(\"letterSpacing\")));\n}\n\nfunction getBorderRadiusData(container) {\n    return [\"TopLeft\", \"TopRight\", \"BottomRight\", \"BottomLeft\"].map(function(side) {\n        var value = container.css('border' + side + 'Radius');\n        var arr = value.split(\" \");\n        if (arr.length <= 1) {\n            arr[1] = arr[0];\n        }\n        return arr.map(asInt);\n    });\n}\n\nfunction renderableNode(node) {\n    return (node.nodeType === Node.TEXT_NODE || node.nodeType === Node.ELEMENT_NODE);\n}\n\nfunction isPositionedForStacking(container) {\n    var position = container.css(\"position\");\n    var zIndex = ([\"absolute\", \"relative\", \"fixed\"].indexOf(position) !== -1) ? container.css(\"zIndex\") : \"auto\";\n    return zIndex !== \"auto\";\n}\n\nfunction isPositioned(container) {\n    return container.css(\"position\") !== \"static\";\n}\n\nfunction isFloating(container) {\n    return container.css(\"float\") !== \"none\";\n}\n\nfunction isInlineBlock(container) {\n    return [\"inline-block\", \"inline-table\"].indexOf(container.css(\"display\")) !== -1;\n}\n\nfunction not(callback) {\n    var context = this;\n    return function() {\n        return !callback.apply(context, arguments);\n    };\n}\n\nfunction isElement(container) {\n    return container.node.nodeType === Node.ELEMENT_NODE;\n}\n\nfunction isPseudoElement(container) {\n    return container.isPseudoElement === true;\n}\n\nfunction isTextNode(container) {\n    return container.node.nodeType === Node.TEXT_NODE;\n}\n\nfunction zIndexSort(contexts) {\n    return function(a, b) {\n        return (a.cssInt(\"zIndex\") + (contexts.indexOf(a) / contexts.length)) - (b.cssInt(\"zIndex\") + (contexts.indexOf(b) / contexts.length));\n    };\n}\n\nfunction hasOpacity(container) {\n    return container.getOpacity() < 1;\n}\n\nfunction asInt(value) {\n    return parseInt(value, 10);\n}\n\nfunction getWidth(border) {\n    return border.width;\n}\n\nfunction nonIgnoredElement(nodeContainer) {\n    return (nodeContainer.node.nodeType !== Node.ELEMENT_NODE || [\"SCRIPT\", \"HEAD\", \"TITLE\", \"OBJECT\", \"BR\", \"OPTION\"].indexOf(nodeContainer.node.nodeName) === -1);\n}\n\nfunction flatten(arrays) {\n    return [].concat.apply([], arrays);\n}\n\nfunction stripQuotes(content) {\n    var first = content.substr(0, 1);\n    return (first === content.substr(content.length - 1) && first.match(/'|\"/)) ? content.substr(1, content.length - 2) : content;\n}\n\nfunction getWords(characters) {\n    var words = [], i = 0, onWordBoundary = false, word;\n    while(characters.length) {\n        if (isWordBoundary(characters[i]) === onWordBoundary) {\n            word = characters.splice(0, i);\n            if (word.length) {\n                words.push(punycode.ucs2.encode(word));\n            }\n            onWordBoundary =! onWordBoundary;\n            i = 0;\n        } else {\n            i++;\n        }\n\n        if (i >= characters.length) {\n            word = characters.splice(0, i);\n            if (word.length) {\n                words.push(punycode.ucs2.encode(word));\n            }\n        }\n    }\n    return words;\n}\n\nfunction isWordBoundary(characterCode) {\n    return [\n        32, // <space>\n        13, // \\r\n        10, // \\n\n        9, // \\t\n        45 // -\n    ].indexOf(characterCode) !== -1;\n}\n\nfunction hasUnicode(string) {\n    return (/[^\\u0000-\\u00ff]/).test(string);\n}\n\nmodule.exports = NodeParser;\n\n},{\"./color\":3,\"./fontmetrics\":7,\"./log\":13,\"./nodecontainer\":14,\"./pseudoelementcontainer\":18,\"./stackingcontext\":21,\"./textcontainer\":25,\"./utils\":26,\"punycode\":1}],16:[function(_dereq_,module,exports){\nvar XHR = _dereq_('./xhr');\nvar utils = _dereq_('./utils');\nvar log = _dereq_('./log');\nvar createWindowClone = _dereq_('./clone');\nvar decode64 = utils.decode64;\n\nfunction Proxy(src, proxyUrl, document) {\n    var supportsCORS = ('withCredentials' in new XMLHttpRequest());\n    if (!proxyUrl) {\n        return Promise.reject(\"No proxy configured\");\n    }\n    var callback = createCallback(supportsCORS);\n    var url = createProxyUrl(proxyUrl, src, callback);\n\n    return supportsCORS ? XHR(url) : (jsonp(document, url, callback).then(function(response) {\n        return decode64(response.content);\n    }));\n}\nvar proxyCount = 0;\n\nfunction ProxyURL(src, proxyUrl, document) {\n    var supportsCORSImage = ('crossOrigin' in new Image());\n    var callback = createCallback(supportsCORSImage);\n    var url = createProxyUrl(proxyUrl, src, callback);\n    return (supportsCORSImage ? Promise.resolve(url) : jsonp(document, url, callback).then(function(response) {\n        return \"data:\" + response.type + \";base64,\" + response.content;\n    }));\n}\n\nfunction jsonp(document, url, callback) {\n    return new Promise(function(resolve, reject) {\n        var s = document.createElement(\"script\");\n        var cleanup = function() {\n            delete window.html2canvas.proxy[callback];\n            document.body.removeChild(s);\n        };\n        window.html2canvas.proxy[callback] = function(response) {\n            cleanup();\n            resolve(response);\n        };\n        s.src = url;\n        s.onerror = function(e) {\n            cleanup();\n            reject(e);\n        };\n        document.body.appendChild(s);\n    });\n}\n\nfunction createCallback(useCORS) {\n    return !useCORS ? \"html2canvas_\" + Date.now() + \"_\" + (++proxyCount) + \"_\" + Math.round(Math.random() * 100000) : \"\";\n}\n\nfunction createProxyUrl(proxyUrl, src, callback) {\n    return proxyUrl + \"?url=\" + encodeURIComponent(src) + (callback.length ? \"&callback=html2canvas.proxy.\" + callback : \"\");\n}\n\nfunction documentFromHTML(src) {\n    return function(html) {\n        var parser = new DOMParser(), doc;\n        try {\n            doc = parser.parseFromString(html, \"text/html\");\n        } catch(e) {\n            log(\"DOMParser not supported, falling back to createHTMLDocument\");\n            doc = document.implementation.createHTMLDocument(\"\");\n            try {\n                doc.open();\n                doc.write(html);\n                doc.close();\n            } catch(ee) {\n                log(\"createHTMLDocument write not supported, falling back to document.body.innerHTML\");\n                doc.body.innerHTML = html; // ie9 doesnt support writing to documentElement\n            }\n        }\n\n        var b = doc.querySelector(\"base\");\n        if (!b || !b.href.host) {\n            var base = doc.createElement(\"base\");\n            base.href = src;\n            doc.head.insertBefore(base, doc.head.firstChild);\n        }\n\n        return doc;\n    };\n}\n\nfunction loadUrlDocument(src, proxy, document, width, height, options) {\n    return new Proxy(src, proxy, window.document).then(documentFromHTML(src)).then(function(doc) {\n        return createWindowClone(doc, document, width, height, options, 0, 0);\n    });\n}\n\nexports.Proxy = Proxy;\nexports.ProxyURL = ProxyURL;\nexports.loadUrlDocument = loadUrlDocument;\n\n},{\"./clone\":2,\"./log\":13,\"./utils\":26,\"./xhr\":28}],17:[function(_dereq_,module,exports){\nvar ProxyURL = _dereq_('./proxy').ProxyURL;\n\nfunction ProxyImageContainer(src, proxy) {\n    var link = document.createElement(\"a\");\n    link.href = src;\n    src = link.href;\n    this.src = src;\n    this.image = new Image();\n    var self = this;\n    this.promise = new Promise(function(resolve, reject) {\n        self.image.crossOrigin = \"Anonymous\";\n        self.image.onload = resolve;\n        self.image.onerror = reject;\n\n        new ProxyURL(src, proxy, document).then(function(url) {\n            self.image.src = url;\n        })['catch'](reject);\n    });\n}\n\nmodule.exports = ProxyImageContainer;\n\n},{\"./proxy\":16}],18:[function(_dereq_,module,exports){\nvar NodeContainer = _dereq_('./nodecontainer');\n\nfunction PseudoElementContainer(node, parent, type) {\n    NodeContainer.call(this, node, parent);\n    this.isPseudoElement = true;\n    this.before = type === \":before\";\n}\n\nPseudoElementContainer.prototype.cloneTo = function(stack) {\n    PseudoElementContainer.prototype.cloneTo.call(this, stack);\n    stack.isPseudoElement = true;\n    stack.before = this.before;\n};\n\nPseudoElementContainer.prototype = Object.create(NodeContainer.prototype);\n\nPseudoElementContainer.prototype.appendToDOM = function() {\n    if (this.before) {\n        this.parent.node.insertBefore(this.node, this.parent.node.firstChild);\n    } else {\n        this.parent.node.appendChild(this.node);\n    }\n    this.parent.node.className += \" \" + this.getHideClass();\n};\n\nPseudoElementContainer.prototype.cleanDOM = function() {\n    this.node.parentNode.removeChild(this.node);\n    this.parent.node.className = this.parent.node.className.replace(this.getHideClass(), \"\");\n};\n\nPseudoElementContainer.prototype.getHideClass = function() {\n    return this[\"PSEUDO_HIDE_ELEMENT_CLASS_\" + (this.before ? \"BEFORE\" : \"AFTER\")];\n};\n\nPseudoElementContainer.prototype.PSEUDO_HIDE_ELEMENT_CLASS_BEFORE = \"___html2canvas___pseudoelement_before\";\nPseudoElementContainer.prototype.PSEUDO_HIDE_ELEMENT_CLASS_AFTER = \"___html2canvas___pseudoelement_after\";\n\nmodule.exports = PseudoElementContainer;\n\n},{\"./nodecontainer\":14}],19:[function(_dereq_,module,exports){\nvar log = _dereq_('./log');\n\nfunction Renderer(width, height, images, options, document) {\n    this.width = width;\n    this.height = height;\n    this.images = images;\n    this.options = options;\n    this.document = document;\n}\n\nRenderer.prototype.renderImage = function(container, bounds, borderData, imageContainer) {\n    var paddingLeft = container.cssInt('paddingLeft'),\n        paddingTop = container.cssInt('paddingTop'),\n        paddingRight = container.cssInt('paddingRight'),\n        paddingBottom = container.cssInt('paddingBottom'),\n        borders = borderData.borders;\n\n    var width = bounds.width - (borders[1].width + borders[3].width + paddingLeft + paddingRight);\n    var height = bounds.height - (borders[0].width + borders[2].width + paddingTop + paddingBottom);\n    this.drawImage(\n        imageContainer,\n        0,\n        0,\n        imageContainer.image.width || width,\n        imageContainer.image.height || height,\n        bounds.left + paddingLeft + borders[3].width,\n        bounds.top + paddingTop + borders[0].width,\n        width,\n        height\n    );\n};\n\nRenderer.prototype.renderBackground = function(container, bounds, borderData) {\n    if (bounds.height > 0 && bounds.width > 0) {\n        this.renderBackgroundColor(container, bounds);\n        this.renderBackgroundImage(container, bounds, borderData);\n    }\n};\n\nRenderer.prototype.renderBackgroundColor = function(container, bounds) {\n    var color = container.color(\"backgroundColor\");\n    if (!color.isTransparent()) {\n        this.rectangle(bounds.left, bounds.top, bounds.width, bounds.height, color);\n    }\n};\n\nRenderer.prototype.renderBorders = function(borders) {\n    borders.forEach(this.renderBorder, this);\n};\n\nRenderer.prototype.renderBorder = function(data) {\n    if (!data.color.isTransparent() && data.args !== null) {\n        this.drawShape(data.args, data.color);\n    }\n};\n\nRenderer.prototype.renderBackgroundImage = function(container, bounds, borderData) {\n    var backgroundImages = container.parseBackgroundImages();\n    backgroundImages.reverse().forEach(function(backgroundImage, index, arr) {\n        switch(backgroundImage.method) {\n        case \"url\":\n            var image = this.images.get(backgroundImage.args[0]);\n            if (image) {\n                this.renderBackgroundRepeating(container, bounds, image, arr.length - (index+1), borderData);\n            } else {\n                log(\"Error loading background-image\", backgroundImage.args[0]);\n            }\n            break;\n        case \"linear-gradient\":\n        case \"gradient\":\n            var gradientImage = this.images.get(backgroundImage.value);\n            if (gradientImage) {\n                this.renderBackgroundGradient(gradientImage, bounds, borderData);\n            } else {\n                log(\"Error loading background-image\", backgroundImage.args[0]);\n            }\n            break;\n        case \"none\":\n            break;\n        default:\n            log(\"Unknown background-image type\", backgroundImage.args[0]);\n        }\n    }, this);\n};\n\nRenderer.prototype.renderBackgroundRepeating = function(container, bounds, imageContainer, index, borderData) {\n    var size = container.parseBackgroundSize(bounds, imageContainer.image, index);\n    var position = container.parseBackgroundPosition(bounds, imageContainer.image, index, size);\n    var repeat = container.parseBackgroundRepeat(index);\n    switch (repeat) {\n    case \"repeat-x\":\n    case \"repeat no-repeat\":\n        this.backgroundRepeatShape(imageContainer, position, size, bounds, bounds.left + borderData[3], bounds.top + position.top + borderData[0], 99999, size.height, borderData);\n        break;\n    case \"repeat-y\":\n    case \"no-repeat repeat\":\n        this.backgroundRepeatShape(imageContainer, position, size, bounds, bounds.left + position.left + borderData[3], bounds.top + borderData[0], size.width, 99999, borderData);\n        break;\n    case \"no-repeat\":\n        this.backgroundRepeatShape(imageContainer, position, size, bounds, bounds.left + position.left + borderData[3], bounds.top + position.top + borderData[0], size.width, size.height, borderData);\n        break;\n    default:\n        this.renderBackgroundRepeat(imageContainer, position, size, {top: bounds.top, left: bounds.left}, borderData[3], borderData[0]);\n        break;\n    }\n};\n\nmodule.exports = Renderer;\n\n},{\"./log\":13}],20:[function(_dereq_,module,exports){\nvar Renderer = _dereq_('../renderer');\nvar LinearGradientContainer = _dereq_('../lineargradientcontainer');\nvar log = _dereq_('../log');\n\nfunction CanvasRenderer(width, height) {\n    Renderer.apply(this, arguments);\n    this.canvas = this.options.canvas || this.document.createElement(\"canvas\");\n    if (!this.options.canvas) {\n        this.canvas.width = width;\n        this.canvas.height = height;\n    }\n    this.ctx = this.canvas.getContext(\"2d\");\n    this.taintCtx = this.document.createElement(\"canvas\").getContext(\"2d\");\n    this.ctx.textBaseline = \"bottom\";\n    this.variables = {};\n    log(\"Initialized CanvasRenderer with size\", width, \"x\", height);\n}\n\nCanvasRenderer.prototype = Object.create(Renderer.prototype);\n\nCanvasRenderer.prototype.setFillStyle = function(fillStyle) {\n    this.ctx.fillStyle = typeof(fillStyle) === \"object\" && !!fillStyle.isColor ? fillStyle.toString() : fillStyle;\n    return this.ctx;\n};\n\nCanvasRenderer.prototype.rectangle = function(left, top, width, height, color) {\n    this.setFillStyle(color).fillRect(left, top, width, height);\n};\n\nCanvasRenderer.prototype.circle = function(left, top, size, color) {\n    this.setFillStyle(color);\n    this.ctx.beginPath();\n    this.ctx.arc(left + size / 2, top + size / 2, size / 2, 0, Math.PI*2, true);\n    this.ctx.closePath();\n    this.ctx.fill();\n};\n\nCanvasRenderer.prototype.circleStroke = function(left, top, size, color, stroke, strokeColor) {\n    this.circle(left, top, size, color);\n    this.ctx.strokeStyle = strokeColor.toString();\n    this.ctx.stroke();\n};\n\nCanvasRenderer.prototype.drawShape = function(shape, color) {\n    this.shape(shape);\n    this.setFillStyle(color).fill();\n};\n\nCanvasRenderer.prototype.taints = function(imageContainer) {\n    if (imageContainer.tainted === null) {\n        this.taintCtx.drawImage(imageContainer.image, 0, 0);\n        try {\n            this.taintCtx.getImageData(0, 0, 1, 1);\n            imageContainer.tainted = false;\n        } catch(e) {\n            this.taintCtx = document.createElement(\"canvas\").getContext(\"2d\");\n            imageContainer.tainted = true;\n        }\n    }\n\n    return imageContainer.tainted;\n};\n\nCanvasRenderer.prototype.drawImage = function(imageContainer, sx, sy, sw, sh, dx, dy, dw, dh) {\n    if (!this.taints(imageContainer) || this.options.allowTaint) {\n        this.ctx.drawImage(imageContainer.image, sx, sy, sw, sh, dx, dy, dw, dh);\n    }\n};\n\nCanvasRenderer.prototype.clip = function(shapes, callback, context) {\n    this.ctx.save();\n    shapes.filter(hasEntries).forEach(function(shape) {\n        this.shape(shape).clip();\n    }, this);\n    callback.call(context);\n    this.ctx.restore();\n};\n\nCanvasRenderer.prototype.shape = function(shape) {\n    this.ctx.beginPath();\n    shape.forEach(function(point, index) {\n        if (point[0] === \"rect\") {\n            this.ctx.rect.apply(this.ctx, point.slice(1));\n        } else {\n            this.ctx[(index === 0) ? \"moveTo\" : point[0] + \"To\" ].apply(this.ctx, point.slice(1));\n        }\n    }, this);\n    this.ctx.closePath();\n    return this.ctx;\n};\n\nCanvasRenderer.prototype.font = function(color, style, variant, weight, size, family) {\n    this.setFillStyle(color).font = [style, variant, weight, size, family].join(\" \").split(\",\")[0];\n};\n\nCanvasRenderer.prototype.fontShadow = function(color, offsetX, offsetY, blur) {\n    this.setVariable(\"shadowColor\", color.toString())\n        .setVariable(\"shadowOffsetY\", offsetX)\n        .setVariable(\"shadowOffsetX\", offsetY)\n        .setVariable(\"shadowBlur\", blur);\n};\n\nCanvasRenderer.prototype.clearShadow = function() {\n    this.setVariable(\"shadowColor\", \"rgba(0,0,0,0)\");\n};\n\nCanvasRenderer.prototype.setOpacity = function(opacity) {\n    this.ctx.globalAlpha = opacity;\n};\n\nCanvasRenderer.prototype.setTransform = function(transform) {\n    this.ctx.translate(transform.origin[0], transform.origin[1]);\n    this.ctx.transform.apply(this.ctx, transform.matrix);\n    this.ctx.translate(-transform.origin[0], -transform.origin[1]);\n};\n\nCanvasRenderer.prototype.setVariable = function(property, value) {\n    if (this.variables[property] !== value) {\n        this.variables[property] = this.ctx[property] = value;\n    }\n\n    return this;\n};\n\nCanvasRenderer.prototype.text = function(text, left, bottom) {\n    this.ctx.fillText(text, left, bottom);\n};\n\nCanvasRenderer.prototype.backgroundRepeatShape = function(imageContainer, backgroundPosition, size, bounds, left, top, width, height, borderData) {\n    var shape = [\n        [\"line\", Math.round(left), Math.round(top)],\n        [\"line\", Math.round(left + width), Math.round(top)],\n        [\"line\", Math.round(left + width), Math.round(height + top)],\n        [\"line\", Math.round(left), Math.round(height + top)]\n    ];\n    this.clip([shape], function() {\n        this.renderBackgroundRepeat(imageContainer, backgroundPosition, size, bounds, borderData[3], borderData[0]);\n    }, this);\n};\n\nCanvasRenderer.prototype.renderBackgroundRepeat = function(imageContainer, backgroundPosition, size, bounds, borderLeft, borderTop) {\n    var offsetX = Math.round(bounds.left + backgroundPosition.left + borderLeft), offsetY = Math.round(bounds.top + backgroundPosition.top + borderTop);\n    this.setFillStyle(this.ctx.createPattern(this.resizeImage(imageContainer, size), \"repeat\"));\n    this.ctx.translate(offsetX, offsetY);\n    this.ctx.fill();\n    this.ctx.translate(-offsetX, -offsetY);\n};\n\nCanvasRenderer.prototype.renderBackgroundGradient = function(gradientImage, bounds) {\n    if (gradientImage instanceof LinearGradientContainer) {\n        var gradient = this.ctx.createLinearGradient(\n            bounds.left + bounds.width * gradientImage.x0,\n            bounds.top + bounds.height * gradientImage.y0,\n            bounds.left +  bounds.width * gradientImage.x1,\n            bounds.top +  bounds.height * gradientImage.y1);\n        gradientImage.colorStops.forEach(function(colorStop) {\n            gradient.addColorStop(colorStop.stop, colorStop.color.toString());\n        });\n        this.rectangle(bounds.left, bounds.top, bounds.width, bounds.height, gradient);\n    }\n};\n\nCanvasRenderer.prototype.resizeImage = function(imageContainer, size) {\n    var image = imageContainer.image;\n    if(image.width === size.width && image.height === size.height) {\n        return image;\n    }\n\n    var ctx, canvas = document.createElement('canvas');\n    canvas.width = size.width;\n    canvas.height = size.height;\n    ctx = canvas.getContext(\"2d\");\n    ctx.drawImage(image, 0, 0, image.width, image.height, 0, 0, size.width, size.height );\n    return canvas;\n};\n\nfunction hasEntries(array) {\n    return array.length > 0;\n}\n\nmodule.exports = CanvasRenderer;\n\n},{\"../lineargradientcontainer\":12,\"../log\":13,\"../renderer\":19}],21:[function(_dereq_,module,exports){\nvar NodeContainer = _dereq_('./nodecontainer');\n\nfunction StackingContext(hasOwnStacking, opacity, element, parent) {\n    NodeContainer.call(this, element, parent);\n    this.ownStacking = hasOwnStacking;\n    this.contexts = [];\n    this.children = [];\n    this.opacity = (this.parent ? this.parent.stack.opacity : 1) * opacity;\n}\n\nStackingContext.prototype = Object.create(NodeContainer.prototype);\n\nStackingContext.prototype.getParentStack = function(context) {\n    var parentStack = (this.parent) ? this.parent.stack : null;\n    return parentStack ? (parentStack.ownStacking ? parentStack : parentStack.getParentStack(context)) : context.stack;\n};\n\nmodule.exports = StackingContext;\n\n},{\"./nodecontainer\":14}],22:[function(_dereq_,module,exports){\nfunction Support(document) {\n    this.rangeBounds = this.testRangeBounds(document);\n    this.cors = this.testCORS();\n    this.svg = this.testSVG();\n}\n\nSupport.prototype.testRangeBounds = function(document) {\n    var range, testElement, rangeBounds, rangeHeight, support = false;\n\n    if (document.createRange) {\n        range = document.createRange();\n        if (range.getBoundingClientRect) {\n            testElement = document.createElement('boundtest');\n            testElement.style.height = \"123px\";\n            testElement.style.display = \"block\";\n            document.body.appendChild(testElement);\n\n            range.selectNode(testElement);\n            rangeBounds = range.getBoundingClientRect();\n            rangeHeight = rangeBounds.height;\n\n            if (rangeHeight === 123) {\n                support = true;\n            }\n            document.body.removeChild(testElement);\n        }\n    }\n\n    return support;\n};\n\nSupport.prototype.testCORS = function() {\n    return typeof((new Image()).crossOrigin) !== \"undefined\";\n};\n\nSupport.prototype.testSVG = function() {\n    var img = new Image();\n    var canvas = document.createElement(\"canvas\");\n    var ctx =  canvas.getContext(\"2d\");\n    img.src = \"data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg'></svg>\";\n\n    try {\n        ctx.drawImage(img, 0, 0);\n        canvas.toDataURL();\n    } catch(e) {\n        return false;\n    }\n    return true;\n};\n\nmodule.exports = Support;\n\n},{}],23:[function(_dereq_,module,exports){\nvar XHR = _dereq_('./xhr');\nvar decode64 = _dereq_('./utils').decode64;\n\nfunction SVGContainer(src) {\n    this.src = src;\n    this.image = null;\n    var self = this;\n\n    this.promise = this.hasFabric().then(function() {\n        return (self.isInline(src) ? Promise.resolve(self.inlineFormatting(src)) : XHR(src));\n    }).then(function(svg) {\n        return new Promise(function(resolve) {\n            window.html2canvas.svg.fabric.loadSVGFromString(svg, self.createCanvas.call(self, resolve));\n        });\n    });\n}\n\nSVGContainer.prototype.hasFabric = function() {\n    return !window.html2canvas.svg || !window.html2canvas.svg.fabric ? Promise.reject(new Error(\"html2canvas.svg.js is not loaded, cannot render svg\")) : Promise.resolve();\n};\n\nSVGContainer.prototype.inlineFormatting = function(src) {\n    return (/^data:image\\/svg\\+xml;base64,/.test(src)) ? this.decode64(this.removeContentType(src)) : this.removeContentType(src);\n};\n\nSVGContainer.prototype.removeContentType = function(src) {\n    return src.replace(/^data:image\\/svg\\+xml(;base64)?,/,'');\n};\n\nSVGContainer.prototype.isInline = function(src) {\n    return (/^data:image\\/svg\\+xml/i.test(src));\n};\n\nSVGContainer.prototype.createCanvas = function(resolve) {\n    var self = this;\n    return function (objects, options) {\n        var canvas = new window.html2canvas.svg.fabric.StaticCanvas('c');\n        self.image = canvas.lowerCanvasEl;\n        canvas\n            .setWidth(options.width)\n            .setHeight(options.height)\n            .add(window.html2canvas.svg.fabric.util.groupSVGElements(objects, options))\n            .renderAll();\n        resolve(canvas.lowerCanvasEl);\n    };\n};\n\nSVGContainer.prototype.decode64 = function(str) {\n    return (typeof(window.atob) === \"function\") ? window.atob(str) : decode64(str);\n};\n\nmodule.exports = SVGContainer;\n\n},{\"./utils\":26,\"./xhr\":28}],24:[function(_dereq_,module,exports){\nvar SVGContainer = _dereq_('./svgcontainer');\n\nfunction SVGNodeContainer(node, _native) {\n    this.src = node;\n    this.image = null;\n    var self = this;\n\n    this.promise = _native ? new Promise(function(resolve, reject) {\n        self.image = new Image();\n        self.image.onload = resolve;\n        self.image.onerror = reject;\n        self.image.src = \"data:image/svg+xml,\" + (new XMLSerializer()).serializeToString(node);\n        if (self.image.complete === true) {\n            resolve(self.image);\n        }\n    }) : this.hasFabric().then(function() {\n        return new Promise(function(resolve) {\n            window.html2canvas.svg.fabric.parseSVGDocument(node, self.createCanvas.call(self, resolve));\n        });\n    });\n}\n\nSVGNodeContainer.prototype = Object.create(SVGContainer.prototype);\n\nmodule.exports = SVGNodeContainer;\n\n},{\"./svgcontainer\":23}],25:[function(_dereq_,module,exports){\nvar NodeContainer = _dereq_('./nodecontainer');\n\nfunction TextContainer(node, parent) {\n    NodeContainer.call(this, node, parent);\n}\n\nTextContainer.prototype = Object.create(NodeContainer.prototype);\n\nTextContainer.prototype.applyTextTransform = function() {\n    this.node.data = this.transform(this.parent.css(\"textTransform\"));\n};\n\nTextContainer.prototype.transform = function(transform) {\n    var text = this.node.data;\n    switch(transform){\n        case \"lowercase\":\n            return text.toLowerCase();\n        case \"capitalize\":\n            return text.replace(/(^|\\s|:|-|\\(|\\))([a-z])/g, capitalize);\n        case \"uppercase\":\n            return text.toUpperCase();\n        default:\n            return text;\n    }\n};\n\nfunction capitalize(m, p1, p2) {\n    if (m.length > 0) {\n        return p1 + p2.toUpperCase();\n    }\n}\n\nmodule.exports = TextContainer;\n\n},{\"./nodecontainer\":14}],26:[function(_dereq_,module,exports){\nexports.smallImage = function smallImage() {\n    return \"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7\";\n};\n\nexports.bind = function(callback, context) {\n    return function() {\n        return callback.apply(context, arguments);\n    };\n};\n\n/*\n * base64-arraybuffer\n * https://github.com/niklasvh/base64-arraybuffer\n *\n * Copyright (c) 2012 Niklas von Hertzen\n * Licensed under the MIT license.\n */\n\nexports.decode64 = function(base64) {\n    var chars = \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\";\n    var len = base64.length, i, encoded1, encoded2, encoded3, encoded4, byte1, byte2, byte3;\n\n    var output = \"\";\n\n    for (i = 0; i < len; i+=4) {\n        encoded1 = chars.indexOf(base64[i]);\n        encoded2 = chars.indexOf(base64[i+1]);\n        encoded3 = chars.indexOf(base64[i+2]);\n        encoded4 = chars.indexOf(base64[i+3]);\n\n        byte1 = (encoded1 << 2) | (encoded2 >> 4);\n        byte2 = ((encoded2 & 15) << 4) | (encoded3 >> 2);\n        byte3 = ((encoded3 & 3) << 6) | encoded4;\n        if (encoded3 === 64) {\n            output += String.fromCharCode(byte1);\n        } else if (encoded4 === 64 || encoded4 === -1) {\n            output += String.fromCharCode(byte1, byte2);\n        } else{\n            output += String.fromCharCode(byte1, byte2, byte3);\n        }\n    }\n\n    return output;\n};\n\nexports.getBounds = function(node) {\n    if (node.getBoundingClientRect) {\n        var clientRect = node.getBoundingClientRect();\n        var width = node.offsetWidth == null ? clientRect.width : node.offsetWidth;\n        return {\n            top: clientRect.top,\n            bottom: clientRect.bottom || (clientRect.top + clientRect.height),\n            right: clientRect.left + width,\n            left: clientRect.left,\n            width:  width,\n            height: node.offsetHeight == null ? clientRect.height : node.offsetHeight\n        };\n    }\n    return {};\n};\n\nexports.offsetBounds = function(node) {\n    var parent = node.offsetParent ? exports.offsetBounds(node.offsetParent) : {top: 0, left: 0};\n\n    return {\n        top: node.offsetTop + parent.top,\n        bottom: node.offsetTop + node.offsetHeight + parent.top,\n        right: node.offsetLeft + parent.left + node.offsetWidth,\n        left: node.offsetLeft + parent.left,\n        width: node.offsetWidth,\n        height: node.offsetHeight\n    };\n};\n\nexports.parseBackgrounds = function(backgroundImage) {\n    var whitespace = ' \\r\\n\\t',\n        method, definition, prefix, prefix_i, block, results = [],\n        mode = 0, numParen = 0, quote, args;\n    var appendResult = function() {\n        if(method) {\n            if (definition.substr(0, 1) === '\"') {\n                definition = definition.substr(1, definition.length - 2);\n            }\n            if (definition) {\n                args.push(definition);\n            }\n            if (method.substr(0, 1) === '-' && (prefix_i = method.indexOf('-', 1 ) + 1) > 0) {\n                prefix = method.substr(0, prefix_i);\n                method = method.substr(prefix_i);\n            }\n            results.push({\n                prefix: prefix,\n                method: method.toLowerCase(),\n                value: block,\n                args: args,\n                image: null\n            });\n        }\n        args = [];\n        method = prefix = definition = block = '';\n    };\n    args = [];\n    method = prefix = definition = block = '';\n    backgroundImage.split(\"\").forEach(function(c) {\n        if (mode === 0 && whitespace.indexOf(c) > -1) {\n            return;\n        }\n        switch(c) {\n        case '\"':\n            if(!quote) {\n                quote = c;\n            } else if(quote === c) {\n                quote = null;\n            }\n            break;\n        case '(':\n            if(quote) {\n                break;\n            } else if(mode === 0) {\n                mode = 1;\n                block += c;\n                return;\n            } else {\n                numParen++;\n            }\n            break;\n        case ')':\n            if (quote) {\n                break;\n            } else if(mode === 1) {\n                if(numParen === 0) {\n                    mode = 0;\n                    block += c;\n                    appendResult();\n                    return;\n                } else {\n                    numParen--;\n                }\n            }\n            break;\n\n        case ',':\n            if (quote) {\n                break;\n            } else if(mode === 0) {\n                appendResult();\n                return;\n            } else if (mode === 1) {\n                if (numParen === 0 && !method.match(/^url$/i)) {\n                    args.push(definition);\n                    definition = '';\n                    block += c;\n                    return;\n                }\n            }\n            break;\n        }\n\n        block += c;\n        if (mode === 0) {\n            method += c;\n        } else {\n            definition += c;\n        }\n    });\n\n    appendResult();\n    return results;\n};\n\n},{}],27:[function(_dereq_,module,exports){\nvar GradientContainer = _dereq_('./gradientcontainer');\n\nfunction WebkitGradientContainer(imageData) {\n    GradientContainer.apply(this, arguments);\n    this.type = imageData.args[0] === \"linear\" ? GradientContainer.TYPES.LINEAR : GradientContainer.TYPES.RADIAL;\n}\n\nWebkitGradientContainer.prototype = Object.create(GradientContainer.prototype);\n\nmodule.exports = WebkitGradientContainer;\n\n},{\"./gradientcontainer\":9}],28:[function(_dereq_,module,exports){\nfunction XHR(url) {\n    return new Promise(function(resolve, reject) {\n        var xhr = new XMLHttpRequest();\n        xhr.open('GET', url);\n\n        xhr.onload = function() {\n            if (xhr.status === 200) {\n                resolve(xhr.responseText);\n            } else {\n                reject(new Error(xhr.statusText));\n            }\n        };\n\n        xhr.onerror = function() {\n            reject(new Error(\"Network Error\"));\n        };\n\n        xhr.send();\n    });\n}\n\nmodule.exports = XHR;\n\n},{}]},{},[4])(4)\n});\n\n\n/** WEBPACK FOOTER **\n ** ./~/html2canvas/dist/html2canvas.js\n **/","/**\n * base class for all object in the library\n * @class Baseobject\n */\nexport default class BaseObject {\n  /**\n   * virtual function for returning class name\n   * @returns {string}\n   */\n  getName() {\n    return '';\n  }\n\n  /**\n   * returns if current mode is debugging mode\n   * @returns {bool}\n   */\n  isDebug() {\n    return this._debugMode;\n  }\n\n  /**\n   * logs message and object for debugging purpose\n   * @param {string} message\n   * @param {Array<any>} args\n   */\n  log(message, ...args) {\n    if (!this.isDebug()) {\n      return;\n    }\n\n    console.log(`${this.getName()}: ${message}`, ...args);\n  }\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/base-object.js\n **/","import BaseObject from './base-object';\nimport Rect from './rect';\n\n/**\n * State enabled class to manage grey canvas on top of html page for cropping\n * @class CanvasState\n */\nexport default class CanvasState extends BaseObject {\n  /**\n   * object constructor\n   * @param {HTMLDocument} doc\n   * @param {HTMLElement} canvas - canvas DOM element\n   */\n  constructor(doc, canvas, debugMode = true) {\n    super();\n\n    this._document = doc;\n    this._canvas = canvas;\n    this._width = canvas.width;\n    this._height = canvas.height;\n    this._ctx = canvas.getContext('2d');\n    this._debugMode = debugMode;\n\n    const html = this._document.body.parentNode;\n\n    this._htmlTop = html.offsetTop;\n    this._htmlLeft = html.offsetLeft;\n\n    this._valid = false; // when set to false, the canvas will redraw everything\n    this._shape = null;  // the rectangle shape\n    this._dragging = false; // Keep track of when we are dragging\n    this._dragoffx = 0; // See mousedown and mousemove events for explanation\n    this._dragoffy = 0;\n\n    this.log('initialized');\n\n    this._initRect();\n    this._initEvents();\n\n    this._interval = 30;\n    setInterval(() => {\n      this.draw();\n    }, this._interval);\n  }\n\n  /**\n   * returns class name\n   * @returns {string}\n   */\n  getName() {\n    return 'CanvasState';\n  }\n\n  /**\n   * attaches event handlers to canvas\n   * @private\n   */\n  _initEvents() {\n    const { _canvas } = this;\n    // fixes a problem where double clicking causesShape text to get selected on the canvas\n    _canvas.addEventListener('selectstart', (e) => {\n      e.preventDefault();\n      return false;\n    }, false);\n\n    // up, down, and move are for dragging\n    _canvas.addEventListener('mousedown', (e) => {\n      const { _shape } = this;\n      const mouse = this.getMouse(e);\n      const mx = mouse.x;\n      const my = mouse.y;\n      this._valid = false;\n      if (_shape.contains(mx, my)) {\n        this._dragoffx = mx - _shape._x;\n        this._dragoffy = my - _shape._y;\n        this._dragging = true;\n\n        this.log('mouse down detected. starting drag', mx, my);\n      }\n\n      this._currentHandle = this._shape.getHoverSelectionHandle(mouse.x, mouse.y);\n    }, true);\n\n    _canvas.addEventListener('mousemove', (e) => {\n      const { _shape } = this;\n      const mouse = this.getMouse(e);\n      const oldx = _shape._x;\n      const oldy = _shape._y;\n      const mx = mouse.x;\n      const my = mouse.y;\n      const handleIndex = _shape.getHoverSelectionHandle(mx, my);\n      switch (handleIndex) {\n        case 0:\n          _canvas.style.cursor = 'nw-resize';\n          break;\n        case 1:\n          _canvas.style.cursor = 'n-resize';\n          break;\n        case 2:\n          _canvas.style.cursor = 'ne-resize';\n          break;\n        case 3:\n          _canvas.style.cursor = 'w-resize';\n          break;\n        case 4:\n          _canvas.style.cursor = 'e-resize';\n          break;\n        case 5:\n          _canvas.style.cursor = 'sw-resize';\n          break;\n        case 6:\n          _canvas.style.cursor = 's-resize';\n          break;\n        case 7:\n          _canvas.style.cursor = 'se-resize';\n          break;\n        default:\n          _canvas.style.cursor = 'auto';\n      }\n\n      if (this._currentHandle !== false) {\n        // Handles resizing\n        switch (this._currentHandle) {\n          case 0:\n            _shape._x = mx;\n            _shape._y = my;\n            _shape._w += oldx - mx;\n            _shape._h += oldy - my;\n            break;\n          case 1:\n            _shape._y = my;\n            _shape._h += oldy - my;\n            break;\n          case 2:\n            _shape._y = my;\n            _shape._w = mx - oldx;\n            _shape._h += oldy - my;\n            break;\n          case 3:\n            _shape._x = mx;\n            _shape._w += oldx - mx;\n            break;\n          case 4:\n            _shape._w = mx - oldx;\n            break;\n          case 5:\n            _shape._x = mx;\n            _shape._w += oldx - mx;\n            _shape._h = my - oldy;\n            break;\n          case 6:\n            _shape._h = my - oldy;\n            break;\n          case 7:\n            _shape._w = mx - oldx;\n            _shape._h = my - oldy;\n            break;\n          default:\n            break;\n        }\n        this._valid = false;\n      } else if (this._dragging) {\n        // We don't want to drag the object by its top-left corner, we want to drag it\n        // from where we clicked. Thats why we saved the offset and use it here\n        this._shape._x = mouse.x - this._dragoffx;\n        this._shape._y = mouse.y - this._dragoffy;\n        this._valid = false; // Something's dragging so we must redraw\n\n        // this.log('moving the rect', mouse.x, mouse.y);\n      }\n    }, true);\n\n    _canvas.addEventListener('mouseup', () => {\n      this._dragging = false;\n      this._currentHandle = false;\n      this.log('dragging finished');\n    });\n\n    this.log('initialized events');\n  }\n\n  /**\n   * creates a movable rectangle and attach to canvas\n   * @private\n   */\n  _initRect() {\n    this._shape = new Rect(\n      this._width / 4,\n      this._height / 4,\n      this._width / 2,\n      this._height / 2,\n      'rgba(0, 200, 0, 0.5)'\n    );\n    this._valid = false;\n  }\n\n  /**\n   * Returns shape positions\n   * @returns {{x, y, w, h}}\n   */\n  getSelection() {\n    const { _x, _y, _w, _h } = this._shape;\n    return { x: _x, y: _y, w: _w, h: _h };\n  }\n\n  /**\n   * clears the canvas for next draw\n   */\n  clear() {\n    this._ctx.clearRect(0, 0, this._width, this._height);\n  }\n\n  /**\n   * while draw is called as often as the INTERVAL variable demands,\n   * it only ever does something if the canvas gets invalidated by our code\n   */\n  draw() {\n    // if our state is invalid, redraw and validate!\n    if (!this._valid) {\n      const { _ctx, _shape } = this;\n      this.clear();\n\n      // fill outside of the rectangle\n      _ctx.fillStyle = 'rgba(0,0,0,.8)';\n      _ctx.beginPath();\n      _ctx.rect(_shape._x, _shape._y, _shape._w, _shape._h);\n      _ctx.rect(this._width, 0, -this._width, this._height);\n      _ctx.fill();\n\n      // draw shape\n      _shape.draw(_ctx);\n\n      this._valid = true;\n\n      this.log('shape drew', _shape._x, _shape._y, _shape._w, _shape._h);\n    }\n  }\n\n  /**\n   * creates an object with x and y defined, set to the mouse position relative to the state's canvas\n   * If you wanna be super-correct this can be tricky, we have to worry about padding and borders\n   * @param {Event} e\n   * @returns {{x: number, y: number}}\n   */\n  getMouse(e) {\n    let el = this._canvas;\n    let offsetX = 0;\n    let offsetY = 0;\n\n    // Compute the total offset\n    if (el.offsetParent !== undefined) {\n      do {\n        offsetX += el.offsetLeft;\n        offsetY += el.offsetTop;\n        el = el.offsetParent;\n      } while (el);\n    }\n\n    // Also add the <html> offsets in case there's a position:fixed bar\n    offsetX += this._htmlLeft;\n    offsetY += this._htmlTop;\n\n    const mx = e.pageX - offsetX;\n    const my = e.pageY - offsetY;\n\n    return { x: mx, y: my };\n  }\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/canvas-state.js\n **/","import BaseObject from './base-object';\n\n/**\n * Rectangle for highlighting the cropping area\n * @class Rect\n */\nexport default class Rect extends BaseObject {\n  /**\n   * object constructor\n   * @param {number} x - left position of shape\n   * @param {number} y - top position of shape\n   * @param {number} w - width\n   * @param {number} h - height\n   * @param {string} fill - background color of the shape\n   */\n  constructor(x, y, w, h, fill, debugMode = true) {\n    super();\n\n    this._selectionHandles = [];\n    this._selectionBoxSize = 6;\n    for (let i = 0; i < 8; i += 1) {\n      this._selectionHandles.push({ x: 0, y: 0 });\n    }\n\n    this._x = x || 0;\n    this._y = y || 0;\n    this._w = w || 1;\n    this._h = h || 1;\n    this._fill = fill || '#AAAAAA';\n    this._debugMode = debugMode;\n\n    this.log('initialized');\n  }\n\n  /**\n   * returns class name\n   * @returns {string}\n   */\n  getName() {\n    return 'Rect';\n  }\n\n  /**\n   * draws the shape\n   * @param {CanvasContext} ctx\n   */\n  draw(ctx) {\n    const { _x, _y, _w, _h, _fill, _selectionHandles, _selectionBoxSize } = this;\n    ctx.fillStyle = _fill; // eslint-disable-line\n    ctx.strokeStyle = 'white'; // eslint-disable-line\n    ctx.lineWidth = 1; // eslint-disable-line\n    ctx.setLineDash([7, 7]);\n    ctx.strokeRect(_x, _y, _w, _h);\n\n    const half = _selectionBoxSize / 2;\n\n    // top left, middle, right\n    _selectionHandles[0].x = _x - half;\n    _selectionHandles[0].y = _y - half;\n\n    _selectionHandles[1].x = _x + _w / 2 - half;\n    _selectionHandles[1].y = _y - half;\n\n    _selectionHandles[2].x = _x + _w - half;\n    _selectionHandles[2].y = _y - half;\n\n    // middle left\n    _selectionHandles[3].x = _x - half;\n    _selectionHandles[3].y = _y + _h / 2 - half;\n\n    // middle right\n    _selectionHandles[4].x = _x + _w - half;\n    _selectionHandles[4].y = _y + _h / 2 - half;\n\n    // bottom left, middle, right\n    _selectionHandles[6].x = _x + _w / 2 - half;\n    _selectionHandles[6].y = _y + _h - half;\n\n    _selectionHandles[5].x = _x - half;\n    _selectionHandles[5].y = _y + _h - half;\n\n    _selectionHandles[7].x = _x + _w - half;\n    _selectionHandles[7].y = _y + _h - half;\n\n    this.log('drawing selection boxes');\n    ctx.fillStyle = 'white'; // eslint-disable-line\n    _selectionHandles.forEach((cur) => {\n      ctx.fillRect(cur.x, cur.y, _selectionBoxSize, _selectionBoxSize);\n    });\n\n    this.log('filling the rectangle', _x, _y, _w, _h);\n  }\n\n  /**\n   * checks if point is inside the shape\n   * @param {number} mx\n   * @param {number} my\n   * @returns {bool}\n   */\n  contains(mx, my) {\n    const { _x, _y, _w, _h } = this;\n    return (_x <= mx) && (_x + _w >= mx) &&\n      (_y <= my) && (_y + _h >= my);\n  }\n\n  /**\n   * returns selection handle if point is inside\n   * @param {number} mx\n   * @param {number} my\n   * @returns {?number}\n   */\n  getHoverSelectionHandle(mx, my) {\n    const { _selectionHandles, _selectionBoxSize } = this;\n    for (let i = 0; i < _selectionHandles.length; i += 1) {\n      const handle = _selectionHandles[i];\n      if (\n        (handle.x <= mx) &&\n        (handle.x + _selectionBoxSize >= mx) &&\n        (handle.y <= my) &&\n        (handle.y + _selectionBoxSize >= my)\n      ) {\n        return i;\n      }\n    }\n\n    return false;\n  }\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/rect.js\n **/"],"sourceRoot":""}