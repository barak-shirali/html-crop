{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///HtmlCrop.min.js","webpack:///webpack/bootstrap 19b980fc6f4d3aeeaee9","webpack:///./src/index.js","webpack:///./~/html2canvas/dist/html2canvas.js","webpack:///./src/base-object.js","webpack:///./src/canvas-state.js","webpack:///./src/rect.js"],"names":["root","factory","exports","module","define","amd","this","modules","__webpack_require__","moduleId","installedModules","id","loaded","call","m","c","p","_interopRequireDefault","obj","__esModule","default","_classCallCheck","instance","Constructor","TypeError","_possibleConstructorReturn","self","ReferenceError","_inherits","subClass","superClass","prototype","Object","create","constructor","value","enumerable","writable","configurable","setPrototypeOf","__proto__","defineProperty","_createClass","defineProperties","target","props","i","length","descriptor","key","protoProps","staticProps","_html2canvas","_html2canvas2","_baseObject","_baseObject2","_canvasState","_canvasState2","HtmlCrop","_BaseObject","doc","options","arguments","undefined","_this","getPrototypeOf","_document","assign","_debugMode","debug","getElementById","log","body","then","canvas","appendChild","__WEBPACK_AMD_DEFINE_FACTORY__","__WEBPACK_AMD_DEFINE_ARRAY__","__WEBPACK_AMD_DEFINE_RESULT__","require","global","_typeof","Symbol","iterator","f","apply","e","t","n","r","s","o","u","a","Error","code","l","1","_dereq_","error","type","RangeError","errors","map","array","fn","result","mapDomain","string","parts","split","replace","regexSeparators","labels","encoded","join","ucs2decode","extra","output","counter","charCodeAt","push","ucs2encode","stringFromCharCode","basicToDigit","codePoint","base","digitToBasic","digit","flag","adapt","delta","numPoints","firstTime","k","floor","damp","baseMinusTMin","tMax","skew","decode","input","out","basic","j","index","oldi","w","baseMinusT","inputLength","initialN","bias","initialBias","lastIndexOf","delimiter","maxInt","tMin","splice","encode","handledCPCount","basicLength","q","currentValue","handledCPCountPlusOne","qMinusT","toUnicode","regexPunycode","test","slice","toLowerCase","toASCII","regexNonASCII","freeExports","nodeType","freeModule","freeGlobal","window","punycode","overflow","not-basic","invalid-input","Math","String","fromCharCode","version","ucs2","hasOwnProperty","2","restoreOwnerScroll","ownerDocument","x","y","defaultView","pageXOffset","pageYOffset","scrollTo","cloneCanvasContents","clonedCanvas","width","height","getContext","putImageData","getImageData","cloneNode","node","javascriptEnabled","clone","document","createTextNode","nodeValue","child","firstChild","nodeName","nextSibling","_scrollTop","scrollTop","_scrollLeft","scrollLeft","initNode","containerDocument","documentElement","container","createElement","className","style","visibility","position","left","top","border","scrolling","Promise","resolve","documentClone","contentWindow","onload","interval","setInterval","childNodes","clearInterval","navigator","userAgent","scrollY","scrollX","open","write","replaceChild","adoptNode","close","./log","3","Color","g","b","fromArray","namedColor","rgb","rgba","hex6","hex3","darken","amount","round","isTransparent","isBlack","Array","isArray","min","_hex3","match","parseInt","_hex6","substring","_rgb","Number","_rgba","toString","color","colors","isColor","aliceblue","antiquewhite","aqua","aquamarine","azure","beige","bisque","black","blanchedalmond","blue","blueviolet","brown","burlywood","cadetblue","chartreuse","chocolate","coral","cornflowerblue","cornsilk","crimson","cyan","darkblue","darkcyan","darkgoldenrod","darkgray","darkgreen","darkgrey","darkkhaki","darkmagenta","darkolivegreen","darkorange","darkorchid","darkred","darksalmon","darkseagreen","darkslateblue","darkslategray","darkslategrey","darkturquoise","darkviolet","deeppink","deepskyblue","dimgray","dimgrey","dodgerblue","firebrick","floralwhite","forestgreen","fuchsia","gainsboro","ghostwhite","gold","goldenrod","gray","green","greenyellow","grey","honeydew","hotpink","indianred","indigo","ivory","khaki","lavender","lavenderblush","lawngreen","lemonchiffon","lightblue","lightcoral","lightcyan","lightgoldenrodyellow","lightgray","lightgreen","lightgrey","lightpink","lightsalmon","lightseagreen","lightskyblue","lightslategray","lightslategrey","lightsteelblue","lightyellow","lime","limegreen","linen","magenta","maroon","mediumaquamarine","mediumblue","mediumorchid","mediumpurple","mediumseagreen","mediumslateblue","mediumspringgreen","mediumturquoise","mediumvioletred","midnightblue","mintcream","mistyrose","moccasin","navajowhite","navy","oldlace","olive","olivedrab","orange","orangered","orchid","palegoldenrod","palegreen","paleturquoise","palevioletred","papayawhip","peachpuff","peru","pink","plum","powderblue","purple","rebeccapurple","red","rosybrown","royalblue","saddlebrown","salmon","sandybrown","seagreen","seashell","sienna","silver","skyblue","slateblue","slategray","slategrey","snow","springgreen","steelblue","tan","teal","thistle","tomato","turquoise","violet","wheat","white","whitesmoke","yellow","yellowgreen","4","html2canvas","nodeList","html2canvasCloneIndex","logging","start","Date","now","async","allowTaint","removeContainer","imageTimeout","renderer","CanvasRenderer","strict","proxy","reject","innerWidth","innerHeight","loadUrlDocument","absoluteUrl","renderWindow","setAttribute","html2canvasNodeAttribute","renderDocument","onrendered","windowWidth","windowHeight","html2canvasIndex","createWindowClone","attributeName","selector","querySelector","removeAttribute","clonedWindow","oncloneHandler","onclone","support","Support","imageLoader","ImageLoader","bounds","getBounds","documentWidth","documentHeight","parser","NodeParser","ready","crop","cleanupContainer","parentNode","removeChild","croppedCanvas","x1","max","x2","y1","y2","drawImage","scrollWidth","offsetWidth","clientWidth","scrollHeight","offsetHeight","clientHeight","url","link","href","NodeContainer","utils","html2canvasExport","./clone","./imageloader","./nodecontainer","./nodeparser","./proxy","./renderers/canvas","./support","./utils","5","DummyImageContainer","src","promise","image","Image","onerror","smallImage","complete","6","Font","family","size","baseline","middle","img","span","sampleText","fontFamily","fontSize","margin","padding","verticalAlign","offsetTop","lineHeight","lineWidth","7","FontMetrics","data","getMetrics","./font","8","FrameContainer","sameOrigin","URL","proxyLoad","./core","9","GradientContainer","imageData","colorStops","x0","y0","TYPES","LINEAR","RADIAL","REGEXP_COLORSTOP","10","ImageContainer","cors","tainted","crossOrigin","11","origin","getOrigin","location","ProxyImageContainer","SVGContainer","SVGNodeContainer","LinearGradientContainer","WebkitGradientContainer","bind","findImages","nodes","images","reduce","imageNodes","concat","args","method","forEach","addImage","loadImage","findBackgroundImage","parseBackgroundImages","filter","hasImageBackground","callback","newImage","imageExists","isSVG","svg","isSameOrigin","useCORS","isInline","some","protocol","hostname","port","getPromise","timeout","dummy","get","found","fetch","all","timer","race","res","setTimeout","clearTimeout","./dummyimagecontainer","./framecontainer","./imagecontainer","./lineargradientcontainer","./proxyimagecontainer","./svgcontainer","./svgnodecontainer","./webkitgradientcontainer","12","hasDirection","REGEXP_DIRECTION","reverse","ratio","parseFloat","isNaN","colorStop","colorStopMatch","unit","stop","find","count","./color","./gradientcontainer","13","logger","console","Function","14","parent","stack","borders","clip","backgroundClip","offsetBounds","visible","computedStyles","styles","backgroundImages","transformData","transformMatrix","isPseudoElement","opacity","selectionValue","option","selectedIndex","text","parseMatrix","trim","matrix3d","isPercentage","indexOf","removePx","str","asFloat","parseBackgrounds","cloneTo","getOpacity","cssFloat","assignStack","children","isElementVisible","Node","TEXT_NODE","css","hasAttribute","getAttribute","attribute","computedStyle","before","prefixedCss","prefixes","prefix","substr","toUpperCase","getComputedStyle","cssInt","fontWeight","weight","parseClip","matches","CLIP","right","bottom","cssList","property","parseBackgroundSize","targetRatio","currentRatio","parseBackgroundPosition","backgroundSize","parseBackgroundRepeat","parseTextShadows","textShadow","results","shadows","TEXT_SHADOW_PROPERTY","TEXT_SHADOW_VALUES","offsetX","offsetY","blur","parseTransform","hasTransform","offset","parseBounds","matrix","parseTransformMatrix","transform","MATRIX_PROPERTY","getValue","tagName","placeholder","15","element","range","renderQueue","StackingContext","background","rectangle","canvasBackground","visibile","createPseudoHideStyles","disableAnimations","flatten","getChildren","getPseudoElements","fontMetrics","calculateOverflowClips","isElement","createStackingContexts","sortStackingContexts","parse","renderIndex","asyncRenderer","paint","hasParentClip","toCamelCase","ClearTransform","calculateBorders","nodeBounds","borderPoints","radius","borderSide","bx","by","bw","bh","drawSide","c1","c2","c3","c4","topLeftOuter","topLeftInner","topRightOuter","topRightInner","bottomRightOuter","bottomRightInner","bottomLeftOuter","bottomLeftInner","getCurvePoints","r1","r2","kappa","sqrt","ox","oy","xm","ym","topLeft","bezierCurve","topRight","bottomRight","bottomLeft","calculateCurvePoints","borderRadius","tlh","tlv","trh","trv","brh","brv","blh","blv","topWidth","rightHeight","bottomWidth","leftHeight","subdivide","startControl","endControl","end","lerp","ab","bc","cd","abbc","bccd","dest","curveTo","borderArgs","curveToReversed","borderData","radius1","radius2","outer1","inner1","outer2","inner2","parseCorner","corner1","corner2","negativeZIndex","positiveZIndex","zIndex0","inlineLevel","isStackingContext","hasText","noLetterSpacing","getBorderRadiusData","side","arr","asInt","renderableNode","ELEMENT_NODE","isPositionedForStacking","zIndex","isPositioned","isFloating","isInlineBlock","not","context","isTextNode","zIndexSort","contexts","hasOpacity","getWidth","nonIgnoredElement","nodeContainer","arrays","stripQuotes","content","first","getWords","characters","word","words","onWordBoundary","isWordBoundary","characterCode","hasUnicode","TextContainer","PseudoElementContainer","appendToDOM","parseBorders","cssClip","cleanDOM","queue","asyncTimer","createStyles","PSEUDO_HIDE_ELEMENT_CLASS_BEFORE","PSEUDO_HIDE_ELEMENT_CLASS_AFTER","hidePseudoElements","innerHTML","getPseudoElement","after","display","isImage","pseudoNode","pseudoContainer","item","parentContainer","newStackingContext","hasOwnStacking","parentStack","getParentStack","isRootElement","isBodyWithTransparentRoot","sort","parseTextBounds","textList","rangeBounds","getRangeBounds","replacementNode","splitText","getWrapperBounds","wrapper","backupText","createRange","setStart","setEnd","getBoundingClientRect","negativeZindex","descendantElements","descendantNonFloats","nonInlineNonPositionedDescendants","nonPositionedFloats","inFlow","stackLevel0","positiveZindex","ctx","restore","paintText","paintNode","setOpacity","save","setTransform","paintCheckbox","paintRadio","paintElement","renderBackground","renderBorders","imgContainer","renderImage","imageContainer","paintFormValue","checked","font","circleStroke","circle","ceil","properties","message","textContent","applyTextTransform","letterRendering","character","fontShadow","clearShadow","renderTextDecoration","metrics","borderColorTransforms","inset","colorTransform","parseBackgroundClip","./fontmetrics","./pseudoelementcontainer","./stackingcontext","./textcontainer","16","Proxy","proxyUrl","supportsCORS","XMLHttpRequest","createCallback","createProxyUrl","XHR","jsonp","response","decode64","ProxyURL","supportsCORSImage","cleanup","proxyCount","random","encodeURIComponent","documentFromHTML","html","DOMParser","parseFromString","implementation","createHTMLDocument","ee","host","head","insertBefore","./xhr","17","18","getHideClass","19","Renderer","paddingLeft","paddingTop","paddingRight","paddingBottom","renderBackgroundColor","renderBackgroundImage","renderBorder","drawShape","backgroundImage","renderBackgroundRepeating","gradientImage","renderBackgroundGradient","repeat","backgroundRepeatShape","renderBackgroundRepeat","20","taintCtx","textBaseline","variables","hasEntries","setFillStyle","fillStyle","fillRect","beginPath","arc","PI","closePath","fill","stroke","strokeColor","strokeStyle","shape","taints","sx","sy","sw","sh","dx","dy","dw","dh","shapes","point","rect","variant","setVariable","globalAlpha","translate","fillText","backgroundPosition","borderLeft","borderTop","createPattern","resizeImage","gradient","createLinearGradient","addColorStop","../lineargradientcontainer","../log","../renderer","21","ownStacking","22","testRangeBounds","testCORS","testSVG","testElement","rangeHeight","selectNode","toDataURL","23","hasFabric","inlineFormatting","fabric","loadSVGFromString","createCanvas","removeContentType","objects","StaticCanvas","lowerCanvasEl","setWidth","setHeight","add","util","groupSVGElements","renderAll","atob","24","_native","XMLSerializer","serializeToString","parseSVGDocument","25","capitalize","p1","p2","26","base64","encoded1","encoded2","encoded3","encoded4","byte1","byte2","byte3","chars","len","clientRect","offsetParent","offsetLeft","definition","prefix_i","block","quote","whitespace","mode","numParen","appendResult","27","28","xhr","status","responseText","statusText","send","BaseObject","_console","isDebug","_len","_key","getName","_rect","_rect2","CanvasState","debugMode","_canvas","_width","_height","_ctx","_htmlTop","_htmlLeft","_valid","_shape","_dragging","_dragoffx","_dragoffy","_initRect","_initEvents","_interval","draw","_this2","addEventListener","preventDefault","mouse","getMouse","mx","my","contains","_x","_y","clearRect","clear","strokeRect","_w","_h","el","pageX","pageY","Rect","h","_fill"],"mappings":"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","file":"HtmlCrop.min.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine(\"HtmlCrop\", [], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"HtmlCrop\"] = factory();\n\telse\n\t\troot[\"HtmlCrop\"] = factory();\n})(this, function() {\nreturn \n\n\n/** WEBPACK FOOTER **\n ** webpack/universalModuleDefinition\n **/","(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine(\"HtmlCrop\", [], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"HtmlCrop\"] = factory();\n\telse\n\t\troot[\"HtmlCrop\"] = factory();\n})(this, function() {\nreturn /******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId])\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\texports: {},\n/******/ \t\t\tid: moduleId,\n/******/ \t\t\tloaded: false\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.loaded = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"\";\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(0);\n/******/ })\n/************************************************************************/\n/******/ ([\n/* 0 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tvar _html2canvas = __webpack_require__(1);\n\t\n\tvar _html2canvas2 = _interopRequireDefault(_html2canvas);\n\t\n\tvar _baseObject = __webpack_require__(2);\n\t\n\tvar _baseObject2 = _interopRequireDefault(_baseObject);\n\t\n\tvar _canvasState = __webpack_require__(3);\n\t\n\tvar _canvasState2 = _interopRequireDefault(_canvasState);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\t\n\tfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\t\n\tvar HtmlCrop = function (_BaseObject) {\n\t  _inherits(HtmlCrop, _BaseObject);\n\t\n\t  /**\n\t   * object constructor\n\t   * @param {HTMLDocument} doc\n\t   * @param {Object} options\n\t   */\n\t  function HtmlCrop(doc) {\n\t    var options = arguments.length <= 1 || arguments[1] === undefined ? {} : arguments[1];\n\t\n\t    _classCallCheck(this, HtmlCrop);\n\t\n\t    var _this = _possibleConstructorReturn(this, (HtmlCrop.__proto__ || Object.getPrototypeOf(HtmlCrop)).call(this));\n\t\n\t    _this._document = doc;\n\t    _this.options = Object.assign({}, options);\n\t    _this._debugMode = options.debug;\n\t    _this._canvasState = new _canvasState2.default(doc, doc.getElementById('canvas'), _this._debugMode);\n\t    _this.log('initialized');\n\t\n\t    // testing\n\t    (0, _html2canvas2.default)(_this._document.body).then(function (canvas) {\n\t      _this._document.body.appendChild(canvas);\n\t    });\n\t    return _this;\n\t  }\n\t\n\t  /**\n\t   * returns class name\n\t   * @returns {string}\n\t   */\n\t\n\t\n\t  _createClass(HtmlCrop, [{\n\t    key: 'getName',\n\t    value: function getName() {\n\t      return 'HtmlCrop';\n\t    }\n\t  }]);\n\t\n\t  return HtmlCrop;\n\t}(_baseObject2.default);\n\t\n\texports.default = HtmlCrop;\n\tmodule.exports = exports['default'];\n\n/***/ },\n/* 1 */\n/***/ function(module, exports, __webpack_require__) {\n\n\tvar __WEBPACK_AMD_DEFINE_FACTORY__, __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;var require;var require;/* WEBPACK VAR INJECTION */(function(global) {\"use strict\";var _typeof=typeof Symbol===\"function\"&&typeof Symbol.iterator===\"symbol\"?function(obj){return typeof obj;}:function(obj){return obj&&typeof Symbol===\"function\"&&obj.constructor===Symbol?\"symbol\":typeof obj;};/*\n\t  html2canvas 0.5.0-beta4 <http://html2canvas.hertzen.com>\n\t  Copyright (c) 2016 Niklas von Hertzen\n\t\n\t  Released under  License\n\t*/(function(f){if(( false?\"undefined\":_typeof(exports))===\"object\"&&typeof module!==\"undefined\"){module.exports=f();}else if(true){!(__WEBPACK_AMD_DEFINE_ARRAY__ = [], __WEBPACK_AMD_DEFINE_FACTORY__ = (f), __WEBPACK_AMD_DEFINE_RESULT__ = (typeof __WEBPACK_AMD_DEFINE_FACTORY__ === 'function' ? (__WEBPACK_AMD_DEFINE_FACTORY__.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__)) : __WEBPACK_AMD_DEFINE_FACTORY__), __WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));}else{var g;if(typeof window!==\"undefined\"){g=window;}else if(typeof global!==\"undefined\"){g=global;}else if(typeof self!==\"undefined\"){g=self;}else{g=this;}g.html2canvas=f();}})(function(){var define,module,exports;return function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return require(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f;}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e);},l,l.exports,e,t,n,r);}return n[o].exports;}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++){s(r[o]);}return s;}({1:[function(_dereq_,module,exports){(function(global){/*! https://mths.be/punycode v1.4.0 by @mathias */;(function(root){/** Detect free variables */var freeExports=(typeof exports===\"undefined\"?\"undefined\":_typeof(exports))=='object'&&exports&&!exports.nodeType&&exports;var freeModule=(typeof module===\"undefined\"?\"undefined\":_typeof(module))=='object'&&module&&!module.nodeType&&module;var freeGlobal=(typeof global===\"undefined\"?\"undefined\":_typeof(global))=='object'&&global;if(freeGlobal.global===freeGlobal||freeGlobal.window===freeGlobal||freeGlobal.self===freeGlobal){root=freeGlobal;}/**\n\t\t * The `punycode` object.\n\t\t * @name punycode\n\t\t * @type Object\n\t\t */var punycode,/** Highest positive signed 32-bit float value */maxInt=2147483647,// aka. 0x7FFFFFFF or 2^31-1\n\t/** Bootstring parameters */base=36,tMin=1,tMax=26,skew=38,damp=700,initialBias=72,initialN=128,// 0x80\n\tdelimiter='-',// '\\x2D'\n\t/** Regular expressions */regexPunycode=/^xn--/,regexNonASCII=/[^\\x20-\\x7E]/,// unprintable ASCII chars + non-ASCII chars\n\tregexSeparators=/[\\x2E\\u3002\\uFF0E\\uFF61]/g,// RFC 3490 separators\n\t/** Error messages */errors={'overflow':'Overflow: input needs wider integers to process','not-basic':'Illegal input >= 0x80 (not a basic code point)','invalid-input':'Invalid input'},/** Convenience shortcuts */baseMinusTMin=base-tMin,floor=Math.floor,stringFromCharCode=String.fromCharCode,/** Temporary variable */key;/*--------------------------------------------------------------------------*//**\n\t\t * A generic error utility function.\n\t\t * @private\n\t\t * @param {String} type The error type.\n\t\t * @returns {Error} Throws a `RangeError` with the applicable error message.\n\t\t */function error(type){throw new RangeError(errors[type]);}/**\n\t\t * A generic `Array#map` utility function.\n\t\t * @private\n\t\t * @param {Array} array The array to iterate over.\n\t\t * @param {Function} callback The function that gets called for every array\n\t\t * item.\n\t\t * @returns {Array} A new array of values returned by the callback function.\n\t\t */function map(array,fn){var length=array.length;var result=[];while(length--){result[length]=fn(array[length]);}return result;}/**\n\t\t * A simple `Array#map`-like wrapper to work with domain name strings or email\n\t\t * addresses.\n\t\t * @private\n\t\t * @param {String} domain The domain name or email address.\n\t\t * @param {Function} callback The function that gets called for every\n\t\t * character.\n\t\t * @returns {Array} A new string of characters returned by the callback\n\t\t * function.\n\t\t */function mapDomain(string,fn){var parts=string.split('@');var result='';if(parts.length>1){// In email addresses, only the domain name should be punycoded. Leave\n\t// the local part (i.e. everything up to `@`) intact.\n\tresult=parts[0]+'@';string=parts[1];}// Avoid `split(regex)` for IE8 compatibility. See #17.\n\tstring=string.replace(regexSeparators,'\\x2E');var labels=string.split('.');var encoded=map(labels,fn).join('.');return result+encoded;}/**\n\t\t * Creates an array containing the numeric code points of each Unicode\n\t\t * character in the string. While JavaScript uses UCS-2 internally,\n\t\t * this function will convert a pair of surrogate halves (each of which\n\t\t * UCS-2 exposes as separate characters) into a single code point,\n\t\t * matching UTF-16.\n\t\t * @see `punycode.ucs2.encode`\n\t\t * @see <https://mathiasbynens.be/notes/javascript-encoding>\n\t\t * @memberOf punycode.ucs2\n\t\t * @name decode\n\t\t * @param {String} string The Unicode input string (UCS-2).\n\t\t * @returns {Array} The new array of code points.\n\t\t */function ucs2decode(string){var output=[],counter=0,length=string.length,value,extra;while(counter<length){value=string.charCodeAt(counter++);if(value>=0xD800&&value<=0xDBFF&&counter<length){// high surrogate, and there is a next character\n\textra=string.charCodeAt(counter++);if((extra&0xFC00)==0xDC00){// low surrogate\n\toutput.push(((value&0x3FF)<<10)+(extra&0x3FF)+0x10000);}else{// unmatched surrogate; only append this code unit, in case the next\n\t// code unit is the high surrogate of a surrogate pair\n\toutput.push(value);counter--;}}else{output.push(value);}}return output;}/**\n\t\t * Creates a string based on an array of numeric code points.\n\t\t * @see `punycode.ucs2.decode`\n\t\t * @memberOf punycode.ucs2\n\t\t * @name encode\n\t\t * @param {Array} codePoints The array of numeric code points.\n\t\t * @returns {String} The new Unicode string (UCS-2).\n\t\t */function ucs2encode(array){return map(array,function(value){var output='';if(value>0xFFFF){value-=0x10000;output+=stringFromCharCode(value>>>10&0x3FF|0xD800);value=0xDC00|value&0x3FF;}output+=stringFromCharCode(value);return output;}).join('');}/**\n\t\t * Converts a basic code point into a digit/integer.\n\t\t * @see `digitToBasic()`\n\t\t * @private\n\t\t * @param {Number} codePoint The basic numeric code point value.\n\t\t * @returns {Number} The numeric value of a basic code point (for use in\n\t\t * representing integers) in the range `0` to `base - 1`, or `base` if\n\t\t * the code point does not represent a value.\n\t\t */function basicToDigit(codePoint){if(codePoint-48<10){return codePoint-22;}if(codePoint-65<26){return codePoint-65;}if(codePoint-97<26){return codePoint-97;}return base;}/**\n\t\t * Converts a digit/integer into a basic code point.\n\t\t * @see `basicToDigit()`\n\t\t * @private\n\t\t * @param {Number} digit The numeric value of a basic code point.\n\t\t * @returns {Number} The basic code point whose value (when used for\n\t\t * representing integers) is `digit`, which needs to be in the range\n\t\t * `0` to `base - 1`. If `flag` is non-zero, the uppercase form is\n\t\t * used; else, the lowercase form is used. The behavior is undefined\n\t\t * if `flag` is non-zero and `digit` has no uppercase form.\n\t\t */function digitToBasic(digit,flag){//  0..25 map to ASCII a..z or A..Z\n\t// 26..35 map to ASCII 0..9\n\treturn digit+22+75*(digit<26)-((flag!=0)<<5);}/**\n\t\t * Bias adaptation function as per section 3.4 of RFC 3492.\n\t\t * https://tools.ietf.org/html/rfc3492#section-3.4\n\t\t * @private\n\t\t */function adapt(delta,numPoints,firstTime){var k=0;delta=firstTime?floor(delta/damp):delta>>1;delta+=floor(delta/numPoints);for(;/* no initialization */delta>baseMinusTMin*tMax>>1;k+=base){delta=floor(delta/baseMinusTMin);}return floor(k+(baseMinusTMin+1)*delta/(delta+skew));}/**\n\t\t * Converts a Punycode string of ASCII-only symbols to a string of Unicode\n\t\t * symbols.\n\t\t * @memberOf punycode\n\t\t * @param {String} input The Punycode string of ASCII-only symbols.\n\t\t * @returns {String} The resulting string of Unicode symbols.\n\t\t */function decode(input){// Don't use UCS-2\n\tvar output=[],inputLength=input.length,out,i=0,n=initialN,bias=initialBias,basic,j,index,oldi,w,k,digit,t,/** Cached calculation results */baseMinusT;// Handle the basic code points: let `basic` be the number of input code\n\t// points before the last delimiter, or `0` if there is none, then copy\n\t// the first basic code points to the output.\n\tbasic=input.lastIndexOf(delimiter);if(basic<0){basic=0;}for(j=0;j<basic;++j){// if it's not a basic code point\n\tif(input.charCodeAt(j)>=0x80){error('not-basic');}output.push(input.charCodeAt(j));}// Main decoding loop: start just after the last delimiter if any basic code\n\t// points were copied; start at the beginning otherwise.\n\tfor(index=basic>0?basic+1:0;index<inputLength;)/* no final expression */{// `index` is the index of the next character to be consumed.\n\t// Decode a generalized variable-length integer into `delta`,\n\t// which gets added to `i`. The overflow checking is easier\n\t// if we increase `i` as we go, then subtract off its starting\n\t// value at the end to obtain `delta`.\n\tfor(oldi=i,w=1,k=base;;/* no condition */k+=base){if(index>=inputLength){error('invalid-input');}digit=basicToDigit(input.charCodeAt(index++));if(digit>=base||digit>floor((maxInt-i)/w)){error('overflow');}i+=digit*w;t=k<=bias?tMin:k>=bias+tMax?tMax:k-bias;if(digit<t){break;}baseMinusT=base-t;if(w>floor(maxInt/baseMinusT)){error('overflow');}w*=baseMinusT;}out=output.length+1;bias=adapt(i-oldi,out,oldi==0);// `i` was supposed to wrap around from `out` to `0`,\n\t// incrementing `n` each time, so we'll fix that now:\n\tif(floor(i/out)>maxInt-n){error('overflow');}n+=floor(i/out);i%=out;// Insert `n` at position `i` of the output\n\toutput.splice(i++,0,n);}return ucs2encode(output);}/**\n\t\t * Converts a string of Unicode symbols (e.g. a domain name label) to a\n\t\t * Punycode string of ASCII-only symbols.\n\t\t * @memberOf punycode\n\t\t * @param {String} input The string of Unicode symbols.\n\t\t * @returns {String} The resulting Punycode string of ASCII-only symbols.\n\t\t */function encode(input){var n,delta,handledCPCount,basicLength,bias,j,m,q,k,t,currentValue,output=[],/** `inputLength` will hold the number of code points in `input`. */inputLength,/** Cached calculation results */handledCPCountPlusOne,baseMinusT,qMinusT;// Convert the input in UCS-2 to Unicode\n\tinput=ucs2decode(input);// Cache the length\n\tinputLength=input.length;// Initialize the state\n\tn=initialN;delta=0;bias=initialBias;// Handle the basic code points\n\tfor(j=0;j<inputLength;++j){currentValue=input[j];if(currentValue<0x80){output.push(stringFromCharCode(currentValue));}}handledCPCount=basicLength=output.length;// `handledCPCount` is the number of code points that have been handled;\n\t// `basicLength` is the number of basic code points.\n\t// Finish the basic string - if it is not empty - with a delimiter\n\tif(basicLength){output.push(delimiter);}// Main encoding loop:\n\twhile(handledCPCount<inputLength){// All non-basic code points < n have been handled already. Find the next\n\t// larger one:\n\tfor(m=maxInt,j=0;j<inputLength;++j){currentValue=input[j];if(currentValue>=n&&currentValue<m){m=currentValue;}}// Increase `delta` enough to advance the decoder's <n,i> state to <m,0>,\n\t// but guard against overflow\n\thandledCPCountPlusOne=handledCPCount+1;if(m-n>floor((maxInt-delta)/handledCPCountPlusOne)){error('overflow');}delta+=(m-n)*handledCPCountPlusOne;n=m;for(j=0;j<inputLength;++j){currentValue=input[j];if(currentValue<n&&++delta>maxInt){error('overflow');}if(currentValue==n){// Represent delta as a generalized variable-length integer\n\tfor(q=delta,k=base;;/* no condition */k+=base){t=k<=bias?tMin:k>=bias+tMax?tMax:k-bias;if(q<t){break;}qMinusT=q-t;baseMinusT=base-t;output.push(stringFromCharCode(digitToBasic(t+qMinusT%baseMinusT,0)));q=floor(qMinusT/baseMinusT);}output.push(stringFromCharCode(digitToBasic(q,0)));bias=adapt(delta,handledCPCountPlusOne,handledCPCount==basicLength);delta=0;++handledCPCount;}}++delta;++n;}return output.join('');}/**\n\t\t * Converts a Punycode string representing a domain name or an email address\n\t\t * to Unicode. Only the Punycoded parts of the input will be converted, i.e.\n\t\t * it doesn't matter if you call it on a string that has already been\n\t\t * converted to Unicode.\n\t\t * @memberOf punycode\n\t\t * @param {String} input The Punycoded domain name or email address to\n\t\t * convert to Unicode.\n\t\t * @returns {String} The Unicode representation of the given Punycode\n\t\t * string.\n\t\t */function toUnicode(input){return mapDomain(input,function(string){return regexPunycode.test(string)?decode(string.slice(4).toLowerCase()):string;});}/**\n\t\t * Converts a Unicode string representing a domain name or an email address to\n\t\t * Punycode. Only the non-ASCII parts of the domain name will be converted,\n\t\t * i.e. it doesn't matter if you call it with a domain that's already in\n\t\t * ASCII.\n\t\t * @memberOf punycode\n\t\t * @param {String} input The domain name or email address to convert, as a\n\t\t * Unicode string.\n\t\t * @returns {String} The Punycode representation of the given domain name or\n\t\t * email address.\n\t\t */function toASCII(input){return mapDomain(input,function(string){return regexNonASCII.test(string)?'xn--'+encode(string):string;});}/*--------------------------------------------------------------------------*//** Define the public API */punycode={/**\n\t\t\t * A string representing the current Punycode.js version number.\n\t\t\t * @memberOf punycode\n\t\t\t * @type String\n\t\t\t */'version':'1.3.2',/**\n\t\t\t * An object of methods to convert from JavaScript's internal character\n\t\t\t * representation (UCS-2) to Unicode code points, and back.\n\t\t\t * @see <https://mathiasbynens.be/notes/javascript-encoding>\n\t\t\t * @memberOf punycode\n\t\t\t * @type Object\n\t\t\t */'ucs2':{'decode':ucs2decode,'encode':ucs2encode},'decode':decode,'encode':encode,'toASCII':toASCII,'toUnicode':toUnicode};/** Expose `punycode` */// Some AMD build optimizers, like r.js, check for specific condition patterns\n\t// like the following:\n\tif(typeof define=='function'&&_typeof(define.amd)=='object'&&define.amd){define('punycode',function(){return punycode;});}else if(freeExports&&freeModule){if(module.exports==freeExports){// in Node.js, io.js, or RingoJS v0.8.0+\n\tfreeModule.exports=punycode;}else{// in Narwhal or RingoJS v0.7.0-\n\tfor(key in punycode){punycode.hasOwnProperty(key)&&(freeExports[key]=punycode[key]);}}}else{// in Rhino or a web browser\n\troot.punycode=punycode;}})(this);}).call(this,typeof global!==\"undefined\"?global:typeof self!==\"undefined\"?self:typeof window!==\"undefined\"?window:{});},{}],2:[function(_dereq_,module,exports){var log=_dereq_('./log');function restoreOwnerScroll(ownerDocument,x,y){if(ownerDocument.defaultView&&(x!==ownerDocument.defaultView.pageXOffset||y!==ownerDocument.defaultView.pageYOffset)){ownerDocument.defaultView.scrollTo(x,y);}}function cloneCanvasContents(canvas,clonedCanvas){try{if(clonedCanvas){clonedCanvas.width=canvas.width;clonedCanvas.height=canvas.height;clonedCanvas.getContext(\"2d\").putImageData(canvas.getContext(\"2d\").getImageData(0,0,canvas.width,canvas.height),0,0);}}catch(e){log(\"Unable to copy canvas content from\",canvas,e);}}function cloneNode(node,javascriptEnabled){var clone=node.nodeType===3?document.createTextNode(node.nodeValue):node.cloneNode(false);var child=node.firstChild;while(child){if(javascriptEnabled===true||child.nodeType!==1||child.nodeName!=='SCRIPT'){clone.appendChild(cloneNode(child,javascriptEnabled));}child=child.nextSibling;}if(node.nodeType===1){clone._scrollTop=node.scrollTop;clone._scrollLeft=node.scrollLeft;if(node.nodeName===\"CANVAS\"){cloneCanvasContents(node,clone);}else if(node.nodeName===\"TEXTAREA\"||node.nodeName===\"SELECT\"){clone.value=node.value;}}return clone;}function initNode(node){if(node.nodeType===1){node.scrollTop=node._scrollTop;node.scrollLeft=node._scrollLeft;var child=node.firstChild;while(child){initNode(child);child=child.nextSibling;}}}module.exports=function(ownerDocument,containerDocument,width,height,options,x,y){var documentElement=cloneNode(ownerDocument.documentElement,options.javascriptEnabled);var container=containerDocument.createElement(\"iframe\");container.className=\"html2canvas-container\";container.style.visibility=\"hidden\";container.style.position=\"fixed\";container.style.left=\"-10000px\";container.style.top=\"0px\";container.style.border=\"0\";container.width=width;container.height=height;container.scrolling=\"no\";// ios won't scroll without it\n\tcontainerDocument.body.appendChild(container);return new Promise(function(resolve){var documentClone=container.contentWindow.document;/* Chrome doesn't detect relative background-images assigned in inline <style> sheets when fetched through getComputedStyle\n\t         if window url is about:blank, we can assign the url to current by writing onto the document\n\t         */container.contentWindow.onload=container.onload=function(){var interval=setInterval(function(){if(documentClone.body.childNodes.length>0){initNode(documentClone.documentElement);clearInterval(interval);if(options.type===\"view\"){container.contentWindow.scrollTo(x,y);if(/(iPad|iPhone|iPod)/g.test(navigator.userAgent)&&(container.contentWindow.scrollY!==y||container.contentWindow.scrollX!==x)){documentClone.documentElement.style.top=-y+\"px\";documentClone.documentElement.style.left=-x+\"px\";documentClone.documentElement.style.position='absolute';}}resolve(container);}},50);};documentClone.open();documentClone.write(\"<!DOCTYPE html><html></html>\");// Chrome scrolls the parent document for some reason after the write to the cloned window???\n\trestoreOwnerScroll(ownerDocument,x,y);documentClone.replaceChild(documentClone.adoptNode(documentElement),documentClone.documentElement);documentClone.close();});};},{\"./log\":13}],3:[function(_dereq_,module,exports){// http://dev.w3.org/csswg/css-color/\n\tfunction Color(value){this.r=0;this.g=0;this.b=0;this.a=null;var result=this.fromArray(value)||this.namedColor(value)||this.rgb(value)||this.rgba(value)||this.hex6(value)||this.hex3(value);}Color.prototype.darken=function(amount){var a=1-amount;return new Color([Math.round(this.r*a),Math.round(this.g*a),Math.round(this.b*a),this.a]);};Color.prototype.isTransparent=function(){return this.a===0;};Color.prototype.isBlack=function(){return this.r===0&&this.g===0&&this.b===0;};Color.prototype.fromArray=function(array){if(Array.isArray(array)){this.r=Math.min(array[0],255);this.g=Math.min(array[1],255);this.b=Math.min(array[2],255);if(array.length>3){this.a=array[3];}}return Array.isArray(array);};var _hex3=/^#([a-f0-9]{3})$/i;Color.prototype.hex3=function(value){var match=null;if((match=value.match(_hex3))!==null){this.r=parseInt(match[1][0]+match[1][0],16);this.g=parseInt(match[1][1]+match[1][1],16);this.b=parseInt(match[1][2]+match[1][2],16);}return match!==null;};var _hex6=/^#([a-f0-9]{6})$/i;Color.prototype.hex6=function(value){var match=null;if((match=value.match(_hex6))!==null){this.r=parseInt(match[1].substring(0,2),16);this.g=parseInt(match[1].substring(2,4),16);this.b=parseInt(match[1].substring(4,6),16);}return match!==null;};var _rgb=/^rgb\\(\\s*(\\d{1,3})\\s*,\\s*(\\d{1,3})\\s*,\\s*(\\d{1,3})\\s*\\)$/;Color.prototype.rgb=function(value){var match=null;if((match=value.match(_rgb))!==null){this.r=Number(match[1]);this.g=Number(match[2]);this.b=Number(match[3]);}return match!==null;};var _rgba=/^rgba\\(\\s*(\\d{1,3})\\s*,\\s*(\\d{1,3})\\s*,\\s*(\\d{1,3})\\s*,\\s*(\\d?\\.?\\d+)\\s*\\)$/;Color.prototype.rgba=function(value){var match=null;if((match=value.match(_rgba))!==null){this.r=Number(match[1]);this.g=Number(match[2]);this.b=Number(match[3]);this.a=Number(match[4]);}return match!==null;};Color.prototype.toString=function(){return this.a!==null&&this.a!==1?\"rgba(\"+[this.r,this.g,this.b,this.a].join(\",\")+\")\":\"rgb(\"+[this.r,this.g,this.b].join(\",\")+\")\";};Color.prototype.namedColor=function(value){value=value.toLowerCase();var color=colors[value];if(color){this.r=color[0];this.g=color[1];this.b=color[2];}else if(value===\"transparent\"){this.r=this.g=this.b=this.a=0;return true;}return!!color;};Color.prototype.isColor=true;// JSON.stringify([].slice.call($$('.named-color-table tr'), 1).map(function(row) { return [row.childNodes[3].textContent, row.childNodes[5].textContent.trim().split(\",\").map(Number)] }).reduce(function(data, row) {data[row[0]] = row[1]; return data}, {}))\n\tvar colors={\"aliceblue\":[240,248,255],\"antiquewhite\":[250,235,215],\"aqua\":[0,255,255],\"aquamarine\":[127,255,212],\"azure\":[240,255,255],\"beige\":[245,245,220],\"bisque\":[255,228,196],\"black\":[0,0,0],\"blanchedalmond\":[255,235,205],\"blue\":[0,0,255],\"blueviolet\":[138,43,226],\"brown\":[165,42,42],\"burlywood\":[222,184,135],\"cadetblue\":[95,158,160],\"chartreuse\":[127,255,0],\"chocolate\":[210,105,30],\"coral\":[255,127,80],\"cornflowerblue\":[100,149,237],\"cornsilk\":[255,248,220],\"crimson\":[220,20,60],\"cyan\":[0,255,255],\"darkblue\":[0,0,139],\"darkcyan\":[0,139,139],\"darkgoldenrod\":[184,134,11],\"darkgray\":[169,169,169],\"darkgreen\":[0,100,0],\"darkgrey\":[169,169,169],\"darkkhaki\":[189,183,107],\"darkmagenta\":[139,0,139],\"darkolivegreen\":[85,107,47],\"darkorange\":[255,140,0],\"darkorchid\":[153,50,204],\"darkred\":[139,0,0],\"darksalmon\":[233,150,122],\"darkseagreen\":[143,188,143],\"darkslateblue\":[72,61,139],\"darkslategray\":[47,79,79],\"darkslategrey\":[47,79,79],\"darkturquoise\":[0,206,209],\"darkviolet\":[148,0,211],\"deeppink\":[255,20,147],\"deepskyblue\":[0,191,255],\"dimgray\":[105,105,105],\"dimgrey\":[105,105,105],\"dodgerblue\":[30,144,255],\"firebrick\":[178,34,34],\"floralwhite\":[255,250,240],\"forestgreen\":[34,139,34],\"fuchsia\":[255,0,255],\"gainsboro\":[220,220,220],\"ghostwhite\":[248,248,255],\"gold\":[255,215,0],\"goldenrod\":[218,165,32],\"gray\":[128,128,128],\"green\":[0,128,0],\"greenyellow\":[173,255,47],\"grey\":[128,128,128],\"honeydew\":[240,255,240],\"hotpink\":[255,105,180],\"indianred\":[205,92,92],\"indigo\":[75,0,130],\"ivory\":[255,255,240],\"khaki\":[240,230,140],\"lavender\":[230,230,250],\"lavenderblush\":[255,240,245],\"lawngreen\":[124,252,0],\"lemonchiffon\":[255,250,205],\"lightblue\":[173,216,230],\"lightcoral\":[240,128,128],\"lightcyan\":[224,255,255],\"lightgoldenrodyellow\":[250,250,210],\"lightgray\":[211,211,211],\"lightgreen\":[144,238,144],\"lightgrey\":[211,211,211],\"lightpink\":[255,182,193],\"lightsalmon\":[255,160,122],\"lightseagreen\":[32,178,170],\"lightskyblue\":[135,206,250],\"lightslategray\":[119,136,153],\"lightslategrey\":[119,136,153],\"lightsteelblue\":[176,196,222],\"lightyellow\":[255,255,224],\"lime\":[0,255,0],\"limegreen\":[50,205,50],\"linen\":[250,240,230],\"magenta\":[255,0,255],\"maroon\":[128,0,0],\"mediumaquamarine\":[102,205,170],\"mediumblue\":[0,0,205],\"mediumorchid\":[186,85,211],\"mediumpurple\":[147,112,219],\"mediumseagreen\":[60,179,113],\"mediumslateblue\":[123,104,238],\"mediumspringgreen\":[0,250,154],\"mediumturquoise\":[72,209,204],\"mediumvioletred\":[199,21,133],\"midnightblue\":[25,25,112],\"mintcream\":[245,255,250],\"mistyrose\":[255,228,225],\"moccasin\":[255,228,181],\"navajowhite\":[255,222,173],\"navy\":[0,0,128],\"oldlace\":[253,245,230],\"olive\":[128,128,0],\"olivedrab\":[107,142,35],\"orange\":[255,165,0],\"orangered\":[255,69,0],\"orchid\":[218,112,214],\"palegoldenrod\":[238,232,170],\"palegreen\":[152,251,152],\"paleturquoise\":[175,238,238],\"palevioletred\":[219,112,147],\"papayawhip\":[255,239,213],\"peachpuff\":[255,218,185],\"peru\":[205,133,63],\"pink\":[255,192,203],\"plum\":[221,160,221],\"powderblue\":[176,224,230],\"purple\":[128,0,128],\"rebeccapurple\":[102,51,153],\"red\":[255,0,0],\"rosybrown\":[188,143,143],\"royalblue\":[65,105,225],\"saddlebrown\":[139,69,19],\"salmon\":[250,128,114],\"sandybrown\":[244,164,96],\"seagreen\":[46,139,87],\"seashell\":[255,245,238],\"sienna\":[160,82,45],\"silver\":[192,192,192],\"skyblue\":[135,206,235],\"slateblue\":[106,90,205],\"slategray\":[112,128,144],\"slategrey\":[112,128,144],\"snow\":[255,250,250],\"springgreen\":[0,255,127],\"steelblue\":[70,130,180],\"tan\":[210,180,140],\"teal\":[0,128,128],\"thistle\":[216,191,216],\"tomato\":[255,99,71],\"turquoise\":[64,224,208],\"violet\":[238,130,238],\"wheat\":[245,222,179],\"white\":[255,255,255],\"whitesmoke\":[245,245,245],\"yellow\":[255,255,0],\"yellowgreen\":[154,205,50]};module.exports=Color;},{}],4:[function(_dereq_,module,exports){var Support=_dereq_('./support');var CanvasRenderer=_dereq_('./renderers/canvas');var ImageLoader=_dereq_('./imageloader');var NodeParser=_dereq_('./nodeparser');var NodeContainer=_dereq_('./nodecontainer');var log=_dereq_('./log');var utils=_dereq_('./utils');var createWindowClone=_dereq_('./clone');var loadUrlDocument=_dereq_('./proxy').loadUrlDocument;var getBounds=utils.getBounds;var html2canvasNodeAttribute=\"data-html2canvas-node\";var html2canvasCloneIndex=0;function html2canvas(nodeList,options){var index=html2canvasCloneIndex++;options=options||{};if(options.logging){log.options.logging=true;log.options.start=Date.now();}options.async=typeof options.async===\"undefined\"?true:options.async;options.allowTaint=typeof options.allowTaint===\"undefined\"?false:options.allowTaint;options.removeContainer=typeof options.removeContainer===\"undefined\"?true:options.removeContainer;options.javascriptEnabled=typeof options.javascriptEnabled===\"undefined\"?false:options.javascriptEnabled;options.imageTimeout=typeof options.imageTimeout===\"undefined\"?10000:options.imageTimeout;options.renderer=typeof options.renderer===\"function\"?options.renderer:CanvasRenderer;options.strict=!!options.strict;if(typeof nodeList===\"string\"){if(typeof options.proxy!==\"string\"){return Promise.reject(\"Proxy must be used when rendering url\");}var width=options.width!=null?options.width:window.innerWidth;var height=options.height!=null?options.height:window.innerHeight;return loadUrlDocument(absoluteUrl(nodeList),options.proxy,document,width,height,options).then(function(container){return renderWindow(container.contentWindow.document.documentElement,container,options,width,height);});}var node=(nodeList===undefined?[document.documentElement]:nodeList.length?nodeList:[nodeList])[0];node.setAttribute(html2canvasNodeAttribute+index,index);return renderDocument(node.ownerDocument,options,node.ownerDocument.defaultView.innerWidth,node.ownerDocument.defaultView.innerHeight,index).then(function(canvas){if(typeof options.onrendered===\"function\"){log(\"options.onrendered is deprecated, html2canvas returns a Promise containing the canvas\");options.onrendered(canvas);}return canvas;});}html2canvas.CanvasRenderer=CanvasRenderer;html2canvas.NodeContainer=NodeContainer;html2canvas.log=log;html2canvas.utils=utils;var html2canvasExport=typeof document===\"undefined\"||typeof Object.create!==\"function\"||typeof document.createElement(\"canvas\").getContext!==\"function\"?function(){return Promise.reject(\"No canvas support\");}:html2canvas;module.exports=html2canvasExport;if(typeof define==='function'&&define.amd){define('html2canvas',[],function(){return html2canvasExport;});}function renderDocument(document,options,windowWidth,windowHeight,html2canvasIndex){return createWindowClone(document,document,windowWidth,windowHeight,options,document.defaultView.pageXOffset,document.defaultView.pageYOffset).then(function(container){log(\"Document cloned\");var attributeName=html2canvasNodeAttribute+html2canvasIndex;var selector=\"[\"+attributeName+\"='\"+html2canvasIndex+\"']\";document.querySelector(selector).removeAttribute(attributeName);var clonedWindow=container.contentWindow;var node=clonedWindow.document.querySelector(selector);var oncloneHandler=typeof options.onclone===\"function\"?Promise.resolve(options.onclone(clonedWindow.document)):Promise.resolve(true);return oncloneHandler.then(function(){return renderWindow(node,container,options,windowWidth,windowHeight);});});}function renderWindow(node,container,options,windowWidth,windowHeight){var clonedWindow=container.contentWindow;var support=new Support(clonedWindow.document);var imageLoader=new ImageLoader(options,support);var bounds=getBounds(node);var width=options.type===\"view\"?windowWidth:documentWidth(clonedWindow.document);var height=options.type===\"view\"?windowHeight:documentHeight(clonedWindow.document);var renderer=new options.renderer(width,height,imageLoader,options,document);var parser=new NodeParser(node,renderer,support,imageLoader,options);return parser.ready.then(function(){log(\"Finished rendering\");var canvas;if(options.type===\"view\"){canvas=crop(renderer.canvas,{width:renderer.canvas.width,height:renderer.canvas.height,top:0,left:0,x:0,y:0});}else if(node===clonedWindow.document.body||node===clonedWindow.document.documentElement||options.canvas!=null){canvas=renderer.canvas;}else{canvas=crop(renderer.canvas,{width:options.width!=null?options.width:bounds.width,height:options.height!=null?options.height:bounds.height,top:bounds.top,left:bounds.left,x:0,y:0});}cleanupContainer(container,options);return canvas;});}function cleanupContainer(container,options){if(options.removeContainer){container.parentNode.removeChild(container);log(\"Cleaned up container\");}}function crop(canvas,bounds){var croppedCanvas=document.createElement(\"canvas\");var x1=Math.min(canvas.width-1,Math.max(0,bounds.left));var x2=Math.min(canvas.width,Math.max(1,bounds.left+bounds.width));var y1=Math.min(canvas.height-1,Math.max(0,bounds.top));var y2=Math.min(canvas.height,Math.max(1,bounds.top+bounds.height));croppedCanvas.width=bounds.width;croppedCanvas.height=bounds.height;var width=x2-x1;var height=y2-y1;log(\"Cropping canvas at:\",\"left:\",bounds.left,\"top:\",bounds.top,\"width:\",width,\"height:\",height);log(\"Resulting crop with width\",bounds.width,\"and height\",bounds.height,\"with x\",x1,\"and y\",y1);croppedCanvas.getContext(\"2d\").drawImage(canvas,x1,y1,width,height,bounds.x,bounds.y,width,height);return croppedCanvas;}function documentWidth(doc){return Math.max(Math.max(doc.body.scrollWidth,doc.documentElement.scrollWidth),Math.max(doc.body.offsetWidth,doc.documentElement.offsetWidth),Math.max(doc.body.clientWidth,doc.documentElement.clientWidth));}function documentHeight(doc){return Math.max(Math.max(doc.body.scrollHeight,doc.documentElement.scrollHeight),Math.max(doc.body.offsetHeight,doc.documentElement.offsetHeight),Math.max(doc.body.clientHeight,doc.documentElement.clientHeight));}function absoluteUrl(url){var link=document.createElement(\"a\");link.href=url;link.href=link.href;return link;}},{\"./clone\":2,\"./imageloader\":11,\"./log\":13,\"./nodecontainer\":14,\"./nodeparser\":15,\"./proxy\":16,\"./renderers/canvas\":20,\"./support\":22,\"./utils\":26}],5:[function(_dereq_,module,exports){var log=_dereq_('./log');var smallImage=_dereq_('./utils').smallImage;function DummyImageContainer(src){this.src=src;log(\"DummyImageContainer for\",src);if(!this.promise||!this.image){log(\"Initiating DummyImageContainer\");DummyImageContainer.prototype.image=new Image();var image=this.image;DummyImageContainer.prototype.promise=new Promise(function(resolve,reject){image.onload=resolve;image.onerror=reject;image.src=smallImage();if(image.complete===true){resolve(image);}});}}module.exports=DummyImageContainer;},{\"./log\":13,\"./utils\":26}],6:[function(_dereq_,module,exports){var smallImage=_dereq_('./utils').smallImage;function Font(family,size){var container=document.createElement('div'),img=document.createElement('img'),span=document.createElement('span'),sampleText='Hidden Text',baseline,middle;container.style.visibility=\"hidden\";container.style.fontFamily=family;container.style.fontSize=size;container.style.margin=0;container.style.padding=0;document.body.appendChild(container);img.src=smallImage();img.width=1;img.height=1;img.style.margin=0;img.style.padding=0;img.style.verticalAlign=\"baseline\";span.style.fontFamily=family;span.style.fontSize=size;span.style.margin=0;span.style.padding=0;span.appendChild(document.createTextNode(sampleText));container.appendChild(span);container.appendChild(img);baseline=img.offsetTop-span.offsetTop+1;container.removeChild(span);container.appendChild(document.createTextNode(sampleText));container.style.lineHeight=\"normal\";img.style.verticalAlign=\"super\";middle=img.offsetTop-container.offsetTop+1;document.body.removeChild(container);this.baseline=baseline;this.lineWidth=1;this.middle=middle;}module.exports=Font;},{\"./utils\":26}],7:[function(_dereq_,module,exports){var Font=_dereq_('./font');function FontMetrics(){this.data={};}FontMetrics.prototype.getMetrics=function(family,size){if(this.data[family+\"-\"+size]===undefined){this.data[family+\"-\"+size]=new Font(family,size);}return this.data[family+\"-\"+size];};module.exports=FontMetrics;},{\"./font\":6}],8:[function(_dereq_,module,exports){var utils=_dereq_('./utils');var getBounds=utils.getBounds;var loadUrlDocument=_dereq_('./proxy').loadUrlDocument;function FrameContainer(container,sameOrigin,options){this.image=null;this.src=container;var self=this;var bounds=getBounds(container);this.promise=(!sameOrigin?this.proxyLoad(options.proxy,bounds,options):new Promise(function(resolve){if(container.contentWindow.document.URL===\"about:blank\"||container.contentWindow.document.documentElement==null){container.contentWindow.onload=container.onload=function(){resolve(container);};}else{resolve(container);}})).then(function(container){var html2canvas=_dereq_('./core');return html2canvas(container.contentWindow.document.documentElement,{type:'view',width:container.width,height:container.height,proxy:options.proxy,javascriptEnabled:options.javascriptEnabled,removeContainer:options.removeContainer,allowTaint:options.allowTaint,imageTimeout:options.imageTimeout/2});}).then(function(canvas){return self.image=canvas;});}FrameContainer.prototype.proxyLoad=function(proxy,bounds,options){var container=this.src;return loadUrlDocument(container.src,proxy,container.ownerDocument,bounds.width,bounds.height,options);};module.exports=FrameContainer;},{\"./core\":4,\"./proxy\":16,\"./utils\":26}],9:[function(_dereq_,module,exports){function GradientContainer(imageData){this.src=imageData.value;this.colorStops=[];this.type=null;this.x0=0.5;this.y0=0.5;this.x1=0.5;this.y1=0.5;this.promise=Promise.resolve(true);}GradientContainer.TYPES={LINEAR:1,RADIAL:2};// TODO: support hsl[a], negative %/length values\n\t// TODO: support <angle> (e.g. -?\\d{1,3}(?:\\.\\d+)deg, etc. : https://developer.mozilla.org/docs/Web/CSS/angle )\n\tGradientContainer.REGEXP_COLORSTOP=/^\\s*(rgba?\\(\\s*\\d{1,3},\\s*\\d{1,3},\\s*\\d{1,3}(?:,\\s*[0-9\\.]+)?\\s*\\)|[a-z]{3,20}|#[a-f0-9]{3,6})(?:\\s+(\\d{1,3}(?:\\.\\d+)?)(%|px)?)?(?:\\s|$)/i;module.exports=GradientContainer;},{}],10:[function(_dereq_,module,exports){function ImageContainer(src,cors){this.src=src;this.image=new Image();var self=this;this.tainted=null;this.promise=new Promise(function(resolve,reject){self.image.onload=resolve;self.image.onerror=reject;if(cors){self.image.crossOrigin=\"anonymous\";}self.image.src=src;if(self.image.complete===true){resolve(self.image);}});}module.exports=ImageContainer;},{}],11:[function(_dereq_,module,exports){var log=_dereq_('./log');var ImageContainer=_dereq_('./imagecontainer');var DummyImageContainer=_dereq_('./dummyimagecontainer');var ProxyImageContainer=_dereq_('./proxyimagecontainer');var FrameContainer=_dereq_('./framecontainer');var SVGContainer=_dereq_('./svgcontainer');var SVGNodeContainer=_dereq_('./svgnodecontainer');var LinearGradientContainer=_dereq_('./lineargradientcontainer');var WebkitGradientContainer=_dereq_('./webkitgradientcontainer');var bind=_dereq_('./utils').bind;function ImageLoader(options,support){this.link=null;this.options=options;this.support=support;this.origin=this.getOrigin(window.location.href);}ImageLoader.prototype.findImages=function(nodes){var images=[];nodes.reduce(function(imageNodes,container){switch(container.node.nodeName){case\"IMG\":return imageNodes.concat([{args:[container.node.src],method:\"url\"}]);case\"svg\":case\"IFRAME\":return imageNodes.concat([{args:[container.node],method:container.node.nodeName}]);}return imageNodes;},[]).forEach(this.addImage(images,this.loadImage),this);return images;};ImageLoader.prototype.findBackgroundImage=function(images,container){container.parseBackgroundImages().filter(this.hasImageBackground).forEach(this.addImage(images,this.loadImage),this);return images;};ImageLoader.prototype.addImage=function(images,callback){return function(newImage){newImage.args.forEach(function(image){if(!this.imageExists(images,image)){images.splice(0,0,callback.call(this,newImage));log('Added image #'+images.length,typeof image===\"string\"?image.substring(0,100):image);}},this);};};ImageLoader.prototype.hasImageBackground=function(imageData){return imageData.method!==\"none\";};ImageLoader.prototype.loadImage=function(imageData){if(imageData.method===\"url\"){var src=imageData.args[0];if(this.isSVG(src)&&!this.support.svg&&!this.options.allowTaint){return new SVGContainer(src);}else if(src.match(/data:image\\/.*;base64,/i)){return new ImageContainer(src.replace(/url\\(['\"]{0,}|['\"]{0,}\\)$/ig,''),false);}else if(this.isSameOrigin(src)||this.options.allowTaint===true||this.isSVG(src)){return new ImageContainer(src,false);}else if(this.support.cors&&!this.options.allowTaint&&this.options.useCORS){return new ImageContainer(src,true);}else if(this.options.proxy){return new ProxyImageContainer(src,this.options.proxy);}else{return new DummyImageContainer(src);}}else if(imageData.method===\"linear-gradient\"){return new LinearGradientContainer(imageData);}else if(imageData.method===\"gradient\"){return new WebkitGradientContainer(imageData);}else if(imageData.method===\"svg\"){return new SVGNodeContainer(imageData.args[0],this.support.svg);}else if(imageData.method===\"IFRAME\"){return new FrameContainer(imageData.args[0],this.isSameOrigin(imageData.args[0].src),this.options);}else{return new DummyImageContainer(imageData);}};ImageLoader.prototype.isSVG=function(src){return src.substring(src.length-3).toLowerCase()===\"svg\"||SVGContainer.prototype.isInline(src);};ImageLoader.prototype.imageExists=function(images,src){return images.some(function(image){return image.src===src;});};ImageLoader.prototype.isSameOrigin=function(url){return this.getOrigin(url)===this.origin;};ImageLoader.prototype.getOrigin=function(url){var link=this.link||(this.link=document.createElement(\"a\"));link.href=url;link.href=link.href;// IE9, LOL! - http://jsfiddle.net/niklasvh/2e48b/\n\treturn link.protocol+link.hostname+link.port;};ImageLoader.prototype.getPromise=function(container){return this.timeout(container,this.options.imageTimeout)['catch'](function(){var dummy=new DummyImageContainer(container.src);return dummy.promise.then(function(image){container.image=image;});});};ImageLoader.prototype.get=function(src){var found=null;return this.images.some(function(img){return(found=img).src===src;})?found:null;};ImageLoader.prototype.fetch=function(nodes){this.images=nodes.reduce(bind(this.findBackgroundImage,this),this.findImages(nodes));this.images.forEach(function(image,index){image.promise.then(function(){log(\"Succesfully loaded image #\"+(index+1),image);},function(e){log(\"Failed loading image #\"+(index+1),image,e);});});this.ready=Promise.all(this.images.map(this.getPromise,this));log(\"Finished searching images\");return this;};ImageLoader.prototype.timeout=function(container,timeout){var timer;var promise=Promise.race([container.promise,new Promise(function(res,reject){timer=setTimeout(function(){log(\"Timed out loading image\",container);reject(container);},timeout);})]).then(function(container){clearTimeout(timer);return container;});promise['catch'](function(){clearTimeout(timer);});return promise;};module.exports=ImageLoader;},{\"./dummyimagecontainer\":5,\"./framecontainer\":8,\"./imagecontainer\":10,\"./lineargradientcontainer\":12,\"./log\":13,\"./proxyimagecontainer\":17,\"./svgcontainer\":23,\"./svgnodecontainer\":24,\"./utils\":26,\"./webkitgradientcontainer\":27}],12:[function(_dereq_,module,exports){var GradientContainer=_dereq_('./gradientcontainer');var Color=_dereq_('./color');function LinearGradientContainer(imageData){GradientContainer.apply(this,arguments);this.type=GradientContainer.TYPES.LINEAR;var hasDirection=LinearGradientContainer.REGEXP_DIRECTION.test(imageData.args[0])||!GradientContainer.REGEXP_COLORSTOP.test(imageData.args[0]);if(hasDirection){imageData.args[0].split(/\\s+/).reverse().forEach(function(position,index){switch(position){case\"left\":this.x0=0;this.x1=1;break;case\"top\":this.y0=0;this.y1=1;break;case\"right\":this.x0=1;this.x1=0;break;case\"bottom\":this.y0=1;this.y1=0;break;case\"to\":var y0=this.y0;var x0=this.x0;this.y0=this.y1;this.x0=this.x1;this.x1=x0;this.y1=y0;break;case\"center\":break;// centered by default\n\t// Firefox internally converts position keywords to percentages:\n\t// http://www.w3.org/TR/2010/WD-CSS2-20101207/colors.html#propdef-background-position\n\tdefault:// percentage or absolute length\n\t// TODO: support absolute start point positions (e.g., use bounds to convert px to a ratio)\n\tvar ratio=parseFloat(position,10)*1e-2;if(isNaN(ratio)){// invalid or unhandled value\n\tbreak;}if(index===0){this.y0=ratio;this.y1=1-this.y0;}else{this.x0=ratio;this.x1=1-this.x0;}break;}},this);}else{this.y0=0;this.y1=1;}this.colorStops=imageData.args.slice(hasDirection?1:0).map(function(colorStop){var colorStopMatch=colorStop.match(GradientContainer.REGEXP_COLORSTOP);var value=+colorStopMatch[2];var unit=value===0?\"%\":colorStopMatch[3];// treat \"0\" as \"0%\"\n\treturn{color:new Color(colorStopMatch[1]),// TODO: support absolute stop positions (e.g., compute gradient line length & convert px to ratio)\n\tstop:unit===\"%\"?value/100:null};});if(this.colorStops[0].stop===null){this.colorStops[0].stop=0;}if(this.colorStops[this.colorStops.length-1].stop===null){this.colorStops[this.colorStops.length-1].stop=1;}// calculates and fills-in explicit stop positions when omitted from rule\n\tthis.colorStops.forEach(function(colorStop,index){if(colorStop.stop===null){this.colorStops.slice(index).some(function(find,count){if(find.stop!==null){colorStop.stop=(find.stop-this.colorStops[index-1].stop)/(count+1)+this.colorStops[index-1].stop;return true;}else{return false;}},this);}},this);}LinearGradientContainer.prototype=Object.create(GradientContainer.prototype);// TODO: support <angle> (e.g. -?\\d{1,3}(?:\\.\\d+)deg, etc. : https://developer.mozilla.org/docs/Web/CSS/angle )\n\tLinearGradientContainer.REGEXP_DIRECTION=/^\\s*(?:to|left|right|top|bottom|center|\\d{1,3}(?:\\.\\d+)?%?)(?:\\s|$)/i;module.exports=LinearGradientContainer;},{\"./color\":3,\"./gradientcontainer\":9}],13:[function(_dereq_,module,exports){var logger=function logger(){if(logger.options.logging&&window.console&&window.console.log){Function.prototype.bind.call(window.console.log,window.console).apply(window.console,[Date.now()-logger.options.start+\"ms\",\"html2canvas:\"].concat([].slice.call(arguments,0)));}};logger.options={logging:false};module.exports=logger;},{}],14:[function(_dereq_,module,exports){var Color=_dereq_('./color');var utils=_dereq_('./utils');var getBounds=utils.getBounds;var parseBackgrounds=utils.parseBackgrounds;var offsetBounds=utils.offsetBounds;function NodeContainer(node,parent){this.node=node;this.parent=parent;this.stack=null;this.bounds=null;this.borders=null;this.clip=[];this.backgroundClip=[];this.offsetBounds=null;this.visible=null;this.computedStyles=null;this.colors={};this.styles={};this.backgroundImages=null;this.transformData=null;this.transformMatrix=null;this.isPseudoElement=false;this.opacity=null;}NodeContainer.prototype.cloneTo=function(stack){stack.visible=this.visible;stack.borders=this.borders;stack.bounds=this.bounds;stack.clip=this.clip;stack.backgroundClip=this.backgroundClip;stack.computedStyles=this.computedStyles;stack.styles=this.styles;stack.backgroundImages=this.backgroundImages;stack.opacity=this.opacity;};NodeContainer.prototype.getOpacity=function(){return this.opacity===null?this.opacity=this.cssFloat('opacity'):this.opacity;};NodeContainer.prototype.assignStack=function(stack){this.stack=stack;stack.children.push(this);};NodeContainer.prototype.isElementVisible=function(){return this.node.nodeType===Node.TEXT_NODE?this.parent.visible:this.css('display')!==\"none\"&&this.css('visibility')!==\"hidden\"&&!this.node.hasAttribute(\"data-html2canvas-ignore\")&&(this.node.nodeName!==\"INPUT\"||this.node.getAttribute(\"type\")!==\"hidden\");};NodeContainer.prototype.css=function(attribute){if(!this.computedStyles){this.computedStyles=this.isPseudoElement?this.parent.computedStyle(this.before?\":before\":\":after\"):this.computedStyle(null);}return this.styles[attribute]||(this.styles[attribute]=this.computedStyles[attribute]);};NodeContainer.prototype.prefixedCss=function(attribute){var prefixes=[\"webkit\",\"moz\",\"ms\",\"o\"];var value=this.css(attribute);if(value===undefined){prefixes.some(function(prefix){value=this.css(prefix+attribute.substr(0,1).toUpperCase()+attribute.substr(1));return value!==undefined;},this);}return value===undefined?null:value;};NodeContainer.prototype.computedStyle=function(type){return this.node.ownerDocument.defaultView.getComputedStyle(this.node,type);};NodeContainer.prototype.cssInt=function(attribute){var value=parseInt(this.css(attribute),10);return isNaN(value)?0:value;// borders in old IE are throwing 'medium' for demo.html\n\t};NodeContainer.prototype.color=function(attribute){return this.colors[attribute]||(this.colors[attribute]=new Color(this.css(attribute)));};NodeContainer.prototype.cssFloat=function(attribute){var value=parseFloat(this.css(attribute));return isNaN(value)?0:value;};NodeContainer.prototype.fontWeight=function(){var weight=this.css(\"fontWeight\");switch(parseInt(weight,10)){case 401:weight=\"bold\";break;case 400:weight=\"normal\";break;}return weight;};NodeContainer.prototype.parseClip=function(){var matches=this.css('clip').match(this.CLIP);if(matches){return{top:parseInt(matches[1],10),right:parseInt(matches[2],10),bottom:parseInt(matches[3],10),left:parseInt(matches[4],10)};}return null;};NodeContainer.prototype.parseBackgroundImages=function(){return this.backgroundImages||(this.backgroundImages=parseBackgrounds(this.css(\"backgroundImage\")));};NodeContainer.prototype.cssList=function(property,index){var value=(this.css(property)||'').split(',');value=value[index||0]||value[0]||'auto';value=value.trim().split(' ');if(value.length===1){value=[value[0],isPercentage(value[0])?'auto':value[0]];}return value;};NodeContainer.prototype.parseBackgroundSize=function(bounds,image,index){var size=this.cssList(\"backgroundSize\",index);var width,height;if(isPercentage(size[0])){width=bounds.width*parseFloat(size[0])/100;}else if(/contain|cover/.test(size[0])){var targetRatio=bounds.width/bounds.height,currentRatio=image.width/image.height;return targetRatio<currentRatio^size[0]==='contain'?{width:bounds.height*currentRatio,height:bounds.height}:{width:bounds.width,height:bounds.width/currentRatio};}else{width=parseInt(size[0],10);}if(size[0]==='auto'&&size[1]==='auto'){height=image.height;}else if(size[1]==='auto'){height=width/image.width*image.height;}else if(isPercentage(size[1])){height=bounds.height*parseFloat(size[1])/100;}else{height=parseInt(size[1],10);}if(size[0]==='auto'){width=height/image.height*image.width;}return{width:width,height:height};};NodeContainer.prototype.parseBackgroundPosition=function(bounds,image,index,backgroundSize){var position=this.cssList('backgroundPosition',index);var left,top;if(isPercentage(position[0])){left=(bounds.width-(backgroundSize||image).width)*(parseFloat(position[0])/100);}else{left=parseInt(position[0],10);}if(position[1]==='auto'){top=left/image.width*image.height;}else if(isPercentage(position[1])){top=(bounds.height-(backgroundSize||image).height)*parseFloat(position[1])/100;}else{top=parseInt(position[1],10);}if(position[0]==='auto'){left=top/image.height*image.width;}return{left:left,top:top};};NodeContainer.prototype.parseBackgroundRepeat=function(index){return this.cssList(\"backgroundRepeat\",index)[0];};NodeContainer.prototype.parseTextShadows=function(){var textShadow=this.css(\"textShadow\");var results=[];if(textShadow&&textShadow!=='none'){var shadows=textShadow.match(this.TEXT_SHADOW_PROPERTY);for(var i=0;shadows&&i<shadows.length;i++){var s=shadows[i].match(this.TEXT_SHADOW_VALUES);results.push({color:new Color(s[0]),offsetX:s[1]?parseFloat(s[1].replace('px','')):0,offsetY:s[2]?parseFloat(s[2].replace('px','')):0,blur:s[3]?s[3].replace('px',''):0});}}return results;};NodeContainer.prototype.parseTransform=function(){if(!this.transformData){if(this.hasTransform()){var offset=this.parseBounds();var origin=this.prefixedCss(\"transformOrigin\").split(\" \").map(removePx).map(asFloat);origin[0]+=offset.left;origin[1]+=offset.top;this.transformData={origin:origin,matrix:this.parseTransformMatrix()};}else{this.transformData={origin:[0,0],matrix:[1,0,0,1,0,0]};}}return this.transformData;};NodeContainer.prototype.parseTransformMatrix=function(){if(!this.transformMatrix){var transform=this.prefixedCss(\"transform\");var matrix=transform?parseMatrix(transform.match(this.MATRIX_PROPERTY)):null;this.transformMatrix=matrix?matrix:[1,0,0,1,0,0];}return this.transformMatrix;};NodeContainer.prototype.parseBounds=function(){return this.bounds||(this.bounds=this.hasTransform()?offsetBounds(this.node):getBounds(this.node));};NodeContainer.prototype.hasTransform=function(){return this.parseTransformMatrix().join(\",\")!==\"1,0,0,1,0,0\"||this.parent&&this.parent.hasTransform();};NodeContainer.prototype.getValue=function(){var value=this.node.value||\"\";if(this.node.tagName===\"SELECT\"){value=selectionValue(this.node);}else if(this.node.type===\"password\"){value=Array(value.length+1).join(\"\");// jshint ignore:line\n\t}return value.length===0?this.node.placeholder||\"\":value;};NodeContainer.prototype.MATRIX_PROPERTY=/(matrix|matrix3d)\\((.+)\\)/;NodeContainer.prototype.TEXT_SHADOW_PROPERTY=/((rgba|rgb)\\([^\\)]+\\)(\\s-?\\d+px){0,})/g;NodeContainer.prototype.TEXT_SHADOW_VALUES=/(-?\\d+px)|(#.+)|(rgb\\(.+\\))|(rgba\\(.+\\))/g;NodeContainer.prototype.CLIP=/^rect\\((\\d+)px,? (\\d+)px,? (\\d+)px,? (\\d+)px\\)$/;function selectionValue(node){var option=node.options[node.selectedIndex||0];return option?option.text||\"\":\"\";}function parseMatrix(match){if(match&&match[1]===\"matrix\"){return match[2].split(\",\").map(function(s){return parseFloat(s.trim());});}else if(match&&match[1]===\"matrix3d\"){var matrix3d=match[2].split(\",\").map(function(s){return parseFloat(s.trim());});return[matrix3d[0],matrix3d[1],matrix3d[4],matrix3d[5],matrix3d[12],matrix3d[13]];}}function isPercentage(value){return value.toString().indexOf(\"%\")!==-1;}function removePx(str){return str.replace(\"px\",\"\");}function asFloat(str){return parseFloat(str);}module.exports=NodeContainer;},{\"./color\":3,\"./utils\":26}],15:[function(_dereq_,module,exports){var log=_dereq_('./log');var punycode=_dereq_('punycode');var NodeContainer=_dereq_('./nodecontainer');var TextContainer=_dereq_('./textcontainer');var PseudoElementContainer=_dereq_('./pseudoelementcontainer');var FontMetrics=_dereq_('./fontmetrics');var Color=_dereq_('./color');var StackingContext=_dereq_('./stackingcontext');var utils=_dereq_('./utils');var bind=utils.bind;var getBounds=utils.getBounds;var parseBackgrounds=utils.parseBackgrounds;var offsetBounds=utils.offsetBounds;function NodeParser(element,renderer,support,imageLoader,options){log(\"Starting NodeParser\");this.renderer=renderer;this.options=options;this.range=null;this.support=support;this.renderQueue=[];this.stack=new StackingContext(true,1,element.ownerDocument,null);var parent=new NodeContainer(element,null);if(options.background){renderer.rectangle(0,0,renderer.width,renderer.height,new Color(options.background));}if(element===element.ownerDocument.documentElement){// http://www.w3.org/TR/css3-background/#special-backgrounds\n\tvar canvasBackground=new NodeContainer(parent.color('backgroundColor').isTransparent()?element.ownerDocument.body:element.ownerDocument.documentElement,null);renderer.rectangle(0,0,renderer.width,renderer.height,canvasBackground.color('backgroundColor'));}parent.visibile=parent.isElementVisible();this.createPseudoHideStyles(element.ownerDocument);this.disableAnimations(element.ownerDocument);this.nodes=flatten([parent].concat(this.getChildren(parent)).filter(function(container){return container.visible=container.isElementVisible();}).map(this.getPseudoElements,this));this.fontMetrics=new FontMetrics();log(\"Fetched nodes, total:\",this.nodes.length);log(\"Calculate overflow clips\");this.calculateOverflowClips();log(\"Start fetching images\");this.images=imageLoader.fetch(this.nodes.filter(isElement));this.ready=this.images.ready.then(bind(function(){log(\"Images loaded, starting parsing\");log(\"Creating stacking contexts\");this.createStackingContexts();log(\"Sorting stacking contexts\");this.sortStackingContexts(this.stack);this.parse(this.stack);log(\"Render queue created with \"+this.renderQueue.length+\" items\");return new Promise(bind(function(resolve){if(!options.async){this.renderQueue.forEach(this.paint,this);resolve();}else if(typeof options.async===\"function\"){options.async.call(this,this.renderQueue,resolve);}else if(this.renderQueue.length>0){this.renderIndex=0;this.asyncRenderer(this.renderQueue,resolve);}else{resolve();}},this));},this));}NodeParser.prototype.calculateOverflowClips=function(){this.nodes.forEach(function(container){if(isElement(container)){if(isPseudoElement(container)){container.appendToDOM();}container.borders=this.parseBorders(container);var clip=container.css('overflow')===\"hidden\"?[container.borders.clip]:[];var cssClip=container.parseClip();if(cssClip&&[\"absolute\",\"fixed\"].indexOf(container.css('position'))!==-1){clip.push([[\"rect\",container.bounds.left+cssClip.left,container.bounds.top+cssClip.top,cssClip.right-cssClip.left,cssClip.bottom-cssClip.top]]);}container.clip=hasParentClip(container)?container.parent.clip.concat(clip):clip;container.backgroundClip=container.css('overflow')!==\"hidden\"?container.clip.concat([container.borders.clip]):container.clip;if(isPseudoElement(container)){container.cleanDOM();}}else if(isTextNode(container)){container.clip=hasParentClip(container)?container.parent.clip:[];}if(!isPseudoElement(container)){container.bounds=null;}},this);};function hasParentClip(container){return container.parent&&container.parent.clip.length;}NodeParser.prototype.asyncRenderer=function(queue,resolve,asyncTimer){asyncTimer=asyncTimer||Date.now();this.paint(queue[this.renderIndex++]);if(queue.length===this.renderIndex){resolve();}else if(asyncTimer+20>Date.now()){this.asyncRenderer(queue,resolve,asyncTimer);}else{setTimeout(bind(function(){this.asyncRenderer(queue,resolve);},this),0);}};NodeParser.prototype.createPseudoHideStyles=function(document){this.createStyles(document,'.'+PseudoElementContainer.prototype.PSEUDO_HIDE_ELEMENT_CLASS_BEFORE+':before { content: \"\" !important; display: none !important; }'+'.'+PseudoElementContainer.prototype.PSEUDO_HIDE_ELEMENT_CLASS_AFTER+':after { content: \"\" !important; display: none !important; }');};NodeParser.prototype.disableAnimations=function(document){this.createStyles(document,'* { -webkit-animation: none !important; -moz-animation: none !important; -o-animation: none !important; animation: none !important; '+'-webkit-transition: none !important; -moz-transition: none !important; -o-transition: none !important; transition: none !important;}');};NodeParser.prototype.createStyles=function(document,styles){var hidePseudoElements=document.createElement('style');hidePseudoElements.innerHTML=styles;document.body.appendChild(hidePseudoElements);};NodeParser.prototype.getPseudoElements=function(container){var nodes=[[container]];if(container.node.nodeType===Node.ELEMENT_NODE){var before=this.getPseudoElement(container,\":before\");var after=this.getPseudoElement(container,\":after\");if(before){nodes.push(before);}if(after){nodes.push(after);}}return flatten(nodes);};function toCamelCase(str){return str.replace(/(\\-[a-z])/g,function(match){return match.toUpperCase().replace('-','');});}NodeParser.prototype.getPseudoElement=function(container,type){var style=container.computedStyle(type);if(!style||!style.content||style.content===\"none\"||style.content===\"-moz-alt-content\"||style.display===\"none\"){return null;}var content=stripQuotes(style.content);var isImage=content.substr(0,3)==='url';var pseudoNode=document.createElement(isImage?'img':'html2canvaspseudoelement');var pseudoContainer=new PseudoElementContainer(pseudoNode,container,type);for(var i=style.length-1;i>=0;i--){var property=toCamelCase(style.item(i));pseudoNode.style[property]=style[property];}pseudoNode.className=PseudoElementContainer.prototype.PSEUDO_HIDE_ELEMENT_CLASS_BEFORE+\" \"+PseudoElementContainer.prototype.PSEUDO_HIDE_ELEMENT_CLASS_AFTER;if(isImage){pseudoNode.src=parseBackgrounds(content)[0].args[0];return[pseudoContainer];}else{var text=document.createTextNode(content);pseudoNode.appendChild(text);return[pseudoContainer,new TextContainer(text,pseudoContainer)];}};NodeParser.prototype.getChildren=function(parentContainer){return flatten([].filter.call(parentContainer.node.childNodes,renderableNode).map(function(node){var container=[node.nodeType===Node.TEXT_NODE?new TextContainer(node,parentContainer):new NodeContainer(node,parentContainer)].filter(nonIgnoredElement);return node.nodeType===Node.ELEMENT_NODE&&container.length&&node.tagName!==\"TEXTAREA\"?container[0].isElementVisible()?container.concat(this.getChildren(container[0])):[]:container;},this));};NodeParser.prototype.newStackingContext=function(container,hasOwnStacking){var stack=new StackingContext(hasOwnStacking,container.getOpacity(),container.node,container.parent);container.cloneTo(stack);var parentStack=hasOwnStacking?stack.getParentStack(this):stack.parent.stack;parentStack.contexts.push(stack);container.stack=stack;};NodeParser.prototype.createStackingContexts=function(){this.nodes.forEach(function(container){if(isElement(container)&&(this.isRootElement(container)||hasOpacity(container)||isPositionedForStacking(container)||this.isBodyWithTransparentRoot(container)||container.hasTransform())){this.newStackingContext(container,true);}else if(isElement(container)&&(isPositioned(container)&&zIndex0(container)||isInlineBlock(container)||isFloating(container))){this.newStackingContext(container,false);}else{container.assignStack(container.parent.stack);}},this);};NodeParser.prototype.isBodyWithTransparentRoot=function(container){return container.node.nodeName===\"BODY\"&&container.parent.color('backgroundColor').isTransparent();};NodeParser.prototype.isRootElement=function(container){return container.parent===null;};NodeParser.prototype.sortStackingContexts=function(stack){stack.contexts.sort(zIndexSort(stack.contexts.slice(0)));stack.contexts.forEach(this.sortStackingContexts,this);};NodeParser.prototype.parseTextBounds=function(container){return function(text,index,textList){if(container.parent.css(\"textDecoration\").substr(0,4)!==\"none\"||text.trim().length!==0){if(this.support.rangeBounds&&!container.parent.hasTransform()){var offset=textList.slice(0,index).join(\"\").length;return this.getRangeBounds(container.node,offset,text.length);}else if(container.node&&typeof container.node.data===\"string\"){var replacementNode=container.node.splitText(text.length);var bounds=this.getWrapperBounds(container.node,container.parent.hasTransform());container.node=replacementNode;return bounds;}}else if(!this.support.rangeBounds||container.parent.hasTransform()){container.node=container.node.splitText(text.length);}return{};};};NodeParser.prototype.getWrapperBounds=function(node,transform){var wrapper=node.ownerDocument.createElement('html2canvaswrapper');var parent=node.parentNode,backupText=node.cloneNode(true);wrapper.appendChild(node.cloneNode(true));parent.replaceChild(wrapper,node);var bounds=transform?offsetBounds(wrapper):getBounds(wrapper);parent.replaceChild(backupText,wrapper);return bounds;};NodeParser.prototype.getRangeBounds=function(node,offset,length){var range=this.range||(this.range=node.ownerDocument.createRange());range.setStart(node,offset);range.setEnd(node,offset+length);return range.getBoundingClientRect();};function ClearTransform(){}NodeParser.prototype.parse=function(stack){// http://www.w3.org/TR/CSS21/visuren.html#z-index\n\tvar negativeZindex=stack.contexts.filter(negativeZIndex);// 2. the child stacking contexts with negative stack levels (most negative first).\n\tvar descendantElements=stack.children.filter(isElement);var descendantNonFloats=descendantElements.filter(not(isFloating));var nonInlineNonPositionedDescendants=descendantNonFloats.filter(not(isPositioned)).filter(not(inlineLevel));// 3 the in-flow, non-inline-level, non-positioned descendants.\n\tvar nonPositionedFloats=descendantElements.filter(not(isPositioned)).filter(isFloating);// 4. the non-positioned floats.\n\tvar inFlow=descendantNonFloats.filter(not(isPositioned)).filter(inlineLevel);// 5. the in-flow, inline-level, non-positioned descendants, including inline tables and inline blocks.\n\tvar stackLevel0=stack.contexts.concat(descendantNonFloats.filter(isPositioned)).filter(zIndex0);// 6. the child stacking contexts with stack level 0 and the positioned descendants with stack level 0.\n\tvar text=stack.children.filter(isTextNode).filter(hasText);var positiveZindex=stack.contexts.filter(positiveZIndex);// 7. the child stacking contexts with positive stack levels (least positive first).\n\tnegativeZindex.concat(nonInlineNonPositionedDescendants).concat(nonPositionedFloats).concat(inFlow).concat(stackLevel0).concat(text).concat(positiveZindex).forEach(function(container){this.renderQueue.push(container);if(isStackingContext(container)){this.parse(container);this.renderQueue.push(new ClearTransform());}},this);};NodeParser.prototype.paint=function(container){try{if(container instanceof ClearTransform){this.renderer.ctx.restore();}else if(isTextNode(container)){if(isPseudoElement(container.parent)){container.parent.appendToDOM();}this.paintText(container);if(isPseudoElement(container.parent)){container.parent.cleanDOM();}}else{this.paintNode(container);}}catch(e){log(e);if(this.options.strict){throw e;}}};NodeParser.prototype.paintNode=function(container){if(isStackingContext(container)){this.renderer.setOpacity(container.opacity);this.renderer.ctx.save();if(container.hasTransform()){this.renderer.setTransform(container.parseTransform());}}if(container.node.nodeName===\"INPUT\"&&container.node.type===\"checkbox\"){this.paintCheckbox(container);}else if(container.node.nodeName===\"INPUT\"&&container.node.type===\"radio\"){this.paintRadio(container);}else{this.paintElement(container);}};NodeParser.prototype.paintElement=function(container){var bounds=container.parseBounds();this.renderer.clip(container.backgroundClip,function(){this.renderer.renderBackground(container,bounds,container.borders.borders.map(getWidth));},this);this.renderer.clip(container.clip,function(){this.renderer.renderBorders(container.borders.borders);},this);this.renderer.clip(container.backgroundClip,function(){switch(container.node.nodeName){case\"svg\":case\"IFRAME\":var imgContainer=this.images.get(container.node);if(imgContainer){this.renderer.renderImage(container,bounds,container.borders,imgContainer);}else{log(\"Error loading <\"+container.node.nodeName+\">\",container.node);}break;case\"IMG\":var imageContainer=this.images.get(container.node.src);if(imageContainer){this.renderer.renderImage(container,bounds,container.borders,imageContainer);}else{log(\"Error loading <img>\",container.node.src);}break;case\"CANVAS\":this.renderer.renderImage(container,bounds,container.borders,{image:container.node});break;case\"SELECT\":case\"INPUT\":case\"TEXTAREA\":this.paintFormValue(container);break;}},this);};NodeParser.prototype.paintCheckbox=function(container){var b=container.parseBounds();var size=Math.min(b.width,b.height);var bounds={width:size-1,height:size-1,top:b.top,left:b.left};var r=[3,3];var radius=[r,r,r,r];var borders=[1,1,1,1].map(function(w){return{color:new Color('#A5A5A5'),width:w};});var borderPoints=calculateCurvePoints(bounds,radius,borders);this.renderer.clip(container.backgroundClip,function(){this.renderer.rectangle(bounds.left+1,bounds.top+1,bounds.width-2,bounds.height-2,new Color(\"#DEDEDE\"));this.renderer.renderBorders(calculateBorders(borders,bounds,borderPoints,radius));if(container.node.checked){this.renderer.font(new Color('#424242'),'normal','normal','bold',size-3+\"px\",'arial');this.renderer.text(\"\",bounds.left+size/6,bounds.top+size-1);}},this);};NodeParser.prototype.paintRadio=function(container){var bounds=container.parseBounds();var size=Math.min(bounds.width,bounds.height)-2;this.renderer.clip(container.backgroundClip,function(){this.renderer.circleStroke(bounds.left+1,bounds.top+1,size,new Color('#DEDEDE'),1,new Color('#A5A5A5'));if(container.node.checked){this.renderer.circle(Math.ceil(bounds.left+size/4)+1,Math.ceil(bounds.top+size/4)+1,Math.floor(size/2),new Color('#424242'));}},this);};NodeParser.prototype.paintFormValue=function(container){var value=container.getValue();if(value.length>0){var document=container.node.ownerDocument;var wrapper=document.createElement('html2canvaswrapper');var properties=['lineHeight','textAlign','fontFamily','fontWeight','fontSize','color','paddingLeft','paddingTop','paddingRight','paddingBottom','width','height','borderLeftStyle','borderTopStyle','borderLeftWidth','borderTopWidth','boxSizing','whiteSpace','wordWrap'];properties.forEach(function(property){try{wrapper.style[property]=container.css(property);}catch(e){// Older IE has issues with \"border\"\n\tlog(\"html2canvas: Parse: Exception caught in renderFormValue: \"+e.message);}});var bounds=container.parseBounds();wrapper.style.position=\"fixed\";wrapper.style.left=bounds.left+\"px\";wrapper.style.top=bounds.top+\"px\";wrapper.textContent=value;document.body.appendChild(wrapper);this.paintText(new TextContainer(wrapper.firstChild,container));document.body.removeChild(wrapper);}};NodeParser.prototype.paintText=function(container){container.applyTextTransform();var characters=punycode.ucs2.decode(container.node.data);var textList=(!this.options.letterRendering||noLetterSpacing(container))&&!hasUnicode(container.node.data)?getWords(characters):characters.map(function(character){return punycode.ucs2.encode([character]);});var weight=container.parent.fontWeight();var size=container.parent.css('fontSize');var family=container.parent.css('fontFamily');var shadows=container.parent.parseTextShadows();this.renderer.font(container.parent.color('color'),container.parent.css('fontStyle'),container.parent.css('fontVariant'),weight,size,family);if(shadows.length){// TODO: support multiple text shadows\n\tthis.renderer.fontShadow(shadows[0].color,shadows[0].offsetX,shadows[0].offsetY,shadows[0].blur);}else{this.renderer.clearShadow();}this.renderer.clip(container.parent.clip,function(){textList.map(this.parseTextBounds(container),this).forEach(function(bounds,index){if(bounds){this.renderer.text(textList[index],bounds.left,bounds.bottom);this.renderTextDecoration(container.parent,bounds,this.fontMetrics.getMetrics(family,size));}},this);},this);};NodeParser.prototype.renderTextDecoration=function(container,bounds,metrics){switch(container.css(\"textDecoration\").split(\" \")[0]){case\"underline\":// Draws a line at the baseline of the font\n\t// TODO As some browsers display the line as more than 1px if the font-size is big, need to take that into account both in position and size\n\tthis.renderer.rectangle(bounds.left,Math.round(bounds.top+metrics.baseline+metrics.lineWidth),bounds.width,1,container.color(\"color\"));break;case\"overline\":this.renderer.rectangle(bounds.left,Math.round(bounds.top),bounds.width,1,container.color(\"color\"));break;case\"line-through\":// TODO try and find exact position for line-through\n\tthis.renderer.rectangle(bounds.left,Math.ceil(bounds.top+metrics.middle+metrics.lineWidth),bounds.width,1,container.color(\"color\"));break;}};var borderColorTransforms={inset:[[\"darken\",0.60],[\"darken\",0.10],[\"darken\",0.10],[\"darken\",0.60]]};NodeParser.prototype.parseBorders=function(container){var nodeBounds=container.parseBounds();var radius=getBorderRadiusData(container);var borders=[\"Top\",\"Right\",\"Bottom\",\"Left\"].map(function(side,index){var style=container.css('border'+side+'Style');var color=container.color('border'+side+'Color');if(style===\"inset\"&&color.isBlack()){color=new Color([255,255,255,color.a]);// this is wrong, but\n\t}var colorTransform=borderColorTransforms[style]?borderColorTransforms[style][index]:null;return{width:container.cssInt('border'+side+'Width'),color:colorTransform?color[colorTransform[0]](colorTransform[1]):color,args:null};});var borderPoints=calculateCurvePoints(nodeBounds,radius,borders);return{clip:this.parseBackgroundClip(container,borderPoints,borders,radius,nodeBounds),borders:calculateBorders(borders,nodeBounds,borderPoints,radius)};};function calculateBorders(borders,nodeBounds,borderPoints,radius){return borders.map(function(border,borderSide){if(border.width>0){var bx=nodeBounds.left;var by=nodeBounds.top;var bw=nodeBounds.width;var bh=nodeBounds.height-borders[2].width;switch(borderSide){case 0:// top border\n\tbh=borders[0].width;border.args=drawSide({c1:[bx,by],c2:[bx+bw,by],c3:[bx+bw-borders[1].width,by+bh],c4:[bx+borders[3].width,by+bh]},radius[0],radius[1],borderPoints.topLeftOuter,borderPoints.topLeftInner,borderPoints.topRightOuter,borderPoints.topRightInner);break;case 1:// right border\n\tbx=nodeBounds.left+nodeBounds.width-borders[1].width;bw=borders[1].width;border.args=drawSide({c1:[bx+bw,by],c2:[bx+bw,by+bh+borders[2].width],c3:[bx,by+bh],c4:[bx,by+borders[0].width]},radius[1],radius[2],borderPoints.topRightOuter,borderPoints.topRightInner,borderPoints.bottomRightOuter,borderPoints.bottomRightInner);break;case 2:// bottom border\n\tby=by+nodeBounds.height-borders[2].width;bh=borders[2].width;border.args=drawSide({c1:[bx+bw,by+bh],c2:[bx,by+bh],c3:[bx+borders[3].width,by],c4:[bx+bw-borders[3].width,by]},radius[2],radius[3],borderPoints.bottomRightOuter,borderPoints.bottomRightInner,borderPoints.bottomLeftOuter,borderPoints.bottomLeftInner);break;case 3:// left border\n\tbw=borders[3].width;border.args=drawSide({c1:[bx,by+bh+borders[2].width],c2:[bx,by],c3:[bx+bw,by+borders[0].width],c4:[bx+bw,by+bh]},radius[3],radius[0],borderPoints.bottomLeftOuter,borderPoints.bottomLeftInner,borderPoints.topLeftOuter,borderPoints.topLeftInner);break;}}return border;});}NodeParser.prototype.parseBackgroundClip=function(container,borderPoints,borders,radius,bounds){var backgroundClip=container.css('backgroundClip'),borderArgs=[];switch(backgroundClip){case\"content-box\":case\"padding-box\":parseCorner(borderArgs,radius[0],radius[1],borderPoints.topLeftInner,borderPoints.topRightInner,bounds.left+borders[3].width,bounds.top+borders[0].width);parseCorner(borderArgs,radius[1],radius[2],borderPoints.topRightInner,borderPoints.bottomRightInner,bounds.left+bounds.width-borders[1].width,bounds.top+borders[0].width);parseCorner(borderArgs,radius[2],radius[3],borderPoints.bottomRightInner,borderPoints.bottomLeftInner,bounds.left+bounds.width-borders[1].width,bounds.top+bounds.height-borders[2].width);parseCorner(borderArgs,radius[3],radius[0],borderPoints.bottomLeftInner,borderPoints.topLeftInner,bounds.left+borders[3].width,bounds.top+bounds.height-borders[2].width);break;default:parseCorner(borderArgs,radius[0],radius[1],borderPoints.topLeftOuter,borderPoints.topRightOuter,bounds.left,bounds.top);parseCorner(borderArgs,radius[1],radius[2],borderPoints.topRightOuter,borderPoints.bottomRightOuter,bounds.left+bounds.width,bounds.top);parseCorner(borderArgs,radius[2],radius[3],borderPoints.bottomRightOuter,borderPoints.bottomLeftOuter,bounds.left+bounds.width,bounds.top+bounds.height);parseCorner(borderArgs,radius[3],radius[0],borderPoints.bottomLeftOuter,borderPoints.topLeftOuter,bounds.left,bounds.top+bounds.height);break;}return borderArgs;};function getCurvePoints(x,y,r1,r2){var kappa=4*((Math.sqrt(2)-1)/3);var ox=r1*kappa,// control point offset horizontal\n\toy=r2*kappa,// control point offset vertical\n\txm=x+r1,// x-middle\n\tym=y+r2;// y-middle\n\treturn{topLeft:bezierCurve({x:x,y:ym},{x:x,y:ym-oy},{x:xm-ox,y:y},{x:xm,y:y}),topRight:bezierCurve({x:x,y:y},{x:x+ox,y:y},{x:xm,y:ym-oy},{x:xm,y:ym}),bottomRight:bezierCurve({x:xm,y:y},{x:xm,y:y+oy},{x:x+ox,y:ym},{x:x,y:ym}),bottomLeft:bezierCurve({x:xm,y:ym},{x:xm-ox,y:ym},{x:x,y:y+oy},{x:x,y:y})};}function calculateCurvePoints(bounds,borderRadius,borders){var x=bounds.left,y=bounds.top,width=bounds.width,height=bounds.height,tlh=borderRadius[0][0]<width/2?borderRadius[0][0]:width/2,tlv=borderRadius[0][1]<height/2?borderRadius[0][1]:height/2,trh=borderRadius[1][0]<width/2?borderRadius[1][0]:width/2,trv=borderRadius[1][1]<height/2?borderRadius[1][1]:height/2,brh=borderRadius[2][0]<width/2?borderRadius[2][0]:width/2,brv=borderRadius[2][1]<height/2?borderRadius[2][1]:height/2,blh=borderRadius[3][0]<width/2?borderRadius[3][0]:width/2,blv=borderRadius[3][1]<height/2?borderRadius[3][1]:height/2;var topWidth=width-trh,rightHeight=height-brv,bottomWidth=width-brh,leftHeight=height-blv;return{topLeftOuter:getCurvePoints(x,y,tlh,tlv).topLeft.subdivide(0.5),topLeftInner:getCurvePoints(x+borders[3].width,y+borders[0].width,Math.max(0,tlh-borders[3].width),Math.max(0,tlv-borders[0].width)).topLeft.subdivide(0.5),topRightOuter:getCurvePoints(x+topWidth,y,trh,trv).topRight.subdivide(0.5),topRightInner:getCurvePoints(x+Math.min(topWidth,width+borders[3].width),y+borders[0].width,topWidth>width+borders[3].width?0:trh-borders[3].width,trv-borders[0].width).topRight.subdivide(0.5),bottomRightOuter:getCurvePoints(x+bottomWidth,y+rightHeight,brh,brv).bottomRight.subdivide(0.5),bottomRightInner:getCurvePoints(x+Math.min(bottomWidth,width-borders[3].width),y+Math.min(rightHeight,height+borders[0].width),Math.max(0,brh-borders[1].width),brv-borders[2].width).bottomRight.subdivide(0.5),bottomLeftOuter:getCurvePoints(x,y+leftHeight,blh,blv).bottomLeft.subdivide(0.5),bottomLeftInner:getCurvePoints(x+borders[3].width,y+leftHeight,Math.max(0,blh-borders[3].width),blv-borders[2].width).bottomLeft.subdivide(0.5)};}function bezierCurve(start,startControl,endControl,end){var lerp=function lerp(a,b,t){return{x:a.x+(b.x-a.x)*t,y:a.y+(b.y-a.y)*t};};return{start:start,startControl:startControl,endControl:endControl,end:end,subdivide:function subdivide(t){var ab=lerp(start,startControl,t),bc=lerp(startControl,endControl,t),cd=lerp(endControl,end,t),abbc=lerp(ab,bc,t),bccd=lerp(bc,cd,t),dest=lerp(abbc,bccd,t);return[bezierCurve(start,ab,abbc,dest),bezierCurve(dest,bccd,cd,end)];},curveTo:function curveTo(borderArgs){borderArgs.push([\"bezierCurve\",startControl.x,startControl.y,endControl.x,endControl.y,end.x,end.y]);},curveToReversed:function curveToReversed(borderArgs){borderArgs.push([\"bezierCurve\",endControl.x,endControl.y,startControl.x,startControl.y,start.x,start.y]);}};}function drawSide(borderData,radius1,radius2,outer1,inner1,outer2,inner2){var borderArgs=[];if(radius1[0]>0||radius1[1]>0){borderArgs.push([\"line\",outer1[1].start.x,outer1[1].start.y]);outer1[1].curveTo(borderArgs);}else{borderArgs.push([\"line\",borderData.c1[0],borderData.c1[1]]);}if(radius2[0]>0||radius2[1]>0){borderArgs.push([\"line\",outer2[0].start.x,outer2[0].start.y]);outer2[0].curveTo(borderArgs);borderArgs.push([\"line\",inner2[0].end.x,inner2[0].end.y]);inner2[0].curveToReversed(borderArgs);}else{borderArgs.push([\"line\",borderData.c2[0],borderData.c2[1]]);borderArgs.push([\"line\",borderData.c3[0],borderData.c3[1]]);}if(radius1[0]>0||radius1[1]>0){borderArgs.push([\"line\",inner1[1].end.x,inner1[1].end.y]);inner1[1].curveToReversed(borderArgs);}else{borderArgs.push([\"line\",borderData.c4[0],borderData.c4[1]]);}return borderArgs;}function parseCorner(borderArgs,radius1,radius2,corner1,corner2,x,y){if(radius1[0]>0||radius1[1]>0){borderArgs.push([\"line\",corner1[0].start.x,corner1[0].start.y]);corner1[0].curveTo(borderArgs);corner1[1].curveTo(borderArgs);}else{borderArgs.push([\"line\",x,y]);}if(radius2[0]>0||radius2[1]>0){borderArgs.push([\"line\",corner2[0].start.x,corner2[0].start.y]);}}function negativeZIndex(container){return container.cssInt(\"zIndex\")<0;}function positiveZIndex(container){return container.cssInt(\"zIndex\")>0;}function zIndex0(container){return container.cssInt(\"zIndex\")===0;}function inlineLevel(container){return[\"inline\",\"inline-block\",\"inline-table\"].indexOf(container.css(\"display\"))!==-1;}function isStackingContext(container){return container instanceof StackingContext;}function hasText(container){return container.node.data.trim().length>0;}function noLetterSpacing(container){return /^(normal|none|0px)$/.test(container.parent.css(\"letterSpacing\"));}function getBorderRadiusData(container){return[\"TopLeft\",\"TopRight\",\"BottomRight\",\"BottomLeft\"].map(function(side){var value=container.css('border'+side+'Radius');var arr=value.split(\" \");if(arr.length<=1){arr[1]=arr[0];}return arr.map(asInt);});}function renderableNode(node){return node.nodeType===Node.TEXT_NODE||node.nodeType===Node.ELEMENT_NODE;}function isPositionedForStacking(container){var position=container.css(\"position\");var zIndex=[\"absolute\",\"relative\",\"fixed\"].indexOf(position)!==-1?container.css(\"zIndex\"):\"auto\";return zIndex!==\"auto\";}function isPositioned(container){return container.css(\"position\")!==\"static\";}function isFloating(container){return container.css(\"float\")!==\"none\";}function isInlineBlock(container){return[\"inline-block\",\"inline-table\"].indexOf(container.css(\"display\"))!==-1;}function not(callback){var context=this;return function(){return!callback.apply(context,arguments);};}function isElement(container){return container.node.nodeType===Node.ELEMENT_NODE;}function isPseudoElement(container){return container.isPseudoElement===true;}function isTextNode(container){return container.node.nodeType===Node.TEXT_NODE;}function zIndexSort(contexts){return function(a,b){return a.cssInt(\"zIndex\")+contexts.indexOf(a)/contexts.length-(b.cssInt(\"zIndex\")+contexts.indexOf(b)/contexts.length);};}function hasOpacity(container){return container.getOpacity()<1;}function asInt(value){return parseInt(value,10);}function getWidth(border){return border.width;}function nonIgnoredElement(nodeContainer){return nodeContainer.node.nodeType!==Node.ELEMENT_NODE||[\"SCRIPT\",\"HEAD\",\"TITLE\",\"OBJECT\",\"BR\",\"OPTION\"].indexOf(nodeContainer.node.nodeName)===-1;}function flatten(arrays){return[].concat.apply([],arrays);}function stripQuotes(content){var first=content.substr(0,1);return first===content.substr(content.length-1)&&first.match(/'|\"/)?content.substr(1,content.length-2):content;}function getWords(characters){var words=[],i=0,onWordBoundary=false,word;while(characters.length){if(isWordBoundary(characters[i])===onWordBoundary){word=characters.splice(0,i);if(word.length){words.push(punycode.ucs2.encode(word));}onWordBoundary=!onWordBoundary;i=0;}else{i++;}if(i>=characters.length){word=characters.splice(0,i);if(word.length){words.push(punycode.ucs2.encode(word));}}}return words;}function isWordBoundary(characterCode){return[32,// <space>\n\t13,// \\r\n\t10,// \\n\n\t9,// \\t\n\t45// -\n\t].indexOf(characterCode)!==-1;}function hasUnicode(string){return /[^\\u0000-\\u00ff]/.test(string);}module.exports=NodeParser;},{\"./color\":3,\"./fontmetrics\":7,\"./log\":13,\"./nodecontainer\":14,\"./pseudoelementcontainer\":18,\"./stackingcontext\":21,\"./textcontainer\":25,\"./utils\":26,\"punycode\":1}],16:[function(_dereq_,module,exports){var XHR=_dereq_('./xhr');var utils=_dereq_('./utils');var log=_dereq_('./log');var createWindowClone=_dereq_('./clone');var decode64=utils.decode64;function Proxy(src,proxyUrl,document){var supportsCORS='withCredentials'in new XMLHttpRequest();if(!proxyUrl){return Promise.reject(\"No proxy configured\");}var callback=createCallback(supportsCORS);var url=createProxyUrl(proxyUrl,src,callback);return supportsCORS?XHR(url):jsonp(document,url,callback).then(function(response){return decode64(response.content);});}var proxyCount=0;function ProxyURL(src,proxyUrl,document){var supportsCORSImage='crossOrigin'in new Image();var callback=createCallback(supportsCORSImage);var url=createProxyUrl(proxyUrl,src,callback);return supportsCORSImage?Promise.resolve(url):jsonp(document,url,callback).then(function(response){return\"data:\"+response.type+\";base64,\"+response.content;});}function jsonp(document,url,callback){return new Promise(function(resolve,reject){var s=document.createElement(\"script\");var cleanup=function cleanup(){delete window.html2canvas.proxy[callback];document.body.removeChild(s);};window.html2canvas.proxy[callback]=function(response){cleanup();resolve(response);};s.src=url;s.onerror=function(e){cleanup();reject(e);};document.body.appendChild(s);});}function createCallback(useCORS){return!useCORS?\"html2canvas_\"+Date.now()+\"_\"+ ++proxyCount+\"_\"+Math.round(Math.random()*100000):\"\";}function createProxyUrl(proxyUrl,src,callback){return proxyUrl+\"?url=\"+encodeURIComponent(src)+(callback.length?\"&callback=html2canvas.proxy.\"+callback:\"\");}function documentFromHTML(src){return function(html){var parser=new DOMParser(),doc;try{doc=parser.parseFromString(html,\"text/html\");}catch(e){log(\"DOMParser not supported, falling back to createHTMLDocument\");doc=document.implementation.createHTMLDocument(\"\");try{doc.open();doc.write(html);doc.close();}catch(ee){log(\"createHTMLDocument write not supported, falling back to document.body.innerHTML\");doc.body.innerHTML=html;// ie9 doesnt support writing to documentElement\n\t}}var b=doc.querySelector(\"base\");if(!b||!b.href.host){var base=doc.createElement(\"base\");base.href=src;doc.head.insertBefore(base,doc.head.firstChild);}return doc;};}function loadUrlDocument(src,proxy,document,width,height,options){return new Proxy(src,proxy,window.document).then(documentFromHTML(src)).then(function(doc){return createWindowClone(doc,document,width,height,options,0,0);});}exports.Proxy=Proxy;exports.ProxyURL=ProxyURL;exports.loadUrlDocument=loadUrlDocument;},{\"./clone\":2,\"./log\":13,\"./utils\":26,\"./xhr\":28}],17:[function(_dereq_,module,exports){var ProxyURL=_dereq_('./proxy').ProxyURL;function ProxyImageContainer(src,proxy){var link=document.createElement(\"a\");link.href=src;src=link.href;this.src=src;this.image=new Image();var self=this;this.promise=new Promise(function(resolve,reject){self.image.crossOrigin=\"Anonymous\";self.image.onload=resolve;self.image.onerror=reject;new ProxyURL(src,proxy,document).then(function(url){self.image.src=url;})['catch'](reject);});}module.exports=ProxyImageContainer;},{\"./proxy\":16}],18:[function(_dereq_,module,exports){var NodeContainer=_dereq_('./nodecontainer');function PseudoElementContainer(node,parent,type){NodeContainer.call(this,node,parent);this.isPseudoElement=true;this.before=type===\":before\";}PseudoElementContainer.prototype.cloneTo=function(stack){PseudoElementContainer.prototype.cloneTo.call(this,stack);stack.isPseudoElement=true;stack.before=this.before;};PseudoElementContainer.prototype=Object.create(NodeContainer.prototype);PseudoElementContainer.prototype.appendToDOM=function(){if(this.before){this.parent.node.insertBefore(this.node,this.parent.node.firstChild);}else{this.parent.node.appendChild(this.node);}this.parent.node.className+=\" \"+this.getHideClass();};PseudoElementContainer.prototype.cleanDOM=function(){this.node.parentNode.removeChild(this.node);this.parent.node.className=this.parent.node.className.replace(this.getHideClass(),\"\");};PseudoElementContainer.prototype.getHideClass=function(){return this[\"PSEUDO_HIDE_ELEMENT_CLASS_\"+(this.before?\"BEFORE\":\"AFTER\")];};PseudoElementContainer.prototype.PSEUDO_HIDE_ELEMENT_CLASS_BEFORE=\"___html2canvas___pseudoelement_before\";PseudoElementContainer.prototype.PSEUDO_HIDE_ELEMENT_CLASS_AFTER=\"___html2canvas___pseudoelement_after\";module.exports=PseudoElementContainer;},{\"./nodecontainer\":14}],19:[function(_dereq_,module,exports){var log=_dereq_('./log');function Renderer(width,height,images,options,document){this.width=width;this.height=height;this.images=images;this.options=options;this.document=document;}Renderer.prototype.renderImage=function(container,bounds,borderData,imageContainer){var paddingLeft=container.cssInt('paddingLeft'),paddingTop=container.cssInt('paddingTop'),paddingRight=container.cssInt('paddingRight'),paddingBottom=container.cssInt('paddingBottom'),borders=borderData.borders;var width=bounds.width-(borders[1].width+borders[3].width+paddingLeft+paddingRight);var height=bounds.height-(borders[0].width+borders[2].width+paddingTop+paddingBottom);this.drawImage(imageContainer,0,0,imageContainer.image.width||width,imageContainer.image.height||height,bounds.left+paddingLeft+borders[3].width,bounds.top+paddingTop+borders[0].width,width,height);};Renderer.prototype.renderBackground=function(container,bounds,borderData){if(bounds.height>0&&bounds.width>0){this.renderBackgroundColor(container,bounds);this.renderBackgroundImage(container,bounds,borderData);}};Renderer.prototype.renderBackgroundColor=function(container,bounds){var color=container.color(\"backgroundColor\");if(!color.isTransparent()){this.rectangle(bounds.left,bounds.top,bounds.width,bounds.height,color);}};Renderer.prototype.renderBorders=function(borders){borders.forEach(this.renderBorder,this);};Renderer.prototype.renderBorder=function(data){if(!data.color.isTransparent()&&data.args!==null){this.drawShape(data.args,data.color);}};Renderer.prototype.renderBackgroundImage=function(container,bounds,borderData){var backgroundImages=container.parseBackgroundImages();backgroundImages.reverse().forEach(function(backgroundImage,index,arr){switch(backgroundImage.method){case\"url\":var image=this.images.get(backgroundImage.args[0]);if(image){this.renderBackgroundRepeating(container,bounds,image,arr.length-(index+1),borderData);}else{log(\"Error loading background-image\",backgroundImage.args[0]);}break;case\"linear-gradient\":case\"gradient\":var gradientImage=this.images.get(backgroundImage.value);if(gradientImage){this.renderBackgroundGradient(gradientImage,bounds,borderData);}else{log(\"Error loading background-image\",backgroundImage.args[0]);}break;case\"none\":break;default:log(\"Unknown background-image type\",backgroundImage.args[0]);}},this);};Renderer.prototype.renderBackgroundRepeating=function(container,bounds,imageContainer,index,borderData){var size=container.parseBackgroundSize(bounds,imageContainer.image,index);var position=container.parseBackgroundPosition(bounds,imageContainer.image,index,size);var repeat=container.parseBackgroundRepeat(index);switch(repeat){case\"repeat-x\":case\"repeat no-repeat\":this.backgroundRepeatShape(imageContainer,position,size,bounds,bounds.left+borderData[3],bounds.top+position.top+borderData[0],99999,size.height,borderData);break;case\"repeat-y\":case\"no-repeat repeat\":this.backgroundRepeatShape(imageContainer,position,size,bounds,bounds.left+position.left+borderData[3],bounds.top+borderData[0],size.width,99999,borderData);break;case\"no-repeat\":this.backgroundRepeatShape(imageContainer,position,size,bounds,bounds.left+position.left+borderData[3],bounds.top+position.top+borderData[0],size.width,size.height,borderData);break;default:this.renderBackgroundRepeat(imageContainer,position,size,{top:bounds.top,left:bounds.left},borderData[3],borderData[0]);break;}};module.exports=Renderer;},{\"./log\":13}],20:[function(_dereq_,module,exports){var Renderer=_dereq_('../renderer');var LinearGradientContainer=_dereq_('../lineargradientcontainer');var log=_dereq_('../log');function CanvasRenderer(width,height){Renderer.apply(this,arguments);this.canvas=this.options.canvas||this.document.createElement(\"canvas\");if(!this.options.canvas){this.canvas.width=width;this.canvas.height=height;}this.ctx=this.canvas.getContext(\"2d\");this.taintCtx=this.document.createElement(\"canvas\").getContext(\"2d\");this.ctx.textBaseline=\"bottom\";this.variables={};log(\"Initialized CanvasRenderer with size\",width,\"x\",height);}CanvasRenderer.prototype=Object.create(Renderer.prototype);CanvasRenderer.prototype.setFillStyle=function(fillStyle){this.ctx.fillStyle=(typeof fillStyle===\"undefined\"?\"undefined\":_typeof(fillStyle))===\"object\"&&!!fillStyle.isColor?fillStyle.toString():fillStyle;return this.ctx;};CanvasRenderer.prototype.rectangle=function(left,top,width,height,color){this.setFillStyle(color).fillRect(left,top,width,height);};CanvasRenderer.prototype.circle=function(left,top,size,color){this.setFillStyle(color);this.ctx.beginPath();this.ctx.arc(left+size/2,top+size/2,size/2,0,Math.PI*2,true);this.ctx.closePath();this.ctx.fill();};CanvasRenderer.prototype.circleStroke=function(left,top,size,color,stroke,strokeColor){this.circle(left,top,size,color);this.ctx.strokeStyle=strokeColor.toString();this.ctx.stroke();};CanvasRenderer.prototype.drawShape=function(shape,color){this.shape(shape);this.setFillStyle(color).fill();};CanvasRenderer.prototype.taints=function(imageContainer){if(imageContainer.tainted===null){this.taintCtx.drawImage(imageContainer.image,0,0);try{this.taintCtx.getImageData(0,0,1,1);imageContainer.tainted=false;}catch(e){this.taintCtx=document.createElement(\"canvas\").getContext(\"2d\");imageContainer.tainted=true;}}return imageContainer.tainted;};CanvasRenderer.prototype.drawImage=function(imageContainer,sx,sy,sw,sh,dx,dy,dw,dh){if(!this.taints(imageContainer)||this.options.allowTaint){this.ctx.drawImage(imageContainer.image,sx,sy,sw,sh,dx,dy,dw,dh);}};CanvasRenderer.prototype.clip=function(shapes,callback,context){this.ctx.save();shapes.filter(hasEntries).forEach(function(shape){this.shape(shape).clip();},this);callback.call(context);this.ctx.restore();};CanvasRenderer.prototype.shape=function(shape){this.ctx.beginPath();shape.forEach(function(point,index){if(point[0]===\"rect\"){this.ctx.rect.apply(this.ctx,point.slice(1));}else{this.ctx[index===0?\"moveTo\":point[0]+\"To\"].apply(this.ctx,point.slice(1));}},this);this.ctx.closePath();return this.ctx;};CanvasRenderer.prototype.font=function(color,style,variant,weight,size,family){this.setFillStyle(color).font=[style,variant,weight,size,family].join(\" \").split(\",\")[0];};CanvasRenderer.prototype.fontShadow=function(color,offsetX,offsetY,blur){this.setVariable(\"shadowColor\",color.toString()).setVariable(\"shadowOffsetY\",offsetX).setVariable(\"shadowOffsetX\",offsetY).setVariable(\"shadowBlur\",blur);};CanvasRenderer.prototype.clearShadow=function(){this.setVariable(\"shadowColor\",\"rgba(0,0,0,0)\");};CanvasRenderer.prototype.setOpacity=function(opacity){this.ctx.globalAlpha=opacity;};CanvasRenderer.prototype.setTransform=function(transform){this.ctx.translate(transform.origin[0],transform.origin[1]);this.ctx.transform.apply(this.ctx,transform.matrix);this.ctx.translate(-transform.origin[0],-transform.origin[1]);};CanvasRenderer.prototype.setVariable=function(property,value){if(this.variables[property]!==value){this.variables[property]=this.ctx[property]=value;}return this;};CanvasRenderer.prototype.text=function(text,left,bottom){this.ctx.fillText(text,left,bottom);};CanvasRenderer.prototype.backgroundRepeatShape=function(imageContainer,backgroundPosition,size,bounds,left,top,width,height,borderData){var shape=[[\"line\",Math.round(left),Math.round(top)],[\"line\",Math.round(left+width),Math.round(top)],[\"line\",Math.round(left+width),Math.round(height+top)],[\"line\",Math.round(left),Math.round(height+top)]];this.clip([shape],function(){this.renderBackgroundRepeat(imageContainer,backgroundPosition,size,bounds,borderData[3],borderData[0]);},this);};CanvasRenderer.prototype.renderBackgroundRepeat=function(imageContainer,backgroundPosition,size,bounds,borderLeft,borderTop){var offsetX=Math.round(bounds.left+backgroundPosition.left+borderLeft),offsetY=Math.round(bounds.top+backgroundPosition.top+borderTop);this.setFillStyle(this.ctx.createPattern(this.resizeImage(imageContainer,size),\"repeat\"));this.ctx.translate(offsetX,offsetY);this.ctx.fill();this.ctx.translate(-offsetX,-offsetY);};CanvasRenderer.prototype.renderBackgroundGradient=function(gradientImage,bounds){if(gradientImage instanceof LinearGradientContainer){var gradient=this.ctx.createLinearGradient(bounds.left+bounds.width*gradientImage.x0,bounds.top+bounds.height*gradientImage.y0,bounds.left+bounds.width*gradientImage.x1,bounds.top+bounds.height*gradientImage.y1);gradientImage.colorStops.forEach(function(colorStop){gradient.addColorStop(colorStop.stop,colorStop.color.toString());});this.rectangle(bounds.left,bounds.top,bounds.width,bounds.height,gradient);}};CanvasRenderer.prototype.resizeImage=function(imageContainer,size){var image=imageContainer.image;if(image.width===size.width&&image.height===size.height){return image;}var ctx,canvas=document.createElement('canvas');canvas.width=size.width;canvas.height=size.height;ctx=canvas.getContext(\"2d\");ctx.drawImage(image,0,0,image.width,image.height,0,0,size.width,size.height);return canvas;};function hasEntries(array){return array.length>0;}module.exports=CanvasRenderer;},{\"../lineargradientcontainer\":12,\"../log\":13,\"../renderer\":19}],21:[function(_dereq_,module,exports){var NodeContainer=_dereq_('./nodecontainer');function StackingContext(hasOwnStacking,opacity,element,parent){NodeContainer.call(this,element,parent);this.ownStacking=hasOwnStacking;this.contexts=[];this.children=[];this.opacity=(this.parent?this.parent.stack.opacity:1)*opacity;}StackingContext.prototype=Object.create(NodeContainer.prototype);StackingContext.prototype.getParentStack=function(context){var parentStack=this.parent?this.parent.stack:null;return parentStack?parentStack.ownStacking?parentStack:parentStack.getParentStack(context):context.stack;};module.exports=StackingContext;},{\"./nodecontainer\":14}],22:[function(_dereq_,module,exports){function Support(document){this.rangeBounds=this.testRangeBounds(document);this.cors=this.testCORS();this.svg=this.testSVG();}Support.prototype.testRangeBounds=function(document){var range,testElement,rangeBounds,rangeHeight,support=false;if(document.createRange){range=document.createRange();if(range.getBoundingClientRect){testElement=document.createElement('boundtest');testElement.style.height=\"123px\";testElement.style.display=\"block\";document.body.appendChild(testElement);range.selectNode(testElement);rangeBounds=range.getBoundingClientRect();rangeHeight=rangeBounds.height;if(rangeHeight===123){support=true;}document.body.removeChild(testElement);}}return support;};Support.prototype.testCORS=function(){return typeof new Image().crossOrigin!==\"undefined\";};Support.prototype.testSVG=function(){var img=new Image();var canvas=document.createElement(\"canvas\");var ctx=canvas.getContext(\"2d\");img.src=\"data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg'></svg>\";try{ctx.drawImage(img,0,0);canvas.toDataURL();}catch(e){return false;}return true;};module.exports=Support;},{}],23:[function(_dereq_,module,exports){var XHR=_dereq_('./xhr');var decode64=_dereq_('./utils').decode64;function SVGContainer(src){this.src=src;this.image=null;var self=this;this.promise=this.hasFabric().then(function(){return self.isInline(src)?Promise.resolve(self.inlineFormatting(src)):XHR(src);}).then(function(svg){return new Promise(function(resolve){window.html2canvas.svg.fabric.loadSVGFromString(svg,self.createCanvas.call(self,resolve));});});}SVGContainer.prototype.hasFabric=function(){return!window.html2canvas.svg||!window.html2canvas.svg.fabric?Promise.reject(new Error(\"html2canvas.svg.js is not loaded, cannot render svg\")):Promise.resolve();};SVGContainer.prototype.inlineFormatting=function(src){return /^data:image\\/svg\\+xml;base64,/.test(src)?this.decode64(this.removeContentType(src)):this.removeContentType(src);};SVGContainer.prototype.removeContentType=function(src){return src.replace(/^data:image\\/svg\\+xml(;base64)?,/,'');};SVGContainer.prototype.isInline=function(src){return /^data:image\\/svg\\+xml/i.test(src);};SVGContainer.prototype.createCanvas=function(resolve){var self=this;return function(objects,options){var canvas=new window.html2canvas.svg.fabric.StaticCanvas('c');self.image=canvas.lowerCanvasEl;canvas.setWidth(options.width).setHeight(options.height).add(window.html2canvas.svg.fabric.util.groupSVGElements(objects,options)).renderAll();resolve(canvas.lowerCanvasEl);};};SVGContainer.prototype.decode64=function(str){return typeof window.atob===\"function\"?window.atob(str):decode64(str);};module.exports=SVGContainer;},{\"./utils\":26,\"./xhr\":28}],24:[function(_dereq_,module,exports){var SVGContainer=_dereq_('./svgcontainer');function SVGNodeContainer(node,_native){this.src=node;this.image=null;var self=this;this.promise=_native?new Promise(function(resolve,reject){self.image=new Image();self.image.onload=resolve;self.image.onerror=reject;self.image.src=\"data:image/svg+xml,\"+new XMLSerializer().serializeToString(node);if(self.image.complete===true){resolve(self.image);}}):this.hasFabric().then(function(){return new Promise(function(resolve){window.html2canvas.svg.fabric.parseSVGDocument(node,self.createCanvas.call(self,resolve));});});}SVGNodeContainer.prototype=Object.create(SVGContainer.prototype);module.exports=SVGNodeContainer;},{\"./svgcontainer\":23}],25:[function(_dereq_,module,exports){var NodeContainer=_dereq_('./nodecontainer');function TextContainer(node,parent){NodeContainer.call(this,node,parent);}TextContainer.prototype=Object.create(NodeContainer.prototype);TextContainer.prototype.applyTextTransform=function(){this.node.data=this.transform(this.parent.css(\"textTransform\"));};TextContainer.prototype.transform=function(transform){var text=this.node.data;switch(transform){case\"lowercase\":return text.toLowerCase();case\"capitalize\":return text.replace(/(^|\\s|:|-|\\(|\\))([a-z])/g,capitalize);case\"uppercase\":return text.toUpperCase();default:return text;}};function capitalize(m,p1,p2){if(m.length>0){return p1+p2.toUpperCase();}}module.exports=TextContainer;},{\"./nodecontainer\":14}],26:[function(_dereq_,module,exports){exports.smallImage=function smallImage(){return\"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7\";};exports.bind=function(callback,context){return function(){return callback.apply(context,arguments);};};/*\n\t * base64-arraybuffer\n\t * https://github.com/niklasvh/base64-arraybuffer\n\t *\n\t * Copyright (c) 2012 Niklas von Hertzen\n\t * Licensed under the MIT license.\n\t */exports.decode64=function(base64){var chars=\"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\";var len=base64.length,i,encoded1,encoded2,encoded3,encoded4,byte1,byte2,byte3;var output=\"\";for(i=0;i<len;i+=4){encoded1=chars.indexOf(base64[i]);encoded2=chars.indexOf(base64[i+1]);encoded3=chars.indexOf(base64[i+2]);encoded4=chars.indexOf(base64[i+3]);byte1=encoded1<<2|encoded2>>4;byte2=(encoded2&15)<<4|encoded3>>2;byte3=(encoded3&3)<<6|encoded4;if(encoded3===64){output+=String.fromCharCode(byte1);}else if(encoded4===64||encoded4===-1){output+=String.fromCharCode(byte1,byte2);}else{output+=String.fromCharCode(byte1,byte2,byte3);}}return output;};exports.getBounds=function(node){if(node.getBoundingClientRect){var clientRect=node.getBoundingClientRect();var width=node.offsetWidth==null?clientRect.width:node.offsetWidth;return{top:clientRect.top,bottom:clientRect.bottom||clientRect.top+clientRect.height,right:clientRect.left+width,left:clientRect.left,width:width,height:node.offsetHeight==null?clientRect.height:node.offsetHeight};}return{};};exports.offsetBounds=function(node){var parent=node.offsetParent?exports.offsetBounds(node.offsetParent):{top:0,left:0};return{top:node.offsetTop+parent.top,bottom:node.offsetTop+node.offsetHeight+parent.top,right:node.offsetLeft+parent.left+node.offsetWidth,left:node.offsetLeft+parent.left,width:node.offsetWidth,height:node.offsetHeight};};exports.parseBackgrounds=function(backgroundImage){var whitespace=' \\r\\n\\t',method,definition,prefix,prefix_i,block,results=[],mode=0,numParen=0,quote,args;var appendResult=function appendResult(){if(method){if(definition.substr(0,1)==='\"'){definition=definition.substr(1,definition.length-2);}if(definition){args.push(definition);}if(method.substr(0,1)==='-'&&(prefix_i=method.indexOf('-',1)+1)>0){prefix=method.substr(0,prefix_i);method=method.substr(prefix_i);}results.push({prefix:prefix,method:method.toLowerCase(),value:block,args:args,image:null});}args=[];method=prefix=definition=block='';};args=[];method=prefix=definition=block='';backgroundImage.split(\"\").forEach(function(c){if(mode===0&&whitespace.indexOf(c)>-1){return;}switch(c){case'\"':if(!quote){quote=c;}else if(quote===c){quote=null;}break;case'(':if(quote){break;}else if(mode===0){mode=1;block+=c;return;}else{numParen++;}break;case')':if(quote){break;}else if(mode===1){if(numParen===0){mode=0;block+=c;appendResult();return;}else{numParen--;}}break;case',':if(quote){break;}else if(mode===0){appendResult();return;}else if(mode===1){if(numParen===0&&!method.match(/^url$/i)){args.push(definition);definition='';block+=c;return;}}break;}block+=c;if(mode===0){method+=c;}else{definition+=c;}});appendResult();return results;};},{}],27:[function(_dereq_,module,exports){var GradientContainer=_dereq_('./gradientcontainer');function WebkitGradientContainer(imageData){GradientContainer.apply(this,arguments);this.type=imageData.args[0]===\"linear\"?GradientContainer.TYPES.LINEAR:GradientContainer.TYPES.RADIAL;}WebkitGradientContainer.prototype=Object.create(GradientContainer.prototype);module.exports=WebkitGradientContainer;},{\"./gradientcontainer\":9}],28:[function(_dereq_,module,exports){function XHR(url){return new Promise(function(resolve,reject){var xhr=new XMLHttpRequest();xhr.open('GET',url);xhr.onload=function(){if(xhr.status===200){resolve(xhr.responseText);}else{reject(new Error(xhr.statusText));}};xhr.onerror=function(){reject(new Error(\"Network Error\"));};xhr.send();});}module.exports=XHR;},{}]},{},[4])(4);});\n\t/* WEBPACK VAR INJECTION */}.call(exports, (function() { return this; }())))\n\n/***/ },\n/* 2 */\n/***/ function(module, exports) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\t/**\n\t * base class for all object in the library\n\t * @class Baseobject\n\t */\n\tvar BaseObject = function () {\n\t  function BaseObject() {\n\t    _classCallCheck(this, BaseObject);\n\t  }\n\t\n\t  _createClass(BaseObject, [{\n\t    key: 'getName',\n\t\n\t    /**\n\t     * virtual function for returning class name\n\t     * @returns {string}\n\t     */\n\t    value: function getName() {\n\t      return '';\n\t    }\n\t\n\t    /**\n\t     * returns if current mode is debugging mode\n\t     * @returns {bool}\n\t     */\n\t\n\t  }, {\n\t    key: 'isDebug',\n\t    value: function isDebug() {\n\t      return this._debugMode;\n\t    }\n\t\n\t    /**\n\t     * logs message and object for debugging purpose\n\t     * @param {string} message\n\t     * @param {Array<any>} args\n\t     */\n\t\n\t  }, {\n\t    key: 'log',\n\t    value: function log(message) {\n\t      var _console;\n\t\n\t      if (!this.isDebug()) {\n\t        return;\n\t      }\n\t\n\t      for (var _len = arguments.length, args = Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n\t        args[_key - 1] = arguments[_key];\n\t      }\n\t\n\t      (_console = console).log.apply(_console, [this.getName() + ': ' + message].concat(args));\n\t    }\n\t  }]);\n\t\n\t  return BaseObject;\n\t}();\n\t\n\texports.default = BaseObject;\n\tmodule.exports = exports['default'];\n\n/***/ },\n/* 3 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tvar _baseObject = __webpack_require__(2);\n\t\n\tvar _baseObject2 = _interopRequireDefault(_baseObject);\n\t\n\tvar _rect = __webpack_require__(4);\n\t\n\tvar _rect2 = _interopRequireDefault(_rect);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\t\n\tfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\t\n\t/**\n\t * State enabled class to manage grey canvas on top of html page for cropping\n\t * @class CanvasState\n\t */\n\tvar CanvasState = function (_BaseObject) {\n\t  _inherits(CanvasState, _BaseObject);\n\t\n\t  /**\n\t   * object constructor\n\t   * @param {HTMLDocument} doc\n\t   * @param {HTMLElement} canvas - canvas DOM element\n\t   */\n\t  function CanvasState(doc, canvas) {\n\t    var debugMode = arguments.length <= 2 || arguments[2] === undefined ? true : arguments[2];\n\t\n\t    _classCallCheck(this, CanvasState);\n\t\n\t    var _this = _possibleConstructorReturn(this, (CanvasState.__proto__ || Object.getPrototypeOf(CanvasState)).call(this));\n\t\n\t    _this._document = doc;\n\t    _this._canvas = canvas;\n\t    _this._width = canvas.width;\n\t    _this._height = canvas.height;\n\t    _this._ctx = canvas.getContext('2d');\n\t    _this._debugMode = debugMode;\n\t\n\t    var html = _this._document.body.parentNode;\n\t\n\t    _this._htmlTop = html.offsetTop;\n\t    _this._htmlLeft = html.offsetLeft;\n\t\n\t    _this._valid = false; // when set to false, the canvas will redraw everything\n\t    _this._shape = null; // the rectangle shape\n\t    _this._dragging = false; // Keep track of when we are dragging\n\t    _this._dragoffx = 0; // See mousedown and mousemove events for explanation\n\t    _this._dragoffy = 0;\n\t\n\t    _this.log('initialized');\n\t\n\t    _this._initRect();\n\t    _this._initEvents();\n\t\n\t    _this._interval = 30;\n\t    setInterval(function () {\n\t      _this.draw();\n\t    }, _this._interval);\n\t    return _this;\n\t  }\n\t\n\t  /**\n\t   * returns class name\n\t   * @returns {string}\n\t   */\n\t\n\t\n\t  _createClass(CanvasState, [{\n\t    key: 'getName',\n\t    value: function getName() {\n\t      return 'CanvasState';\n\t    }\n\t\n\t    /**\n\t     * attaches event handlers to canvas\n\t     * @private\n\t     */\n\t\n\t  }, {\n\t    key: '_initEvents',\n\t    value: function _initEvents() {\n\t      var _this2 = this;\n\t\n\t      var _canvas = this._canvas;\n\t      // fixes a problem where double clicking causesShape text to get selected on the canvas\n\t\n\t      _canvas.addEventListener('selectstart', function (e) {\n\t        e.preventDefault();\n\t        return false;\n\t      }, false);\n\t\n\t      // up, down, and move are for dragging\n\t      _canvas.addEventListener('mousedown', function (e) {\n\t        var _shape = _this2._shape;\n\t\n\t        var mouse = _this2.getMouse(e);\n\t        var mx = mouse.x;\n\t        var my = mouse.y;\n\t        _this2._valid = false;\n\t        if (_shape.contains(mx, my)) {\n\t          _this2._dragoffx = mx - _shape._x;\n\t          _this2._dragoffy = my - _shape._y;\n\t          _this2._dragging = true;\n\t\n\t          _this2.log('mouse down detected. starting drag', mx, my);\n\t        }\n\t      }, true);\n\t\n\t      _canvas.addEventListener('mousemove', function (e) {\n\t        if (_this2._dragging) {\n\t          var mouse = _this2.getMouse(e);\n\t          // We don't want to drag the object by its top-left corner, we want to drag it\n\t          // from where we clicked. Thats why we saved the offset and use it here\n\t          _this2._shape._x = mouse.x - _this2._dragoffx;\n\t          _this2._shape._y = mouse.y - _this2._dragoffy;\n\t          _this2._valid = false; // Something's dragging so we must redraw\n\t\n\t          // this.log('moving the rect', mouse.x, mouse.y);\n\t        }\n\t      }, true);\n\t\n\t      _canvas.addEventListener('mouseup', function () {\n\t        _this2._dragging = false;\n\t        _this2.log('dragging finished');\n\t      });\n\t\n\t      this.log('initialized events');\n\t    }\n\t\n\t    /**\n\t     * creates a movable rectangle and attach to canvas\n\t     * @private\n\t     */\n\t\n\t  }, {\n\t    key: '_initRect',\n\t    value: function _initRect() {\n\t      this._shape = new _rect2.default(this._width / 4, this._height / 4, this._width / 2, this._height / 2, 'rgba(0, 200, 0, 0.5)');\n\t      this._valid = false;\n\t    }\n\t\n\t    /**\n\t     * clears the canvas for next draw\n\t     */\n\t\n\t  }, {\n\t    key: 'clear',\n\t    value: function clear() {\n\t      this._ctx.clearRect(0, 0, this._width, this._height);\n\t    }\n\t\n\t    /**\n\t     * while draw is called as often as the INTERVAL variable demands,\n\t     * it only ever does something if the canvas gets invalidated by our code\n\t     */\n\t\n\t  }, {\n\t    key: 'draw',\n\t    value: function draw() {\n\t      // if our state is invalid, redraw and validate!\n\t      if (!this._valid) {\n\t        var _ctx = this._ctx;\n\t        var _shape = this._shape;\n\t\n\t        this.clear();\n\t\n\t        // @TODO draw background here\n\t\n\t        // draw shape\n\t        _shape.draw(_ctx);\n\t\n\t        _ctx.strokeStyle = '#CC0000';\n\t        _ctx.lineWidth = 2;\n\t        _ctx.strokeRect(_shape._x, _shape._y, _shape._w, _shape._h);\n\t\n\t        this._valid = true;\n\t\n\t        this.log('shape drew', _shape._x, _shape._y, _shape._w, _shape._h);\n\t      }\n\t    }\n\t\n\t    /**\n\t     * creates an object with x and y defined, set to the mouse position relative to the state's canvas\n\t     * If you wanna be super-correct this can be tricky, we have to worry about padding and borders\n\t     * @param {Event} e\n\t     * @returns {{x: number, y: number}}\n\t     */\n\t\n\t  }, {\n\t    key: 'getMouse',\n\t    value: function getMouse(e) {\n\t      var el = this._canvas;\n\t      var offsetX = 0;\n\t      var offsetY = 0;\n\t\n\t      // Compute the total offset\n\t      if (el.offsetParent !== undefined) {\n\t        do {\n\t          offsetX += el.offsetLeft;\n\t          offsetY += el.offsetTop;\n\t          el = el.offsetParent;\n\t        } while (el);\n\t      }\n\t\n\t      // Also add the <html> offsets in case there's a position:fixed bar\n\t      offsetX += this._htmlLeft;\n\t      offsetY += this._htmlTop;\n\t\n\t      var mx = e.pageX - offsetX;\n\t      var my = e.pageY - offsetY;\n\t\n\t      return { x: mx, y: my };\n\t    }\n\t  }]);\n\t\n\t  return CanvasState;\n\t}(_baseObject2.default);\n\t\n\texports.default = CanvasState;\n\tmodule.exports = exports['default'];\n\n/***/ },\n/* 4 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tvar _baseObject = __webpack_require__(2);\n\t\n\tvar _baseObject2 = _interopRequireDefault(_baseObject);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\t\n\tfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\t\n\t/**\n\t * Rectangle for highlighting the cropping area\n\t * @class Rect\n\t */\n\tvar Rect = function (_BaseObject) {\n\t  _inherits(Rect, _BaseObject);\n\t\n\t  /**\n\t   * object constructor\n\t   * @param {number} x - left position of shape\n\t   * @param {number} y - top position of shape\n\t   * @param {number} w - width\n\t   * @param {number} h - height\n\t   * @param {string} fill - background color of the shape\n\t   */\n\t  function Rect(x, y, w, h, fill) {\n\t    var debugMode = arguments.length <= 5 || arguments[5] === undefined ? true : arguments[5];\n\t\n\t    _classCallCheck(this, Rect);\n\t\n\t    var _this = _possibleConstructorReturn(this, (Rect.__proto__ || Object.getPrototypeOf(Rect)).call(this));\n\t\n\t    _this._x = x || 0;\n\t    _this._y = y || 0;\n\t    _this._w = w || 1;\n\t    _this._h = h || 1;\n\t    _this._fill = fill || '#AAAAAA';\n\t    _this._debugMode = debugMode;\n\t\n\t    _this.log('initialized');\n\t    return _this;\n\t  }\n\t\n\t  /**\n\t   * returns class name\n\t   * @returns {string}\n\t   */\n\t\n\t\n\t  _createClass(Rect, [{\n\t    key: 'getName',\n\t    value: function getName() {\n\t      return 'Rect';\n\t    }\n\t\n\t    /**\n\t     * draws the shape\n\t     * @param {CanvasContext} ctx\n\t     */\n\t\n\t  }, {\n\t    key: 'draw',\n\t    value: function draw(ctx) {\n\t      var _x = this._x;\n\t      var _y = this._y;\n\t      var _w = this._w;\n\t      var _h = this._h;\n\t      var _fill = this._fill;\n\t\n\t      ctx.fillStyle = _fill; // eslint-disable-line\n\t      ctx.fillRect(_x, _y, _w, _h);\n\t\n\t      this.log('filling the rectangle', _x, _y, _w, _h);\n\t    }\n\t\n\t    /**\n\t     * checks if point is inside the shape\n\t     * @param {number} mx\n\t     * @param {number} my\n\t     * @returns {bool}\n\t     */\n\t\n\t  }, {\n\t    key: 'contains',\n\t    value: function contains(mx, my) {\n\t      var _x = this._x;\n\t      var _y = this._y;\n\t      var _w = this._w;\n\t      var _h = this._h;\n\t\n\t      return _x <= mx && _x + _w >= mx && _y <= my && _y + _h >= my;\n\t    }\n\t  }]);\n\t\n\t  return Rect;\n\t}(_baseObject2.default);\n\t\n\texports.default = Rect;\n\tmodule.exports = exports['default'];\n\n/***/ }\n/******/ ])\n});\n;\n\n\n/** WEBPACK FOOTER **\n ** HtmlCrop.min.js\n **/"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n/** WEBPACK FOOTER **\n ** webpack/bootstrap 19b980fc6f4d3aeeaee9\n **/","import html2canvas from 'html2canvas';\nimport BaseObject from './base-object';\nimport CanvasState from './canvas-state';\n\nexport default class HtmlCrop extends BaseObject {\n  /**\n   * object constructor\n   * @param {HTMLDocument} doc\n   * @param {Object} options\n   */\n  constructor(doc, options = {}) {\n    super();\n    this._document = doc;\n    this.options = Object.assign({}, options);\n    this._debugMode = options.debug;\n    this._canvasState = new CanvasState(doc, doc.getElementById('canvas'), this._debugMode);\n    this.log('initialized');\n\n    // testing\n    html2canvas(this._document.body).then((canvas) => {\n      this._document.body.appendChild(canvas);\n    });\n  }\n\n  /**\n   * returns class name\n   * @returns {string}\n   */\n  getName() {\n    return 'HtmlCrop';\n  }\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/index.js\n **/","/*\n  html2canvas 0.5.0-beta4 <http://html2canvas.hertzen.com>\n  Copyright (c) 2016 Niklas von Hertzen\n\n  Released under  License\n*/\n\n(function(f){if(typeof exports===\"object\"&&typeof module!==\"undefined\"){module.exports=f()}else if(typeof define===\"function\"&&define.amd){define([],f)}else{var g;if(typeof window!==\"undefined\"){g=window}else if(typeof global!==\"undefined\"){g=global}else if(typeof self!==\"undefined\"){g=self}else{g=this}g.html2canvas = f()}})(function(){var define,module,exports;return (function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(_dereq_,module,exports){\n(function (global){\n/*! https://mths.be/punycode v1.4.0 by @mathias */\n;(function(root) {\n\n\t/** Detect free variables */\n\tvar freeExports = typeof exports == 'object' && exports &&\n\t\t!exports.nodeType && exports;\n\tvar freeModule = typeof module == 'object' && module &&\n\t\t!module.nodeType && module;\n\tvar freeGlobal = typeof global == 'object' && global;\n\tif (\n\t\tfreeGlobal.global === freeGlobal ||\n\t\tfreeGlobal.window === freeGlobal ||\n\t\tfreeGlobal.self === freeGlobal\n\t) {\n\t\troot = freeGlobal;\n\t}\n\n\t/**\n\t * The `punycode` object.\n\t * @name punycode\n\t * @type Object\n\t */\n\tvar punycode,\n\n\t/** Highest positive signed 32-bit float value */\n\tmaxInt = 2147483647, // aka. 0x7FFFFFFF or 2^31-1\n\n\t/** Bootstring parameters */\n\tbase = 36,\n\ttMin = 1,\n\ttMax = 26,\n\tskew = 38,\n\tdamp = 700,\n\tinitialBias = 72,\n\tinitialN = 128, // 0x80\n\tdelimiter = '-', // '\\x2D'\n\n\t/** Regular expressions */\n\tregexPunycode = /^xn--/,\n\tregexNonASCII = /[^\\x20-\\x7E]/, // unprintable ASCII chars + non-ASCII chars\n\tregexSeparators = /[\\x2E\\u3002\\uFF0E\\uFF61]/g, // RFC 3490 separators\n\n\t/** Error messages */\n\terrors = {\n\t\t'overflow': 'Overflow: input needs wider integers to process',\n\t\t'not-basic': 'Illegal input >= 0x80 (not a basic code point)',\n\t\t'invalid-input': 'Invalid input'\n\t},\n\n\t/** Convenience shortcuts */\n\tbaseMinusTMin = base - tMin,\n\tfloor = Math.floor,\n\tstringFromCharCode = String.fromCharCode,\n\n\t/** Temporary variable */\n\tkey;\n\n\t/*--------------------------------------------------------------------------*/\n\n\t/**\n\t * A generic error utility function.\n\t * @private\n\t * @param {String} type The error type.\n\t * @returns {Error} Throws a `RangeError` with the applicable error message.\n\t */\n\tfunction error(type) {\n\t\tthrow new RangeError(errors[type]);\n\t}\n\n\t/**\n\t * A generic `Array#map` utility function.\n\t * @private\n\t * @param {Array} array The array to iterate over.\n\t * @param {Function} callback The function that gets called for every array\n\t * item.\n\t * @returns {Array} A new array of values returned by the callback function.\n\t */\n\tfunction map(array, fn) {\n\t\tvar length = array.length;\n\t\tvar result = [];\n\t\twhile (length--) {\n\t\t\tresult[length] = fn(array[length]);\n\t\t}\n\t\treturn result;\n\t}\n\n\t/**\n\t * A simple `Array#map`-like wrapper to work with domain name strings or email\n\t * addresses.\n\t * @private\n\t * @param {String} domain The domain name or email address.\n\t * @param {Function} callback The function that gets called for every\n\t * character.\n\t * @returns {Array} A new string of characters returned by the callback\n\t * function.\n\t */\n\tfunction mapDomain(string, fn) {\n\t\tvar parts = string.split('@');\n\t\tvar result = '';\n\t\tif (parts.length > 1) {\n\t\t\t// In email addresses, only the domain name should be punycoded. Leave\n\t\t\t// the local part (i.e. everything up to `@`) intact.\n\t\t\tresult = parts[0] + '@';\n\t\t\tstring = parts[1];\n\t\t}\n\t\t// Avoid `split(regex)` for IE8 compatibility. See #17.\n\t\tstring = string.replace(regexSeparators, '\\x2E');\n\t\tvar labels = string.split('.');\n\t\tvar encoded = map(labels, fn).join('.');\n\t\treturn result + encoded;\n\t}\n\n\t/**\n\t * Creates an array containing the numeric code points of each Unicode\n\t * character in the string. While JavaScript uses UCS-2 internally,\n\t * this function will convert a pair of surrogate halves (each of which\n\t * UCS-2 exposes as separate characters) into a single code point,\n\t * matching UTF-16.\n\t * @see `punycode.ucs2.encode`\n\t * @see <https://mathiasbynens.be/notes/javascript-encoding>\n\t * @memberOf punycode.ucs2\n\t * @name decode\n\t * @param {String} string The Unicode input string (UCS-2).\n\t * @returns {Array} The new array of code points.\n\t */\n\tfunction ucs2decode(string) {\n\t\tvar output = [],\n\t\t    counter = 0,\n\t\t    length = string.length,\n\t\t    value,\n\t\t    extra;\n\t\twhile (counter < length) {\n\t\t\tvalue = string.charCodeAt(counter++);\n\t\t\tif (value >= 0xD800 && value <= 0xDBFF && counter < length) {\n\t\t\t\t// high surrogate, and there is a next character\n\t\t\t\textra = string.charCodeAt(counter++);\n\t\t\t\tif ((extra & 0xFC00) == 0xDC00) { // low surrogate\n\t\t\t\t\toutput.push(((value & 0x3FF) << 10) + (extra & 0x3FF) + 0x10000);\n\t\t\t\t} else {\n\t\t\t\t\t// unmatched surrogate; only append this code unit, in case the next\n\t\t\t\t\t// code unit is the high surrogate of a surrogate pair\n\t\t\t\t\toutput.push(value);\n\t\t\t\t\tcounter--;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\toutput.push(value);\n\t\t\t}\n\t\t}\n\t\treturn output;\n\t}\n\n\t/**\n\t * Creates a string based on an array of numeric code points.\n\t * @see `punycode.ucs2.decode`\n\t * @memberOf punycode.ucs2\n\t * @name encode\n\t * @param {Array} codePoints The array of numeric code points.\n\t * @returns {String} The new Unicode string (UCS-2).\n\t */\n\tfunction ucs2encode(array) {\n\t\treturn map(array, function(value) {\n\t\t\tvar output = '';\n\t\t\tif (value > 0xFFFF) {\n\t\t\t\tvalue -= 0x10000;\n\t\t\t\toutput += stringFromCharCode(value >>> 10 & 0x3FF | 0xD800);\n\t\t\t\tvalue = 0xDC00 | value & 0x3FF;\n\t\t\t}\n\t\t\toutput += stringFromCharCode(value);\n\t\t\treturn output;\n\t\t}).join('');\n\t}\n\n\t/**\n\t * Converts a basic code point into a digit/integer.\n\t * @see `digitToBasic()`\n\t * @private\n\t * @param {Number} codePoint The basic numeric code point value.\n\t * @returns {Number} The numeric value of a basic code point (for use in\n\t * representing integers) in the range `0` to `base - 1`, or `base` if\n\t * the code point does not represent a value.\n\t */\n\tfunction basicToDigit(codePoint) {\n\t\tif (codePoint - 48 < 10) {\n\t\t\treturn codePoint - 22;\n\t\t}\n\t\tif (codePoint - 65 < 26) {\n\t\t\treturn codePoint - 65;\n\t\t}\n\t\tif (codePoint - 97 < 26) {\n\t\t\treturn codePoint - 97;\n\t\t}\n\t\treturn base;\n\t}\n\n\t/**\n\t * Converts a digit/integer into a basic code point.\n\t * @see `basicToDigit()`\n\t * @private\n\t * @param {Number} digit The numeric value of a basic code point.\n\t * @returns {Number} The basic code point whose value (when used for\n\t * representing integers) is `digit`, which needs to be in the range\n\t * `0` to `base - 1`. If `flag` is non-zero, the uppercase form is\n\t * used; else, the lowercase form is used. The behavior is undefined\n\t * if `flag` is non-zero and `digit` has no uppercase form.\n\t */\n\tfunction digitToBasic(digit, flag) {\n\t\t//  0..25 map to ASCII a..z or A..Z\n\t\t// 26..35 map to ASCII 0..9\n\t\treturn digit + 22 + 75 * (digit < 26) - ((flag != 0) << 5);\n\t}\n\n\t/**\n\t * Bias adaptation function as per section 3.4 of RFC 3492.\n\t * https://tools.ietf.org/html/rfc3492#section-3.4\n\t * @private\n\t */\n\tfunction adapt(delta, numPoints, firstTime) {\n\t\tvar k = 0;\n\t\tdelta = firstTime ? floor(delta / damp) : delta >> 1;\n\t\tdelta += floor(delta / numPoints);\n\t\tfor (/* no initialization */; delta > baseMinusTMin * tMax >> 1; k += base) {\n\t\t\tdelta = floor(delta / baseMinusTMin);\n\t\t}\n\t\treturn floor(k + (baseMinusTMin + 1) * delta / (delta + skew));\n\t}\n\n\t/**\n\t * Converts a Punycode string of ASCII-only symbols to a string of Unicode\n\t * symbols.\n\t * @memberOf punycode\n\t * @param {String} input The Punycode string of ASCII-only symbols.\n\t * @returns {String} The resulting string of Unicode symbols.\n\t */\n\tfunction decode(input) {\n\t\t// Don't use UCS-2\n\t\tvar output = [],\n\t\t    inputLength = input.length,\n\t\t    out,\n\t\t    i = 0,\n\t\t    n = initialN,\n\t\t    bias = initialBias,\n\t\t    basic,\n\t\t    j,\n\t\t    index,\n\t\t    oldi,\n\t\t    w,\n\t\t    k,\n\t\t    digit,\n\t\t    t,\n\t\t    /** Cached calculation results */\n\t\t    baseMinusT;\n\n\t\t// Handle the basic code points: let `basic` be the number of input code\n\t\t// points before the last delimiter, or `0` if there is none, then copy\n\t\t// the first basic code points to the output.\n\n\t\tbasic = input.lastIndexOf(delimiter);\n\t\tif (basic < 0) {\n\t\t\tbasic = 0;\n\t\t}\n\n\t\tfor (j = 0; j < basic; ++j) {\n\t\t\t// if it's not a basic code point\n\t\t\tif (input.charCodeAt(j) >= 0x80) {\n\t\t\t\terror('not-basic');\n\t\t\t}\n\t\t\toutput.push(input.charCodeAt(j));\n\t\t}\n\n\t\t// Main decoding loop: start just after the last delimiter if any basic code\n\t\t// points were copied; start at the beginning otherwise.\n\n\t\tfor (index = basic > 0 ? basic + 1 : 0; index < inputLength; /* no final expression */) {\n\n\t\t\t// `index` is the index of the next character to be consumed.\n\t\t\t// Decode a generalized variable-length integer into `delta`,\n\t\t\t// which gets added to `i`. The overflow checking is easier\n\t\t\t// if we increase `i` as we go, then subtract off its starting\n\t\t\t// value at the end to obtain `delta`.\n\t\t\tfor (oldi = i, w = 1, k = base; /* no condition */; k += base) {\n\n\t\t\t\tif (index >= inputLength) {\n\t\t\t\t\terror('invalid-input');\n\t\t\t\t}\n\n\t\t\t\tdigit = basicToDigit(input.charCodeAt(index++));\n\n\t\t\t\tif (digit >= base || digit > floor((maxInt - i) / w)) {\n\t\t\t\t\terror('overflow');\n\t\t\t\t}\n\n\t\t\t\ti += digit * w;\n\t\t\t\tt = k <= bias ? tMin : (k >= bias + tMax ? tMax : k - bias);\n\n\t\t\t\tif (digit < t) {\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\n\t\t\t\tbaseMinusT = base - t;\n\t\t\t\tif (w > floor(maxInt / baseMinusT)) {\n\t\t\t\t\terror('overflow');\n\t\t\t\t}\n\n\t\t\t\tw *= baseMinusT;\n\n\t\t\t}\n\n\t\t\tout = output.length + 1;\n\t\t\tbias = adapt(i - oldi, out, oldi == 0);\n\n\t\t\t// `i` was supposed to wrap around from `out` to `0`,\n\t\t\t// incrementing `n` each time, so we'll fix that now:\n\t\t\tif (floor(i / out) > maxInt - n) {\n\t\t\t\terror('overflow');\n\t\t\t}\n\n\t\t\tn += floor(i / out);\n\t\t\ti %= out;\n\n\t\t\t// Insert `n` at position `i` of the output\n\t\t\toutput.splice(i++, 0, n);\n\n\t\t}\n\n\t\treturn ucs2encode(output);\n\t}\n\n\t/**\n\t * Converts a string of Unicode symbols (e.g. a domain name label) to a\n\t * Punycode string of ASCII-only symbols.\n\t * @memberOf punycode\n\t * @param {String} input The string of Unicode symbols.\n\t * @returns {String} The resulting Punycode string of ASCII-only symbols.\n\t */\n\tfunction encode(input) {\n\t\tvar n,\n\t\t    delta,\n\t\t    handledCPCount,\n\t\t    basicLength,\n\t\t    bias,\n\t\t    j,\n\t\t    m,\n\t\t    q,\n\t\t    k,\n\t\t    t,\n\t\t    currentValue,\n\t\t    output = [],\n\t\t    /** `inputLength` will hold the number of code points in `input`. */\n\t\t    inputLength,\n\t\t    /** Cached calculation results */\n\t\t    handledCPCountPlusOne,\n\t\t    baseMinusT,\n\t\t    qMinusT;\n\n\t\t// Convert the input in UCS-2 to Unicode\n\t\tinput = ucs2decode(input);\n\n\t\t// Cache the length\n\t\tinputLength = input.length;\n\n\t\t// Initialize the state\n\t\tn = initialN;\n\t\tdelta = 0;\n\t\tbias = initialBias;\n\n\t\t// Handle the basic code points\n\t\tfor (j = 0; j < inputLength; ++j) {\n\t\t\tcurrentValue = input[j];\n\t\t\tif (currentValue < 0x80) {\n\t\t\t\toutput.push(stringFromCharCode(currentValue));\n\t\t\t}\n\t\t}\n\n\t\thandledCPCount = basicLength = output.length;\n\n\t\t// `handledCPCount` is the number of code points that have been handled;\n\t\t// `basicLength` is the number of basic code points.\n\n\t\t// Finish the basic string - if it is not empty - with a delimiter\n\t\tif (basicLength) {\n\t\t\toutput.push(delimiter);\n\t\t}\n\n\t\t// Main encoding loop:\n\t\twhile (handledCPCount < inputLength) {\n\n\t\t\t// All non-basic code points < n have been handled already. Find the next\n\t\t\t// larger one:\n\t\t\tfor (m = maxInt, j = 0; j < inputLength; ++j) {\n\t\t\t\tcurrentValue = input[j];\n\t\t\t\tif (currentValue >= n && currentValue < m) {\n\t\t\t\t\tm = currentValue;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Increase `delta` enough to advance the decoder's <n,i> state to <m,0>,\n\t\t\t// but guard against overflow\n\t\t\thandledCPCountPlusOne = handledCPCount + 1;\n\t\t\tif (m - n > floor((maxInt - delta) / handledCPCountPlusOne)) {\n\t\t\t\terror('overflow');\n\t\t\t}\n\n\t\t\tdelta += (m - n) * handledCPCountPlusOne;\n\t\t\tn = m;\n\n\t\t\tfor (j = 0; j < inputLength; ++j) {\n\t\t\t\tcurrentValue = input[j];\n\n\t\t\t\tif (currentValue < n && ++delta > maxInt) {\n\t\t\t\t\terror('overflow');\n\t\t\t\t}\n\n\t\t\t\tif (currentValue == n) {\n\t\t\t\t\t// Represent delta as a generalized variable-length integer\n\t\t\t\t\tfor (q = delta, k = base; /* no condition */; k += base) {\n\t\t\t\t\t\tt = k <= bias ? tMin : (k >= bias + tMax ? tMax : k - bias);\n\t\t\t\t\t\tif (q < t) {\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tqMinusT = q - t;\n\t\t\t\t\t\tbaseMinusT = base - t;\n\t\t\t\t\t\toutput.push(\n\t\t\t\t\t\t\tstringFromCharCode(digitToBasic(t + qMinusT % baseMinusT, 0))\n\t\t\t\t\t\t);\n\t\t\t\t\t\tq = floor(qMinusT / baseMinusT);\n\t\t\t\t\t}\n\n\t\t\t\t\toutput.push(stringFromCharCode(digitToBasic(q, 0)));\n\t\t\t\t\tbias = adapt(delta, handledCPCountPlusOne, handledCPCount == basicLength);\n\t\t\t\t\tdelta = 0;\n\t\t\t\t\t++handledCPCount;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t++delta;\n\t\t\t++n;\n\n\t\t}\n\t\treturn output.join('');\n\t}\n\n\t/**\n\t * Converts a Punycode string representing a domain name or an email address\n\t * to Unicode. Only the Punycoded parts of the input will be converted, i.e.\n\t * it doesn't matter if you call it on a string that has already been\n\t * converted to Unicode.\n\t * @memberOf punycode\n\t * @param {String} input The Punycoded domain name or email address to\n\t * convert to Unicode.\n\t * @returns {String} The Unicode representation of the given Punycode\n\t * string.\n\t */\n\tfunction toUnicode(input) {\n\t\treturn mapDomain(input, function(string) {\n\t\t\treturn regexPunycode.test(string)\n\t\t\t\t? decode(string.slice(4).toLowerCase())\n\t\t\t\t: string;\n\t\t});\n\t}\n\n\t/**\n\t * Converts a Unicode string representing a domain name or an email address to\n\t * Punycode. Only the non-ASCII parts of the domain name will be converted,\n\t * i.e. it doesn't matter if you call it with a domain that's already in\n\t * ASCII.\n\t * @memberOf punycode\n\t * @param {String} input The domain name or email address to convert, as a\n\t * Unicode string.\n\t * @returns {String} The Punycode representation of the given domain name or\n\t * email address.\n\t */\n\tfunction toASCII(input) {\n\t\treturn mapDomain(input, function(string) {\n\t\t\treturn regexNonASCII.test(string)\n\t\t\t\t? 'xn--' + encode(string)\n\t\t\t\t: string;\n\t\t});\n\t}\n\n\t/*--------------------------------------------------------------------------*/\n\n\t/** Define the public API */\n\tpunycode = {\n\t\t/**\n\t\t * A string representing the current Punycode.js version number.\n\t\t * @memberOf punycode\n\t\t * @type String\n\t\t */\n\t\t'version': '1.3.2',\n\t\t/**\n\t\t * An object of methods to convert from JavaScript's internal character\n\t\t * representation (UCS-2) to Unicode code points, and back.\n\t\t * @see <https://mathiasbynens.be/notes/javascript-encoding>\n\t\t * @memberOf punycode\n\t\t * @type Object\n\t\t */\n\t\t'ucs2': {\n\t\t\t'decode': ucs2decode,\n\t\t\t'encode': ucs2encode\n\t\t},\n\t\t'decode': decode,\n\t\t'encode': encode,\n\t\t'toASCII': toASCII,\n\t\t'toUnicode': toUnicode\n\t};\n\n\t/** Expose `punycode` */\n\t// Some AMD build optimizers, like r.js, check for specific condition patterns\n\t// like the following:\n\tif (\n\t\ttypeof define == 'function' &&\n\t\ttypeof define.amd == 'object' &&\n\t\tdefine.amd\n\t) {\n\t\tdefine('punycode', function() {\n\t\t\treturn punycode;\n\t\t});\n\t} else if (freeExports && freeModule) {\n\t\tif (module.exports == freeExports) {\n\t\t\t// in Node.js, io.js, or RingoJS v0.8.0+\n\t\t\tfreeModule.exports = punycode;\n\t\t} else {\n\t\t\t// in Narwhal or RingoJS v0.7.0-\n\t\t\tfor (key in punycode) {\n\t\t\t\tpunycode.hasOwnProperty(key) && (freeExports[key] = punycode[key]);\n\t\t\t}\n\t\t}\n\t} else {\n\t\t// in Rhino or a web browser\n\t\troot.punycode = punycode;\n\t}\n\n}(this));\n\n}).call(this,typeof global !== \"undefined\" ? global : typeof self !== \"undefined\" ? self : typeof window !== \"undefined\" ? window : {})\n},{}],2:[function(_dereq_,module,exports){\nvar log = _dereq_('./log');\n\nfunction restoreOwnerScroll(ownerDocument, x, y) {\n    if (ownerDocument.defaultView && (x !== ownerDocument.defaultView.pageXOffset || y !== ownerDocument.defaultView.pageYOffset)) {\n        ownerDocument.defaultView.scrollTo(x, y);\n    }\n}\n\nfunction cloneCanvasContents(canvas, clonedCanvas) {\n    try {\n        if (clonedCanvas) {\n            clonedCanvas.width = canvas.width;\n            clonedCanvas.height = canvas.height;\n            clonedCanvas.getContext(\"2d\").putImageData(canvas.getContext(\"2d\").getImageData(0, 0, canvas.width, canvas.height), 0, 0);\n        }\n    } catch(e) {\n        log(\"Unable to copy canvas content from\", canvas, e);\n    }\n}\n\nfunction cloneNode(node, javascriptEnabled) {\n    var clone = node.nodeType === 3 ? document.createTextNode(node.nodeValue) : node.cloneNode(false);\n\n    var child = node.firstChild;\n    while(child) {\n        if (javascriptEnabled === true || child.nodeType !== 1 || child.nodeName !== 'SCRIPT') {\n            clone.appendChild(cloneNode(child, javascriptEnabled));\n        }\n        child = child.nextSibling;\n    }\n\n    if (node.nodeType === 1) {\n        clone._scrollTop = node.scrollTop;\n        clone._scrollLeft = node.scrollLeft;\n        if (node.nodeName === \"CANVAS\") {\n            cloneCanvasContents(node, clone);\n        } else if (node.nodeName === \"TEXTAREA\" || node.nodeName === \"SELECT\") {\n            clone.value = node.value;\n        }\n    }\n\n    return clone;\n}\n\nfunction initNode(node) {\n    if (node.nodeType === 1) {\n        node.scrollTop = node._scrollTop;\n        node.scrollLeft = node._scrollLeft;\n\n        var child = node.firstChild;\n        while(child) {\n            initNode(child);\n            child = child.nextSibling;\n        }\n    }\n}\n\nmodule.exports = function(ownerDocument, containerDocument, width, height, options, x ,y) {\n    var documentElement = cloneNode(ownerDocument.documentElement, options.javascriptEnabled);\n    var container = containerDocument.createElement(\"iframe\");\n\n    container.className = \"html2canvas-container\";\n    container.style.visibility = \"hidden\";\n    container.style.position = \"fixed\";\n    container.style.left = \"-10000px\";\n    container.style.top = \"0px\";\n    container.style.border = \"0\";\n    container.width = width;\n    container.height = height;\n    container.scrolling = \"no\"; // ios won't scroll without it\n    containerDocument.body.appendChild(container);\n\n    return new Promise(function(resolve) {\n        var documentClone = container.contentWindow.document;\n\n        /* Chrome doesn't detect relative background-images assigned in inline <style> sheets when fetched through getComputedStyle\n         if window url is about:blank, we can assign the url to current by writing onto the document\n         */\n        container.contentWindow.onload = container.onload = function() {\n            var interval = setInterval(function() {\n                if (documentClone.body.childNodes.length > 0) {\n                    initNode(documentClone.documentElement);\n                    clearInterval(interval);\n                    if (options.type === \"view\") {\n                        container.contentWindow.scrollTo(x, y);\n                        if ((/(iPad|iPhone|iPod)/g).test(navigator.userAgent) && (container.contentWindow.scrollY !== y || container.contentWindow.scrollX !== x)) {\n                            documentClone.documentElement.style.top = (-y) + \"px\";\n                            documentClone.documentElement.style.left = (-x) + \"px\";\n                            documentClone.documentElement.style.position = 'absolute';\n                        }\n                    }\n                    resolve(container);\n                }\n            }, 50);\n        };\n\n        documentClone.open();\n        documentClone.write(\"<!DOCTYPE html><html></html>\");\n        // Chrome scrolls the parent document for some reason after the write to the cloned window???\n        restoreOwnerScroll(ownerDocument, x, y);\n        documentClone.replaceChild(documentClone.adoptNode(documentElement), documentClone.documentElement);\n        documentClone.close();\n    });\n};\n\n},{\"./log\":13}],3:[function(_dereq_,module,exports){\n// http://dev.w3.org/csswg/css-color/\n\nfunction Color(value) {\n    this.r = 0;\n    this.g = 0;\n    this.b = 0;\n    this.a = null;\n    var result = this.fromArray(value) ||\n        this.namedColor(value) ||\n        this.rgb(value) ||\n        this.rgba(value) ||\n        this.hex6(value) ||\n        this.hex3(value);\n}\n\nColor.prototype.darken = function(amount) {\n    var a = 1 - amount;\n    return  new Color([\n        Math.round(this.r * a),\n        Math.round(this.g * a),\n        Math.round(this.b * a),\n        this.a\n    ]);\n};\n\nColor.prototype.isTransparent = function() {\n    return this.a === 0;\n};\n\nColor.prototype.isBlack = function() {\n    return this.r === 0 && this.g === 0 && this.b === 0;\n};\n\nColor.prototype.fromArray = function(array) {\n    if (Array.isArray(array)) {\n        this.r = Math.min(array[0], 255);\n        this.g = Math.min(array[1], 255);\n        this.b = Math.min(array[2], 255);\n        if (array.length > 3) {\n            this.a = array[3];\n        }\n    }\n\n    return (Array.isArray(array));\n};\n\nvar _hex3 = /^#([a-f0-9]{3})$/i;\n\nColor.prototype.hex3 = function(value) {\n    var match = null;\n    if ((match = value.match(_hex3)) !== null) {\n        this.r = parseInt(match[1][0] + match[1][0], 16);\n        this.g = parseInt(match[1][1] + match[1][1], 16);\n        this.b = parseInt(match[1][2] + match[1][2], 16);\n    }\n    return match !== null;\n};\n\nvar _hex6 = /^#([a-f0-9]{6})$/i;\n\nColor.prototype.hex6 = function(value) {\n    var match = null;\n    if ((match = value.match(_hex6)) !== null) {\n        this.r = parseInt(match[1].substring(0, 2), 16);\n        this.g = parseInt(match[1].substring(2, 4), 16);\n        this.b = parseInt(match[1].substring(4, 6), 16);\n    }\n    return match !== null;\n};\n\n\nvar _rgb = /^rgb\\(\\s*(\\d{1,3})\\s*,\\s*(\\d{1,3})\\s*,\\s*(\\d{1,3})\\s*\\)$/;\n\nColor.prototype.rgb = function(value) {\n    var match = null;\n    if ((match = value.match(_rgb)) !== null) {\n        this.r = Number(match[1]);\n        this.g = Number(match[2]);\n        this.b = Number(match[3]);\n    }\n    return match !== null;\n};\n\nvar _rgba = /^rgba\\(\\s*(\\d{1,3})\\s*,\\s*(\\d{1,3})\\s*,\\s*(\\d{1,3})\\s*,\\s*(\\d?\\.?\\d+)\\s*\\)$/;\n\nColor.prototype.rgba = function(value) {\n    var match = null;\n    if ((match = value.match(_rgba)) !== null) {\n        this.r = Number(match[1]);\n        this.g = Number(match[2]);\n        this.b = Number(match[3]);\n        this.a = Number(match[4]);\n    }\n    return match !== null;\n};\n\nColor.prototype.toString = function() {\n    return this.a !== null && this.a !== 1 ?\n    \"rgba(\" + [this.r, this.g, this.b, this.a].join(\",\") + \")\" :\n    \"rgb(\" + [this.r, this.g, this.b].join(\",\") + \")\";\n};\n\nColor.prototype.namedColor = function(value) {\n    value = value.toLowerCase();\n    var color = colors[value];\n    if (color) {\n        this.r = color[0];\n        this.g = color[1];\n        this.b = color[2];\n    } else if (value === \"transparent\") {\n        this.r = this.g = this.b = this.a = 0;\n        return true;\n    }\n\n    return !!color;\n};\n\nColor.prototype.isColor = true;\n\n// JSON.stringify([].slice.call($$('.named-color-table tr'), 1).map(function(row) { return [row.childNodes[3].textContent, row.childNodes[5].textContent.trim().split(\",\").map(Number)] }).reduce(function(data, row) {data[row[0]] = row[1]; return data}, {}))\nvar colors = {\n    \"aliceblue\": [240, 248, 255],\n    \"antiquewhite\": [250, 235, 215],\n    \"aqua\": [0, 255, 255],\n    \"aquamarine\": [127, 255, 212],\n    \"azure\": [240, 255, 255],\n    \"beige\": [245, 245, 220],\n    \"bisque\": [255, 228, 196],\n    \"black\": [0, 0, 0],\n    \"blanchedalmond\": [255, 235, 205],\n    \"blue\": [0, 0, 255],\n    \"blueviolet\": [138, 43, 226],\n    \"brown\": [165, 42, 42],\n    \"burlywood\": [222, 184, 135],\n    \"cadetblue\": [95, 158, 160],\n    \"chartreuse\": [127, 255, 0],\n    \"chocolate\": [210, 105, 30],\n    \"coral\": [255, 127, 80],\n    \"cornflowerblue\": [100, 149, 237],\n    \"cornsilk\": [255, 248, 220],\n    \"crimson\": [220, 20, 60],\n    \"cyan\": [0, 255, 255],\n    \"darkblue\": [0, 0, 139],\n    \"darkcyan\": [0, 139, 139],\n    \"darkgoldenrod\": [184, 134, 11],\n    \"darkgray\": [169, 169, 169],\n    \"darkgreen\": [0, 100, 0],\n    \"darkgrey\": [169, 169, 169],\n    \"darkkhaki\": [189, 183, 107],\n    \"darkmagenta\": [139, 0, 139],\n    \"darkolivegreen\": [85, 107, 47],\n    \"darkorange\": [255, 140, 0],\n    \"darkorchid\": [153, 50, 204],\n    \"darkred\": [139, 0, 0],\n    \"darksalmon\": [233, 150, 122],\n    \"darkseagreen\": [143, 188, 143],\n    \"darkslateblue\": [72, 61, 139],\n    \"darkslategray\": [47, 79, 79],\n    \"darkslategrey\": [47, 79, 79],\n    \"darkturquoise\": [0, 206, 209],\n    \"darkviolet\": [148, 0, 211],\n    \"deeppink\": [255, 20, 147],\n    \"deepskyblue\": [0, 191, 255],\n    \"dimgray\": [105, 105, 105],\n    \"dimgrey\": [105, 105, 105],\n    \"dodgerblue\": [30, 144, 255],\n    \"firebrick\": [178, 34, 34],\n    \"floralwhite\": [255, 250, 240],\n    \"forestgreen\": [34, 139, 34],\n    \"fuchsia\": [255, 0, 255],\n    \"gainsboro\": [220, 220, 220],\n    \"ghostwhite\": [248, 248, 255],\n    \"gold\": [255, 215, 0],\n    \"goldenrod\": [218, 165, 32],\n    \"gray\": [128, 128, 128],\n    \"green\": [0, 128, 0],\n    \"greenyellow\": [173, 255, 47],\n    \"grey\": [128, 128, 128],\n    \"honeydew\": [240, 255, 240],\n    \"hotpink\": [255, 105, 180],\n    \"indianred\": [205, 92, 92],\n    \"indigo\": [75, 0, 130],\n    \"ivory\": [255, 255, 240],\n    \"khaki\": [240, 230, 140],\n    \"lavender\": [230, 230, 250],\n    \"lavenderblush\": [255, 240, 245],\n    \"lawngreen\": [124, 252, 0],\n    \"lemonchiffon\": [255, 250, 205],\n    \"lightblue\": [173, 216, 230],\n    \"lightcoral\": [240, 128, 128],\n    \"lightcyan\": [224, 255, 255],\n    \"lightgoldenrodyellow\": [250, 250, 210],\n    \"lightgray\": [211, 211, 211],\n    \"lightgreen\": [144, 238, 144],\n    \"lightgrey\": [211, 211, 211],\n    \"lightpink\": [255, 182, 193],\n    \"lightsalmon\": [255, 160, 122],\n    \"lightseagreen\": [32, 178, 170],\n    \"lightskyblue\": [135, 206, 250],\n    \"lightslategray\": [119, 136, 153],\n    \"lightslategrey\": [119, 136, 153],\n    \"lightsteelblue\": [176, 196, 222],\n    \"lightyellow\": [255, 255, 224],\n    \"lime\": [0, 255, 0],\n    \"limegreen\": [50, 205, 50],\n    \"linen\": [250, 240, 230],\n    \"magenta\": [255, 0, 255],\n    \"maroon\": [128, 0, 0],\n    \"mediumaquamarine\": [102, 205, 170],\n    \"mediumblue\": [0, 0, 205],\n    \"mediumorchid\": [186, 85, 211],\n    \"mediumpurple\": [147, 112, 219],\n    \"mediumseagreen\": [60, 179, 113],\n    \"mediumslateblue\": [123, 104, 238],\n    \"mediumspringgreen\": [0, 250, 154],\n    \"mediumturquoise\": [72, 209, 204],\n    \"mediumvioletred\": [199, 21, 133],\n    \"midnightblue\": [25, 25, 112],\n    \"mintcream\": [245, 255, 250],\n    \"mistyrose\": [255, 228, 225],\n    \"moccasin\": [255, 228, 181],\n    \"navajowhite\": [255, 222, 173],\n    \"navy\": [0, 0, 128],\n    \"oldlace\": [253, 245, 230],\n    \"olive\": [128, 128, 0],\n    \"olivedrab\": [107, 142, 35],\n    \"orange\": [255, 165, 0],\n    \"orangered\": [255, 69, 0],\n    \"orchid\": [218, 112, 214],\n    \"palegoldenrod\": [238, 232, 170],\n    \"palegreen\": [152, 251, 152],\n    \"paleturquoise\": [175, 238, 238],\n    \"palevioletred\": [219, 112, 147],\n    \"papayawhip\": [255, 239, 213],\n    \"peachpuff\": [255, 218, 185],\n    \"peru\": [205, 133, 63],\n    \"pink\": [255, 192, 203],\n    \"plum\": [221, 160, 221],\n    \"powderblue\": [176, 224, 230],\n    \"purple\": [128, 0, 128],\n    \"rebeccapurple\": [102, 51, 153],\n    \"red\": [255, 0, 0],\n    \"rosybrown\": [188, 143, 143],\n    \"royalblue\": [65, 105, 225],\n    \"saddlebrown\": [139, 69, 19],\n    \"salmon\": [250, 128, 114],\n    \"sandybrown\": [244, 164, 96],\n    \"seagreen\": [46, 139, 87],\n    \"seashell\": [255, 245, 238],\n    \"sienna\": [160, 82, 45],\n    \"silver\": [192, 192, 192],\n    \"skyblue\": [135, 206, 235],\n    \"slateblue\": [106, 90, 205],\n    \"slategray\": [112, 128, 144],\n    \"slategrey\": [112, 128, 144],\n    \"snow\": [255, 250, 250],\n    \"springgreen\": [0, 255, 127],\n    \"steelblue\": [70, 130, 180],\n    \"tan\": [210, 180, 140],\n    \"teal\": [0, 128, 128],\n    \"thistle\": [216, 191, 216],\n    \"tomato\": [255, 99, 71],\n    \"turquoise\": [64, 224, 208],\n    \"violet\": [238, 130, 238],\n    \"wheat\": [245, 222, 179],\n    \"white\": [255, 255, 255],\n    \"whitesmoke\": [245, 245, 245],\n    \"yellow\": [255, 255, 0],\n    \"yellowgreen\": [154, 205, 50]\n};\n\nmodule.exports = Color;\n\n},{}],4:[function(_dereq_,module,exports){\nvar Support = _dereq_('./support');\nvar CanvasRenderer = _dereq_('./renderers/canvas');\nvar ImageLoader = _dereq_('./imageloader');\nvar NodeParser = _dereq_('./nodeparser');\nvar NodeContainer = _dereq_('./nodecontainer');\nvar log = _dereq_('./log');\nvar utils = _dereq_('./utils');\nvar createWindowClone = _dereq_('./clone');\nvar loadUrlDocument = _dereq_('./proxy').loadUrlDocument;\nvar getBounds = utils.getBounds;\n\nvar html2canvasNodeAttribute = \"data-html2canvas-node\";\nvar html2canvasCloneIndex = 0;\n\nfunction html2canvas(nodeList, options) {\n    var index = html2canvasCloneIndex++;\n    options = options || {};\n    if (options.logging) {\n        log.options.logging = true;\n        log.options.start = Date.now();\n    }\n\n    options.async = typeof(options.async) === \"undefined\" ? true : options.async;\n    options.allowTaint = typeof(options.allowTaint) === \"undefined\" ? false : options.allowTaint;\n    options.removeContainer = typeof(options.removeContainer) === \"undefined\" ? true : options.removeContainer;\n    options.javascriptEnabled = typeof(options.javascriptEnabled) === \"undefined\" ? false : options.javascriptEnabled;\n    options.imageTimeout = typeof(options.imageTimeout) === \"undefined\" ? 10000 : options.imageTimeout;\n    options.renderer = typeof(options.renderer) === \"function\" ? options.renderer : CanvasRenderer;\n    options.strict = !!options.strict;\n\n    if (typeof(nodeList) === \"string\") {\n        if (typeof(options.proxy) !== \"string\") {\n            return Promise.reject(\"Proxy must be used when rendering url\");\n        }\n        var width = options.width != null ? options.width : window.innerWidth;\n        var height = options.height != null ? options.height : window.innerHeight;\n        return loadUrlDocument(absoluteUrl(nodeList), options.proxy, document, width, height, options).then(function(container) {\n            return renderWindow(container.contentWindow.document.documentElement, container, options, width, height);\n        });\n    }\n\n    var node = ((nodeList === undefined) ? [document.documentElement] : ((nodeList.length) ? nodeList : [nodeList]))[0];\n    node.setAttribute(html2canvasNodeAttribute + index, index);\n    return renderDocument(node.ownerDocument, options, node.ownerDocument.defaultView.innerWidth, node.ownerDocument.defaultView.innerHeight, index).then(function(canvas) {\n        if (typeof(options.onrendered) === \"function\") {\n            log(\"options.onrendered is deprecated, html2canvas returns a Promise containing the canvas\");\n            options.onrendered(canvas);\n        }\n        return canvas;\n    });\n}\n\nhtml2canvas.CanvasRenderer = CanvasRenderer;\nhtml2canvas.NodeContainer = NodeContainer;\nhtml2canvas.log = log;\nhtml2canvas.utils = utils;\n\nvar html2canvasExport = (typeof(document) === \"undefined\" || typeof(Object.create) !== \"function\" || typeof(document.createElement(\"canvas\").getContext) !== \"function\") ? function() {\n    return Promise.reject(\"No canvas support\");\n} : html2canvas;\n\nmodule.exports = html2canvasExport;\n\nif (typeof(define) === 'function' && define.amd) {\n    define('html2canvas', [], function() {\n        return html2canvasExport;\n    });\n}\n\nfunction renderDocument(document, options, windowWidth, windowHeight, html2canvasIndex) {\n    return createWindowClone(document, document, windowWidth, windowHeight, options, document.defaultView.pageXOffset, document.defaultView.pageYOffset).then(function(container) {\n        log(\"Document cloned\");\n        var attributeName = html2canvasNodeAttribute + html2canvasIndex;\n        var selector = \"[\" + attributeName + \"='\" + html2canvasIndex + \"']\";\n        document.querySelector(selector).removeAttribute(attributeName);\n        var clonedWindow = container.contentWindow;\n        var node = clonedWindow.document.querySelector(selector);\n        var oncloneHandler = (typeof(options.onclone) === \"function\") ? Promise.resolve(options.onclone(clonedWindow.document)) : Promise.resolve(true);\n        return oncloneHandler.then(function() {\n            return renderWindow(node, container, options, windowWidth, windowHeight);\n        });\n    });\n}\n\nfunction renderWindow(node, container, options, windowWidth, windowHeight) {\n    var clonedWindow = container.contentWindow;\n    var support = new Support(clonedWindow.document);\n    var imageLoader = new ImageLoader(options, support);\n    var bounds = getBounds(node);\n    var width = options.type === \"view\" ? windowWidth : documentWidth(clonedWindow.document);\n    var height = options.type === \"view\" ? windowHeight : documentHeight(clonedWindow.document);\n    var renderer = new options.renderer(width, height, imageLoader, options, document);\n    var parser = new NodeParser(node, renderer, support, imageLoader, options);\n    return parser.ready.then(function() {\n        log(\"Finished rendering\");\n        var canvas;\n\n        if (options.type === \"view\") {\n            canvas = crop(renderer.canvas, {width: renderer.canvas.width, height: renderer.canvas.height, top: 0, left: 0, x: 0, y: 0});\n        } else if (node === clonedWindow.document.body || node === clonedWindow.document.documentElement || options.canvas != null) {\n            canvas = renderer.canvas;\n        } else {\n            canvas = crop(renderer.canvas, {width:  options.width != null ? options.width : bounds.width, height: options.height != null ? options.height : bounds.height, top: bounds.top, left: bounds.left, x: 0, y: 0});\n        }\n\n        cleanupContainer(container, options);\n        return canvas;\n    });\n}\n\nfunction cleanupContainer(container, options) {\n    if (options.removeContainer) {\n        container.parentNode.removeChild(container);\n        log(\"Cleaned up container\");\n    }\n}\n\nfunction crop(canvas, bounds) {\n    var croppedCanvas = document.createElement(\"canvas\");\n    var x1 = Math.min(canvas.width - 1, Math.max(0, bounds.left));\n    var x2 = Math.min(canvas.width, Math.max(1, bounds.left + bounds.width));\n    var y1 = Math.min(canvas.height - 1, Math.max(0, bounds.top));\n    var y2 = Math.min(canvas.height, Math.max(1, bounds.top + bounds.height));\n    croppedCanvas.width = bounds.width;\n    croppedCanvas.height =  bounds.height;\n    var width = x2-x1;\n    var height = y2-y1;\n    log(\"Cropping canvas at:\", \"left:\", bounds.left, \"top:\", bounds.top, \"width:\", width, \"height:\", height);\n    log(\"Resulting crop with width\", bounds.width, \"and height\", bounds.height, \"with x\", x1, \"and y\", y1);\n    croppedCanvas.getContext(\"2d\").drawImage(canvas, x1, y1, width, height, bounds.x, bounds.y, width, height);\n    return croppedCanvas;\n}\n\nfunction documentWidth (doc) {\n    return Math.max(\n        Math.max(doc.body.scrollWidth, doc.documentElement.scrollWidth),\n        Math.max(doc.body.offsetWidth, doc.documentElement.offsetWidth),\n        Math.max(doc.body.clientWidth, doc.documentElement.clientWidth)\n    );\n}\n\nfunction documentHeight (doc) {\n    return Math.max(\n        Math.max(doc.body.scrollHeight, doc.documentElement.scrollHeight),\n        Math.max(doc.body.offsetHeight, doc.documentElement.offsetHeight),\n        Math.max(doc.body.clientHeight, doc.documentElement.clientHeight)\n    );\n}\n\nfunction absoluteUrl(url) {\n    var link = document.createElement(\"a\");\n    link.href = url;\n    link.href = link.href;\n    return link;\n}\n\n},{\"./clone\":2,\"./imageloader\":11,\"./log\":13,\"./nodecontainer\":14,\"./nodeparser\":15,\"./proxy\":16,\"./renderers/canvas\":20,\"./support\":22,\"./utils\":26}],5:[function(_dereq_,module,exports){\nvar log = _dereq_('./log');\nvar smallImage = _dereq_('./utils').smallImage;\n\nfunction DummyImageContainer(src) {\n    this.src = src;\n    log(\"DummyImageContainer for\", src);\n    if (!this.promise || !this.image) {\n        log(\"Initiating DummyImageContainer\");\n        DummyImageContainer.prototype.image = new Image();\n        var image = this.image;\n        DummyImageContainer.prototype.promise = new Promise(function(resolve, reject) {\n            image.onload = resolve;\n            image.onerror = reject;\n            image.src = smallImage();\n            if (image.complete === true) {\n                resolve(image);\n            }\n        });\n    }\n}\n\nmodule.exports = DummyImageContainer;\n\n},{\"./log\":13,\"./utils\":26}],6:[function(_dereq_,module,exports){\nvar smallImage = _dereq_('./utils').smallImage;\n\nfunction Font(family, size) {\n    var container = document.createElement('div'),\n        img = document.createElement('img'),\n        span = document.createElement('span'),\n        sampleText = 'Hidden Text',\n        baseline,\n        middle;\n\n    container.style.visibility = \"hidden\";\n    container.style.fontFamily = family;\n    container.style.fontSize = size;\n    container.style.margin = 0;\n    container.style.padding = 0;\n\n    document.body.appendChild(container);\n\n    img.src = smallImage();\n    img.width = 1;\n    img.height = 1;\n\n    img.style.margin = 0;\n    img.style.padding = 0;\n    img.style.verticalAlign = \"baseline\";\n\n    span.style.fontFamily = family;\n    span.style.fontSize = size;\n    span.style.margin = 0;\n    span.style.padding = 0;\n\n    span.appendChild(document.createTextNode(sampleText));\n    container.appendChild(span);\n    container.appendChild(img);\n    baseline = (img.offsetTop - span.offsetTop) + 1;\n\n    container.removeChild(span);\n    container.appendChild(document.createTextNode(sampleText));\n\n    container.style.lineHeight = \"normal\";\n    img.style.verticalAlign = \"super\";\n\n    middle = (img.offsetTop-container.offsetTop) + 1;\n\n    document.body.removeChild(container);\n\n    this.baseline = baseline;\n    this.lineWidth = 1;\n    this.middle = middle;\n}\n\nmodule.exports = Font;\n\n},{\"./utils\":26}],7:[function(_dereq_,module,exports){\nvar Font = _dereq_('./font');\n\nfunction FontMetrics() {\n    this.data = {};\n}\n\nFontMetrics.prototype.getMetrics = function(family, size) {\n    if (this.data[family + \"-\" + size] === undefined) {\n        this.data[family + \"-\" + size] = new Font(family, size);\n    }\n    return this.data[family + \"-\" + size];\n};\n\nmodule.exports = FontMetrics;\n\n},{\"./font\":6}],8:[function(_dereq_,module,exports){\nvar utils = _dereq_('./utils');\nvar getBounds = utils.getBounds;\nvar loadUrlDocument = _dereq_('./proxy').loadUrlDocument;\n\nfunction FrameContainer(container, sameOrigin, options) {\n    this.image = null;\n    this.src = container;\n    var self = this;\n    var bounds = getBounds(container);\n    this.promise = (!sameOrigin ? this.proxyLoad(options.proxy, bounds, options) : new Promise(function(resolve) {\n        if (container.contentWindow.document.URL === \"about:blank\" || container.contentWindow.document.documentElement == null) {\n            container.contentWindow.onload = container.onload = function() {\n                resolve(container);\n            };\n        } else {\n            resolve(container);\n        }\n    })).then(function(container) {\n        var html2canvas = _dereq_('./core');\n        return html2canvas(container.contentWindow.document.documentElement, {type: 'view', width: container.width, height: container.height, proxy: options.proxy, javascriptEnabled: options.javascriptEnabled, removeContainer: options.removeContainer, allowTaint: options.allowTaint, imageTimeout: options.imageTimeout / 2});\n    }).then(function(canvas) {\n        return self.image = canvas;\n    });\n}\n\nFrameContainer.prototype.proxyLoad = function(proxy, bounds, options) {\n    var container = this.src;\n    return loadUrlDocument(container.src, proxy, container.ownerDocument, bounds.width, bounds.height, options);\n};\n\nmodule.exports = FrameContainer;\n\n},{\"./core\":4,\"./proxy\":16,\"./utils\":26}],9:[function(_dereq_,module,exports){\nfunction GradientContainer(imageData) {\n    this.src = imageData.value;\n    this.colorStops = [];\n    this.type = null;\n    this.x0 = 0.5;\n    this.y0 = 0.5;\n    this.x1 = 0.5;\n    this.y1 = 0.5;\n    this.promise = Promise.resolve(true);\n}\n\nGradientContainer.TYPES = {\n    LINEAR: 1,\n    RADIAL: 2\n};\n\n// TODO: support hsl[a], negative %/length values\n// TODO: support <angle> (e.g. -?\\d{1,3}(?:\\.\\d+)deg, etc. : https://developer.mozilla.org/docs/Web/CSS/angle )\nGradientContainer.REGEXP_COLORSTOP = /^\\s*(rgba?\\(\\s*\\d{1,3},\\s*\\d{1,3},\\s*\\d{1,3}(?:,\\s*[0-9\\.]+)?\\s*\\)|[a-z]{3,20}|#[a-f0-9]{3,6})(?:\\s+(\\d{1,3}(?:\\.\\d+)?)(%|px)?)?(?:\\s|$)/i;\n\nmodule.exports = GradientContainer;\n\n},{}],10:[function(_dereq_,module,exports){\nfunction ImageContainer(src, cors) {\n    this.src = src;\n    this.image = new Image();\n    var self = this;\n    this.tainted = null;\n    this.promise = new Promise(function(resolve, reject) {\n        self.image.onload = resolve;\n        self.image.onerror = reject;\n        if (cors) {\n            self.image.crossOrigin = \"anonymous\";\n        }\n        self.image.src = src;\n        if (self.image.complete === true) {\n            resolve(self.image);\n        }\n    });\n}\n\nmodule.exports = ImageContainer;\n\n},{}],11:[function(_dereq_,module,exports){\nvar log = _dereq_('./log');\nvar ImageContainer = _dereq_('./imagecontainer');\nvar DummyImageContainer = _dereq_('./dummyimagecontainer');\nvar ProxyImageContainer = _dereq_('./proxyimagecontainer');\nvar FrameContainer = _dereq_('./framecontainer');\nvar SVGContainer = _dereq_('./svgcontainer');\nvar SVGNodeContainer = _dereq_('./svgnodecontainer');\nvar LinearGradientContainer = _dereq_('./lineargradientcontainer');\nvar WebkitGradientContainer = _dereq_('./webkitgradientcontainer');\nvar bind = _dereq_('./utils').bind;\n\nfunction ImageLoader(options, support) {\n    this.link = null;\n    this.options = options;\n    this.support = support;\n    this.origin = this.getOrigin(window.location.href);\n}\n\nImageLoader.prototype.findImages = function(nodes) {\n    var images = [];\n    nodes.reduce(function(imageNodes, container) {\n        switch(container.node.nodeName) {\n        case \"IMG\":\n            return imageNodes.concat([{\n                args: [container.node.src],\n                method: \"url\"\n            }]);\n        case \"svg\":\n        case \"IFRAME\":\n            return imageNodes.concat([{\n                args: [container.node],\n                method: container.node.nodeName\n            }]);\n        }\n        return imageNodes;\n    }, []).forEach(this.addImage(images, this.loadImage), this);\n    return images;\n};\n\nImageLoader.prototype.findBackgroundImage = function(images, container) {\n    container.parseBackgroundImages().filter(this.hasImageBackground).forEach(this.addImage(images, this.loadImage), this);\n    return images;\n};\n\nImageLoader.prototype.addImage = function(images, callback) {\n    return function(newImage) {\n        newImage.args.forEach(function(image) {\n            if (!this.imageExists(images, image)) {\n                images.splice(0, 0, callback.call(this, newImage));\n                log('Added image #' + (images.length), typeof(image) === \"string\" ? image.substring(0, 100) : image);\n            }\n        }, this);\n    };\n};\n\nImageLoader.prototype.hasImageBackground = function(imageData) {\n    return imageData.method !== \"none\";\n};\n\nImageLoader.prototype.loadImage = function(imageData) {\n    if (imageData.method === \"url\") {\n        var src = imageData.args[0];\n        if (this.isSVG(src) && !this.support.svg && !this.options.allowTaint) {\n            return new SVGContainer(src);\n        } else if (src.match(/data:image\\/.*;base64,/i)) {\n            return new ImageContainer(src.replace(/url\\(['\"]{0,}|['\"]{0,}\\)$/ig, ''), false);\n        } else if (this.isSameOrigin(src) || this.options.allowTaint === true || this.isSVG(src)) {\n            return new ImageContainer(src, false);\n        } else if (this.support.cors && !this.options.allowTaint && this.options.useCORS) {\n            return new ImageContainer(src, true);\n        } else if (this.options.proxy) {\n            return new ProxyImageContainer(src, this.options.proxy);\n        } else {\n            return new DummyImageContainer(src);\n        }\n    } else if (imageData.method === \"linear-gradient\") {\n        return new LinearGradientContainer(imageData);\n    } else if (imageData.method === \"gradient\") {\n        return new WebkitGradientContainer(imageData);\n    } else if (imageData.method === \"svg\") {\n        return new SVGNodeContainer(imageData.args[0], this.support.svg);\n    } else if (imageData.method === \"IFRAME\") {\n        return new FrameContainer(imageData.args[0], this.isSameOrigin(imageData.args[0].src), this.options);\n    } else {\n        return new DummyImageContainer(imageData);\n    }\n};\n\nImageLoader.prototype.isSVG = function(src) {\n    return src.substring(src.length - 3).toLowerCase() === \"svg\" || SVGContainer.prototype.isInline(src);\n};\n\nImageLoader.prototype.imageExists = function(images, src) {\n    return images.some(function(image) {\n        return image.src === src;\n    });\n};\n\nImageLoader.prototype.isSameOrigin = function(url) {\n    return (this.getOrigin(url) === this.origin);\n};\n\nImageLoader.prototype.getOrigin = function(url) {\n    var link = this.link || (this.link = document.createElement(\"a\"));\n    link.href = url;\n    link.href = link.href; // IE9, LOL! - http://jsfiddle.net/niklasvh/2e48b/\n    return link.protocol + link.hostname + link.port;\n};\n\nImageLoader.prototype.getPromise = function(container) {\n    return this.timeout(container, this.options.imageTimeout)['catch'](function() {\n        var dummy = new DummyImageContainer(container.src);\n        return dummy.promise.then(function(image) {\n            container.image = image;\n        });\n    });\n};\n\nImageLoader.prototype.get = function(src) {\n    var found = null;\n    return this.images.some(function(img) {\n        return (found = img).src === src;\n    }) ? found : null;\n};\n\nImageLoader.prototype.fetch = function(nodes) {\n    this.images = nodes.reduce(bind(this.findBackgroundImage, this), this.findImages(nodes));\n    this.images.forEach(function(image, index) {\n        image.promise.then(function() {\n            log(\"Succesfully loaded image #\"+ (index+1), image);\n        }, function(e) {\n            log(\"Failed loading image #\"+ (index+1), image, e);\n        });\n    });\n    this.ready = Promise.all(this.images.map(this.getPromise, this));\n    log(\"Finished searching images\");\n    return this;\n};\n\nImageLoader.prototype.timeout = function(container, timeout) {\n    var timer;\n    var promise = Promise.race([container.promise, new Promise(function(res, reject) {\n        timer = setTimeout(function() {\n            log(\"Timed out loading image\", container);\n            reject(container);\n        }, timeout);\n    })]).then(function(container) {\n        clearTimeout(timer);\n        return container;\n    });\n    promise['catch'](function() {\n        clearTimeout(timer);\n    });\n    return promise;\n};\n\nmodule.exports = ImageLoader;\n\n},{\"./dummyimagecontainer\":5,\"./framecontainer\":8,\"./imagecontainer\":10,\"./lineargradientcontainer\":12,\"./log\":13,\"./proxyimagecontainer\":17,\"./svgcontainer\":23,\"./svgnodecontainer\":24,\"./utils\":26,\"./webkitgradientcontainer\":27}],12:[function(_dereq_,module,exports){\nvar GradientContainer = _dereq_('./gradientcontainer');\nvar Color = _dereq_('./color');\n\nfunction LinearGradientContainer(imageData) {\n    GradientContainer.apply(this, arguments);\n    this.type = GradientContainer.TYPES.LINEAR;\n\n    var hasDirection = LinearGradientContainer.REGEXP_DIRECTION.test( imageData.args[0] ) ||\n        !GradientContainer.REGEXP_COLORSTOP.test( imageData.args[0] );\n\n    if (hasDirection) {\n        imageData.args[0].split(/\\s+/).reverse().forEach(function(position, index) {\n            switch(position) {\n            case \"left\":\n                this.x0 = 0;\n                this.x1 = 1;\n                break;\n            case \"top\":\n                this.y0 = 0;\n                this.y1 = 1;\n                break;\n            case \"right\":\n                this.x0 = 1;\n                this.x1 = 0;\n                break;\n            case \"bottom\":\n                this.y0 = 1;\n                this.y1 = 0;\n                break;\n            case \"to\":\n                var y0 = this.y0;\n                var x0 = this.x0;\n                this.y0 = this.y1;\n                this.x0 = this.x1;\n                this.x1 = x0;\n                this.y1 = y0;\n                break;\n            case \"center\":\n                break; // centered by default\n            // Firefox internally converts position keywords to percentages:\n            // http://www.w3.org/TR/2010/WD-CSS2-20101207/colors.html#propdef-background-position\n            default: // percentage or absolute length\n                // TODO: support absolute start point positions (e.g., use bounds to convert px to a ratio)\n                var ratio = parseFloat(position, 10) * 1e-2;\n                if (isNaN(ratio)) { // invalid or unhandled value\n                    break;\n                }\n                if (index === 0) {\n                    this.y0 = ratio;\n                    this.y1 = 1 - this.y0;\n                } else {\n                    this.x0 = ratio;\n                    this.x1 = 1 - this.x0;\n                }\n                break;\n            }\n        }, this);\n    } else {\n        this.y0 = 0;\n        this.y1 = 1;\n    }\n\n    this.colorStops = imageData.args.slice(hasDirection ? 1 : 0).map(function(colorStop) {\n        var colorStopMatch = colorStop.match(GradientContainer.REGEXP_COLORSTOP);\n        var value = +colorStopMatch[2];\n        var unit = value === 0 ? \"%\" : colorStopMatch[3]; // treat \"0\" as \"0%\"\n        return {\n            color: new Color(colorStopMatch[1]),\n            // TODO: support absolute stop positions (e.g., compute gradient line length & convert px to ratio)\n            stop: unit === \"%\" ? value / 100 : null\n        };\n    });\n\n    if (this.colorStops[0].stop === null) {\n        this.colorStops[0].stop = 0;\n    }\n\n    if (this.colorStops[this.colorStops.length - 1].stop === null) {\n        this.colorStops[this.colorStops.length - 1].stop = 1;\n    }\n\n    // calculates and fills-in explicit stop positions when omitted from rule\n    this.colorStops.forEach(function(colorStop, index) {\n        if (colorStop.stop === null) {\n            this.colorStops.slice(index).some(function(find, count) {\n                if (find.stop !== null) {\n                    colorStop.stop = ((find.stop - this.colorStops[index - 1].stop) / (count + 1)) + this.colorStops[index - 1].stop;\n                    return true;\n                } else {\n                    return false;\n                }\n            }, this);\n        }\n    }, this);\n}\n\nLinearGradientContainer.prototype = Object.create(GradientContainer.prototype);\n\n// TODO: support <angle> (e.g. -?\\d{1,3}(?:\\.\\d+)deg, etc. : https://developer.mozilla.org/docs/Web/CSS/angle )\nLinearGradientContainer.REGEXP_DIRECTION = /^\\s*(?:to|left|right|top|bottom|center|\\d{1,3}(?:\\.\\d+)?%?)(?:\\s|$)/i;\n\nmodule.exports = LinearGradientContainer;\n\n},{\"./color\":3,\"./gradientcontainer\":9}],13:[function(_dereq_,module,exports){\nvar logger = function() {\n    if (logger.options.logging && window.console && window.console.log) {\n        Function.prototype.bind.call(window.console.log, (window.console)).apply(window.console, [(Date.now() - logger.options.start) + \"ms\", \"html2canvas:\"].concat([].slice.call(arguments, 0)));\n    }\n};\n\nlogger.options = {logging: false};\nmodule.exports = logger;\n\n},{}],14:[function(_dereq_,module,exports){\nvar Color = _dereq_('./color');\nvar utils = _dereq_('./utils');\nvar getBounds = utils.getBounds;\nvar parseBackgrounds = utils.parseBackgrounds;\nvar offsetBounds = utils.offsetBounds;\n\nfunction NodeContainer(node, parent) {\n    this.node = node;\n    this.parent = parent;\n    this.stack = null;\n    this.bounds = null;\n    this.borders = null;\n    this.clip = [];\n    this.backgroundClip = [];\n    this.offsetBounds = null;\n    this.visible = null;\n    this.computedStyles = null;\n    this.colors = {};\n    this.styles = {};\n    this.backgroundImages = null;\n    this.transformData = null;\n    this.transformMatrix = null;\n    this.isPseudoElement = false;\n    this.opacity = null;\n}\n\nNodeContainer.prototype.cloneTo = function(stack) {\n    stack.visible = this.visible;\n    stack.borders = this.borders;\n    stack.bounds = this.bounds;\n    stack.clip = this.clip;\n    stack.backgroundClip = this.backgroundClip;\n    stack.computedStyles = this.computedStyles;\n    stack.styles = this.styles;\n    stack.backgroundImages = this.backgroundImages;\n    stack.opacity = this.opacity;\n};\n\nNodeContainer.prototype.getOpacity = function() {\n    return this.opacity === null ? (this.opacity = this.cssFloat('opacity')) : this.opacity;\n};\n\nNodeContainer.prototype.assignStack = function(stack) {\n    this.stack = stack;\n    stack.children.push(this);\n};\n\nNodeContainer.prototype.isElementVisible = function() {\n    return this.node.nodeType === Node.TEXT_NODE ? this.parent.visible : (\n        this.css('display') !== \"none\" &&\n        this.css('visibility') !== \"hidden\" &&\n        !this.node.hasAttribute(\"data-html2canvas-ignore\") &&\n        (this.node.nodeName !== \"INPUT\" || this.node.getAttribute(\"type\") !== \"hidden\")\n    );\n};\n\nNodeContainer.prototype.css = function(attribute) {\n    if (!this.computedStyles) {\n        this.computedStyles = this.isPseudoElement ? this.parent.computedStyle(this.before ? \":before\" : \":after\") : this.computedStyle(null);\n    }\n\n    return this.styles[attribute] || (this.styles[attribute] = this.computedStyles[attribute]);\n};\n\nNodeContainer.prototype.prefixedCss = function(attribute) {\n    var prefixes = [\"webkit\", \"moz\", \"ms\", \"o\"];\n    var value = this.css(attribute);\n    if (value === undefined) {\n        prefixes.some(function(prefix) {\n            value = this.css(prefix + attribute.substr(0, 1).toUpperCase() + attribute.substr(1));\n            return value !== undefined;\n        }, this);\n    }\n    return value === undefined ? null : value;\n};\n\nNodeContainer.prototype.computedStyle = function(type) {\n    return this.node.ownerDocument.defaultView.getComputedStyle(this.node, type);\n};\n\nNodeContainer.prototype.cssInt = function(attribute) {\n    var value = parseInt(this.css(attribute), 10);\n    return (isNaN(value)) ? 0 : value; // borders in old IE are throwing 'medium' for demo.html\n};\n\nNodeContainer.prototype.color = function(attribute) {\n    return this.colors[attribute] || (this.colors[attribute] = new Color(this.css(attribute)));\n};\n\nNodeContainer.prototype.cssFloat = function(attribute) {\n    var value = parseFloat(this.css(attribute));\n    return (isNaN(value)) ? 0 : value;\n};\n\nNodeContainer.prototype.fontWeight = function() {\n    var weight = this.css(\"fontWeight\");\n    switch(parseInt(weight, 10)){\n    case 401:\n        weight = \"bold\";\n        break;\n    case 400:\n        weight = \"normal\";\n        break;\n    }\n    return weight;\n};\n\nNodeContainer.prototype.parseClip = function() {\n    var matches = this.css('clip').match(this.CLIP);\n    if (matches) {\n        return {\n            top: parseInt(matches[1], 10),\n            right: parseInt(matches[2], 10),\n            bottom: parseInt(matches[3], 10),\n            left: parseInt(matches[4], 10)\n        };\n    }\n    return null;\n};\n\nNodeContainer.prototype.parseBackgroundImages = function() {\n    return this.backgroundImages || (this.backgroundImages = parseBackgrounds(this.css(\"backgroundImage\")));\n};\n\nNodeContainer.prototype.cssList = function(property, index) {\n    var value = (this.css(property) || '').split(',');\n    value = value[index || 0] || value[0] || 'auto';\n    value = value.trim().split(' ');\n    if (value.length === 1) {\n        value = [value[0], isPercentage(value[0]) ? 'auto' : value[0]];\n    }\n    return value;\n};\n\nNodeContainer.prototype.parseBackgroundSize = function(bounds, image, index) {\n    var size = this.cssList(\"backgroundSize\", index);\n    var width, height;\n\n    if (isPercentage(size[0])) {\n        width = bounds.width * parseFloat(size[0]) / 100;\n    } else if (/contain|cover/.test(size[0])) {\n        var targetRatio = bounds.width / bounds.height, currentRatio = image.width / image.height;\n        return (targetRatio < currentRatio ^ size[0] === 'contain') ?  {width: bounds.height * currentRatio, height: bounds.height} : {width: bounds.width, height: bounds.width / currentRatio};\n    } else {\n        width = parseInt(size[0], 10);\n    }\n\n    if (size[0] === 'auto' && size[1] === 'auto') {\n        height = image.height;\n    } else if (size[1] === 'auto') {\n        height = width / image.width * image.height;\n    } else if (isPercentage(size[1])) {\n        height =  bounds.height * parseFloat(size[1]) / 100;\n    } else {\n        height = parseInt(size[1], 10);\n    }\n\n    if (size[0] === 'auto') {\n        width = height / image.height * image.width;\n    }\n\n    return {width: width, height: height};\n};\n\nNodeContainer.prototype.parseBackgroundPosition = function(bounds, image, index, backgroundSize) {\n    var position = this.cssList('backgroundPosition', index);\n    var left, top;\n\n    if (isPercentage(position[0])){\n        left = (bounds.width - (backgroundSize || image).width) * (parseFloat(position[0]) / 100);\n    } else {\n        left = parseInt(position[0], 10);\n    }\n\n    if (position[1] === 'auto') {\n        top = left / image.width * image.height;\n    } else if (isPercentage(position[1])){\n        top =  (bounds.height - (backgroundSize || image).height) * parseFloat(position[1]) / 100;\n    } else {\n        top = parseInt(position[1], 10);\n    }\n\n    if (position[0] === 'auto') {\n        left = top / image.height * image.width;\n    }\n\n    return {left: left, top: top};\n};\n\nNodeContainer.prototype.parseBackgroundRepeat = function(index) {\n    return this.cssList(\"backgroundRepeat\", index)[0];\n};\n\nNodeContainer.prototype.parseTextShadows = function() {\n    var textShadow = this.css(\"textShadow\");\n    var results = [];\n\n    if (textShadow && textShadow !== 'none') {\n        var shadows = textShadow.match(this.TEXT_SHADOW_PROPERTY);\n        for (var i = 0; shadows && (i < shadows.length); i++) {\n            var s = shadows[i].match(this.TEXT_SHADOW_VALUES);\n            results.push({\n                color: new Color(s[0]),\n                offsetX: s[1] ? parseFloat(s[1].replace('px', '')) : 0,\n                offsetY: s[2] ? parseFloat(s[2].replace('px', '')) : 0,\n                blur: s[3] ? s[3].replace('px', '') : 0\n            });\n        }\n    }\n    return results;\n};\n\nNodeContainer.prototype.parseTransform = function() {\n    if (!this.transformData) {\n        if (this.hasTransform()) {\n            var offset = this.parseBounds();\n            var origin = this.prefixedCss(\"transformOrigin\").split(\" \").map(removePx).map(asFloat);\n            origin[0] += offset.left;\n            origin[1] += offset.top;\n            this.transformData = {\n                origin: origin,\n                matrix: this.parseTransformMatrix()\n            };\n        } else {\n            this.transformData = {\n                origin: [0, 0],\n                matrix: [1, 0, 0, 1, 0, 0]\n            };\n        }\n    }\n    return this.transformData;\n};\n\nNodeContainer.prototype.parseTransformMatrix = function() {\n    if (!this.transformMatrix) {\n        var transform = this.prefixedCss(\"transform\");\n        var matrix = transform ? parseMatrix(transform.match(this.MATRIX_PROPERTY)) : null;\n        this.transformMatrix = matrix ? matrix : [1, 0, 0, 1, 0, 0];\n    }\n    return this.transformMatrix;\n};\n\nNodeContainer.prototype.parseBounds = function() {\n    return this.bounds || (this.bounds = this.hasTransform() ? offsetBounds(this.node) : getBounds(this.node));\n};\n\nNodeContainer.prototype.hasTransform = function() {\n    return this.parseTransformMatrix().join(\",\") !== \"1,0,0,1,0,0\" || (this.parent && this.parent.hasTransform());\n};\n\nNodeContainer.prototype.getValue = function() {\n    var value = this.node.value || \"\";\n    if (this.node.tagName === \"SELECT\") {\n        value = selectionValue(this.node);\n    } else if (this.node.type === \"password\") {\n        value = Array(value.length + 1).join('\\u2022'); // jshint ignore:line\n    }\n    return value.length === 0 ? (this.node.placeholder || \"\") : value;\n};\n\nNodeContainer.prototype.MATRIX_PROPERTY = /(matrix|matrix3d)\\((.+)\\)/;\nNodeContainer.prototype.TEXT_SHADOW_PROPERTY = /((rgba|rgb)\\([^\\)]+\\)(\\s-?\\d+px){0,})/g;\nNodeContainer.prototype.TEXT_SHADOW_VALUES = /(-?\\d+px)|(#.+)|(rgb\\(.+\\))|(rgba\\(.+\\))/g;\nNodeContainer.prototype.CLIP = /^rect\\((\\d+)px,? (\\d+)px,? (\\d+)px,? (\\d+)px\\)$/;\n\nfunction selectionValue(node) {\n    var option = node.options[node.selectedIndex || 0];\n    return option ? (option.text || \"\") : \"\";\n}\n\nfunction parseMatrix(match) {\n    if (match && match[1] === \"matrix\") {\n        return match[2].split(\",\").map(function(s) {\n            return parseFloat(s.trim());\n        });\n    } else if (match && match[1] === \"matrix3d\") {\n        var matrix3d = match[2].split(\",\").map(function(s) {\n          return parseFloat(s.trim());\n        });\n        return [matrix3d[0], matrix3d[1], matrix3d[4], matrix3d[5], matrix3d[12], matrix3d[13]];\n    }\n}\n\nfunction isPercentage(value) {\n    return value.toString().indexOf(\"%\") !== -1;\n}\n\nfunction removePx(str) {\n    return str.replace(\"px\", \"\");\n}\n\nfunction asFloat(str) {\n    return parseFloat(str);\n}\n\nmodule.exports = NodeContainer;\n\n},{\"./color\":3,\"./utils\":26}],15:[function(_dereq_,module,exports){\nvar log = _dereq_('./log');\nvar punycode = _dereq_('punycode');\nvar NodeContainer = _dereq_('./nodecontainer');\nvar TextContainer = _dereq_('./textcontainer');\nvar PseudoElementContainer = _dereq_('./pseudoelementcontainer');\nvar FontMetrics = _dereq_('./fontmetrics');\nvar Color = _dereq_('./color');\nvar StackingContext = _dereq_('./stackingcontext');\nvar utils = _dereq_('./utils');\nvar bind = utils.bind;\nvar getBounds = utils.getBounds;\nvar parseBackgrounds = utils.parseBackgrounds;\nvar offsetBounds = utils.offsetBounds;\n\nfunction NodeParser(element, renderer, support, imageLoader, options) {\n    log(\"Starting NodeParser\");\n    this.renderer = renderer;\n    this.options = options;\n    this.range = null;\n    this.support = support;\n    this.renderQueue = [];\n    this.stack = new StackingContext(true, 1, element.ownerDocument, null);\n    var parent = new NodeContainer(element, null);\n    if (options.background) {\n        renderer.rectangle(0, 0, renderer.width, renderer.height, new Color(options.background));\n    }\n    if (element === element.ownerDocument.documentElement) {\n        // http://www.w3.org/TR/css3-background/#special-backgrounds\n        var canvasBackground = new NodeContainer(parent.color('backgroundColor').isTransparent() ? element.ownerDocument.body : element.ownerDocument.documentElement, null);\n        renderer.rectangle(0, 0, renderer.width, renderer.height, canvasBackground.color('backgroundColor'));\n    }\n    parent.visibile = parent.isElementVisible();\n    this.createPseudoHideStyles(element.ownerDocument);\n    this.disableAnimations(element.ownerDocument);\n    this.nodes = flatten([parent].concat(this.getChildren(parent)).filter(function(container) {\n        return container.visible = container.isElementVisible();\n    }).map(this.getPseudoElements, this));\n    this.fontMetrics = new FontMetrics();\n    log(\"Fetched nodes, total:\", this.nodes.length);\n    log(\"Calculate overflow clips\");\n    this.calculateOverflowClips();\n    log(\"Start fetching images\");\n    this.images = imageLoader.fetch(this.nodes.filter(isElement));\n    this.ready = this.images.ready.then(bind(function() {\n        log(\"Images loaded, starting parsing\");\n        log(\"Creating stacking contexts\");\n        this.createStackingContexts();\n        log(\"Sorting stacking contexts\");\n        this.sortStackingContexts(this.stack);\n        this.parse(this.stack);\n        log(\"Render queue created with \" + this.renderQueue.length + \" items\");\n        return new Promise(bind(function(resolve) {\n            if (!options.async) {\n                this.renderQueue.forEach(this.paint, this);\n                resolve();\n            } else if (typeof(options.async) === \"function\") {\n                options.async.call(this, this.renderQueue, resolve);\n            } else if (this.renderQueue.length > 0){\n                this.renderIndex = 0;\n                this.asyncRenderer(this.renderQueue, resolve);\n            } else {\n                resolve();\n            }\n        }, this));\n    }, this));\n}\n\nNodeParser.prototype.calculateOverflowClips = function() {\n    this.nodes.forEach(function(container) {\n        if (isElement(container)) {\n            if (isPseudoElement(container)) {\n                container.appendToDOM();\n            }\n            container.borders = this.parseBorders(container);\n            var clip = (container.css('overflow') === \"hidden\") ? [container.borders.clip] : [];\n            var cssClip = container.parseClip();\n            if (cssClip && [\"absolute\", \"fixed\"].indexOf(container.css('position')) !== -1) {\n                clip.push([[\"rect\",\n                        container.bounds.left + cssClip.left,\n                        container.bounds.top + cssClip.top,\n                        cssClip.right - cssClip.left,\n                        cssClip.bottom - cssClip.top\n                ]]);\n            }\n            container.clip = hasParentClip(container) ? container.parent.clip.concat(clip) : clip;\n            container.backgroundClip = (container.css('overflow') !== \"hidden\") ? container.clip.concat([container.borders.clip]) : container.clip;\n            if (isPseudoElement(container)) {\n                container.cleanDOM();\n            }\n        } else if (isTextNode(container)) {\n            container.clip = hasParentClip(container) ? container.parent.clip : [];\n        }\n        if (!isPseudoElement(container)) {\n            container.bounds = null;\n        }\n    }, this);\n};\n\nfunction hasParentClip(container) {\n    return container.parent && container.parent.clip.length;\n}\n\nNodeParser.prototype.asyncRenderer = function(queue, resolve, asyncTimer) {\n    asyncTimer = asyncTimer || Date.now();\n    this.paint(queue[this.renderIndex++]);\n    if (queue.length === this.renderIndex) {\n        resolve();\n    } else if (asyncTimer + 20 > Date.now()) {\n        this.asyncRenderer(queue, resolve, asyncTimer);\n    } else {\n        setTimeout(bind(function() {\n            this.asyncRenderer(queue, resolve);\n        }, this), 0);\n    }\n};\n\nNodeParser.prototype.createPseudoHideStyles = function(document) {\n    this.createStyles(document, '.' + PseudoElementContainer.prototype.PSEUDO_HIDE_ELEMENT_CLASS_BEFORE + ':before { content: \"\" !important; display: none !important; }' +\n        '.' + PseudoElementContainer.prototype.PSEUDO_HIDE_ELEMENT_CLASS_AFTER + ':after { content: \"\" !important; display: none !important; }');\n};\n\nNodeParser.prototype.disableAnimations = function(document) {\n    this.createStyles(document, '* { -webkit-animation: none !important; -moz-animation: none !important; -o-animation: none !important; animation: none !important; ' +\n        '-webkit-transition: none !important; -moz-transition: none !important; -o-transition: none !important; transition: none !important;}');\n};\n\nNodeParser.prototype.createStyles = function(document, styles) {\n    var hidePseudoElements = document.createElement('style');\n    hidePseudoElements.innerHTML = styles;\n    document.body.appendChild(hidePseudoElements);\n};\n\nNodeParser.prototype.getPseudoElements = function(container) {\n    var nodes = [[container]];\n    if (container.node.nodeType === Node.ELEMENT_NODE) {\n        var before = this.getPseudoElement(container, \":before\");\n        var after = this.getPseudoElement(container, \":after\");\n\n        if (before) {\n            nodes.push(before);\n        }\n\n        if (after) {\n            nodes.push(after);\n        }\n    }\n    return flatten(nodes);\n};\n\nfunction toCamelCase(str) {\n    return str.replace(/(\\-[a-z])/g, function(match){\n        return match.toUpperCase().replace('-','');\n    });\n}\n\nNodeParser.prototype.getPseudoElement = function(container, type) {\n    var style = container.computedStyle(type);\n    if(!style || !style.content || style.content === \"none\" || style.content === \"-moz-alt-content\" || style.display === \"none\") {\n        return null;\n    }\n\n    var content = stripQuotes(style.content);\n    var isImage = content.substr(0, 3) === 'url';\n    var pseudoNode = document.createElement(isImage ? 'img' : 'html2canvaspseudoelement');\n    var pseudoContainer = new PseudoElementContainer(pseudoNode, container, type);\n\n    for (var i = style.length-1; i >= 0; i--) {\n        var property = toCamelCase(style.item(i));\n        pseudoNode.style[property] = style[property];\n    }\n\n    pseudoNode.className = PseudoElementContainer.prototype.PSEUDO_HIDE_ELEMENT_CLASS_BEFORE + \" \" + PseudoElementContainer.prototype.PSEUDO_HIDE_ELEMENT_CLASS_AFTER;\n\n    if (isImage) {\n        pseudoNode.src = parseBackgrounds(content)[0].args[0];\n        return [pseudoContainer];\n    } else {\n        var text = document.createTextNode(content);\n        pseudoNode.appendChild(text);\n        return [pseudoContainer, new TextContainer(text, pseudoContainer)];\n    }\n};\n\n\nNodeParser.prototype.getChildren = function(parentContainer) {\n    return flatten([].filter.call(parentContainer.node.childNodes, renderableNode).map(function(node) {\n        var container = [node.nodeType === Node.TEXT_NODE ? new TextContainer(node, parentContainer) : new NodeContainer(node, parentContainer)].filter(nonIgnoredElement);\n        return node.nodeType === Node.ELEMENT_NODE && container.length && node.tagName !== \"TEXTAREA\" ? (container[0].isElementVisible() ? container.concat(this.getChildren(container[0])) : []) : container;\n    }, this));\n};\n\nNodeParser.prototype.newStackingContext = function(container, hasOwnStacking) {\n    var stack = new StackingContext(hasOwnStacking, container.getOpacity(), container.node, container.parent);\n    container.cloneTo(stack);\n    var parentStack = hasOwnStacking ? stack.getParentStack(this) : stack.parent.stack;\n    parentStack.contexts.push(stack);\n    container.stack = stack;\n};\n\nNodeParser.prototype.createStackingContexts = function() {\n    this.nodes.forEach(function(container) {\n        if (isElement(container) && (this.isRootElement(container) || hasOpacity(container) || isPositionedForStacking(container) || this.isBodyWithTransparentRoot(container) || container.hasTransform())) {\n            this.newStackingContext(container, true);\n        } else if (isElement(container) && ((isPositioned(container) && zIndex0(container)) || isInlineBlock(container) || isFloating(container))) {\n            this.newStackingContext(container, false);\n        } else {\n            container.assignStack(container.parent.stack);\n        }\n    }, this);\n};\n\nNodeParser.prototype.isBodyWithTransparentRoot = function(container) {\n    return container.node.nodeName === \"BODY\" && container.parent.color('backgroundColor').isTransparent();\n};\n\nNodeParser.prototype.isRootElement = function(container) {\n    return container.parent === null;\n};\n\nNodeParser.prototype.sortStackingContexts = function(stack) {\n    stack.contexts.sort(zIndexSort(stack.contexts.slice(0)));\n    stack.contexts.forEach(this.sortStackingContexts, this);\n};\n\nNodeParser.prototype.parseTextBounds = function(container) {\n    return function(text, index, textList) {\n        if (container.parent.css(\"textDecoration\").substr(0, 4) !== \"none\" || text.trim().length !== 0) {\n            if (this.support.rangeBounds && !container.parent.hasTransform()) {\n                var offset = textList.slice(0, index).join(\"\").length;\n                return this.getRangeBounds(container.node, offset, text.length);\n            } else if (container.node && typeof(container.node.data) === \"string\") {\n                var replacementNode = container.node.splitText(text.length);\n                var bounds = this.getWrapperBounds(container.node, container.parent.hasTransform());\n                container.node = replacementNode;\n                return bounds;\n            }\n        } else if(!this.support.rangeBounds || container.parent.hasTransform()){\n            container.node = container.node.splitText(text.length);\n        }\n        return {};\n    };\n};\n\nNodeParser.prototype.getWrapperBounds = function(node, transform) {\n    var wrapper = node.ownerDocument.createElement('html2canvaswrapper');\n    var parent = node.parentNode,\n        backupText = node.cloneNode(true);\n\n    wrapper.appendChild(node.cloneNode(true));\n    parent.replaceChild(wrapper, node);\n    var bounds = transform ? offsetBounds(wrapper) : getBounds(wrapper);\n    parent.replaceChild(backupText, wrapper);\n    return bounds;\n};\n\nNodeParser.prototype.getRangeBounds = function(node, offset, length) {\n    var range = this.range || (this.range = node.ownerDocument.createRange());\n    range.setStart(node, offset);\n    range.setEnd(node, offset + length);\n    return range.getBoundingClientRect();\n};\n\nfunction ClearTransform() {}\n\nNodeParser.prototype.parse = function(stack) {\n    // http://www.w3.org/TR/CSS21/visuren.html#z-index\n    var negativeZindex = stack.contexts.filter(negativeZIndex); // 2. the child stacking contexts with negative stack levels (most negative first).\n    var descendantElements = stack.children.filter(isElement);\n    var descendantNonFloats = descendantElements.filter(not(isFloating));\n    var nonInlineNonPositionedDescendants = descendantNonFloats.filter(not(isPositioned)).filter(not(inlineLevel)); // 3 the in-flow, non-inline-level, non-positioned descendants.\n    var nonPositionedFloats = descendantElements.filter(not(isPositioned)).filter(isFloating); // 4. the non-positioned floats.\n    var inFlow = descendantNonFloats.filter(not(isPositioned)).filter(inlineLevel); // 5. the in-flow, inline-level, non-positioned descendants, including inline tables and inline blocks.\n    var stackLevel0 = stack.contexts.concat(descendantNonFloats.filter(isPositioned)).filter(zIndex0); // 6. the child stacking contexts with stack level 0 and the positioned descendants with stack level 0.\n    var text = stack.children.filter(isTextNode).filter(hasText);\n    var positiveZindex = stack.contexts.filter(positiveZIndex); // 7. the child stacking contexts with positive stack levels (least positive first).\n    negativeZindex.concat(nonInlineNonPositionedDescendants).concat(nonPositionedFloats)\n        .concat(inFlow).concat(stackLevel0).concat(text).concat(positiveZindex).forEach(function(container) {\n            this.renderQueue.push(container);\n            if (isStackingContext(container)) {\n                this.parse(container);\n                this.renderQueue.push(new ClearTransform());\n            }\n        }, this);\n};\n\nNodeParser.prototype.paint = function(container) {\n    try {\n        if (container instanceof ClearTransform) {\n            this.renderer.ctx.restore();\n        } else if (isTextNode(container)) {\n            if (isPseudoElement(container.parent)) {\n                container.parent.appendToDOM();\n            }\n            this.paintText(container);\n            if (isPseudoElement(container.parent)) {\n                container.parent.cleanDOM();\n            }\n        } else {\n            this.paintNode(container);\n        }\n    } catch(e) {\n        log(e);\n        if (this.options.strict) {\n            throw e;\n        }\n    }\n};\n\nNodeParser.prototype.paintNode = function(container) {\n    if (isStackingContext(container)) {\n        this.renderer.setOpacity(container.opacity);\n        this.renderer.ctx.save();\n        if (container.hasTransform()) {\n            this.renderer.setTransform(container.parseTransform());\n        }\n    }\n\n    if (container.node.nodeName === \"INPUT\" && container.node.type === \"checkbox\") {\n        this.paintCheckbox(container);\n    } else if (container.node.nodeName === \"INPUT\" && container.node.type === \"radio\") {\n        this.paintRadio(container);\n    } else {\n        this.paintElement(container);\n    }\n};\n\nNodeParser.prototype.paintElement = function(container) {\n    var bounds = container.parseBounds();\n    this.renderer.clip(container.backgroundClip, function() {\n        this.renderer.renderBackground(container, bounds, container.borders.borders.map(getWidth));\n    }, this);\n\n    this.renderer.clip(container.clip, function() {\n        this.renderer.renderBorders(container.borders.borders);\n    }, this);\n\n    this.renderer.clip(container.backgroundClip, function() {\n        switch (container.node.nodeName) {\n        case \"svg\":\n        case \"IFRAME\":\n            var imgContainer = this.images.get(container.node);\n            if (imgContainer) {\n                this.renderer.renderImage(container, bounds, container.borders, imgContainer);\n            } else {\n                log(\"Error loading <\" + container.node.nodeName + \">\", container.node);\n            }\n            break;\n        case \"IMG\":\n            var imageContainer = this.images.get(container.node.src);\n            if (imageContainer) {\n                this.renderer.renderImage(container, bounds, container.borders, imageContainer);\n            } else {\n                log(\"Error loading <img>\", container.node.src);\n            }\n            break;\n        case \"CANVAS\":\n            this.renderer.renderImage(container, bounds, container.borders, {image: container.node});\n            break;\n        case \"SELECT\":\n        case \"INPUT\":\n        case \"TEXTAREA\":\n            this.paintFormValue(container);\n            break;\n        }\n    }, this);\n};\n\nNodeParser.prototype.paintCheckbox = function(container) {\n    var b = container.parseBounds();\n\n    var size = Math.min(b.width, b.height);\n    var bounds = {width: size - 1, height: size - 1, top: b.top, left: b.left};\n    var r = [3, 3];\n    var radius = [r, r, r, r];\n    var borders = [1,1,1,1].map(function(w) {\n        return {color: new Color('#A5A5A5'), width: w};\n    });\n\n    var borderPoints = calculateCurvePoints(bounds, radius, borders);\n\n    this.renderer.clip(container.backgroundClip, function() {\n        this.renderer.rectangle(bounds.left + 1, bounds.top + 1, bounds.width - 2, bounds.height - 2, new Color(\"#DEDEDE\"));\n        this.renderer.renderBorders(calculateBorders(borders, bounds, borderPoints, radius));\n        if (container.node.checked) {\n            this.renderer.font(new Color('#424242'), 'normal', 'normal', 'bold', (size - 3) + \"px\", 'arial');\n            this.renderer.text(\"\\u2714\", bounds.left + size / 6, bounds.top + size - 1);\n        }\n    }, this);\n};\n\nNodeParser.prototype.paintRadio = function(container) {\n    var bounds = container.parseBounds();\n\n    var size = Math.min(bounds.width, bounds.height) - 2;\n\n    this.renderer.clip(container.backgroundClip, function() {\n        this.renderer.circleStroke(bounds.left + 1, bounds.top + 1, size, new Color('#DEDEDE'), 1, new Color('#A5A5A5'));\n        if (container.node.checked) {\n            this.renderer.circle(Math.ceil(bounds.left + size / 4) + 1, Math.ceil(bounds.top + size / 4) + 1, Math.floor(size / 2), new Color('#424242'));\n        }\n    }, this);\n};\n\nNodeParser.prototype.paintFormValue = function(container) {\n    var value = container.getValue();\n    if (value.length > 0) {\n        var document = container.node.ownerDocument;\n        var wrapper = document.createElement('html2canvaswrapper');\n        var properties = ['lineHeight', 'textAlign', 'fontFamily', 'fontWeight', 'fontSize', 'color',\n            'paddingLeft', 'paddingTop', 'paddingRight', 'paddingBottom',\n            'width', 'height', 'borderLeftStyle', 'borderTopStyle', 'borderLeftWidth', 'borderTopWidth',\n            'boxSizing', 'whiteSpace', 'wordWrap'];\n\n        properties.forEach(function(property) {\n            try {\n                wrapper.style[property] = container.css(property);\n            } catch(e) {\n                // Older IE has issues with \"border\"\n                log(\"html2canvas: Parse: Exception caught in renderFormValue: \" + e.message);\n            }\n        });\n        var bounds = container.parseBounds();\n        wrapper.style.position = \"fixed\";\n        wrapper.style.left = bounds.left + \"px\";\n        wrapper.style.top = bounds.top + \"px\";\n        wrapper.textContent = value;\n        document.body.appendChild(wrapper);\n        this.paintText(new TextContainer(wrapper.firstChild, container));\n        document.body.removeChild(wrapper);\n    }\n};\n\nNodeParser.prototype.paintText = function(container) {\n    container.applyTextTransform();\n    var characters = punycode.ucs2.decode(container.node.data);\n    var textList = (!this.options.letterRendering || noLetterSpacing(container)) && !hasUnicode(container.node.data) ? getWords(characters) : characters.map(function(character) {\n        return punycode.ucs2.encode([character]);\n    });\n\n    var weight = container.parent.fontWeight();\n    var size = container.parent.css('fontSize');\n    var family = container.parent.css('fontFamily');\n    var shadows = container.parent.parseTextShadows();\n\n    this.renderer.font(container.parent.color('color'), container.parent.css('fontStyle'), container.parent.css('fontVariant'), weight, size, family);\n    if (shadows.length) {\n        // TODO: support multiple text shadows\n        this.renderer.fontShadow(shadows[0].color, shadows[0].offsetX, shadows[0].offsetY, shadows[0].blur);\n    } else {\n        this.renderer.clearShadow();\n    }\n\n    this.renderer.clip(container.parent.clip, function() {\n        textList.map(this.parseTextBounds(container), this).forEach(function(bounds, index) {\n            if (bounds) {\n                this.renderer.text(textList[index], bounds.left, bounds.bottom);\n                this.renderTextDecoration(container.parent, bounds, this.fontMetrics.getMetrics(family, size));\n            }\n        }, this);\n    }, this);\n};\n\nNodeParser.prototype.renderTextDecoration = function(container, bounds, metrics) {\n    switch(container.css(\"textDecoration\").split(\" \")[0]) {\n    case \"underline\":\n        // Draws a line at the baseline of the font\n        // TODO As some browsers display the line as more than 1px if the font-size is big, need to take that into account both in position and size\n        this.renderer.rectangle(bounds.left, Math.round(bounds.top + metrics.baseline + metrics.lineWidth), bounds.width, 1, container.color(\"color\"));\n        break;\n    case \"overline\":\n        this.renderer.rectangle(bounds.left, Math.round(bounds.top), bounds.width, 1, container.color(\"color\"));\n        break;\n    case \"line-through\":\n        // TODO try and find exact position for line-through\n        this.renderer.rectangle(bounds.left, Math.ceil(bounds.top + metrics.middle + metrics.lineWidth), bounds.width, 1, container.color(\"color\"));\n        break;\n    }\n};\n\nvar borderColorTransforms = {\n    inset: [\n        [\"darken\", 0.60],\n        [\"darken\", 0.10],\n        [\"darken\", 0.10],\n        [\"darken\", 0.60]\n    ]\n};\n\nNodeParser.prototype.parseBorders = function(container) {\n    var nodeBounds = container.parseBounds();\n    var radius = getBorderRadiusData(container);\n    var borders = [\"Top\", \"Right\", \"Bottom\", \"Left\"].map(function(side, index) {\n        var style = container.css('border' + side + 'Style');\n        var color = container.color('border' + side + 'Color');\n        if (style === \"inset\" && color.isBlack()) {\n            color = new Color([255, 255, 255, color.a]); // this is wrong, but\n        }\n        var colorTransform = borderColorTransforms[style] ? borderColorTransforms[style][index] : null;\n        return {\n            width: container.cssInt('border' + side + 'Width'),\n            color: colorTransform ? color[colorTransform[0]](colorTransform[1]) : color,\n            args: null\n        };\n    });\n    var borderPoints = calculateCurvePoints(nodeBounds, radius, borders);\n\n    return {\n        clip: this.parseBackgroundClip(container, borderPoints, borders, radius, nodeBounds),\n        borders: calculateBorders(borders, nodeBounds, borderPoints, radius)\n    };\n};\n\nfunction calculateBorders(borders, nodeBounds, borderPoints, radius) {\n    return borders.map(function(border, borderSide) {\n        if (border.width > 0) {\n            var bx = nodeBounds.left;\n            var by = nodeBounds.top;\n            var bw = nodeBounds.width;\n            var bh = nodeBounds.height - (borders[2].width);\n\n            switch(borderSide) {\n            case 0:\n                // top border\n                bh = borders[0].width;\n                border.args = drawSide({\n                        c1: [bx, by],\n                        c2: [bx + bw, by],\n                        c3: [bx + bw - borders[1].width, by + bh],\n                        c4: [bx + borders[3].width, by + bh]\n                    }, radius[0], radius[1],\n                    borderPoints.topLeftOuter, borderPoints.topLeftInner, borderPoints.topRightOuter, borderPoints.topRightInner);\n                break;\n            case 1:\n                // right border\n                bx = nodeBounds.left + nodeBounds.width - (borders[1].width);\n                bw = borders[1].width;\n\n                border.args = drawSide({\n                        c1: [bx + bw, by],\n                        c2: [bx + bw, by + bh + borders[2].width],\n                        c3: [bx, by + bh],\n                        c4: [bx, by + borders[0].width]\n                    }, radius[1], radius[2],\n                    borderPoints.topRightOuter, borderPoints.topRightInner, borderPoints.bottomRightOuter, borderPoints.bottomRightInner);\n                break;\n            case 2:\n                // bottom border\n                by = (by + nodeBounds.height) - (borders[2].width);\n                bh = borders[2].width;\n                border.args = drawSide({\n                        c1: [bx + bw, by + bh],\n                        c2: [bx, by + bh],\n                        c3: [bx + borders[3].width, by],\n                        c4: [bx + bw - borders[3].width, by]\n                    }, radius[2], radius[3],\n                    borderPoints.bottomRightOuter, borderPoints.bottomRightInner, borderPoints.bottomLeftOuter, borderPoints.bottomLeftInner);\n                break;\n            case 3:\n                // left border\n                bw = borders[3].width;\n                border.args = drawSide({\n                        c1: [bx, by + bh + borders[2].width],\n                        c2: [bx, by],\n                        c3: [bx + bw, by + borders[0].width],\n                        c4: [bx + bw, by + bh]\n                    }, radius[3], radius[0],\n                    borderPoints.bottomLeftOuter, borderPoints.bottomLeftInner, borderPoints.topLeftOuter, borderPoints.topLeftInner);\n                break;\n            }\n        }\n        return border;\n    });\n}\n\nNodeParser.prototype.parseBackgroundClip = function(container, borderPoints, borders, radius, bounds) {\n    var backgroundClip = container.css('backgroundClip'),\n        borderArgs = [];\n\n    switch(backgroundClip) {\n    case \"content-box\":\n    case \"padding-box\":\n        parseCorner(borderArgs, radius[0], radius[1], borderPoints.topLeftInner, borderPoints.topRightInner, bounds.left + borders[3].width, bounds.top + borders[0].width);\n        parseCorner(borderArgs, radius[1], radius[2], borderPoints.topRightInner, borderPoints.bottomRightInner, bounds.left + bounds.width - borders[1].width, bounds.top + borders[0].width);\n        parseCorner(borderArgs, radius[2], radius[3], borderPoints.bottomRightInner, borderPoints.bottomLeftInner, bounds.left + bounds.width - borders[1].width, bounds.top + bounds.height - borders[2].width);\n        parseCorner(borderArgs, radius[3], radius[0], borderPoints.bottomLeftInner, borderPoints.topLeftInner, bounds.left + borders[3].width, bounds.top + bounds.height - borders[2].width);\n        break;\n\n    default:\n        parseCorner(borderArgs, radius[0], radius[1], borderPoints.topLeftOuter, borderPoints.topRightOuter, bounds.left, bounds.top);\n        parseCorner(borderArgs, radius[1], radius[2], borderPoints.topRightOuter, borderPoints.bottomRightOuter, bounds.left + bounds.width, bounds.top);\n        parseCorner(borderArgs, radius[2], radius[3], borderPoints.bottomRightOuter, borderPoints.bottomLeftOuter, bounds.left + bounds.width, bounds.top + bounds.height);\n        parseCorner(borderArgs, radius[3], radius[0], borderPoints.bottomLeftOuter, borderPoints.topLeftOuter, bounds.left, bounds.top + bounds.height);\n        break;\n    }\n\n    return borderArgs;\n};\n\nfunction getCurvePoints(x, y, r1, r2) {\n    var kappa = 4 * ((Math.sqrt(2) - 1) / 3);\n    var ox = (r1) * kappa, // control point offset horizontal\n        oy = (r2) * kappa, // control point offset vertical\n        xm = x + r1, // x-middle\n        ym = y + r2; // y-middle\n    return {\n        topLeft: bezierCurve({x: x, y: ym}, {x: x, y: ym - oy}, {x: xm - ox, y: y}, {x: xm, y: y}),\n        topRight: bezierCurve({x: x, y: y}, {x: x + ox,y: y}, {x: xm, y: ym - oy}, {x: xm, y: ym}),\n        bottomRight: bezierCurve({x: xm, y: y}, {x: xm, y: y + oy}, {x: x + ox, y: ym}, {x: x, y: ym}),\n        bottomLeft: bezierCurve({x: xm, y: ym}, {x: xm - ox, y: ym}, {x: x, y: y + oy}, {x: x, y:y})\n    };\n}\n\nfunction calculateCurvePoints(bounds, borderRadius, borders) {\n    var x = bounds.left,\n        y = bounds.top,\n        width = bounds.width,\n        height = bounds.height,\n\n        tlh = borderRadius[0][0] < width / 2 ? borderRadius[0][0] : width / 2,\n        tlv = borderRadius[0][1] < height / 2 ? borderRadius[0][1] : height / 2,\n        trh = borderRadius[1][0] < width / 2 ? borderRadius[1][0] : width / 2,\n        trv = borderRadius[1][1] < height / 2 ? borderRadius[1][1] : height / 2,\n        brh = borderRadius[2][0] < width / 2 ? borderRadius[2][0] : width / 2,\n        brv = borderRadius[2][1] < height / 2 ? borderRadius[2][1] : height / 2,\n        blh = borderRadius[3][0] < width / 2 ? borderRadius[3][0] : width / 2,\n        blv = borderRadius[3][1] < height / 2 ? borderRadius[3][1] : height / 2;\n\n    var topWidth = width - trh,\n        rightHeight = height - brv,\n        bottomWidth = width - brh,\n        leftHeight = height - blv;\n\n    return {\n        topLeftOuter: getCurvePoints(x, y, tlh, tlv).topLeft.subdivide(0.5),\n        topLeftInner: getCurvePoints(x + borders[3].width, y + borders[0].width, Math.max(0, tlh - borders[3].width), Math.max(0, tlv - borders[0].width)).topLeft.subdivide(0.5),\n        topRightOuter: getCurvePoints(x + topWidth, y, trh, trv).topRight.subdivide(0.5),\n        topRightInner: getCurvePoints(x + Math.min(topWidth, width + borders[3].width), y + borders[0].width, (topWidth > width + borders[3].width) ? 0 :trh - borders[3].width, trv - borders[0].width).topRight.subdivide(0.5),\n        bottomRightOuter: getCurvePoints(x + bottomWidth, y + rightHeight, brh, brv).bottomRight.subdivide(0.5),\n        bottomRightInner: getCurvePoints(x + Math.min(bottomWidth, width - borders[3].width), y + Math.min(rightHeight, height + borders[0].width), Math.max(0, brh - borders[1].width),  brv - borders[2].width).bottomRight.subdivide(0.5),\n        bottomLeftOuter: getCurvePoints(x, y + leftHeight, blh, blv).bottomLeft.subdivide(0.5),\n        bottomLeftInner: getCurvePoints(x + borders[3].width, y + leftHeight, Math.max(0, blh - borders[3].width), blv - borders[2].width).bottomLeft.subdivide(0.5)\n    };\n}\n\nfunction bezierCurve(start, startControl, endControl, end) {\n    var lerp = function (a, b, t) {\n        return {\n            x: a.x + (b.x - a.x) * t,\n            y: a.y + (b.y - a.y) * t\n        };\n    };\n\n    return {\n        start: start,\n        startControl: startControl,\n        endControl: endControl,\n        end: end,\n        subdivide: function(t) {\n            var ab = lerp(start, startControl, t),\n                bc = lerp(startControl, endControl, t),\n                cd = lerp(endControl, end, t),\n                abbc = lerp(ab, bc, t),\n                bccd = lerp(bc, cd, t),\n                dest = lerp(abbc, bccd, t);\n            return [bezierCurve(start, ab, abbc, dest), bezierCurve(dest, bccd, cd, end)];\n        },\n        curveTo: function(borderArgs) {\n            borderArgs.push([\"bezierCurve\", startControl.x, startControl.y, endControl.x, endControl.y, end.x, end.y]);\n        },\n        curveToReversed: function(borderArgs) {\n            borderArgs.push([\"bezierCurve\", endControl.x, endControl.y, startControl.x, startControl.y, start.x, start.y]);\n        }\n    };\n}\n\nfunction drawSide(borderData, radius1, radius2, outer1, inner1, outer2, inner2) {\n    var borderArgs = [];\n\n    if (radius1[0] > 0 || radius1[1] > 0) {\n        borderArgs.push([\"line\", outer1[1].start.x, outer1[1].start.y]);\n        outer1[1].curveTo(borderArgs);\n    } else {\n        borderArgs.push([ \"line\", borderData.c1[0], borderData.c1[1]]);\n    }\n\n    if (radius2[0] > 0 || radius2[1] > 0) {\n        borderArgs.push([\"line\", outer2[0].start.x, outer2[0].start.y]);\n        outer2[0].curveTo(borderArgs);\n        borderArgs.push([\"line\", inner2[0].end.x, inner2[0].end.y]);\n        inner2[0].curveToReversed(borderArgs);\n    } else {\n        borderArgs.push([\"line\", borderData.c2[0], borderData.c2[1]]);\n        borderArgs.push([\"line\", borderData.c3[0], borderData.c3[1]]);\n    }\n\n    if (radius1[0] > 0 || radius1[1] > 0) {\n        borderArgs.push([\"line\", inner1[1].end.x, inner1[1].end.y]);\n        inner1[1].curveToReversed(borderArgs);\n    } else {\n        borderArgs.push([\"line\", borderData.c4[0], borderData.c4[1]]);\n    }\n\n    return borderArgs;\n}\n\nfunction parseCorner(borderArgs, radius1, radius2, corner1, corner2, x, y) {\n    if (radius1[0] > 0 || radius1[1] > 0) {\n        borderArgs.push([\"line\", corner1[0].start.x, corner1[0].start.y]);\n        corner1[0].curveTo(borderArgs);\n        corner1[1].curveTo(borderArgs);\n    } else {\n        borderArgs.push([\"line\", x, y]);\n    }\n\n    if (radius2[0] > 0 || radius2[1] > 0) {\n        borderArgs.push([\"line\", corner2[0].start.x, corner2[0].start.y]);\n    }\n}\n\nfunction negativeZIndex(container) {\n    return container.cssInt(\"zIndex\") < 0;\n}\n\nfunction positiveZIndex(container) {\n    return container.cssInt(\"zIndex\") > 0;\n}\n\nfunction zIndex0(container) {\n    return container.cssInt(\"zIndex\") === 0;\n}\n\nfunction inlineLevel(container) {\n    return [\"inline\", \"inline-block\", \"inline-table\"].indexOf(container.css(\"display\")) !== -1;\n}\n\nfunction isStackingContext(container) {\n    return (container instanceof StackingContext);\n}\n\nfunction hasText(container) {\n    return container.node.data.trim().length > 0;\n}\n\nfunction noLetterSpacing(container) {\n    return (/^(normal|none|0px)$/.test(container.parent.css(\"letterSpacing\")));\n}\n\nfunction getBorderRadiusData(container) {\n    return [\"TopLeft\", \"TopRight\", \"BottomRight\", \"BottomLeft\"].map(function(side) {\n        var value = container.css('border' + side + 'Radius');\n        var arr = value.split(\" \");\n        if (arr.length <= 1) {\n            arr[1] = arr[0];\n        }\n        return arr.map(asInt);\n    });\n}\n\nfunction renderableNode(node) {\n    return (node.nodeType === Node.TEXT_NODE || node.nodeType === Node.ELEMENT_NODE);\n}\n\nfunction isPositionedForStacking(container) {\n    var position = container.css(\"position\");\n    var zIndex = ([\"absolute\", \"relative\", \"fixed\"].indexOf(position) !== -1) ? container.css(\"zIndex\") : \"auto\";\n    return zIndex !== \"auto\";\n}\n\nfunction isPositioned(container) {\n    return container.css(\"position\") !== \"static\";\n}\n\nfunction isFloating(container) {\n    return container.css(\"float\") !== \"none\";\n}\n\nfunction isInlineBlock(container) {\n    return [\"inline-block\", \"inline-table\"].indexOf(container.css(\"display\")) !== -1;\n}\n\nfunction not(callback) {\n    var context = this;\n    return function() {\n        return !callback.apply(context, arguments);\n    };\n}\n\nfunction isElement(container) {\n    return container.node.nodeType === Node.ELEMENT_NODE;\n}\n\nfunction isPseudoElement(container) {\n    return container.isPseudoElement === true;\n}\n\nfunction isTextNode(container) {\n    return container.node.nodeType === Node.TEXT_NODE;\n}\n\nfunction zIndexSort(contexts) {\n    return function(a, b) {\n        return (a.cssInt(\"zIndex\") + (contexts.indexOf(a) / contexts.length)) - (b.cssInt(\"zIndex\") + (contexts.indexOf(b) / contexts.length));\n    };\n}\n\nfunction hasOpacity(container) {\n    return container.getOpacity() < 1;\n}\n\nfunction asInt(value) {\n    return parseInt(value, 10);\n}\n\nfunction getWidth(border) {\n    return border.width;\n}\n\nfunction nonIgnoredElement(nodeContainer) {\n    return (nodeContainer.node.nodeType !== Node.ELEMENT_NODE || [\"SCRIPT\", \"HEAD\", \"TITLE\", \"OBJECT\", \"BR\", \"OPTION\"].indexOf(nodeContainer.node.nodeName) === -1);\n}\n\nfunction flatten(arrays) {\n    return [].concat.apply([], arrays);\n}\n\nfunction stripQuotes(content) {\n    var first = content.substr(0, 1);\n    return (first === content.substr(content.length - 1) && first.match(/'|\"/)) ? content.substr(1, content.length - 2) : content;\n}\n\nfunction getWords(characters) {\n    var words = [], i = 0, onWordBoundary = false, word;\n    while(characters.length) {\n        if (isWordBoundary(characters[i]) === onWordBoundary) {\n            word = characters.splice(0, i);\n            if (word.length) {\n                words.push(punycode.ucs2.encode(word));\n            }\n            onWordBoundary =! onWordBoundary;\n            i = 0;\n        } else {\n            i++;\n        }\n\n        if (i >= characters.length) {\n            word = characters.splice(0, i);\n            if (word.length) {\n                words.push(punycode.ucs2.encode(word));\n            }\n        }\n    }\n    return words;\n}\n\nfunction isWordBoundary(characterCode) {\n    return [\n        32, // <space>\n        13, // \\r\n        10, // \\n\n        9, // \\t\n        45 // -\n    ].indexOf(characterCode) !== -1;\n}\n\nfunction hasUnicode(string) {\n    return (/[^\\u0000-\\u00ff]/).test(string);\n}\n\nmodule.exports = NodeParser;\n\n},{\"./color\":3,\"./fontmetrics\":7,\"./log\":13,\"./nodecontainer\":14,\"./pseudoelementcontainer\":18,\"./stackingcontext\":21,\"./textcontainer\":25,\"./utils\":26,\"punycode\":1}],16:[function(_dereq_,module,exports){\nvar XHR = _dereq_('./xhr');\nvar utils = _dereq_('./utils');\nvar log = _dereq_('./log');\nvar createWindowClone = _dereq_('./clone');\nvar decode64 = utils.decode64;\n\nfunction Proxy(src, proxyUrl, document) {\n    var supportsCORS = ('withCredentials' in new XMLHttpRequest());\n    if (!proxyUrl) {\n        return Promise.reject(\"No proxy configured\");\n    }\n    var callback = createCallback(supportsCORS);\n    var url = createProxyUrl(proxyUrl, src, callback);\n\n    return supportsCORS ? XHR(url) : (jsonp(document, url, callback).then(function(response) {\n        return decode64(response.content);\n    }));\n}\nvar proxyCount = 0;\n\nfunction ProxyURL(src, proxyUrl, document) {\n    var supportsCORSImage = ('crossOrigin' in new Image());\n    var callback = createCallback(supportsCORSImage);\n    var url = createProxyUrl(proxyUrl, src, callback);\n    return (supportsCORSImage ? Promise.resolve(url) : jsonp(document, url, callback).then(function(response) {\n        return \"data:\" + response.type + \";base64,\" + response.content;\n    }));\n}\n\nfunction jsonp(document, url, callback) {\n    return new Promise(function(resolve, reject) {\n        var s = document.createElement(\"script\");\n        var cleanup = function() {\n            delete window.html2canvas.proxy[callback];\n            document.body.removeChild(s);\n        };\n        window.html2canvas.proxy[callback] = function(response) {\n            cleanup();\n            resolve(response);\n        };\n        s.src = url;\n        s.onerror = function(e) {\n            cleanup();\n            reject(e);\n        };\n        document.body.appendChild(s);\n    });\n}\n\nfunction createCallback(useCORS) {\n    return !useCORS ? \"html2canvas_\" + Date.now() + \"_\" + (++proxyCount) + \"_\" + Math.round(Math.random() * 100000) : \"\";\n}\n\nfunction createProxyUrl(proxyUrl, src, callback) {\n    return proxyUrl + \"?url=\" + encodeURIComponent(src) + (callback.length ? \"&callback=html2canvas.proxy.\" + callback : \"\");\n}\n\nfunction documentFromHTML(src) {\n    return function(html) {\n        var parser = new DOMParser(), doc;\n        try {\n            doc = parser.parseFromString(html, \"text/html\");\n        } catch(e) {\n            log(\"DOMParser not supported, falling back to createHTMLDocument\");\n            doc = document.implementation.createHTMLDocument(\"\");\n            try {\n                doc.open();\n                doc.write(html);\n                doc.close();\n            } catch(ee) {\n                log(\"createHTMLDocument write not supported, falling back to document.body.innerHTML\");\n                doc.body.innerHTML = html; // ie9 doesnt support writing to documentElement\n            }\n        }\n\n        var b = doc.querySelector(\"base\");\n        if (!b || !b.href.host) {\n            var base = doc.createElement(\"base\");\n            base.href = src;\n            doc.head.insertBefore(base, doc.head.firstChild);\n        }\n\n        return doc;\n    };\n}\n\nfunction loadUrlDocument(src, proxy, document, width, height, options) {\n    return new Proxy(src, proxy, window.document).then(documentFromHTML(src)).then(function(doc) {\n        return createWindowClone(doc, document, width, height, options, 0, 0);\n    });\n}\n\nexports.Proxy = Proxy;\nexports.ProxyURL = ProxyURL;\nexports.loadUrlDocument = loadUrlDocument;\n\n},{\"./clone\":2,\"./log\":13,\"./utils\":26,\"./xhr\":28}],17:[function(_dereq_,module,exports){\nvar ProxyURL = _dereq_('./proxy').ProxyURL;\n\nfunction ProxyImageContainer(src, proxy) {\n    var link = document.createElement(\"a\");\n    link.href = src;\n    src = link.href;\n    this.src = src;\n    this.image = new Image();\n    var self = this;\n    this.promise = new Promise(function(resolve, reject) {\n        self.image.crossOrigin = \"Anonymous\";\n        self.image.onload = resolve;\n        self.image.onerror = reject;\n\n        new ProxyURL(src, proxy, document).then(function(url) {\n            self.image.src = url;\n        })['catch'](reject);\n    });\n}\n\nmodule.exports = ProxyImageContainer;\n\n},{\"./proxy\":16}],18:[function(_dereq_,module,exports){\nvar NodeContainer = _dereq_('./nodecontainer');\n\nfunction PseudoElementContainer(node, parent, type) {\n    NodeContainer.call(this, node, parent);\n    this.isPseudoElement = true;\n    this.before = type === \":before\";\n}\n\nPseudoElementContainer.prototype.cloneTo = function(stack) {\n    PseudoElementContainer.prototype.cloneTo.call(this, stack);\n    stack.isPseudoElement = true;\n    stack.before = this.before;\n};\n\nPseudoElementContainer.prototype = Object.create(NodeContainer.prototype);\n\nPseudoElementContainer.prototype.appendToDOM = function() {\n    if (this.before) {\n        this.parent.node.insertBefore(this.node, this.parent.node.firstChild);\n    } else {\n        this.parent.node.appendChild(this.node);\n    }\n    this.parent.node.className += \" \" + this.getHideClass();\n};\n\nPseudoElementContainer.prototype.cleanDOM = function() {\n    this.node.parentNode.removeChild(this.node);\n    this.parent.node.className = this.parent.node.className.replace(this.getHideClass(), \"\");\n};\n\nPseudoElementContainer.prototype.getHideClass = function() {\n    return this[\"PSEUDO_HIDE_ELEMENT_CLASS_\" + (this.before ? \"BEFORE\" : \"AFTER\")];\n};\n\nPseudoElementContainer.prototype.PSEUDO_HIDE_ELEMENT_CLASS_BEFORE = \"___html2canvas___pseudoelement_before\";\nPseudoElementContainer.prototype.PSEUDO_HIDE_ELEMENT_CLASS_AFTER = \"___html2canvas___pseudoelement_after\";\n\nmodule.exports = PseudoElementContainer;\n\n},{\"./nodecontainer\":14}],19:[function(_dereq_,module,exports){\nvar log = _dereq_('./log');\n\nfunction Renderer(width, height, images, options, document) {\n    this.width = width;\n    this.height = height;\n    this.images = images;\n    this.options = options;\n    this.document = document;\n}\n\nRenderer.prototype.renderImage = function(container, bounds, borderData, imageContainer) {\n    var paddingLeft = container.cssInt('paddingLeft'),\n        paddingTop = container.cssInt('paddingTop'),\n        paddingRight = container.cssInt('paddingRight'),\n        paddingBottom = container.cssInt('paddingBottom'),\n        borders = borderData.borders;\n\n    var width = bounds.width - (borders[1].width + borders[3].width + paddingLeft + paddingRight);\n    var height = bounds.height - (borders[0].width + borders[2].width + paddingTop + paddingBottom);\n    this.drawImage(\n        imageContainer,\n        0,\n        0,\n        imageContainer.image.width || width,\n        imageContainer.image.height || height,\n        bounds.left + paddingLeft + borders[3].width,\n        bounds.top + paddingTop + borders[0].width,\n        width,\n        height\n    );\n};\n\nRenderer.prototype.renderBackground = function(container, bounds, borderData) {\n    if (bounds.height > 0 && bounds.width > 0) {\n        this.renderBackgroundColor(container, bounds);\n        this.renderBackgroundImage(container, bounds, borderData);\n    }\n};\n\nRenderer.prototype.renderBackgroundColor = function(container, bounds) {\n    var color = container.color(\"backgroundColor\");\n    if (!color.isTransparent()) {\n        this.rectangle(bounds.left, bounds.top, bounds.width, bounds.height, color);\n    }\n};\n\nRenderer.prototype.renderBorders = function(borders) {\n    borders.forEach(this.renderBorder, this);\n};\n\nRenderer.prototype.renderBorder = function(data) {\n    if (!data.color.isTransparent() && data.args !== null) {\n        this.drawShape(data.args, data.color);\n    }\n};\n\nRenderer.prototype.renderBackgroundImage = function(container, bounds, borderData) {\n    var backgroundImages = container.parseBackgroundImages();\n    backgroundImages.reverse().forEach(function(backgroundImage, index, arr) {\n        switch(backgroundImage.method) {\n        case \"url\":\n            var image = this.images.get(backgroundImage.args[0]);\n            if (image) {\n                this.renderBackgroundRepeating(container, bounds, image, arr.length - (index+1), borderData);\n            } else {\n                log(\"Error loading background-image\", backgroundImage.args[0]);\n            }\n            break;\n        case \"linear-gradient\":\n        case \"gradient\":\n            var gradientImage = this.images.get(backgroundImage.value);\n            if (gradientImage) {\n                this.renderBackgroundGradient(gradientImage, bounds, borderData);\n            } else {\n                log(\"Error loading background-image\", backgroundImage.args[0]);\n            }\n            break;\n        case \"none\":\n            break;\n        default:\n            log(\"Unknown background-image type\", backgroundImage.args[0]);\n        }\n    }, this);\n};\n\nRenderer.prototype.renderBackgroundRepeating = function(container, bounds, imageContainer, index, borderData) {\n    var size = container.parseBackgroundSize(bounds, imageContainer.image, index);\n    var position = container.parseBackgroundPosition(bounds, imageContainer.image, index, size);\n    var repeat = container.parseBackgroundRepeat(index);\n    switch (repeat) {\n    case \"repeat-x\":\n    case \"repeat no-repeat\":\n        this.backgroundRepeatShape(imageContainer, position, size, bounds, bounds.left + borderData[3], bounds.top + position.top + borderData[0], 99999, size.height, borderData);\n        break;\n    case \"repeat-y\":\n    case \"no-repeat repeat\":\n        this.backgroundRepeatShape(imageContainer, position, size, bounds, bounds.left + position.left + borderData[3], bounds.top + borderData[0], size.width, 99999, borderData);\n        break;\n    case \"no-repeat\":\n        this.backgroundRepeatShape(imageContainer, position, size, bounds, bounds.left + position.left + borderData[3], bounds.top + position.top + borderData[0], size.width, size.height, borderData);\n        break;\n    default:\n        this.renderBackgroundRepeat(imageContainer, position, size, {top: bounds.top, left: bounds.left}, borderData[3], borderData[0]);\n        break;\n    }\n};\n\nmodule.exports = Renderer;\n\n},{\"./log\":13}],20:[function(_dereq_,module,exports){\nvar Renderer = _dereq_('../renderer');\nvar LinearGradientContainer = _dereq_('../lineargradientcontainer');\nvar log = _dereq_('../log');\n\nfunction CanvasRenderer(width, height) {\n    Renderer.apply(this, arguments);\n    this.canvas = this.options.canvas || this.document.createElement(\"canvas\");\n    if (!this.options.canvas) {\n        this.canvas.width = width;\n        this.canvas.height = height;\n    }\n    this.ctx = this.canvas.getContext(\"2d\");\n    this.taintCtx = this.document.createElement(\"canvas\").getContext(\"2d\");\n    this.ctx.textBaseline = \"bottom\";\n    this.variables = {};\n    log(\"Initialized CanvasRenderer with size\", width, \"x\", height);\n}\n\nCanvasRenderer.prototype = Object.create(Renderer.prototype);\n\nCanvasRenderer.prototype.setFillStyle = function(fillStyle) {\n    this.ctx.fillStyle = typeof(fillStyle) === \"object\" && !!fillStyle.isColor ? fillStyle.toString() : fillStyle;\n    return this.ctx;\n};\n\nCanvasRenderer.prototype.rectangle = function(left, top, width, height, color) {\n    this.setFillStyle(color).fillRect(left, top, width, height);\n};\n\nCanvasRenderer.prototype.circle = function(left, top, size, color) {\n    this.setFillStyle(color);\n    this.ctx.beginPath();\n    this.ctx.arc(left + size / 2, top + size / 2, size / 2, 0, Math.PI*2, true);\n    this.ctx.closePath();\n    this.ctx.fill();\n};\n\nCanvasRenderer.prototype.circleStroke = function(left, top, size, color, stroke, strokeColor) {\n    this.circle(left, top, size, color);\n    this.ctx.strokeStyle = strokeColor.toString();\n    this.ctx.stroke();\n};\n\nCanvasRenderer.prototype.drawShape = function(shape, color) {\n    this.shape(shape);\n    this.setFillStyle(color).fill();\n};\n\nCanvasRenderer.prototype.taints = function(imageContainer) {\n    if (imageContainer.tainted === null) {\n        this.taintCtx.drawImage(imageContainer.image, 0, 0);\n        try {\n            this.taintCtx.getImageData(0, 0, 1, 1);\n            imageContainer.tainted = false;\n        } catch(e) {\n            this.taintCtx = document.createElement(\"canvas\").getContext(\"2d\");\n            imageContainer.tainted = true;\n        }\n    }\n\n    return imageContainer.tainted;\n};\n\nCanvasRenderer.prototype.drawImage = function(imageContainer, sx, sy, sw, sh, dx, dy, dw, dh) {\n    if (!this.taints(imageContainer) || this.options.allowTaint) {\n        this.ctx.drawImage(imageContainer.image, sx, sy, sw, sh, dx, dy, dw, dh);\n    }\n};\n\nCanvasRenderer.prototype.clip = function(shapes, callback, context) {\n    this.ctx.save();\n    shapes.filter(hasEntries).forEach(function(shape) {\n        this.shape(shape).clip();\n    }, this);\n    callback.call(context);\n    this.ctx.restore();\n};\n\nCanvasRenderer.prototype.shape = function(shape) {\n    this.ctx.beginPath();\n    shape.forEach(function(point, index) {\n        if (point[0] === \"rect\") {\n            this.ctx.rect.apply(this.ctx, point.slice(1));\n        } else {\n            this.ctx[(index === 0) ? \"moveTo\" : point[0] + \"To\" ].apply(this.ctx, point.slice(1));\n        }\n    }, this);\n    this.ctx.closePath();\n    return this.ctx;\n};\n\nCanvasRenderer.prototype.font = function(color, style, variant, weight, size, family) {\n    this.setFillStyle(color).font = [style, variant, weight, size, family].join(\" \").split(\",\")[0];\n};\n\nCanvasRenderer.prototype.fontShadow = function(color, offsetX, offsetY, blur) {\n    this.setVariable(\"shadowColor\", color.toString())\n        .setVariable(\"shadowOffsetY\", offsetX)\n        .setVariable(\"shadowOffsetX\", offsetY)\n        .setVariable(\"shadowBlur\", blur);\n};\n\nCanvasRenderer.prototype.clearShadow = function() {\n    this.setVariable(\"shadowColor\", \"rgba(0,0,0,0)\");\n};\n\nCanvasRenderer.prototype.setOpacity = function(opacity) {\n    this.ctx.globalAlpha = opacity;\n};\n\nCanvasRenderer.prototype.setTransform = function(transform) {\n    this.ctx.translate(transform.origin[0], transform.origin[1]);\n    this.ctx.transform.apply(this.ctx, transform.matrix);\n    this.ctx.translate(-transform.origin[0], -transform.origin[1]);\n};\n\nCanvasRenderer.prototype.setVariable = function(property, value) {\n    if (this.variables[property] !== value) {\n        this.variables[property] = this.ctx[property] = value;\n    }\n\n    return this;\n};\n\nCanvasRenderer.prototype.text = function(text, left, bottom) {\n    this.ctx.fillText(text, left, bottom);\n};\n\nCanvasRenderer.prototype.backgroundRepeatShape = function(imageContainer, backgroundPosition, size, bounds, left, top, width, height, borderData) {\n    var shape = [\n        [\"line\", Math.round(left), Math.round(top)],\n        [\"line\", Math.round(left + width), Math.round(top)],\n        [\"line\", Math.round(left + width), Math.round(height + top)],\n        [\"line\", Math.round(left), Math.round(height + top)]\n    ];\n    this.clip([shape], function() {\n        this.renderBackgroundRepeat(imageContainer, backgroundPosition, size, bounds, borderData[3], borderData[0]);\n    }, this);\n};\n\nCanvasRenderer.prototype.renderBackgroundRepeat = function(imageContainer, backgroundPosition, size, bounds, borderLeft, borderTop) {\n    var offsetX = Math.round(bounds.left + backgroundPosition.left + borderLeft), offsetY = Math.round(bounds.top + backgroundPosition.top + borderTop);\n    this.setFillStyle(this.ctx.createPattern(this.resizeImage(imageContainer, size), \"repeat\"));\n    this.ctx.translate(offsetX, offsetY);\n    this.ctx.fill();\n    this.ctx.translate(-offsetX, -offsetY);\n};\n\nCanvasRenderer.prototype.renderBackgroundGradient = function(gradientImage, bounds) {\n    if (gradientImage instanceof LinearGradientContainer) {\n        var gradient = this.ctx.createLinearGradient(\n            bounds.left + bounds.width * gradientImage.x0,\n            bounds.top + bounds.height * gradientImage.y0,\n            bounds.left +  bounds.width * gradientImage.x1,\n            bounds.top +  bounds.height * gradientImage.y1);\n        gradientImage.colorStops.forEach(function(colorStop) {\n            gradient.addColorStop(colorStop.stop, colorStop.color.toString());\n        });\n        this.rectangle(bounds.left, bounds.top, bounds.width, bounds.height, gradient);\n    }\n};\n\nCanvasRenderer.prototype.resizeImage = function(imageContainer, size) {\n    var image = imageContainer.image;\n    if(image.width === size.width && image.height === size.height) {\n        return image;\n    }\n\n    var ctx, canvas = document.createElement('canvas');\n    canvas.width = size.width;\n    canvas.height = size.height;\n    ctx = canvas.getContext(\"2d\");\n    ctx.drawImage(image, 0, 0, image.width, image.height, 0, 0, size.width, size.height );\n    return canvas;\n};\n\nfunction hasEntries(array) {\n    return array.length > 0;\n}\n\nmodule.exports = CanvasRenderer;\n\n},{\"../lineargradientcontainer\":12,\"../log\":13,\"../renderer\":19}],21:[function(_dereq_,module,exports){\nvar NodeContainer = _dereq_('./nodecontainer');\n\nfunction StackingContext(hasOwnStacking, opacity, element, parent) {\n    NodeContainer.call(this, element, parent);\n    this.ownStacking = hasOwnStacking;\n    this.contexts = [];\n    this.children = [];\n    this.opacity = (this.parent ? this.parent.stack.opacity : 1) * opacity;\n}\n\nStackingContext.prototype = Object.create(NodeContainer.prototype);\n\nStackingContext.prototype.getParentStack = function(context) {\n    var parentStack = (this.parent) ? this.parent.stack : null;\n    return parentStack ? (parentStack.ownStacking ? parentStack : parentStack.getParentStack(context)) : context.stack;\n};\n\nmodule.exports = StackingContext;\n\n},{\"./nodecontainer\":14}],22:[function(_dereq_,module,exports){\nfunction Support(document) {\n    this.rangeBounds = this.testRangeBounds(document);\n    this.cors = this.testCORS();\n    this.svg = this.testSVG();\n}\n\nSupport.prototype.testRangeBounds = function(document) {\n    var range, testElement, rangeBounds, rangeHeight, support = false;\n\n    if (document.createRange) {\n        range = document.createRange();\n        if (range.getBoundingClientRect) {\n            testElement = document.createElement('boundtest');\n            testElement.style.height = \"123px\";\n            testElement.style.display = \"block\";\n            document.body.appendChild(testElement);\n\n            range.selectNode(testElement);\n            rangeBounds = range.getBoundingClientRect();\n            rangeHeight = rangeBounds.height;\n\n            if (rangeHeight === 123) {\n                support = true;\n            }\n            document.body.removeChild(testElement);\n        }\n    }\n\n    return support;\n};\n\nSupport.prototype.testCORS = function() {\n    return typeof((new Image()).crossOrigin) !== \"undefined\";\n};\n\nSupport.prototype.testSVG = function() {\n    var img = new Image();\n    var canvas = document.createElement(\"canvas\");\n    var ctx =  canvas.getContext(\"2d\");\n    img.src = \"data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg'></svg>\";\n\n    try {\n        ctx.drawImage(img, 0, 0);\n        canvas.toDataURL();\n    } catch(e) {\n        return false;\n    }\n    return true;\n};\n\nmodule.exports = Support;\n\n},{}],23:[function(_dereq_,module,exports){\nvar XHR = _dereq_('./xhr');\nvar decode64 = _dereq_('./utils').decode64;\n\nfunction SVGContainer(src) {\n    this.src = src;\n    this.image = null;\n    var self = this;\n\n    this.promise = this.hasFabric().then(function() {\n        return (self.isInline(src) ? Promise.resolve(self.inlineFormatting(src)) : XHR(src));\n    }).then(function(svg) {\n        return new Promise(function(resolve) {\n            window.html2canvas.svg.fabric.loadSVGFromString(svg, self.createCanvas.call(self, resolve));\n        });\n    });\n}\n\nSVGContainer.prototype.hasFabric = function() {\n    return !window.html2canvas.svg || !window.html2canvas.svg.fabric ? Promise.reject(new Error(\"html2canvas.svg.js is not loaded, cannot render svg\")) : Promise.resolve();\n};\n\nSVGContainer.prototype.inlineFormatting = function(src) {\n    return (/^data:image\\/svg\\+xml;base64,/.test(src)) ? this.decode64(this.removeContentType(src)) : this.removeContentType(src);\n};\n\nSVGContainer.prototype.removeContentType = function(src) {\n    return src.replace(/^data:image\\/svg\\+xml(;base64)?,/,'');\n};\n\nSVGContainer.prototype.isInline = function(src) {\n    return (/^data:image\\/svg\\+xml/i.test(src));\n};\n\nSVGContainer.prototype.createCanvas = function(resolve) {\n    var self = this;\n    return function (objects, options) {\n        var canvas = new window.html2canvas.svg.fabric.StaticCanvas('c');\n        self.image = canvas.lowerCanvasEl;\n        canvas\n            .setWidth(options.width)\n            .setHeight(options.height)\n            .add(window.html2canvas.svg.fabric.util.groupSVGElements(objects, options))\n            .renderAll();\n        resolve(canvas.lowerCanvasEl);\n    };\n};\n\nSVGContainer.prototype.decode64 = function(str) {\n    return (typeof(window.atob) === \"function\") ? window.atob(str) : decode64(str);\n};\n\nmodule.exports = SVGContainer;\n\n},{\"./utils\":26,\"./xhr\":28}],24:[function(_dereq_,module,exports){\nvar SVGContainer = _dereq_('./svgcontainer');\n\nfunction SVGNodeContainer(node, _native) {\n    this.src = node;\n    this.image = null;\n    var self = this;\n\n    this.promise = _native ? new Promise(function(resolve, reject) {\n        self.image = new Image();\n        self.image.onload = resolve;\n        self.image.onerror = reject;\n        self.image.src = \"data:image/svg+xml,\" + (new XMLSerializer()).serializeToString(node);\n        if (self.image.complete === true) {\n            resolve(self.image);\n        }\n    }) : this.hasFabric().then(function() {\n        return new Promise(function(resolve) {\n            window.html2canvas.svg.fabric.parseSVGDocument(node, self.createCanvas.call(self, resolve));\n        });\n    });\n}\n\nSVGNodeContainer.prototype = Object.create(SVGContainer.prototype);\n\nmodule.exports = SVGNodeContainer;\n\n},{\"./svgcontainer\":23}],25:[function(_dereq_,module,exports){\nvar NodeContainer = _dereq_('./nodecontainer');\n\nfunction TextContainer(node, parent) {\n    NodeContainer.call(this, node, parent);\n}\n\nTextContainer.prototype = Object.create(NodeContainer.prototype);\n\nTextContainer.prototype.applyTextTransform = function() {\n    this.node.data = this.transform(this.parent.css(\"textTransform\"));\n};\n\nTextContainer.prototype.transform = function(transform) {\n    var text = this.node.data;\n    switch(transform){\n        case \"lowercase\":\n            return text.toLowerCase();\n        case \"capitalize\":\n            return text.replace(/(^|\\s|:|-|\\(|\\))([a-z])/g, capitalize);\n        case \"uppercase\":\n            return text.toUpperCase();\n        default:\n            return text;\n    }\n};\n\nfunction capitalize(m, p1, p2) {\n    if (m.length > 0) {\n        return p1 + p2.toUpperCase();\n    }\n}\n\nmodule.exports = TextContainer;\n\n},{\"./nodecontainer\":14}],26:[function(_dereq_,module,exports){\nexports.smallImage = function smallImage() {\n    return \"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7\";\n};\n\nexports.bind = function(callback, context) {\n    return function() {\n        return callback.apply(context, arguments);\n    };\n};\n\n/*\n * base64-arraybuffer\n * https://github.com/niklasvh/base64-arraybuffer\n *\n * Copyright (c) 2012 Niklas von Hertzen\n * Licensed under the MIT license.\n */\n\nexports.decode64 = function(base64) {\n    var chars = \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\";\n    var len = base64.length, i, encoded1, encoded2, encoded3, encoded4, byte1, byte2, byte3;\n\n    var output = \"\";\n\n    for (i = 0; i < len; i+=4) {\n        encoded1 = chars.indexOf(base64[i]);\n        encoded2 = chars.indexOf(base64[i+1]);\n        encoded3 = chars.indexOf(base64[i+2]);\n        encoded4 = chars.indexOf(base64[i+3]);\n\n        byte1 = (encoded1 << 2) | (encoded2 >> 4);\n        byte2 = ((encoded2 & 15) << 4) | (encoded3 >> 2);\n        byte3 = ((encoded3 & 3) << 6) | encoded4;\n        if (encoded3 === 64) {\n            output += String.fromCharCode(byte1);\n        } else if (encoded4 === 64 || encoded4 === -1) {\n            output += String.fromCharCode(byte1, byte2);\n        } else{\n            output += String.fromCharCode(byte1, byte2, byte3);\n        }\n    }\n\n    return output;\n};\n\nexports.getBounds = function(node) {\n    if (node.getBoundingClientRect) {\n        var clientRect = node.getBoundingClientRect();\n        var width = node.offsetWidth == null ? clientRect.width : node.offsetWidth;\n        return {\n            top: clientRect.top,\n            bottom: clientRect.bottom || (clientRect.top + clientRect.height),\n            right: clientRect.left + width,\n            left: clientRect.left,\n            width:  width,\n            height: node.offsetHeight == null ? clientRect.height : node.offsetHeight\n        };\n    }\n    return {};\n};\n\nexports.offsetBounds = function(node) {\n    var parent = node.offsetParent ? exports.offsetBounds(node.offsetParent) : {top: 0, left: 0};\n\n    return {\n        top: node.offsetTop + parent.top,\n        bottom: node.offsetTop + node.offsetHeight + parent.top,\n        right: node.offsetLeft + parent.left + node.offsetWidth,\n        left: node.offsetLeft + parent.left,\n        width: node.offsetWidth,\n        height: node.offsetHeight\n    };\n};\n\nexports.parseBackgrounds = function(backgroundImage) {\n    var whitespace = ' \\r\\n\\t',\n        method, definition, prefix, prefix_i, block, results = [],\n        mode = 0, numParen = 0, quote, args;\n    var appendResult = function() {\n        if(method) {\n            if (definition.substr(0, 1) === '\"') {\n                definition = definition.substr(1, definition.length - 2);\n            }\n            if (definition) {\n                args.push(definition);\n            }\n            if (method.substr(0, 1) === '-' && (prefix_i = method.indexOf('-', 1 ) + 1) > 0) {\n                prefix = method.substr(0, prefix_i);\n                method = method.substr(prefix_i);\n            }\n            results.push({\n                prefix: prefix,\n                method: method.toLowerCase(),\n                value: block,\n                args: args,\n                image: null\n            });\n        }\n        args = [];\n        method = prefix = definition = block = '';\n    };\n    args = [];\n    method = prefix = definition = block = '';\n    backgroundImage.split(\"\").forEach(function(c) {\n        if (mode === 0 && whitespace.indexOf(c) > -1) {\n            return;\n        }\n        switch(c) {\n        case '\"':\n            if(!quote) {\n                quote = c;\n            } else if(quote === c) {\n                quote = null;\n            }\n            break;\n        case '(':\n            if(quote) {\n                break;\n            } else if(mode === 0) {\n                mode = 1;\n                block += c;\n                return;\n            } else {\n                numParen++;\n            }\n            break;\n        case ')':\n            if (quote) {\n                break;\n            } else if(mode === 1) {\n                if(numParen === 0) {\n                    mode = 0;\n                    block += c;\n                    appendResult();\n                    return;\n                } else {\n                    numParen--;\n                }\n            }\n            break;\n\n        case ',':\n            if (quote) {\n                break;\n            } else if(mode === 0) {\n                appendResult();\n                return;\n            } else if (mode === 1) {\n                if (numParen === 0 && !method.match(/^url$/i)) {\n                    args.push(definition);\n                    definition = '';\n                    block += c;\n                    return;\n                }\n            }\n            break;\n        }\n\n        block += c;\n        if (mode === 0) {\n            method += c;\n        } else {\n            definition += c;\n        }\n    });\n\n    appendResult();\n    return results;\n};\n\n},{}],27:[function(_dereq_,module,exports){\nvar GradientContainer = _dereq_('./gradientcontainer');\n\nfunction WebkitGradientContainer(imageData) {\n    GradientContainer.apply(this, arguments);\n    this.type = imageData.args[0] === \"linear\" ? GradientContainer.TYPES.LINEAR : GradientContainer.TYPES.RADIAL;\n}\n\nWebkitGradientContainer.prototype = Object.create(GradientContainer.prototype);\n\nmodule.exports = WebkitGradientContainer;\n\n},{\"./gradientcontainer\":9}],28:[function(_dereq_,module,exports){\nfunction XHR(url) {\n    return new Promise(function(resolve, reject) {\n        var xhr = new XMLHttpRequest();\n        xhr.open('GET', url);\n\n        xhr.onload = function() {\n            if (xhr.status === 200) {\n                resolve(xhr.responseText);\n            } else {\n                reject(new Error(xhr.statusText));\n            }\n        };\n\n        xhr.onerror = function() {\n            reject(new Error(\"Network Error\"));\n        };\n\n        xhr.send();\n    });\n}\n\nmodule.exports = XHR;\n\n},{}]},{},[4])(4)\n});\n\n\n/** WEBPACK FOOTER **\n ** ./~/html2canvas/dist/html2canvas.js\n **/","/**\n * base class for all object in the library\n * @class Baseobject\n */\nexport default class BaseObject {\n  /**\n   * virtual function for returning class name\n   * @returns {string}\n   */\n  getName() {\n    return '';\n  }\n\n  /**\n   * returns if current mode is debugging mode\n   * @returns {bool}\n   */\n  isDebug() {\n    return this._debugMode;\n  }\n\n  /**\n   * logs message and object for debugging purpose\n   * @param {string} message\n   * @param {Array<any>} args\n   */\n  log(message, ...args) {\n    if (!this.isDebug()) {\n      return;\n    }\n\n    console.log(`${this.getName()}: ${message}`, ...args);\n  }\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/base-object.js\n **/","import BaseObject from './base-object';\nimport Rect from './rect';\n\n/**\n * State enabled class to manage grey canvas on top of html page for cropping\n * @class CanvasState\n */\nexport default class CanvasState extends BaseObject {\n  /**\n   * object constructor\n   * @param {HTMLDocument} doc\n   * @param {HTMLElement} canvas - canvas DOM element\n   */\n  constructor(doc, canvas, debugMode = true) {\n    super();\n\n    this._document = doc;\n    this._canvas = canvas;\n    this._width = canvas.width;\n    this._height = canvas.height;\n    this._ctx = canvas.getContext('2d');\n    this._debugMode = debugMode;\n\n    const html = this._document.body.parentNode;\n\n    this._htmlTop = html.offsetTop;\n    this._htmlLeft = html.offsetLeft;\n\n    this._valid = false; // when set to false, the canvas will redraw everything\n    this._shape = null;  // the rectangle shape\n    this._dragging = false; // Keep track of when we are dragging\n    this._dragoffx = 0; // See mousedown and mousemove events for explanation\n    this._dragoffy = 0;\n\n    this.log('initialized');\n\n    this._initRect();\n    this._initEvents();\n\n    this._interval = 30;\n    setInterval(() => {\n      this.draw();\n    }, this._interval);\n  }\n\n  /**\n   * returns class name\n   * @returns {string}\n   */\n  getName() {\n    return 'CanvasState';\n  }\n\n  /**\n   * attaches event handlers to canvas\n   * @private\n   */\n  _initEvents() {\n    const { _canvas } = this;\n    // fixes a problem where double clicking causesShape text to get selected on the canvas\n    _canvas.addEventListener('selectstart', (e) => {\n      e.preventDefault();\n      return false;\n    }, false);\n\n    // up, down, and move are for dragging\n    _canvas.addEventListener('mousedown', (e) => {\n      const { _shape } = this;\n      const mouse = this.getMouse(e);\n      const mx = mouse.x;\n      const my = mouse.y;\n      this._valid = false;\n      if (_shape.contains(mx, my)) {\n        this._dragoffx = mx - _shape._x;\n        this._dragoffy = my - _shape._y;\n        this._dragging = true;\n\n        this.log('mouse down detected. starting drag', mx, my);\n      }\n    }, true);\n\n    _canvas.addEventListener('mousemove', (e) => {\n      if (this._dragging) {\n        const mouse = this.getMouse(e);\n        // We don't want to drag the object by its top-left corner, we want to drag it\n        // from where we clicked. Thats why we saved the offset and use it here\n        this._shape._x = mouse.x - this._dragoffx;\n        this._shape._y = mouse.y - this._dragoffy;\n        this._valid = false; // Something's dragging so we must redraw\n\n        // this.log('moving the rect', mouse.x, mouse.y);\n      }\n    }, true);\n\n    _canvas.addEventListener('mouseup', () => {\n      this._dragging = false;\n      this.log('dragging finished');\n    });\n\n    this.log('initialized events');\n  }\n\n  /**\n   * creates a movable rectangle and attach to canvas\n   * @private\n   */\n  _initRect() {\n    this._shape = new Rect(\n      this._width / 4,\n      this._height / 4,\n      this._width / 2,\n      this._height / 2,\n      'rgba(0, 200, 0, 0.5)'\n    );\n    this._valid = false;\n  }\n\n  /**\n   * clears the canvas for next draw\n   */\n  clear() {\n    this._ctx.clearRect(0, 0, this._width, this._height);\n  }\n\n  /**\n   * while draw is called as often as the INTERVAL variable demands,\n   * it only ever does something if the canvas gets invalidated by our code\n   */\n  draw() {\n    // if our state is invalid, redraw and validate!\n    if (!this._valid) {\n      const { _ctx, _shape } = this;\n      this.clear();\n\n      // @TODO draw background here\n\n      // draw shape\n      _shape.draw(_ctx);\n\n      _ctx.strokeStyle = '#CC0000';\n      _ctx.lineWidth = 2;\n      _ctx.strokeRect(_shape._x, _shape._y, _shape._w, _shape._h);\n\n      this._valid = true;\n\n      this.log('shape drew', _shape._x, _shape._y, _shape._w, _shape._h);\n    }\n  }\n\n  /**\n   * creates an object with x and y defined, set to the mouse position relative to the state's canvas\n   * If you wanna be super-correct this can be tricky, we have to worry about padding and borders\n   * @param {Event} e\n   * @returns {{x: number, y: number}}\n   */\n  getMouse(e) {\n    let el = this._canvas;\n    let offsetX = 0;\n    let offsetY = 0;\n\n    // Compute the total offset\n    if (el.offsetParent !== undefined) {\n      do {\n        offsetX += el.offsetLeft;\n        offsetY += el.offsetTop;\n        el = el.offsetParent;\n      } while (el);\n    }\n\n    // Also add the <html> offsets in case there's a position:fixed bar\n    offsetX += this._htmlLeft;\n    offsetY += this._htmlTop;\n\n    const mx = e.pageX - offsetX;\n    const my = e.pageY - offsetY;\n\n    return { x: mx, y: my };\n  }\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/canvas-state.js\n **/","import BaseObject from './base-object';\n\n/**\n * Rectangle for highlighting the cropping area\n * @class Rect\n */\nexport default class Rect extends BaseObject {\n  /**\n   * object constructor\n   * @param {number} x - left position of shape\n   * @param {number} y - top position of shape\n   * @param {number} w - width\n   * @param {number} h - height\n   * @param {string} fill - background color of the shape\n   */\n  constructor(x, y, w, h, fill, debugMode = true) {\n    super();\n\n    this._x = x || 0;\n    this._y = y || 0;\n    this._w = w || 1;\n    this._h = h || 1;\n    this._fill = fill || '#AAAAAA';\n    this._debugMode = debugMode;\n\n    this.log('initialized');\n  }\n\n  /**\n   * returns class name\n   * @returns {string}\n   */\n  getName() {\n    return 'Rect';\n  }\n\n  /**\n   * draws the shape\n   * @param {CanvasContext} ctx\n   */\n  draw(ctx) {\n    const { _x, _y, _w, _h, _fill } = this;\n    ctx.fillStyle = _fill; // eslint-disable-line\n    ctx.fillRect(_x, _y, _w, _h);\n\n    this.log('filling the rectangle', _x, _y, _w, _h);\n  }\n\n  /**\n   * checks if point is inside the shape\n   * @param {number} mx\n   * @param {number} my\n   * @returns {bool}\n   */\n  contains(mx, my) {\n    const { _x, _y, _w, _h } = this;\n    return (_x <= mx) && (_x + _w >= mx) &&\n      (_y <= my) && (_y + _h >= my);\n  }\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/rect.js\n **/"],"sourceRoot":""}