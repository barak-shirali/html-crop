{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///HtmlCrop.min.js","webpack:///webpack/bootstrap be71e92647ce8c0ad117","webpack:///./src/index.js","webpack:///./~/html2canvas/dist/html2canvas.js","webpack:///./src/base-object.js","webpack:///./src/canvas-state.js","webpack:///./src/rect.js","webpack:///./src/preview-modal.js"],"names":["root","factory","exports","module","define","amd","this","modules","__webpack_require__","moduleId","installedModules","id","loaded","call","m","c","p","_interopRequireDefault","obj","__esModule","default","_classCallCheck","instance","Constructor","TypeError","_possibleConstructorReturn","self","ReferenceError","_inherits","subClass","superClass","prototype","Object","create","constructor","value","enumerable","writable","configurable","setPrototypeOf","__proto__","defineProperty","_createClass","defineProperties","target","props","i","length","descriptor","key","protoProps","staticProps","_html2canvas","_html2canvas2","_baseObject","_baseObject2","_canvasState","_canvasState2","_previewModal","_previewModal2","defaultOptions","ctrlKey","shiftKey","serverURL","startButton","debug","HtmlCrop","_BaseObject","doc","options","arguments","undefined","_this","getPrototypeOf","_document","assign","_debugMode","log","_onKeyDown","bind","reset","_listenHotKey","_attachStartButton","_this2","_started","_disableScroll","html","then","canvas","_canvas","selectionCanvas","createElement","_selectionCanvas","width","height","style","position","left","top","body","appendChild","_attachCaptureButton","_renderSelection","_startButton","removeChild","removeEventListener","_captureButton","_cancelButton","_infoDiv","addEventListener","button","textNode","createTextNode","right","bottom","onclick","startCropping","captureBtn","_onCapture","cancelBtn","endCropping","infoDiv","color","w","h","innerHTML","Math","round","event","keyOptions","ctx","getContext","selection","getSelection","imgData","getImageData","x","y","newCanvas","newCtx","putImageData","_enableScroll","_renderPreviewModal","preventDefault","e","returnValue","preventDefaultForScrollKeys","keys","indexOf","keyCode","onkeydown","onmousewheel","__WEBPACK_AMD_DEFINE_FACTORY__","__WEBPACK_AMD_DEFINE_ARRAY__","__WEBPACK_AMD_DEFINE_RESULT__","require","global","_typeof","Symbol","iterator","f","apply","t","n","r","s","o","u","a","Error","code","l","1","_dereq_","error","type","RangeError","errors","map","array","fn","result","mapDomain","string","parts","split","replace","regexSeparators","labels","encoded","join","ucs2decode","extra","output","counter","charCodeAt","push","ucs2encode","stringFromCharCode","basicToDigit","codePoint","base","digitToBasic","digit","flag","adapt","delta","numPoints","firstTime","k","floor","damp","baseMinusTMin","tMax","skew","decode","input","out","basic","j","index","oldi","baseMinusT","inputLength","initialN","bias","initialBias","lastIndexOf","delimiter","maxInt","tMin","splice","encode","handledCPCount","basicLength","q","currentValue","handledCPCountPlusOne","qMinusT","toUnicode","regexPunycode","test","slice","toLowerCase","toASCII","regexNonASCII","freeExports","nodeType","freeModule","freeGlobal","window","punycode","overflow","not-basic","invalid-input","String","fromCharCode","version","ucs2","hasOwnProperty","2","restoreOwnerScroll","ownerDocument","defaultView","pageXOffset","pageYOffset","scrollTo","cloneCanvasContents","clonedCanvas","cloneNode","node","javascriptEnabled","clone","document","nodeValue","child","firstChild","nodeName","nextSibling","_scrollTop","scrollTop","_scrollLeft","scrollLeft","initNode","containerDocument","documentElement","container","className","visibility","border","scrolling","Promise","resolve","documentClone","contentWindow","onload","interval","setInterval","childNodes","clearInterval","navigator","userAgent","scrollY","scrollX","open","write","replaceChild","adoptNode","close","./log","3","Color","g","b","fromArray","namedColor","rgb","rgba","hex6","hex3","darken","amount","isTransparent","isBlack","Array","isArray","min","_hex3","match","parseInt","_hex6","substring","_rgb","Number","_rgba","toString","colors","isColor","aliceblue","antiquewhite","aqua","aquamarine","azure","beige","bisque","black","blanchedalmond","blue","blueviolet","brown","burlywood","cadetblue","chartreuse","chocolate","coral","cornflowerblue","cornsilk","crimson","cyan","darkblue","darkcyan","darkgoldenrod","darkgray","darkgreen","darkgrey","darkkhaki","darkmagenta","darkolivegreen","darkorange","darkorchid","darkred","darksalmon","darkseagreen","darkslateblue","darkslategray","darkslategrey","darkturquoise","darkviolet","deeppink","deepskyblue","dimgray","dimgrey","dodgerblue","firebrick","floralwhite","forestgreen","fuchsia","gainsboro","ghostwhite","gold","goldenrod","gray","green","greenyellow","grey","honeydew","hotpink","indianred","indigo","ivory","khaki","lavender","lavenderblush","lawngreen","lemonchiffon","lightblue","lightcoral","lightcyan","lightgoldenrodyellow","lightgray","lightgreen","lightgrey","lightpink","lightsalmon","lightseagreen","lightskyblue","lightslategray","lightslategrey","lightsteelblue","lightyellow","lime","limegreen","linen","magenta","maroon","mediumaquamarine","mediumblue","mediumorchid","mediumpurple","mediumseagreen","mediumslateblue","mediumspringgreen","mediumturquoise","mediumvioletred","midnightblue","mintcream","mistyrose","moccasin","navajowhite","navy","oldlace","olive","olivedrab","orange","orangered","orchid","palegoldenrod","palegreen","paleturquoise","palevioletred","papayawhip","peachpuff","peru","pink","plum","powderblue","purple","rebeccapurple","red","rosybrown","royalblue","saddlebrown","salmon","sandybrown","seagreen","seashell","sienna","silver","skyblue","slateblue","slategray","slategrey","snow","springgreen","steelblue","tan","teal","thistle","tomato","turquoise","violet","wheat","white","whitesmoke","yellow","yellowgreen","4","html2canvas","nodeList","html2canvasCloneIndex","logging","start","Date","now","async","allowTaint","removeContainer","imageTimeout","renderer","CanvasRenderer","strict","proxy","reject","innerWidth","innerHeight","loadUrlDocument","absoluteUrl","renderWindow","setAttribute","html2canvasNodeAttribute","renderDocument","onrendered","windowWidth","windowHeight","html2canvasIndex","createWindowClone","attributeName","selector","querySelector","removeAttribute","clonedWindow","oncloneHandler","onclone","support","Support","imageLoader","ImageLoader","bounds","getBounds","documentWidth","documentHeight","parser","NodeParser","ready","crop","cleanupContainer","parentNode","croppedCanvas","x1","max","x2","y1","y2","drawImage","scrollWidth","offsetWidth","clientWidth","scrollHeight","offsetHeight","clientHeight","url","link","href","NodeContainer","utils","html2canvasExport","./clone","./imageloader","./nodecontainer","./nodeparser","./proxy","./renderers/canvas","./support","./utils","5","DummyImageContainer","src","promise","image","Image","onerror","smallImage","complete","6","Font","family","size","baseline","middle","img","span","sampleText","fontFamily","fontSize","margin","padding","verticalAlign","offsetTop","lineHeight","lineWidth","7","FontMetrics","data","getMetrics","./font","8","FrameContainer","sameOrigin","URL","proxyLoad","./core","9","GradientContainer","imageData","colorStops","x0","y0","TYPES","LINEAR","RADIAL","REGEXP_COLORSTOP","10","ImageContainer","cors","tainted","crossOrigin","11","origin","getOrigin","location","ProxyImageContainer","SVGContainer","SVGNodeContainer","LinearGradientContainer","WebkitGradientContainer","findImages","nodes","images","reduce","imageNodes","concat","args","method","forEach","addImage","loadImage","findBackgroundImage","parseBackgroundImages","filter","hasImageBackground","callback","newImage","imageExists","isSVG","svg","isSameOrigin","useCORS","isInline","some","protocol","hostname","port","getPromise","timeout","dummy","get","found","fetch","all","timer","race","res","setTimeout","clearTimeout","./dummyimagecontainer","./framecontainer","./imagecontainer","./lineargradientcontainer","./proxyimagecontainer","./svgcontainer","./svgnodecontainer","./webkitgradientcontainer","12","hasDirection","REGEXP_DIRECTION","reverse","ratio","parseFloat","isNaN","colorStop","colorStopMatch","unit","stop","find","count","./color","./gradientcontainer","13","logger","console","Function","14","parent","stack","borders","clip","backgroundClip","offsetBounds","visible","computedStyles","styles","backgroundImages","transformData","transformMatrix","isPseudoElement","opacity","selectionValue","option","selectedIndex","text","parseMatrix","trim","matrix3d","isPercentage","removePx","str","asFloat","parseBackgrounds","cloneTo","getOpacity","cssFloat","assignStack","children","isElementVisible","Node","TEXT_NODE","css","hasAttribute","getAttribute","attribute","computedStyle","before","prefixedCss","prefixes","prefix","substr","toUpperCase","getComputedStyle","cssInt","fontWeight","weight","parseClip","matches","CLIP","cssList","property","parseBackgroundSize","targetRatio","currentRatio","parseBackgroundPosition","backgroundSize","parseBackgroundRepeat","parseTextShadows","textShadow","results","shadows","TEXT_SHADOW_PROPERTY","TEXT_SHADOW_VALUES","offsetX","offsetY","blur","parseTransform","hasTransform","offset","parseBounds","matrix","parseTransformMatrix","transform","MATRIX_PROPERTY","getValue","tagName","placeholder","15","element","range","renderQueue","StackingContext","background","rectangle","canvasBackground","visibile","createPseudoHideStyles","disableAnimations","flatten","getChildren","getPseudoElements","fontMetrics","calculateOverflowClips","isElement","createStackingContexts","sortStackingContexts","parse","renderIndex","asyncRenderer","paint","hasParentClip","toCamelCase","ClearTransform","calculateBorders","nodeBounds","borderPoints","radius","borderSide","bx","by","bw","bh","drawSide","c1","c2","c3","c4","topLeftOuter","topLeftInner","topRightOuter","topRightInner","bottomRightOuter","bottomRightInner","bottomLeftOuter","bottomLeftInner","getCurvePoints","r1","r2","kappa","sqrt","ox","oy","xm","ym","topLeft","bezierCurve","topRight","bottomRight","bottomLeft","calculateCurvePoints","borderRadius","tlh","tlv","trh","trv","brh","brv","blh","blv","topWidth","rightHeight","bottomWidth","leftHeight","subdivide","startControl","endControl","end","lerp","ab","bc","cd","abbc","bccd","dest","curveTo","borderArgs","curveToReversed","borderData","radius1","radius2","outer1","inner1","outer2","inner2","parseCorner","corner1","corner2","negativeZIndex","positiveZIndex","zIndex0","inlineLevel","isStackingContext","hasText","noLetterSpacing","getBorderRadiusData","side","arr","asInt","renderableNode","ELEMENT_NODE","isPositionedForStacking","zIndex","isPositioned","isFloating","isInlineBlock","not","context","isTextNode","zIndexSort","contexts","hasOpacity","getWidth","nonIgnoredElement","nodeContainer","arrays","stripQuotes","content","first","getWords","characters","word","words","onWordBoundary","isWordBoundary","characterCode","hasUnicode","TextContainer","PseudoElementContainer","appendToDOM","parseBorders","cssClip","cleanDOM","queue","asyncTimer","createStyles","PSEUDO_HIDE_ELEMENT_CLASS_BEFORE","PSEUDO_HIDE_ELEMENT_CLASS_AFTER","hidePseudoElements","getPseudoElement","after","display","isImage","pseudoNode","pseudoContainer","item","parentContainer","newStackingContext","hasOwnStacking","parentStack","getParentStack","isRootElement","isBodyWithTransparentRoot","sort","parseTextBounds","textList","rangeBounds","getRangeBounds","replacementNode","splitText","getWrapperBounds","wrapper","backupText","createRange","setStart","setEnd","getBoundingClientRect","negativeZindex","descendantElements","descendantNonFloats","nonInlineNonPositionedDescendants","nonPositionedFloats","inFlow","stackLevel0","positiveZindex","restore","paintText","paintNode","setOpacity","save","setTransform","paintCheckbox","paintRadio","paintElement","renderBackground","renderBorders","imgContainer","renderImage","imageContainer","paintFormValue","checked","font","circleStroke","circle","ceil","properties","message","textContent","applyTextTransform","letterRendering","character","fontShadow","clearShadow","renderTextDecoration","metrics","borderColorTransforms","inset","colorTransform","parseBackgroundClip","./fontmetrics","./pseudoelementcontainer","./stackingcontext","./textcontainer","16","Proxy","proxyUrl","supportsCORS","XMLHttpRequest","createCallback","createProxyUrl","XHR","jsonp","response","decode64","ProxyURL","supportsCORSImage","cleanup","proxyCount","random","encodeURIComponent","documentFromHTML","DOMParser","parseFromString","implementation","createHTMLDocument","ee","host","head","insertBefore","./xhr","17","18","getHideClass","19","Renderer","paddingLeft","paddingTop","paddingRight","paddingBottom","renderBackgroundColor","renderBackgroundImage","renderBorder","drawShape","backgroundImage","renderBackgroundRepeating","gradientImage","renderBackgroundGradient","repeat","backgroundRepeatShape","renderBackgroundRepeat","20","taintCtx","textBaseline","variables","hasEntries","setFillStyle","fillStyle","fillRect","beginPath","arc","PI","closePath","fill","stroke","strokeColor","strokeStyle","shape","taints","sx","sy","sw","sh","dx","dy","dw","dh","shapes","point","rect","variant","setVariable","globalAlpha","translate","fillText","backgroundPosition","borderLeft","borderTop","createPattern","resizeImage","gradient","createLinearGradient","addColorStop","../lineargradientcontainer","../log","../renderer","21","ownStacking","22","testRangeBounds","testCORS","testSVG","testElement","rangeHeight","selectNode","toDataURL","23","hasFabric","inlineFormatting","fabric","loadSVGFromString","createCanvas","removeContentType","objects","StaticCanvas","lowerCanvasEl","setWidth","setHeight","add","util","groupSVGElements","renderAll","atob","24","_native","XMLSerializer","serializeToString","parseSVGDocument","25","capitalize","p1","p2","26","base64","encoded1","encoded2","encoded3","encoded4","byte1","byte2","byte3","chars","len","clientRect","offsetParent","offsetLeft","definition","prefix_i","block","quote","whitespace","mode","numParen","appendResult","27","28","xhr","status","responseText","statusText","send","BaseObject","_console","isDebug","_len","_key","getName","_rect","_rect2","CanvasState","onSelectionChange","debugMode","_onMouseDown","_onMouseMove","_onMouseUp","_onTouch","_onSelectionChange","_width","_height","_ctx","_htmlTop","_htmlLeft","_valid","_shape","_dragging","_dragoffx","_dragoffy","_initRect","_initEvents","_w","_h","_interval","draw","mouse","getMouse","mx","my","contains","_x","_y","_currentHandle","getHoverSelectionHandle","oldx","oldy","handleIndex","cursor","evt","touches","newEvt","createEvent","srcElement","originalTarget","touch","changedTouches","initMouseEvent","screenX","screenY","clientX","clientY","altKey","metaKey","dispatchEvent","_shape2","clearRect","clear","el","getOffset","pageX","pageY","Rect","selectionBoxSize","_selectionHandles","_selectionBoxSize","_fill","setLineDash","strokeRect","half","cur","handle","selectStyles","sendBtnStyles","progressDivStyles","actionDivStyles","infoDivStyles","modalWindowStyles","overlayStyles","z-index","justify-content","align-items","background-color","flex-direction","box-shadow","margin-top","font-size","margin-right","PreviewModal","_serverURL","_compressionRatio","_fileFormat","overlayDiv","_overlayDiv","_applyStyles","modalWindow","actionDiv","_actionDiv","sendBtn","_sendBtn","sendImage","_cancelBtn","removeModal","fileFormatSelect","_fileFormatSelect","onchange","updateImage","compressionRatioSelect","_compressionRatioSelect","progressDiv","_progressDiv","_img","formData","FormData","append","getImage","lengthComputable","percentage","total","dataURL","header","fileSize"],"mappings":"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","file":"HtmlCrop.min.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine(\"HtmlCrop\", [], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"HtmlCrop\"] = factory();\n\telse\n\t\troot[\"HtmlCrop\"] = factory();\n})(this, function() {\nreturn \n\n\n/** WEBPACK FOOTER **\n ** webpack/universalModuleDefinition\n **/","(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine(\"HtmlCrop\", [], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"HtmlCrop\"] = factory();\n\telse\n\t\troot[\"HtmlCrop\"] = factory();\n})(this, function() {\nreturn /******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId])\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\texports: {},\n/******/ \t\t\tid: moduleId,\n/******/ \t\t\tloaded: false\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.loaded = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"\";\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(0);\n/******/ })\n/************************************************************************/\n/******/ ([\n/* 0 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tvar _html2canvas = __webpack_require__(1);\n\t\n\tvar _html2canvas2 = _interopRequireDefault(_html2canvas);\n\t\n\tvar _baseObject = __webpack_require__(2);\n\t\n\tvar _baseObject2 = _interopRequireDefault(_baseObject);\n\t\n\tvar _canvasState = __webpack_require__(3);\n\t\n\tvar _canvasState2 = _interopRequireDefault(_canvasState);\n\t\n\tvar _previewModal = __webpack_require__(5);\n\t\n\tvar _previewModal2 = _interopRequireDefault(_previewModal);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\t\n\tfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\t\n\tvar defaultOptions = {\n\t  key: {\n\t    ctrlKey: false,\n\t    shiftKey: true,\n\t    key: 'F7'\n\t  },\n\t  serverURL: '',\n\t  startButton: true,\n\t  debug: true\n\t};\n\t\n\tvar HtmlCrop = function (_BaseObject) {\n\t  _inherits(HtmlCrop, _BaseObject);\n\t\n\t  /**\n\t   * object constructor\n\t   * @param {HTMLDocument} doc\n\t   * @param {Object} options\n\t   */\n\t  function HtmlCrop(doc) {\n\t    var options = arguments.length <= 1 || arguments[1] === undefined ? {} : arguments[1];\n\t\n\t    _classCallCheck(this, HtmlCrop);\n\t\n\t    var _this = _possibleConstructorReturn(this, (HtmlCrop.__proto__ || Object.getPrototypeOf(HtmlCrop)).call(this));\n\t\n\t    _this._document = doc;\n\t    _this.options = Object.assign({}, defaultOptions, options);\n\t    _this._debugMode = options.debug;\n\t    _this.log('initialized');\n\t\n\t    // bind this context into keydown event here\n\t    // because it needs to be removed later\n\t    _this._onKeyDown = _this._onKeyDown.bind(_this);\n\t\n\t    _this.reset();\n\t    return _this;\n\t  }\n\t\n\t  /**\n\t   * resets to starting state\n\t   */\n\t\n\t\n\t  _createClass(HtmlCrop, [{\n\t    key: 'reset',\n\t    value: function reset() {\n\t      this._listenHotKey();\n\t\n\t      if (this.options.startButton) {\n\t        this._attachStartButton();\n\t      }\n\t    }\n\t\n\t    /**\n\t     * starts cropping the page\n\t     */\n\t\n\t  }, {\n\t    key: 'startCropping',\n\t    value: function startCropping() {\n\t      var _this2 = this;\n\t\n\t      if (this._started) {\n\t        return;\n\t      }\n\t\n\t      this._started = true;\n\t      this._disableScroll();\n\t\n\t      (0, _html2canvas2.default)(this._document.html).then(function (canvas) {\n\t        _this2._canvas = canvas;\n\t\n\t        var selectionCanvas = _this2._document.createElement('canvas');\n\t        _this2._selectionCanvas = selectionCanvas;\n\t        selectionCanvas.width = canvas.width;\n\t        selectionCanvas.height = canvas.height;\n\t        selectionCanvas.style.position = 'fixed';\n\t        selectionCanvas.style.left = '0';\n\t        selectionCanvas.style.top = '0';\n\t        selectionCanvas.style['z-index'] = 9999997;\n\t\n\t        _this2._document.body.appendChild(selectionCanvas);\n\t\n\t        // debug mode is set as false because of lots of logging\n\t        _this2._attachCaptureButton();\n\t        _this2._canvasState = new _canvasState2.default(_this2._document, selectionCanvas, _this2._renderSelection.bind(_this2), true);\n\t\n\t        // removes start button and event listener to avoid multiple cropping instances\n\t        if (_this2._startButton) {\n\t          _this2._document.body.removeChild(_this2._startButton);\n\t        }\n\t        _this2._document.removeEventListener('keydown', _this2._onKeyDown);\n\t      });\n\t    }\n\t\n\t    /**\n\t     * ends cropping\n\t     */\n\t\n\t  }, {\n\t    key: 'endCropping',\n\t    value: function endCropping() {\n\t      if (!this._started) {\n\t        return;\n\t      }\n\t\n\t      this._started = false;\n\t      if (this._captureButton) {\n\t        this._document.body.removeChild(this._captureButton);\n\t        this._document.body.removeChild(this._cancelButton);\n\t        this._document.body.removeChild(this._infoDiv);\n\t      }\n\t\n\t      if (this._selectionCanvas) {\n\t        this._document.body.removeChild(this._selectionCanvas);\n\t      }\n\t\n\t      this.reset();\n\t    }\n\t\n\t    /**\n\t     * returns class name\n\t     * @returns {string}\n\t     */\n\t\n\t  }, {\n\t    key: 'getName',\n\t    value: function getName() {\n\t      return 'HtmlCrop';\n\t    }\n\t\n\t    /**\n\t     * attaches listener which triggers cropping\n\t     */\n\t\n\t  }, {\n\t    key: '_listenHotKey',\n\t    value: function _listenHotKey() {\n\t      this._document.addEventListener('keydown', this._onKeyDown);\n\t    }\n\t\n\t    /**\n\t     * attaches start cropping button\n\t     */\n\t\n\t  }, {\n\t    key: '_attachStartButton',\n\t    value: function _attachStartButton() {\n\t      var _document = this._document;\n\t\n\t      var button = _document.createElement('button');\n\t      var textNode = _document.createTextNode('Start Cropping');\n\t      button.appendChild(textNode);\n\t      button.style.position = 'fixed';\n\t      button.style.right = '30px';\n\t      button.style.bottom = '30px';\n\t      button.style['z-index'] = 9999997;\n\t      button.onclick = this.startCropping.bind(this);\n\t\n\t      this._startButton = button;\n\t      _document.body.appendChild(button);\n\t    }\n\t\n\t    /**\n\t     * attaches button to capture\n\t     * @private\n\t     */\n\t\n\t  }, {\n\t    key: '_attachCaptureButton',\n\t    value: function _attachCaptureButton() {\n\t      var _document = this._document;\n\t\n\t      var captureBtn = _document.createElement('button');\n\t      var textNode = _document.createTextNode('Capture');\n\t      captureBtn.appendChild(textNode);\n\t      captureBtn.style.position = 'fixed';\n\t      captureBtn.style.right = '30px';\n\t      captureBtn.style.bottom = '30px';\n\t      captureBtn.style['z-index'] = 9999997;\n\t      captureBtn.onclick = this._onCapture.bind(this);\n\t\n\t      this._captureButton = captureBtn;\n\t      _document.body.appendChild(captureBtn);\n\t\n\t      // appends cancel button on the left side of capture button\n\t      var cancelBtn = _document.createElement('button');\n\t      textNode = _document.createTextNode('Cancel');\n\t      cancelBtn.appendChild(textNode);\n\t      cancelBtn.style.position = 'fixed';\n\t      cancelBtn.style.right = '100px';\n\t      cancelBtn.style.bottom = '30px';\n\t      cancelBtn.style['z-index'] = 9999997;\n\t      cancelBtn.onclick = this.endCropping.bind(this);\n\t\n\t      this._cancelButton = cancelBtn;\n\t      _document.body.appendChild(cancelBtn);\n\t\n\t      // appends div for width and height of selection here as well\n\t      var infoDiv = _document.createElement('div');\n\t      infoDiv.style.position = 'fixed';\n\t      infoDiv.style.right = '30px';\n\t      infoDiv.style.bottom = '60px';\n\t      infoDiv.style.color = 'white';\n\t      infoDiv.style['z-index'] = 9999997;\n\t      this._infoDiv = infoDiv;\n\t      _document.body.appendChild(infoDiv);\n\t    }\n\t\n\t    /**\n\t     * renders modal window for previewing and compressing\n\t     * @param {HTMLDOMElement} canvas canvas contains cropped image\n\t     * @private\n\t     */\n\t\n\t  }, {\n\t    key: '_renderPreviewModal',\n\t    value: function _renderPreviewModal(canvas) {\n\t      this._previewModal = new _previewModal2.default(this._document, canvas, this.options.serverURL);\n\t    }\n\t\n\t    /**\n\t     * renders width and height of selection\n\t     */\n\t\n\t  }, {\n\t    key: '_renderSelection',\n\t    value: function _renderSelection(w, h) {\n\t      this._infoDiv.innerHTML = 'w: ' + Math.round(w) + ', h: ' + Math.round(h);\n\t    }\n\t\n\t    /*\n\t     * handles key down for hot key capturing\n\t     * @param {KeyboardEvent} event\n\t     */\n\t\n\t  }, {\n\t    key: '_onKeyDown',\n\t    value: function _onKeyDown(event) {\n\t      var key = event.key;\n\t      var ctrlKey = event.ctrlKey;\n\t      var shiftKey = event.shiftKey;\n\t      var keyOptions = this.options.key;\n\t\n\t\n\t      this.log('keydown detected: ctrl=' + ctrlKey + ' shift=' + shiftKey + ' key=' + key);\n\t\n\t      if (key === keyOptions.key && ctrlKey === keyOptions.ctrlKey && keyOptions.shiftKey) {\n\t        this.log('key down matches with setting. starts cropping');\n\t        this.startCropping();\n\t      }\n\t    }\n\t\n\t    /**\n\t     * capture button click handler\n\t     * @private\n\t     */\n\t\n\t  }, {\n\t    key: '_onCapture',\n\t    value: function _onCapture() {\n\t      var ctx = this._canvas.getContext('2d');\n\t      var selection = this._canvasState.getSelection();\n\t      var imgData = ctx.getImageData(selection.x, selection.y, selection.w, selection.h);\n\t\n\t      var newCanvas = this._document.createElement('canvas');\n\t      newCanvas.width = selection.w;\n\t      newCanvas.height = selection.h;\n\t      var newCtx = newCanvas.getContext('2d');\n\t      newCtx.putImageData(imgData, 0, 0);\n\t\n\t      this._enableScroll();\n\t\n\t      this._renderPreviewModal(newCanvas);\n\t      this.endCropping();\n\t    }\n\t\n\t    /**\n\t     * disables scrolling temporaily\n\t     * @private\n\t     */\n\t\n\t  }, {\n\t    key: '_disableScroll',\n\t    value: function _disableScroll() {\n\t      var preventDefault = function preventDefault() {\n\t        var e = arguments.length <= 0 || arguments[0] === undefined ? {} : arguments[0];\n\t\n\t        if (e.preventDefault) {\n\t          e.preventDefault();\n\t        }\n\t        e.returnValue = false; // eslint-disable-line\n\t      };\n\t\n\t      // disable scrolling with keys\n\t      // left: 37, up: 38, right: 39, down: 40,\n\t      // spacebar: 32, pageup: 33, pagedown: 34, end: 35, home: 36\n\t      var preventDefaultForScrollKeys = function preventDefaultForScrollKeys(e) {\n\t        var keys = [32, 33, 34, 35, 36, 37, 38, 39, 40];\n\t        if (keys.indexOf(e.keyCode) !== -1) {\n\t          preventDefault(e);\n\t          return false;\n\t        }\n\t        return true;\n\t      };\n\t\n\t      this._document.onkeydown = preventDefaultForScrollKeys;\n\t      this._document.onmousewheel = preventDefault;\n\t    }\n\t\n\t    /**\n\t     * enables scrolling\n\t     * @private\n\t     */\n\t\n\t  }, {\n\t    key: '_enableScroll',\n\t    value: function _enableScroll() {\n\t      this._document.onkeydown = null;\n\t      this._document.onmousewheel = null;\n\t    }\n\t  }]);\n\t\n\t  return HtmlCrop;\n\t}(_baseObject2.default);\n\t\n\texports.default = HtmlCrop;\n\tmodule.exports = exports['default'];\n\n/***/ },\n/* 1 */\n/***/ function(module, exports, __webpack_require__) {\n\n\tvar __WEBPACK_AMD_DEFINE_FACTORY__, __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;var require;var require;/* WEBPACK VAR INJECTION */(function(global) {\"use strict\";var _typeof=typeof Symbol===\"function\"&&typeof Symbol.iterator===\"symbol\"?function(obj){return typeof obj;}:function(obj){return obj&&typeof Symbol===\"function\"&&obj.constructor===Symbol?\"symbol\":typeof obj;};/*\n\t  html2canvas 0.5.0-beta4 <http://html2canvas.hertzen.com>\n\t  Copyright (c) 2016 Niklas von Hertzen\n\t\n\t  Released under  License\n\t*/(function(f){if(( false?\"undefined\":_typeof(exports))===\"object\"&&typeof module!==\"undefined\"){module.exports=f();}else if(true){!(__WEBPACK_AMD_DEFINE_ARRAY__ = [], __WEBPACK_AMD_DEFINE_FACTORY__ = (f), __WEBPACK_AMD_DEFINE_RESULT__ = (typeof __WEBPACK_AMD_DEFINE_FACTORY__ === 'function' ? (__WEBPACK_AMD_DEFINE_FACTORY__.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__)) : __WEBPACK_AMD_DEFINE_FACTORY__), __WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));}else{var g;if(typeof window!==\"undefined\"){g=window;}else if(typeof global!==\"undefined\"){g=global;}else if(typeof self!==\"undefined\"){g=self;}else{g=this;}g.html2canvas=f();}})(function(){var define,module,exports;return function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return require(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f;}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e);},l,l.exports,e,t,n,r);}return n[o].exports;}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++){s(r[o]);}return s;}({1:[function(_dereq_,module,exports){(function(global){/*! https://mths.be/punycode v1.4.0 by @mathias */;(function(root){/** Detect free variables */var freeExports=(typeof exports===\"undefined\"?\"undefined\":_typeof(exports))=='object'&&exports&&!exports.nodeType&&exports;var freeModule=(typeof module===\"undefined\"?\"undefined\":_typeof(module))=='object'&&module&&!module.nodeType&&module;var freeGlobal=(typeof global===\"undefined\"?\"undefined\":_typeof(global))=='object'&&global;if(freeGlobal.global===freeGlobal||freeGlobal.window===freeGlobal||freeGlobal.self===freeGlobal){root=freeGlobal;}/**\n\t\t * The `punycode` object.\n\t\t * @name punycode\n\t\t * @type Object\n\t\t */var punycode,/** Highest positive signed 32-bit float value */maxInt=2147483647,// aka. 0x7FFFFFFF or 2^31-1\n\t/** Bootstring parameters */base=36,tMin=1,tMax=26,skew=38,damp=700,initialBias=72,initialN=128,// 0x80\n\tdelimiter='-',// '\\x2D'\n\t/** Regular expressions */regexPunycode=/^xn--/,regexNonASCII=/[^\\x20-\\x7E]/,// unprintable ASCII chars + non-ASCII chars\n\tregexSeparators=/[\\x2E\\u3002\\uFF0E\\uFF61]/g,// RFC 3490 separators\n\t/** Error messages */errors={'overflow':'Overflow: input needs wider integers to process','not-basic':'Illegal input >= 0x80 (not a basic code point)','invalid-input':'Invalid input'},/** Convenience shortcuts */baseMinusTMin=base-tMin,floor=Math.floor,stringFromCharCode=String.fromCharCode,/** Temporary variable */key;/*--------------------------------------------------------------------------*//**\n\t\t * A generic error utility function.\n\t\t * @private\n\t\t * @param {String} type The error type.\n\t\t * @returns {Error} Throws a `RangeError` with the applicable error message.\n\t\t */function error(type){throw new RangeError(errors[type]);}/**\n\t\t * A generic `Array#map` utility function.\n\t\t * @private\n\t\t * @param {Array} array The array to iterate over.\n\t\t * @param {Function} callback The function that gets called for every array\n\t\t * item.\n\t\t * @returns {Array} A new array of values returned by the callback function.\n\t\t */function map(array,fn){var length=array.length;var result=[];while(length--){result[length]=fn(array[length]);}return result;}/**\n\t\t * A simple `Array#map`-like wrapper to work with domain name strings or email\n\t\t * addresses.\n\t\t * @private\n\t\t * @param {String} domain The domain name or email address.\n\t\t * @param {Function} callback The function that gets called for every\n\t\t * character.\n\t\t * @returns {Array} A new string of characters returned by the callback\n\t\t * function.\n\t\t */function mapDomain(string,fn){var parts=string.split('@');var result='';if(parts.length>1){// In email addresses, only the domain name should be punycoded. Leave\n\t// the local part (i.e. everything up to `@`) intact.\n\tresult=parts[0]+'@';string=parts[1];}// Avoid `split(regex)` for IE8 compatibility. See #17.\n\tstring=string.replace(regexSeparators,'\\x2E');var labels=string.split('.');var encoded=map(labels,fn).join('.');return result+encoded;}/**\n\t\t * Creates an array containing the numeric code points of each Unicode\n\t\t * character in the string. While JavaScript uses UCS-2 internally,\n\t\t * this function will convert a pair of surrogate halves (each of which\n\t\t * UCS-2 exposes as separate characters) into a single code point,\n\t\t * matching UTF-16.\n\t\t * @see `punycode.ucs2.encode`\n\t\t * @see <https://mathiasbynens.be/notes/javascript-encoding>\n\t\t * @memberOf punycode.ucs2\n\t\t * @name decode\n\t\t * @param {String} string The Unicode input string (UCS-2).\n\t\t * @returns {Array} The new array of code points.\n\t\t */function ucs2decode(string){var output=[],counter=0,length=string.length,value,extra;while(counter<length){value=string.charCodeAt(counter++);if(value>=0xD800&&value<=0xDBFF&&counter<length){// high surrogate, and there is a next character\n\textra=string.charCodeAt(counter++);if((extra&0xFC00)==0xDC00){// low surrogate\n\toutput.push(((value&0x3FF)<<10)+(extra&0x3FF)+0x10000);}else{// unmatched surrogate; only append this code unit, in case the next\n\t// code unit is the high surrogate of a surrogate pair\n\toutput.push(value);counter--;}}else{output.push(value);}}return output;}/**\n\t\t * Creates a string based on an array of numeric code points.\n\t\t * @see `punycode.ucs2.decode`\n\t\t * @memberOf punycode.ucs2\n\t\t * @name encode\n\t\t * @param {Array} codePoints The array of numeric code points.\n\t\t * @returns {String} The new Unicode string (UCS-2).\n\t\t */function ucs2encode(array){return map(array,function(value){var output='';if(value>0xFFFF){value-=0x10000;output+=stringFromCharCode(value>>>10&0x3FF|0xD800);value=0xDC00|value&0x3FF;}output+=stringFromCharCode(value);return output;}).join('');}/**\n\t\t * Converts a basic code point into a digit/integer.\n\t\t * @see `digitToBasic()`\n\t\t * @private\n\t\t * @param {Number} codePoint The basic numeric code point value.\n\t\t * @returns {Number} The numeric value of a basic code point (for use in\n\t\t * representing integers) in the range `0` to `base - 1`, or `base` if\n\t\t * the code point does not represent a value.\n\t\t */function basicToDigit(codePoint){if(codePoint-48<10){return codePoint-22;}if(codePoint-65<26){return codePoint-65;}if(codePoint-97<26){return codePoint-97;}return base;}/**\n\t\t * Converts a digit/integer into a basic code point.\n\t\t * @see `basicToDigit()`\n\t\t * @private\n\t\t * @param {Number} digit The numeric value of a basic code point.\n\t\t * @returns {Number} The basic code point whose value (when used for\n\t\t * representing integers) is `digit`, which needs to be in the range\n\t\t * `0` to `base - 1`. If `flag` is non-zero, the uppercase form is\n\t\t * used; else, the lowercase form is used. The behavior is undefined\n\t\t * if `flag` is non-zero and `digit` has no uppercase form.\n\t\t */function digitToBasic(digit,flag){//  0..25 map to ASCII a..z or A..Z\n\t// 26..35 map to ASCII 0..9\n\treturn digit+22+75*(digit<26)-((flag!=0)<<5);}/**\n\t\t * Bias adaptation function as per section 3.4 of RFC 3492.\n\t\t * https://tools.ietf.org/html/rfc3492#section-3.4\n\t\t * @private\n\t\t */function adapt(delta,numPoints,firstTime){var k=0;delta=firstTime?floor(delta/damp):delta>>1;delta+=floor(delta/numPoints);for(;/* no initialization */delta>baseMinusTMin*tMax>>1;k+=base){delta=floor(delta/baseMinusTMin);}return floor(k+(baseMinusTMin+1)*delta/(delta+skew));}/**\n\t\t * Converts a Punycode string of ASCII-only symbols to a string of Unicode\n\t\t * symbols.\n\t\t * @memberOf punycode\n\t\t * @param {String} input The Punycode string of ASCII-only symbols.\n\t\t * @returns {String} The resulting string of Unicode symbols.\n\t\t */function decode(input){// Don't use UCS-2\n\tvar output=[],inputLength=input.length,out,i=0,n=initialN,bias=initialBias,basic,j,index,oldi,w,k,digit,t,/** Cached calculation results */baseMinusT;// Handle the basic code points: let `basic` be the number of input code\n\t// points before the last delimiter, or `0` if there is none, then copy\n\t// the first basic code points to the output.\n\tbasic=input.lastIndexOf(delimiter);if(basic<0){basic=0;}for(j=0;j<basic;++j){// if it's not a basic code point\n\tif(input.charCodeAt(j)>=0x80){error('not-basic');}output.push(input.charCodeAt(j));}// Main decoding loop: start just after the last delimiter if any basic code\n\t// points were copied; start at the beginning otherwise.\n\tfor(index=basic>0?basic+1:0;index<inputLength;)/* no final expression */{// `index` is the index of the next character to be consumed.\n\t// Decode a generalized variable-length integer into `delta`,\n\t// which gets added to `i`. The overflow checking is easier\n\t// if we increase `i` as we go, then subtract off its starting\n\t// value at the end to obtain `delta`.\n\tfor(oldi=i,w=1,k=base;;/* no condition */k+=base){if(index>=inputLength){error('invalid-input');}digit=basicToDigit(input.charCodeAt(index++));if(digit>=base||digit>floor((maxInt-i)/w)){error('overflow');}i+=digit*w;t=k<=bias?tMin:k>=bias+tMax?tMax:k-bias;if(digit<t){break;}baseMinusT=base-t;if(w>floor(maxInt/baseMinusT)){error('overflow');}w*=baseMinusT;}out=output.length+1;bias=adapt(i-oldi,out,oldi==0);// `i` was supposed to wrap around from `out` to `0`,\n\t// incrementing `n` each time, so we'll fix that now:\n\tif(floor(i/out)>maxInt-n){error('overflow');}n+=floor(i/out);i%=out;// Insert `n` at position `i` of the output\n\toutput.splice(i++,0,n);}return ucs2encode(output);}/**\n\t\t * Converts a string of Unicode symbols (e.g. a domain name label) to a\n\t\t * Punycode string of ASCII-only symbols.\n\t\t * @memberOf punycode\n\t\t * @param {String} input The string of Unicode symbols.\n\t\t * @returns {String} The resulting Punycode string of ASCII-only symbols.\n\t\t */function encode(input){var n,delta,handledCPCount,basicLength,bias,j,m,q,k,t,currentValue,output=[],/** `inputLength` will hold the number of code points in `input`. */inputLength,/** Cached calculation results */handledCPCountPlusOne,baseMinusT,qMinusT;// Convert the input in UCS-2 to Unicode\n\tinput=ucs2decode(input);// Cache the length\n\tinputLength=input.length;// Initialize the state\n\tn=initialN;delta=0;bias=initialBias;// Handle the basic code points\n\tfor(j=0;j<inputLength;++j){currentValue=input[j];if(currentValue<0x80){output.push(stringFromCharCode(currentValue));}}handledCPCount=basicLength=output.length;// `handledCPCount` is the number of code points that have been handled;\n\t// `basicLength` is the number of basic code points.\n\t// Finish the basic string - if it is not empty - with a delimiter\n\tif(basicLength){output.push(delimiter);}// Main encoding loop:\n\twhile(handledCPCount<inputLength){// All non-basic code points < n have been handled already. Find the next\n\t// larger one:\n\tfor(m=maxInt,j=0;j<inputLength;++j){currentValue=input[j];if(currentValue>=n&&currentValue<m){m=currentValue;}}// Increase `delta` enough to advance the decoder's <n,i> state to <m,0>,\n\t// but guard against overflow\n\thandledCPCountPlusOne=handledCPCount+1;if(m-n>floor((maxInt-delta)/handledCPCountPlusOne)){error('overflow');}delta+=(m-n)*handledCPCountPlusOne;n=m;for(j=0;j<inputLength;++j){currentValue=input[j];if(currentValue<n&&++delta>maxInt){error('overflow');}if(currentValue==n){// Represent delta as a generalized variable-length integer\n\tfor(q=delta,k=base;;/* no condition */k+=base){t=k<=bias?tMin:k>=bias+tMax?tMax:k-bias;if(q<t){break;}qMinusT=q-t;baseMinusT=base-t;output.push(stringFromCharCode(digitToBasic(t+qMinusT%baseMinusT,0)));q=floor(qMinusT/baseMinusT);}output.push(stringFromCharCode(digitToBasic(q,0)));bias=adapt(delta,handledCPCountPlusOne,handledCPCount==basicLength);delta=0;++handledCPCount;}}++delta;++n;}return output.join('');}/**\n\t\t * Converts a Punycode string representing a domain name or an email address\n\t\t * to Unicode. Only the Punycoded parts of the input will be converted, i.e.\n\t\t * it doesn't matter if you call it on a string that has already been\n\t\t * converted to Unicode.\n\t\t * @memberOf punycode\n\t\t * @param {String} input The Punycoded domain name or email address to\n\t\t * convert to Unicode.\n\t\t * @returns {String} The Unicode representation of the given Punycode\n\t\t * string.\n\t\t */function toUnicode(input){return mapDomain(input,function(string){return regexPunycode.test(string)?decode(string.slice(4).toLowerCase()):string;});}/**\n\t\t * Converts a Unicode string representing a domain name or an email address to\n\t\t * Punycode. Only the non-ASCII parts of the domain name will be converted,\n\t\t * i.e. it doesn't matter if you call it with a domain that's already in\n\t\t * ASCII.\n\t\t * @memberOf punycode\n\t\t * @param {String} input The domain name or email address to convert, as a\n\t\t * Unicode string.\n\t\t * @returns {String} The Punycode representation of the given domain name or\n\t\t * email address.\n\t\t */function toASCII(input){return mapDomain(input,function(string){return regexNonASCII.test(string)?'xn--'+encode(string):string;});}/*--------------------------------------------------------------------------*//** Define the public API */punycode={/**\n\t\t\t * A string representing the current Punycode.js version number.\n\t\t\t * @memberOf punycode\n\t\t\t * @type String\n\t\t\t */'version':'1.3.2',/**\n\t\t\t * An object of methods to convert from JavaScript's internal character\n\t\t\t * representation (UCS-2) to Unicode code points, and back.\n\t\t\t * @see <https://mathiasbynens.be/notes/javascript-encoding>\n\t\t\t * @memberOf punycode\n\t\t\t * @type Object\n\t\t\t */'ucs2':{'decode':ucs2decode,'encode':ucs2encode},'decode':decode,'encode':encode,'toASCII':toASCII,'toUnicode':toUnicode};/** Expose `punycode` */// Some AMD build optimizers, like r.js, check for specific condition patterns\n\t// like the following:\n\tif(typeof define=='function'&&_typeof(define.amd)=='object'&&define.amd){define('punycode',function(){return punycode;});}else if(freeExports&&freeModule){if(module.exports==freeExports){// in Node.js, io.js, or RingoJS v0.8.0+\n\tfreeModule.exports=punycode;}else{// in Narwhal or RingoJS v0.7.0-\n\tfor(key in punycode){punycode.hasOwnProperty(key)&&(freeExports[key]=punycode[key]);}}}else{// in Rhino or a web browser\n\troot.punycode=punycode;}})(this);}).call(this,typeof global!==\"undefined\"?global:typeof self!==\"undefined\"?self:typeof window!==\"undefined\"?window:{});},{}],2:[function(_dereq_,module,exports){var log=_dereq_('./log');function restoreOwnerScroll(ownerDocument,x,y){if(ownerDocument.defaultView&&(x!==ownerDocument.defaultView.pageXOffset||y!==ownerDocument.defaultView.pageYOffset)){ownerDocument.defaultView.scrollTo(x,y);}}function cloneCanvasContents(canvas,clonedCanvas){try{if(clonedCanvas){clonedCanvas.width=canvas.width;clonedCanvas.height=canvas.height;clonedCanvas.getContext(\"2d\").putImageData(canvas.getContext(\"2d\").getImageData(0,0,canvas.width,canvas.height),0,0);}}catch(e){log(\"Unable to copy canvas content from\",canvas,e);}}function cloneNode(node,javascriptEnabled){var clone=node.nodeType===3?document.createTextNode(node.nodeValue):node.cloneNode(false);var child=node.firstChild;while(child){if(javascriptEnabled===true||child.nodeType!==1||child.nodeName!=='SCRIPT'){clone.appendChild(cloneNode(child,javascriptEnabled));}child=child.nextSibling;}if(node.nodeType===1){clone._scrollTop=node.scrollTop;clone._scrollLeft=node.scrollLeft;if(node.nodeName===\"CANVAS\"){cloneCanvasContents(node,clone);}else if(node.nodeName===\"TEXTAREA\"||node.nodeName===\"SELECT\"){clone.value=node.value;}}return clone;}function initNode(node){if(node.nodeType===1){node.scrollTop=node._scrollTop;node.scrollLeft=node._scrollLeft;var child=node.firstChild;while(child){initNode(child);child=child.nextSibling;}}}module.exports=function(ownerDocument,containerDocument,width,height,options,x,y){var documentElement=cloneNode(ownerDocument.documentElement,options.javascriptEnabled);var container=containerDocument.createElement(\"iframe\");container.className=\"html2canvas-container\";container.style.visibility=\"hidden\";container.style.position=\"fixed\";container.style.left=\"-10000px\";container.style.top=\"0px\";container.style.border=\"0\";container.width=width;container.height=height;container.scrolling=\"no\";// ios won't scroll without it\n\tcontainerDocument.body.appendChild(container);return new Promise(function(resolve){var documentClone=container.contentWindow.document;/* Chrome doesn't detect relative background-images assigned in inline <style> sheets when fetched through getComputedStyle\n\t         if window url is about:blank, we can assign the url to current by writing onto the document\n\t         */container.contentWindow.onload=container.onload=function(){var interval=setInterval(function(){if(documentClone.body.childNodes.length>0){initNode(documentClone.documentElement);clearInterval(interval);if(options.type===\"view\"){container.contentWindow.scrollTo(x,y);if(/(iPad|iPhone|iPod)/g.test(navigator.userAgent)&&(container.contentWindow.scrollY!==y||container.contentWindow.scrollX!==x)){documentClone.documentElement.style.top=-y+\"px\";documentClone.documentElement.style.left=-x+\"px\";documentClone.documentElement.style.position='absolute';}}resolve(container);}},50);};documentClone.open();documentClone.write(\"<!DOCTYPE html><html></html>\");// Chrome scrolls the parent document for some reason after the write to the cloned window???\n\trestoreOwnerScroll(ownerDocument,x,y);documentClone.replaceChild(documentClone.adoptNode(documentElement),documentClone.documentElement);documentClone.close();});};},{\"./log\":13}],3:[function(_dereq_,module,exports){// http://dev.w3.org/csswg/css-color/\n\tfunction Color(value){this.r=0;this.g=0;this.b=0;this.a=null;var result=this.fromArray(value)||this.namedColor(value)||this.rgb(value)||this.rgba(value)||this.hex6(value)||this.hex3(value);}Color.prototype.darken=function(amount){var a=1-amount;return new Color([Math.round(this.r*a),Math.round(this.g*a),Math.round(this.b*a),this.a]);};Color.prototype.isTransparent=function(){return this.a===0;};Color.prototype.isBlack=function(){return this.r===0&&this.g===0&&this.b===0;};Color.prototype.fromArray=function(array){if(Array.isArray(array)){this.r=Math.min(array[0],255);this.g=Math.min(array[1],255);this.b=Math.min(array[2],255);if(array.length>3){this.a=array[3];}}return Array.isArray(array);};var _hex3=/^#([a-f0-9]{3})$/i;Color.prototype.hex3=function(value){var match=null;if((match=value.match(_hex3))!==null){this.r=parseInt(match[1][0]+match[1][0],16);this.g=parseInt(match[1][1]+match[1][1],16);this.b=parseInt(match[1][2]+match[1][2],16);}return match!==null;};var _hex6=/^#([a-f0-9]{6})$/i;Color.prototype.hex6=function(value){var match=null;if((match=value.match(_hex6))!==null){this.r=parseInt(match[1].substring(0,2),16);this.g=parseInt(match[1].substring(2,4),16);this.b=parseInt(match[1].substring(4,6),16);}return match!==null;};var _rgb=/^rgb\\(\\s*(\\d{1,3})\\s*,\\s*(\\d{1,3})\\s*,\\s*(\\d{1,3})\\s*\\)$/;Color.prototype.rgb=function(value){var match=null;if((match=value.match(_rgb))!==null){this.r=Number(match[1]);this.g=Number(match[2]);this.b=Number(match[3]);}return match!==null;};var _rgba=/^rgba\\(\\s*(\\d{1,3})\\s*,\\s*(\\d{1,3})\\s*,\\s*(\\d{1,3})\\s*,\\s*(\\d?\\.?\\d+)\\s*\\)$/;Color.prototype.rgba=function(value){var match=null;if((match=value.match(_rgba))!==null){this.r=Number(match[1]);this.g=Number(match[2]);this.b=Number(match[3]);this.a=Number(match[4]);}return match!==null;};Color.prototype.toString=function(){return this.a!==null&&this.a!==1?\"rgba(\"+[this.r,this.g,this.b,this.a].join(\",\")+\")\":\"rgb(\"+[this.r,this.g,this.b].join(\",\")+\")\";};Color.prototype.namedColor=function(value){value=value.toLowerCase();var color=colors[value];if(color){this.r=color[0];this.g=color[1];this.b=color[2];}else if(value===\"transparent\"){this.r=this.g=this.b=this.a=0;return true;}return!!color;};Color.prototype.isColor=true;// JSON.stringify([].slice.call($$('.named-color-table tr'), 1).map(function(row) { return [row.childNodes[3].textContent, row.childNodes[5].textContent.trim().split(\",\").map(Number)] }).reduce(function(data, row) {data[row[0]] = row[1]; return data}, {}))\n\tvar colors={\"aliceblue\":[240,248,255],\"antiquewhite\":[250,235,215],\"aqua\":[0,255,255],\"aquamarine\":[127,255,212],\"azure\":[240,255,255],\"beige\":[245,245,220],\"bisque\":[255,228,196],\"black\":[0,0,0],\"blanchedalmond\":[255,235,205],\"blue\":[0,0,255],\"blueviolet\":[138,43,226],\"brown\":[165,42,42],\"burlywood\":[222,184,135],\"cadetblue\":[95,158,160],\"chartreuse\":[127,255,0],\"chocolate\":[210,105,30],\"coral\":[255,127,80],\"cornflowerblue\":[100,149,237],\"cornsilk\":[255,248,220],\"crimson\":[220,20,60],\"cyan\":[0,255,255],\"darkblue\":[0,0,139],\"darkcyan\":[0,139,139],\"darkgoldenrod\":[184,134,11],\"darkgray\":[169,169,169],\"darkgreen\":[0,100,0],\"darkgrey\":[169,169,169],\"darkkhaki\":[189,183,107],\"darkmagenta\":[139,0,139],\"darkolivegreen\":[85,107,47],\"darkorange\":[255,140,0],\"darkorchid\":[153,50,204],\"darkred\":[139,0,0],\"darksalmon\":[233,150,122],\"darkseagreen\":[143,188,143],\"darkslateblue\":[72,61,139],\"darkslategray\":[47,79,79],\"darkslategrey\":[47,79,79],\"darkturquoise\":[0,206,209],\"darkviolet\":[148,0,211],\"deeppink\":[255,20,147],\"deepskyblue\":[0,191,255],\"dimgray\":[105,105,105],\"dimgrey\":[105,105,105],\"dodgerblue\":[30,144,255],\"firebrick\":[178,34,34],\"floralwhite\":[255,250,240],\"forestgreen\":[34,139,34],\"fuchsia\":[255,0,255],\"gainsboro\":[220,220,220],\"ghostwhite\":[248,248,255],\"gold\":[255,215,0],\"goldenrod\":[218,165,32],\"gray\":[128,128,128],\"green\":[0,128,0],\"greenyellow\":[173,255,47],\"grey\":[128,128,128],\"honeydew\":[240,255,240],\"hotpink\":[255,105,180],\"indianred\":[205,92,92],\"indigo\":[75,0,130],\"ivory\":[255,255,240],\"khaki\":[240,230,140],\"lavender\":[230,230,250],\"lavenderblush\":[255,240,245],\"lawngreen\":[124,252,0],\"lemonchiffon\":[255,250,205],\"lightblue\":[173,216,230],\"lightcoral\":[240,128,128],\"lightcyan\":[224,255,255],\"lightgoldenrodyellow\":[250,250,210],\"lightgray\":[211,211,211],\"lightgreen\":[144,238,144],\"lightgrey\":[211,211,211],\"lightpink\":[255,182,193],\"lightsalmon\":[255,160,122],\"lightseagreen\":[32,178,170],\"lightskyblue\":[135,206,250],\"lightslategray\":[119,136,153],\"lightslategrey\":[119,136,153],\"lightsteelblue\":[176,196,222],\"lightyellow\":[255,255,224],\"lime\":[0,255,0],\"limegreen\":[50,205,50],\"linen\":[250,240,230],\"magenta\":[255,0,255],\"maroon\":[128,0,0],\"mediumaquamarine\":[102,205,170],\"mediumblue\":[0,0,205],\"mediumorchid\":[186,85,211],\"mediumpurple\":[147,112,219],\"mediumseagreen\":[60,179,113],\"mediumslateblue\":[123,104,238],\"mediumspringgreen\":[0,250,154],\"mediumturquoise\":[72,209,204],\"mediumvioletred\":[199,21,133],\"midnightblue\":[25,25,112],\"mintcream\":[245,255,250],\"mistyrose\":[255,228,225],\"moccasin\":[255,228,181],\"navajowhite\":[255,222,173],\"navy\":[0,0,128],\"oldlace\":[253,245,230],\"olive\":[128,128,0],\"olivedrab\":[107,142,35],\"orange\":[255,165,0],\"orangered\":[255,69,0],\"orchid\":[218,112,214],\"palegoldenrod\":[238,232,170],\"palegreen\":[152,251,152],\"paleturquoise\":[175,238,238],\"palevioletred\":[219,112,147],\"papayawhip\":[255,239,213],\"peachpuff\":[255,218,185],\"peru\":[205,133,63],\"pink\":[255,192,203],\"plum\":[221,160,221],\"powderblue\":[176,224,230],\"purple\":[128,0,128],\"rebeccapurple\":[102,51,153],\"red\":[255,0,0],\"rosybrown\":[188,143,143],\"royalblue\":[65,105,225],\"saddlebrown\":[139,69,19],\"salmon\":[250,128,114],\"sandybrown\":[244,164,96],\"seagreen\":[46,139,87],\"seashell\":[255,245,238],\"sienna\":[160,82,45],\"silver\":[192,192,192],\"skyblue\":[135,206,235],\"slateblue\":[106,90,205],\"slategray\":[112,128,144],\"slategrey\":[112,128,144],\"snow\":[255,250,250],\"springgreen\":[0,255,127],\"steelblue\":[70,130,180],\"tan\":[210,180,140],\"teal\":[0,128,128],\"thistle\":[216,191,216],\"tomato\":[255,99,71],\"turquoise\":[64,224,208],\"violet\":[238,130,238],\"wheat\":[245,222,179],\"white\":[255,255,255],\"whitesmoke\":[245,245,245],\"yellow\":[255,255,0],\"yellowgreen\":[154,205,50]};module.exports=Color;},{}],4:[function(_dereq_,module,exports){var Support=_dereq_('./support');var CanvasRenderer=_dereq_('./renderers/canvas');var ImageLoader=_dereq_('./imageloader');var NodeParser=_dereq_('./nodeparser');var NodeContainer=_dereq_('./nodecontainer');var log=_dereq_('./log');var utils=_dereq_('./utils');var createWindowClone=_dereq_('./clone');var loadUrlDocument=_dereq_('./proxy').loadUrlDocument;var getBounds=utils.getBounds;var html2canvasNodeAttribute=\"data-html2canvas-node\";var html2canvasCloneIndex=0;function html2canvas(nodeList,options){var index=html2canvasCloneIndex++;options=options||{};if(options.logging){log.options.logging=true;log.options.start=Date.now();}options.async=typeof options.async===\"undefined\"?true:options.async;options.allowTaint=typeof options.allowTaint===\"undefined\"?false:options.allowTaint;options.removeContainer=typeof options.removeContainer===\"undefined\"?true:options.removeContainer;options.javascriptEnabled=typeof options.javascriptEnabled===\"undefined\"?false:options.javascriptEnabled;options.imageTimeout=typeof options.imageTimeout===\"undefined\"?10000:options.imageTimeout;options.renderer=typeof options.renderer===\"function\"?options.renderer:CanvasRenderer;options.strict=!!options.strict;if(typeof nodeList===\"string\"){if(typeof options.proxy!==\"string\"){return Promise.reject(\"Proxy must be used when rendering url\");}var width=options.width!=null?options.width:window.innerWidth;var height=options.height!=null?options.height:window.innerHeight;return loadUrlDocument(absoluteUrl(nodeList),options.proxy,document,width,height,options).then(function(container){return renderWindow(container.contentWindow.document.documentElement,container,options,width,height);});}var node=(nodeList===undefined?[document.documentElement]:nodeList.length?nodeList:[nodeList])[0];node.setAttribute(html2canvasNodeAttribute+index,index);return renderDocument(node.ownerDocument,options,node.ownerDocument.defaultView.innerWidth,node.ownerDocument.defaultView.innerHeight,index).then(function(canvas){if(typeof options.onrendered===\"function\"){log(\"options.onrendered is deprecated, html2canvas returns a Promise containing the canvas\");options.onrendered(canvas);}return canvas;});}html2canvas.CanvasRenderer=CanvasRenderer;html2canvas.NodeContainer=NodeContainer;html2canvas.log=log;html2canvas.utils=utils;var html2canvasExport=typeof document===\"undefined\"||typeof Object.create!==\"function\"||typeof document.createElement(\"canvas\").getContext!==\"function\"?function(){return Promise.reject(\"No canvas support\");}:html2canvas;module.exports=html2canvasExport;if(typeof define==='function'&&define.amd){define('html2canvas',[],function(){return html2canvasExport;});}function renderDocument(document,options,windowWidth,windowHeight,html2canvasIndex){return createWindowClone(document,document,windowWidth,windowHeight,options,document.defaultView.pageXOffset,document.defaultView.pageYOffset).then(function(container){log(\"Document cloned\");var attributeName=html2canvasNodeAttribute+html2canvasIndex;var selector=\"[\"+attributeName+\"='\"+html2canvasIndex+\"']\";document.querySelector(selector).removeAttribute(attributeName);var clonedWindow=container.contentWindow;var node=clonedWindow.document.querySelector(selector);var oncloneHandler=typeof options.onclone===\"function\"?Promise.resolve(options.onclone(clonedWindow.document)):Promise.resolve(true);return oncloneHandler.then(function(){return renderWindow(node,container,options,windowWidth,windowHeight);});});}function renderWindow(node,container,options,windowWidth,windowHeight){var clonedWindow=container.contentWindow;var support=new Support(clonedWindow.document);var imageLoader=new ImageLoader(options,support);var bounds=getBounds(node);var width=options.type===\"view\"?windowWidth:documentWidth(clonedWindow.document);var height=options.type===\"view\"?windowHeight:documentHeight(clonedWindow.document);var renderer=new options.renderer(width,height,imageLoader,options,document);var parser=new NodeParser(node,renderer,support,imageLoader,options);return parser.ready.then(function(){log(\"Finished rendering\");var canvas;if(options.type===\"view\"){canvas=crop(renderer.canvas,{width:renderer.canvas.width,height:renderer.canvas.height,top:0,left:0,x:0,y:0});}else if(node===clonedWindow.document.body||node===clonedWindow.document.documentElement||options.canvas!=null){canvas=renderer.canvas;}else{canvas=crop(renderer.canvas,{width:options.width!=null?options.width:bounds.width,height:options.height!=null?options.height:bounds.height,top:bounds.top,left:bounds.left,x:0,y:0});}cleanupContainer(container,options);return canvas;});}function cleanupContainer(container,options){if(options.removeContainer){container.parentNode.removeChild(container);log(\"Cleaned up container\");}}function crop(canvas,bounds){var croppedCanvas=document.createElement(\"canvas\");var x1=Math.min(canvas.width-1,Math.max(0,bounds.left));var x2=Math.min(canvas.width,Math.max(1,bounds.left+bounds.width));var y1=Math.min(canvas.height-1,Math.max(0,bounds.top));var y2=Math.min(canvas.height,Math.max(1,bounds.top+bounds.height));croppedCanvas.width=bounds.width;croppedCanvas.height=bounds.height;var width=x2-x1;var height=y2-y1;log(\"Cropping canvas at:\",\"left:\",bounds.left,\"top:\",bounds.top,\"width:\",width,\"height:\",height);log(\"Resulting crop with width\",bounds.width,\"and height\",bounds.height,\"with x\",x1,\"and y\",y1);croppedCanvas.getContext(\"2d\").drawImage(canvas,x1,y1,width,height,bounds.x,bounds.y,width,height);return croppedCanvas;}function documentWidth(doc){return Math.max(Math.max(doc.body.scrollWidth,doc.documentElement.scrollWidth),Math.max(doc.body.offsetWidth,doc.documentElement.offsetWidth),Math.max(doc.body.clientWidth,doc.documentElement.clientWidth));}function documentHeight(doc){return Math.max(Math.max(doc.body.scrollHeight,doc.documentElement.scrollHeight),Math.max(doc.body.offsetHeight,doc.documentElement.offsetHeight),Math.max(doc.body.clientHeight,doc.documentElement.clientHeight));}function absoluteUrl(url){var link=document.createElement(\"a\");link.href=url;link.href=link.href;return link;}},{\"./clone\":2,\"./imageloader\":11,\"./log\":13,\"./nodecontainer\":14,\"./nodeparser\":15,\"./proxy\":16,\"./renderers/canvas\":20,\"./support\":22,\"./utils\":26}],5:[function(_dereq_,module,exports){var log=_dereq_('./log');var smallImage=_dereq_('./utils').smallImage;function DummyImageContainer(src){this.src=src;log(\"DummyImageContainer for\",src);if(!this.promise||!this.image){log(\"Initiating DummyImageContainer\");DummyImageContainer.prototype.image=new Image();var image=this.image;DummyImageContainer.prototype.promise=new Promise(function(resolve,reject){image.onload=resolve;image.onerror=reject;image.src=smallImage();if(image.complete===true){resolve(image);}});}}module.exports=DummyImageContainer;},{\"./log\":13,\"./utils\":26}],6:[function(_dereq_,module,exports){var smallImage=_dereq_('./utils').smallImage;function Font(family,size){var container=document.createElement('div'),img=document.createElement('img'),span=document.createElement('span'),sampleText='Hidden Text',baseline,middle;container.style.visibility=\"hidden\";container.style.fontFamily=family;container.style.fontSize=size;container.style.margin=0;container.style.padding=0;document.body.appendChild(container);img.src=smallImage();img.width=1;img.height=1;img.style.margin=0;img.style.padding=0;img.style.verticalAlign=\"baseline\";span.style.fontFamily=family;span.style.fontSize=size;span.style.margin=0;span.style.padding=0;span.appendChild(document.createTextNode(sampleText));container.appendChild(span);container.appendChild(img);baseline=img.offsetTop-span.offsetTop+1;container.removeChild(span);container.appendChild(document.createTextNode(sampleText));container.style.lineHeight=\"normal\";img.style.verticalAlign=\"super\";middle=img.offsetTop-container.offsetTop+1;document.body.removeChild(container);this.baseline=baseline;this.lineWidth=1;this.middle=middle;}module.exports=Font;},{\"./utils\":26}],7:[function(_dereq_,module,exports){var Font=_dereq_('./font');function FontMetrics(){this.data={};}FontMetrics.prototype.getMetrics=function(family,size){if(this.data[family+\"-\"+size]===undefined){this.data[family+\"-\"+size]=new Font(family,size);}return this.data[family+\"-\"+size];};module.exports=FontMetrics;},{\"./font\":6}],8:[function(_dereq_,module,exports){var utils=_dereq_('./utils');var getBounds=utils.getBounds;var loadUrlDocument=_dereq_('./proxy').loadUrlDocument;function FrameContainer(container,sameOrigin,options){this.image=null;this.src=container;var self=this;var bounds=getBounds(container);this.promise=(!sameOrigin?this.proxyLoad(options.proxy,bounds,options):new Promise(function(resolve){if(container.contentWindow.document.URL===\"about:blank\"||container.contentWindow.document.documentElement==null){container.contentWindow.onload=container.onload=function(){resolve(container);};}else{resolve(container);}})).then(function(container){var html2canvas=_dereq_('./core');return html2canvas(container.contentWindow.document.documentElement,{type:'view',width:container.width,height:container.height,proxy:options.proxy,javascriptEnabled:options.javascriptEnabled,removeContainer:options.removeContainer,allowTaint:options.allowTaint,imageTimeout:options.imageTimeout/2});}).then(function(canvas){return self.image=canvas;});}FrameContainer.prototype.proxyLoad=function(proxy,bounds,options){var container=this.src;return loadUrlDocument(container.src,proxy,container.ownerDocument,bounds.width,bounds.height,options);};module.exports=FrameContainer;},{\"./core\":4,\"./proxy\":16,\"./utils\":26}],9:[function(_dereq_,module,exports){function GradientContainer(imageData){this.src=imageData.value;this.colorStops=[];this.type=null;this.x0=0.5;this.y0=0.5;this.x1=0.5;this.y1=0.5;this.promise=Promise.resolve(true);}GradientContainer.TYPES={LINEAR:1,RADIAL:2};// TODO: support hsl[a], negative %/length values\n\t// TODO: support <angle> (e.g. -?\\d{1,3}(?:\\.\\d+)deg, etc. : https://developer.mozilla.org/docs/Web/CSS/angle )\n\tGradientContainer.REGEXP_COLORSTOP=/^\\s*(rgba?\\(\\s*\\d{1,3},\\s*\\d{1,3},\\s*\\d{1,3}(?:,\\s*[0-9\\.]+)?\\s*\\)|[a-z]{3,20}|#[a-f0-9]{3,6})(?:\\s+(\\d{1,3}(?:\\.\\d+)?)(%|px)?)?(?:\\s|$)/i;module.exports=GradientContainer;},{}],10:[function(_dereq_,module,exports){function ImageContainer(src,cors){this.src=src;this.image=new Image();var self=this;this.tainted=null;this.promise=new Promise(function(resolve,reject){self.image.onload=resolve;self.image.onerror=reject;if(cors){self.image.crossOrigin=\"anonymous\";}self.image.src=src;if(self.image.complete===true){resolve(self.image);}});}module.exports=ImageContainer;},{}],11:[function(_dereq_,module,exports){var log=_dereq_('./log');var ImageContainer=_dereq_('./imagecontainer');var DummyImageContainer=_dereq_('./dummyimagecontainer');var ProxyImageContainer=_dereq_('./proxyimagecontainer');var FrameContainer=_dereq_('./framecontainer');var SVGContainer=_dereq_('./svgcontainer');var SVGNodeContainer=_dereq_('./svgnodecontainer');var LinearGradientContainer=_dereq_('./lineargradientcontainer');var WebkitGradientContainer=_dereq_('./webkitgradientcontainer');var bind=_dereq_('./utils').bind;function ImageLoader(options,support){this.link=null;this.options=options;this.support=support;this.origin=this.getOrigin(window.location.href);}ImageLoader.prototype.findImages=function(nodes){var images=[];nodes.reduce(function(imageNodes,container){switch(container.node.nodeName){case\"IMG\":return imageNodes.concat([{args:[container.node.src],method:\"url\"}]);case\"svg\":case\"IFRAME\":return imageNodes.concat([{args:[container.node],method:container.node.nodeName}]);}return imageNodes;},[]).forEach(this.addImage(images,this.loadImage),this);return images;};ImageLoader.prototype.findBackgroundImage=function(images,container){container.parseBackgroundImages().filter(this.hasImageBackground).forEach(this.addImage(images,this.loadImage),this);return images;};ImageLoader.prototype.addImage=function(images,callback){return function(newImage){newImage.args.forEach(function(image){if(!this.imageExists(images,image)){images.splice(0,0,callback.call(this,newImage));log('Added image #'+images.length,typeof image===\"string\"?image.substring(0,100):image);}},this);};};ImageLoader.prototype.hasImageBackground=function(imageData){return imageData.method!==\"none\";};ImageLoader.prototype.loadImage=function(imageData){if(imageData.method===\"url\"){var src=imageData.args[0];if(this.isSVG(src)&&!this.support.svg&&!this.options.allowTaint){return new SVGContainer(src);}else if(src.match(/data:image\\/.*;base64,/i)){return new ImageContainer(src.replace(/url\\(['\"]{0,}|['\"]{0,}\\)$/ig,''),false);}else if(this.isSameOrigin(src)||this.options.allowTaint===true||this.isSVG(src)){return new ImageContainer(src,false);}else if(this.support.cors&&!this.options.allowTaint&&this.options.useCORS){return new ImageContainer(src,true);}else if(this.options.proxy){return new ProxyImageContainer(src,this.options.proxy);}else{return new DummyImageContainer(src);}}else if(imageData.method===\"linear-gradient\"){return new LinearGradientContainer(imageData);}else if(imageData.method===\"gradient\"){return new WebkitGradientContainer(imageData);}else if(imageData.method===\"svg\"){return new SVGNodeContainer(imageData.args[0],this.support.svg);}else if(imageData.method===\"IFRAME\"){return new FrameContainer(imageData.args[0],this.isSameOrigin(imageData.args[0].src),this.options);}else{return new DummyImageContainer(imageData);}};ImageLoader.prototype.isSVG=function(src){return src.substring(src.length-3).toLowerCase()===\"svg\"||SVGContainer.prototype.isInline(src);};ImageLoader.prototype.imageExists=function(images,src){return images.some(function(image){return image.src===src;});};ImageLoader.prototype.isSameOrigin=function(url){return this.getOrigin(url)===this.origin;};ImageLoader.prototype.getOrigin=function(url){var link=this.link||(this.link=document.createElement(\"a\"));link.href=url;link.href=link.href;// IE9, LOL! - http://jsfiddle.net/niklasvh/2e48b/\n\treturn link.protocol+link.hostname+link.port;};ImageLoader.prototype.getPromise=function(container){return this.timeout(container,this.options.imageTimeout)['catch'](function(){var dummy=new DummyImageContainer(container.src);return dummy.promise.then(function(image){container.image=image;});});};ImageLoader.prototype.get=function(src){var found=null;return this.images.some(function(img){return(found=img).src===src;})?found:null;};ImageLoader.prototype.fetch=function(nodes){this.images=nodes.reduce(bind(this.findBackgroundImage,this),this.findImages(nodes));this.images.forEach(function(image,index){image.promise.then(function(){log(\"Succesfully loaded image #\"+(index+1),image);},function(e){log(\"Failed loading image #\"+(index+1),image,e);});});this.ready=Promise.all(this.images.map(this.getPromise,this));log(\"Finished searching images\");return this;};ImageLoader.prototype.timeout=function(container,timeout){var timer;var promise=Promise.race([container.promise,new Promise(function(res,reject){timer=setTimeout(function(){log(\"Timed out loading image\",container);reject(container);},timeout);})]).then(function(container){clearTimeout(timer);return container;});promise['catch'](function(){clearTimeout(timer);});return promise;};module.exports=ImageLoader;},{\"./dummyimagecontainer\":5,\"./framecontainer\":8,\"./imagecontainer\":10,\"./lineargradientcontainer\":12,\"./log\":13,\"./proxyimagecontainer\":17,\"./svgcontainer\":23,\"./svgnodecontainer\":24,\"./utils\":26,\"./webkitgradientcontainer\":27}],12:[function(_dereq_,module,exports){var GradientContainer=_dereq_('./gradientcontainer');var Color=_dereq_('./color');function LinearGradientContainer(imageData){GradientContainer.apply(this,arguments);this.type=GradientContainer.TYPES.LINEAR;var hasDirection=LinearGradientContainer.REGEXP_DIRECTION.test(imageData.args[0])||!GradientContainer.REGEXP_COLORSTOP.test(imageData.args[0]);if(hasDirection){imageData.args[0].split(/\\s+/).reverse().forEach(function(position,index){switch(position){case\"left\":this.x0=0;this.x1=1;break;case\"top\":this.y0=0;this.y1=1;break;case\"right\":this.x0=1;this.x1=0;break;case\"bottom\":this.y0=1;this.y1=0;break;case\"to\":var y0=this.y0;var x0=this.x0;this.y0=this.y1;this.x0=this.x1;this.x1=x0;this.y1=y0;break;case\"center\":break;// centered by default\n\t// Firefox internally converts position keywords to percentages:\n\t// http://www.w3.org/TR/2010/WD-CSS2-20101207/colors.html#propdef-background-position\n\tdefault:// percentage or absolute length\n\t// TODO: support absolute start point positions (e.g., use bounds to convert px to a ratio)\n\tvar ratio=parseFloat(position,10)*1e-2;if(isNaN(ratio)){// invalid or unhandled value\n\tbreak;}if(index===0){this.y0=ratio;this.y1=1-this.y0;}else{this.x0=ratio;this.x1=1-this.x0;}break;}},this);}else{this.y0=0;this.y1=1;}this.colorStops=imageData.args.slice(hasDirection?1:0).map(function(colorStop){var colorStopMatch=colorStop.match(GradientContainer.REGEXP_COLORSTOP);var value=+colorStopMatch[2];var unit=value===0?\"%\":colorStopMatch[3];// treat \"0\" as \"0%\"\n\treturn{color:new Color(colorStopMatch[1]),// TODO: support absolute stop positions (e.g., compute gradient line length & convert px to ratio)\n\tstop:unit===\"%\"?value/100:null};});if(this.colorStops[0].stop===null){this.colorStops[0].stop=0;}if(this.colorStops[this.colorStops.length-1].stop===null){this.colorStops[this.colorStops.length-1].stop=1;}// calculates and fills-in explicit stop positions when omitted from rule\n\tthis.colorStops.forEach(function(colorStop,index){if(colorStop.stop===null){this.colorStops.slice(index).some(function(find,count){if(find.stop!==null){colorStop.stop=(find.stop-this.colorStops[index-1].stop)/(count+1)+this.colorStops[index-1].stop;return true;}else{return false;}},this);}},this);}LinearGradientContainer.prototype=Object.create(GradientContainer.prototype);// TODO: support <angle> (e.g. -?\\d{1,3}(?:\\.\\d+)deg, etc. : https://developer.mozilla.org/docs/Web/CSS/angle )\n\tLinearGradientContainer.REGEXP_DIRECTION=/^\\s*(?:to|left|right|top|bottom|center|\\d{1,3}(?:\\.\\d+)?%?)(?:\\s|$)/i;module.exports=LinearGradientContainer;},{\"./color\":3,\"./gradientcontainer\":9}],13:[function(_dereq_,module,exports){var logger=function logger(){if(logger.options.logging&&window.console&&window.console.log){Function.prototype.bind.call(window.console.log,window.console).apply(window.console,[Date.now()-logger.options.start+\"ms\",\"html2canvas:\"].concat([].slice.call(arguments,0)));}};logger.options={logging:false};module.exports=logger;},{}],14:[function(_dereq_,module,exports){var Color=_dereq_('./color');var utils=_dereq_('./utils');var getBounds=utils.getBounds;var parseBackgrounds=utils.parseBackgrounds;var offsetBounds=utils.offsetBounds;function NodeContainer(node,parent){this.node=node;this.parent=parent;this.stack=null;this.bounds=null;this.borders=null;this.clip=[];this.backgroundClip=[];this.offsetBounds=null;this.visible=null;this.computedStyles=null;this.colors={};this.styles={};this.backgroundImages=null;this.transformData=null;this.transformMatrix=null;this.isPseudoElement=false;this.opacity=null;}NodeContainer.prototype.cloneTo=function(stack){stack.visible=this.visible;stack.borders=this.borders;stack.bounds=this.bounds;stack.clip=this.clip;stack.backgroundClip=this.backgroundClip;stack.computedStyles=this.computedStyles;stack.styles=this.styles;stack.backgroundImages=this.backgroundImages;stack.opacity=this.opacity;};NodeContainer.prototype.getOpacity=function(){return this.opacity===null?this.opacity=this.cssFloat('opacity'):this.opacity;};NodeContainer.prototype.assignStack=function(stack){this.stack=stack;stack.children.push(this);};NodeContainer.prototype.isElementVisible=function(){return this.node.nodeType===Node.TEXT_NODE?this.parent.visible:this.css('display')!==\"none\"&&this.css('visibility')!==\"hidden\"&&!this.node.hasAttribute(\"data-html2canvas-ignore\")&&(this.node.nodeName!==\"INPUT\"||this.node.getAttribute(\"type\")!==\"hidden\");};NodeContainer.prototype.css=function(attribute){if(!this.computedStyles){this.computedStyles=this.isPseudoElement?this.parent.computedStyle(this.before?\":before\":\":after\"):this.computedStyle(null);}return this.styles[attribute]||(this.styles[attribute]=this.computedStyles[attribute]);};NodeContainer.prototype.prefixedCss=function(attribute){var prefixes=[\"webkit\",\"moz\",\"ms\",\"o\"];var value=this.css(attribute);if(value===undefined){prefixes.some(function(prefix){value=this.css(prefix+attribute.substr(0,1).toUpperCase()+attribute.substr(1));return value!==undefined;},this);}return value===undefined?null:value;};NodeContainer.prototype.computedStyle=function(type){return this.node.ownerDocument.defaultView.getComputedStyle(this.node,type);};NodeContainer.prototype.cssInt=function(attribute){var value=parseInt(this.css(attribute),10);return isNaN(value)?0:value;// borders in old IE are throwing 'medium' for demo.html\n\t};NodeContainer.prototype.color=function(attribute){return this.colors[attribute]||(this.colors[attribute]=new Color(this.css(attribute)));};NodeContainer.prototype.cssFloat=function(attribute){var value=parseFloat(this.css(attribute));return isNaN(value)?0:value;};NodeContainer.prototype.fontWeight=function(){var weight=this.css(\"fontWeight\");switch(parseInt(weight,10)){case 401:weight=\"bold\";break;case 400:weight=\"normal\";break;}return weight;};NodeContainer.prototype.parseClip=function(){var matches=this.css('clip').match(this.CLIP);if(matches){return{top:parseInt(matches[1],10),right:parseInt(matches[2],10),bottom:parseInt(matches[3],10),left:parseInt(matches[4],10)};}return null;};NodeContainer.prototype.parseBackgroundImages=function(){return this.backgroundImages||(this.backgroundImages=parseBackgrounds(this.css(\"backgroundImage\")));};NodeContainer.prototype.cssList=function(property,index){var value=(this.css(property)||'').split(',');value=value[index||0]||value[0]||'auto';value=value.trim().split(' ');if(value.length===1){value=[value[0],isPercentage(value[0])?'auto':value[0]];}return value;};NodeContainer.prototype.parseBackgroundSize=function(bounds,image,index){var size=this.cssList(\"backgroundSize\",index);var width,height;if(isPercentage(size[0])){width=bounds.width*parseFloat(size[0])/100;}else if(/contain|cover/.test(size[0])){var targetRatio=bounds.width/bounds.height,currentRatio=image.width/image.height;return targetRatio<currentRatio^size[0]==='contain'?{width:bounds.height*currentRatio,height:bounds.height}:{width:bounds.width,height:bounds.width/currentRatio};}else{width=parseInt(size[0],10);}if(size[0]==='auto'&&size[1]==='auto'){height=image.height;}else if(size[1]==='auto'){height=width/image.width*image.height;}else if(isPercentage(size[1])){height=bounds.height*parseFloat(size[1])/100;}else{height=parseInt(size[1],10);}if(size[0]==='auto'){width=height/image.height*image.width;}return{width:width,height:height};};NodeContainer.prototype.parseBackgroundPosition=function(bounds,image,index,backgroundSize){var position=this.cssList('backgroundPosition',index);var left,top;if(isPercentage(position[0])){left=(bounds.width-(backgroundSize||image).width)*(parseFloat(position[0])/100);}else{left=parseInt(position[0],10);}if(position[1]==='auto'){top=left/image.width*image.height;}else if(isPercentage(position[1])){top=(bounds.height-(backgroundSize||image).height)*parseFloat(position[1])/100;}else{top=parseInt(position[1],10);}if(position[0]==='auto'){left=top/image.height*image.width;}return{left:left,top:top};};NodeContainer.prototype.parseBackgroundRepeat=function(index){return this.cssList(\"backgroundRepeat\",index)[0];};NodeContainer.prototype.parseTextShadows=function(){var textShadow=this.css(\"textShadow\");var results=[];if(textShadow&&textShadow!=='none'){var shadows=textShadow.match(this.TEXT_SHADOW_PROPERTY);for(var i=0;shadows&&i<shadows.length;i++){var s=shadows[i].match(this.TEXT_SHADOW_VALUES);results.push({color:new Color(s[0]),offsetX:s[1]?parseFloat(s[1].replace('px','')):0,offsetY:s[2]?parseFloat(s[2].replace('px','')):0,blur:s[3]?s[3].replace('px',''):0});}}return results;};NodeContainer.prototype.parseTransform=function(){if(!this.transformData){if(this.hasTransform()){var offset=this.parseBounds();var origin=this.prefixedCss(\"transformOrigin\").split(\" \").map(removePx).map(asFloat);origin[0]+=offset.left;origin[1]+=offset.top;this.transformData={origin:origin,matrix:this.parseTransformMatrix()};}else{this.transformData={origin:[0,0],matrix:[1,0,0,1,0,0]};}}return this.transformData;};NodeContainer.prototype.parseTransformMatrix=function(){if(!this.transformMatrix){var transform=this.prefixedCss(\"transform\");var matrix=transform?parseMatrix(transform.match(this.MATRIX_PROPERTY)):null;this.transformMatrix=matrix?matrix:[1,0,0,1,0,0];}return this.transformMatrix;};NodeContainer.prototype.parseBounds=function(){return this.bounds||(this.bounds=this.hasTransform()?offsetBounds(this.node):getBounds(this.node));};NodeContainer.prototype.hasTransform=function(){return this.parseTransformMatrix().join(\",\")!==\"1,0,0,1,0,0\"||this.parent&&this.parent.hasTransform();};NodeContainer.prototype.getValue=function(){var value=this.node.value||\"\";if(this.node.tagName===\"SELECT\"){value=selectionValue(this.node);}else if(this.node.type===\"password\"){value=Array(value.length+1).join(\"•\");// jshint ignore:line\n\t}return value.length===0?this.node.placeholder||\"\":value;};NodeContainer.prototype.MATRIX_PROPERTY=/(matrix|matrix3d)\\((.+)\\)/;NodeContainer.prototype.TEXT_SHADOW_PROPERTY=/((rgba|rgb)\\([^\\)]+\\)(\\s-?\\d+px){0,})/g;NodeContainer.prototype.TEXT_SHADOW_VALUES=/(-?\\d+px)|(#.+)|(rgb\\(.+\\))|(rgba\\(.+\\))/g;NodeContainer.prototype.CLIP=/^rect\\((\\d+)px,? (\\d+)px,? (\\d+)px,? (\\d+)px\\)$/;function selectionValue(node){var option=node.options[node.selectedIndex||0];return option?option.text||\"\":\"\";}function parseMatrix(match){if(match&&match[1]===\"matrix\"){return match[2].split(\",\").map(function(s){return parseFloat(s.trim());});}else if(match&&match[1]===\"matrix3d\"){var matrix3d=match[2].split(\",\").map(function(s){return parseFloat(s.trim());});return[matrix3d[0],matrix3d[1],matrix3d[4],matrix3d[5],matrix3d[12],matrix3d[13]];}}function isPercentage(value){return value.toString().indexOf(\"%\")!==-1;}function removePx(str){return str.replace(\"px\",\"\");}function asFloat(str){return parseFloat(str);}module.exports=NodeContainer;},{\"./color\":3,\"./utils\":26}],15:[function(_dereq_,module,exports){var log=_dereq_('./log');var punycode=_dereq_('punycode');var NodeContainer=_dereq_('./nodecontainer');var TextContainer=_dereq_('./textcontainer');var PseudoElementContainer=_dereq_('./pseudoelementcontainer');var FontMetrics=_dereq_('./fontmetrics');var Color=_dereq_('./color');var StackingContext=_dereq_('./stackingcontext');var utils=_dereq_('./utils');var bind=utils.bind;var getBounds=utils.getBounds;var parseBackgrounds=utils.parseBackgrounds;var offsetBounds=utils.offsetBounds;function NodeParser(element,renderer,support,imageLoader,options){log(\"Starting NodeParser\");this.renderer=renderer;this.options=options;this.range=null;this.support=support;this.renderQueue=[];this.stack=new StackingContext(true,1,element.ownerDocument,null);var parent=new NodeContainer(element,null);if(options.background){renderer.rectangle(0,0,renderer.width,renderer.height,new Color(options.background));}if(element===element.ownerDocument.documentElement){// http://www.w3.org/TR/css3-background/#special-backgrounds\n\tvar canvasBackground=new NodeContainer(parent.color('backgroundColor').isTransparent()?element.ownerDocument.body:element.ownerDocument.documentElement,null);renderer.rectangle(0,0,renderer.width,renderer.height,canvasBackground.color('backgroundColor'));}parent.visibile=parent.isElementVisible();this.createPseudoHideStyles(element.ownerDocument);this.disableAnimations(element.ownerDocument);this.nodes=flatten([parent].concat(this.getChildren(parent)).filter(function(container){return container.visible=container.isElementVisible();}).map(this.getPseudoElements,this));this.fontMetrics=new FontMetrics();log(\"Fetched nodes, total:\",this.nodes.length);log(\"Calculate overflow clips\");this.calculateOverflowClips();log(\"Start fetching images\");this.images=imageLoader.fetch(this.nodes.filter(isElement));this.ready=this.images.ready.then(bind(function(){log(\"Images loaded, starting parsing\");log(\"Creating stacking contexts\");this.createStackingContexts();log(\"Sorting stacking contexts\");this.sortStackingContexts(this.stack);this.parse(this.stack);log(\"Render queue created with \"+this.renderQueue.length+\" items\");return new Promise(bind(function(resolve){if(!options.async){this.renderQueue.forEach(this.paint,this);resolve();}else if(typeof options.async===\"function\"){options.async.call(this,this.renderQueue,resolve);}else if(this.renderQueue.length>0){this.renderIndex=0;this.asyncRenderer(this.renderQueue,resolve);}else{resolve();}},this));},this));}NodeParser.prototype.calculateOverflowClips=function(){this.nodes.forEach(function(container){if(isElement(container)){if(isPseudoElement(container)){container.appendToDOM();}container.borders=this.parseBorders(container);var clip=container.css('overflow')===\"hidden\"?[container.borders.clip]:[];var cssClip=container.parseClip();if(cssClip&&[\"absolute\",\"fixed\"].indexOf(container.css('position'))!==-1){clip.push([[\"rect\",container.bounds.left+cssClip.left,container.bounds.top+cssClip.top,cssClip.right-cssClip.left,cssClip.bottom-cssClip.top]]);}container.clip=hasParentClip(container)?container.parent.clip.concat(clip):clip;container.backgroundClip=container.css('overflow')!==\"hidden\"?container.clip.concat([container.borders.clip]):container.clip;if(isPseudoElement(container)){container.cleanDOM();}}else if(isTextNode(container)){container.clip=hasParentClip(container)?container.parent.clip:[];}if(!isPseudoElement(container)){container.bounds=null;}},this);};function hasParentClip(container){return container.parent&&container.parent.clip.length;}NodeParser.prototype.asyncRenderer=function(queue,resolve,asyncTimer){asyncTimer=asyncTimer||Date.now();this.paint(queue[this.renderIndex++]);if(queue.length===this.renderIndex){resolve();}else if(asyncTimer+20>Date.now()){this.asyncRenderer(queue,resolve,asyncTimer);}else{setTimeout(bind(function(){this.asyncRenderer(queue,resolve);},this),0);}};NodeParser.prototype.createPseudoHideStyles=function(document){this.createStyles(document,'.'+PseudoElementContainer.prototype.PSEUDO_HIDE_ELEMENT_CLASS_BEFORE+':before { content: \"\" !important; display: none !important; }'+'.'+PseudoElementContainer.prototype.PSEUDO_HIDE_ELEMENT_CLASS_AFTER+':after { content: \"\" !important; display: none !important; }');};NodeParser.prototype.disableAnimations=function(document){this.createStyles(document,'* { -webkit-animation: none !important; -moz-animation: none !important; -o-animation: none !important; animation: none !important; '+'-webkit-transition: none !important; -moz-transition: none !important; -o-transition: none !important; transition: none !important;}');};NodeParser.prototype.createStyles=function(document,styles){var hidePseudoElements=document.createElement('style');hidePseudoElements.innerHTML=styles;document.body.appendChild(hidePseudoElements);};NodeParser.prototype.getPseudoElements=function(container){var nodes=[[container]];if(container.node.nodeType===Node.ELEMENT_NODE){var before=this.getPseudoElement(container,\":before\");var after=this.getPseudoElement(container,\":after\");if(before){nodes.push(before);}if(after){nodes.push(after);}}return flatten(nodes);};function toCamelCase(str){return str.replace(/(\\-[a-z])/g,function(match){return match.toUpperCase().replace('-','');});}NodeParser.prototype.getPseudoElement=function(container,type){var style=container.computedStyle(type);if(!style||!style.content||style.content===\"none\"||style.content===\"-moz-alt-content\"||style.display===\"none\"){return null;}var content=stripQuotes(style.content);var isImage=content.substr(0,3)==='url';var pseudoNode=document.createElement(isImage?'img':'html2canvaspseudoelement');var pseudoContainer=new PseudoElementContainer(pseudoNode,container,type);for(var i=style.length-1;i>=0;i--){var property=toCamelCase(style.item(i));pseudoNode.style[property]=style[property];}pseudoNode.className=PseudoElementContainer.prototype.PSEUDO_HIDE_ELEMENT_CLASS_BEFORE+\" \"+PseudoElementContainer.prototype.PSEUDO_HIDE_ELEMENT_CLASS_AFTER;if(isImage){pseudoNode.src=parseBackgrounds(content)[0].args[0];return[pseudoContainer];}else{var text=document.createTextNode(content);pseudoNode.appendChild(text);return[pseudoContainer,new TextContainer(text,pseudoContainer)];}};NodeParser.prototype.getChildren=function(parentContainer){return flatten([].filter.call(parentContainer.node.childNodes,renderableNode).map(function(node){var container=[node.nodeType===Node.TEXT_NODE?new TextContainer(node,parentContainer):new NodeContainer(node,parentContainer)].filter(nonIgnoredElement);return node.nodeType===Node.ELEMENT_NODE&&container.length&&node.tagName!==\"TEXTAREA\"?container[0].isElementVisible()?container.concat(this.getChildren(container[0])):[]:container;},this));};NodeParser.prototype.newStackingContext=function(container,hasOwnStacking){var stack=new StackingContext(hasOwnStacking,container.getOpacity(),container.node,container.parent);container.cloneTo(stack);var parentStack=hasOwnStacking?stack.getParentStack(this):stack.parent.stack;parentStack.contexts.push(stack);container.stack=stack;};NodeParser.prototype.createStackingContexts=function(){this.nodes.forEach(function(container){if(isElement(container)&&(this.isRootElement(container)||hasOpacity(container)||isPositionedForStacking(container)||this.isBodyWithTransparentRoot(container)||container.hasTransform())){this.newStackingContext(container,true);}else if(isElement(container)&&(isPositioned(container)&&zIndex0(container)||isInlineBlock(container)||isFloating(container))){this.newStackingContext(container,false);}else{container.assignStack(container.parent.stack);}},this);};NodeParser.prototype.isBodyWithTransparentRoot=function(container){return container.node.nodeName===\"BODY\"&&container.parent.color('backgroundColor').isTransparent();};NodeParser.prototype.isRootElement=function(container){return container.parent===null;};NodeParser.prototype.sortStackingContexts=function(stack){stack.contexts.sort(zIndexSort(stack.contexts.slice(0)));stack.contexts.forEach(this.sortStackingContexts,this);};NodeParser.prototype.parseTextBounds=function(container){return function(text,index,textList){if(container.parent.css(\"textDecoration\").substr(0,4)!==\"none\"||text.trim().length!==0){if(this.support.rangeBounds&&!container.parent.hasTransform()){var offset=textList.slice(0,index).join(\"\").length;return this.getRangeBounds(container.node,offset,text.length);}else if(container.node&&typeof container.node.data===\"string\"){var replacementNode=container.node.splitText(text.length);var bounds=this.getWrapperBounds(container.node,container.parent.hasTransform());container.node=replacementNode;return bounds;}}else if(!this.support.rangeBounds||container.parent.hasTransform()){container.node=container.node.splitText(text.length);}return{};};};NodeParser.prototype.getWrapperBounds=function(node,transform){var wrapper=node.ownerDocument.createElement('html2canvaswrapper');var parent=node.parentNode,backupText=node.cloneNode(true);wrapper.appendChild(node.cloneNode(true));parent.replaceChild(wrapper,node);var bounds=transform?offsetBounds(wrapper):getBounds(wrapper);parent.replaceChild(backupText,wrapper);return bounds;};NodeParser.prototype.getRangeBounds=function(node,offset,length){var range=this.range||(this.range=node.ownerDocument.createRange());range.setStart(node,offset);range.setEnd(node,offset+length);return range.getBoundingClientRect();};function ClearTransform(){}NodeParser.prototype.parse=function(stack){// http://www.w3.org/TR/CSS21/visuren.html#z-index\n\tvar negativeZindex=stack.contexts.filter(negativeZIndex);// 2. the child stacking contexts with negative stack levels (most negative first).\n\tvar descendantElements=stack.children.filter(isElement);var descendantNonFloats=descendantElements.filter(not(isFloating));var nonInlineNonPositionedDescendants=descendantNonFloats.filter(not(isPositioned)).filter(not(inlineLevel));// 3 the in-flow, non-inline-level, non-positioned descendants.\n\tvar nonPositionedFloats=descendantElements.filter(not(isPositioned)).filter(isFloating);// 4. the non-positioned floats.\n\tvar inFlow=descendantNonFloats.filter(not(isPositioned)).filter(inlineLevel);// 5. the in-flow, inline-level, non-positioned descendants, including inline tables and inline blocks.\n\tvar stackLevel0=stack.contexts.concat(descendantNonFloats.filter(isPositioned)).filter(zIndex0);// 6. the child stacking contexts with stack level 0 and the positioned descendants with stack level 0.\n\tvar text=stack.children.filter(isTextNode).filter(hasText);var positiveZindex=stack.contexts.filter(positiveZIndex);// 7. the child stacking contexts with positive stack levels (least positive first).\n\tnegativeZindex.concat(nonInlineNonPositionedDescendants).concat(nonPositionedFloats).concat(inFlow).concat(stackLevel0).concat(text).concat(positiveZindex).forEach(function(container){this.renderQueue.push(container);if(isStackingContext(container)){this.parse(container);this.renderQueue.push(new ClearTransform());}},this);};NodeParser.prototype.paint=function(container){try{if(container instanceof ClearTransform){this.renderer.ctx.restore();}else if(isTextNode(container)){if(isPseudoElement(container.parent)){container.parent.appendToDOM();}this.paintText(container);if(isPseudoElement(container.parent)){container.parent.cleanDOM();}}else{this.paintNode(container);}}catch(e){log(e);if(this.options.strict){throw e;}}};NodeParser.prototype.paintNode=function(container){if(isStackingContext(container)){this.renderer.setOpacity(container.opacity);this.renderer.ctx.save();if(container.hasTransform()){this.renderer.setTransform(container.parseTransform());}}if(container.node.nodeName===\"INPUT\"&&container.node.type===\"checkbox\"){this.paintCheckbox(container);}else if(container.node.nodeName===\"INPUT\"&&container.node.type===\"radio\"){this.paintRadio(container);}else{this.paintElement(container);}};NodeParser.prototype.paintElement=function(container){var bounds=container.parseBounds();this.renderer.clip(container.backgroundClip,function(){this.renderer.renderBackground(container,bounds,container.borders.borders.map(getWidth));},this);this.renderer.clip(container.clip,function(){this.renderer.renderBorders(container.borders.borders);},this);this.renderer.clip(container.backgroundClip,function(){switch(container.node.nodeName){case\"svg\":case\"IFRAME\":var imgContainer=this.images.get(container.node);if(imgContainer){this.renderer.renderImage(container,bounds,container.borders,imgContainer);}else{log(\"Error loading <\"+container.node.nodeName+\">\",container.node);}break;case\"IMG\":var imageContainer=this.images.get(container.node.src);if(imageContainer){this.renderer.renderImage(container,bounds,container.borders,imageContainer);}else{log(\"Error loading <img>\",container.node.src);}break;case\"CANVAS\":this.renderer.renderImage(container,bounds,container.borders,{image:container.node});break;case\"SELECT\":case\"INPUT\":case\"TEXTAREA\":this.paintFormValue(container);break;}},this);};NodeParser.prototype.paintCheckbox=function(container){var b=container.parseBounds();var size=Math.min(b.width,b.height);var bounds={width:size-1,height:size-1,top:b.top,left:b.left};var r=[3,3];var radius=[r,r,r,r];var borders=[1,1,1,1].map(function(w){return{color:new Color('#A5A5A5'),width:w};});var borderPoints=calculateCurvePoints(bounds,radius,borders);this.renderer.clip(container.backgroundClip,function(){this.renderer.rectangle(bounds.left+1,bounds.top+1,bounds.width-2,bounds.height-2,new Color(\"#DEDEDE\"));this.renderer.renderBorders(calculateBorders(borders,bounds,borderPoints,radius));if(container.node.checked){this.renderer.font(new Color('#424242'),'normal','normal','bold',size-3+\"px\",'arial');this.renderer.text(\"✔\",bounds.left+size/6,bounds.top+size-1);}},this);};NodeParser.prototype.paintRadio=function(container){var bounds=container.parseBounds();var size=Math.min(bounds.width,bounds.height)-2;this.renderer.clip(container.backgroundClip,function(){this.renderer.circleStroke(bounds.left+1,bounds.top+1,size,new Color('#DEDEDE'),1,new Color('#A5A5A5'));if(container.node.checked){this.renderer.circle(Math.ceil(bounds.left+size/4)+1,Math.ceil(bounds.top+size/4)+1,Math.floor(size/2),new Color('#424242'));}},this);};NodeParser.prototype.paintFormValue=function(container){var value=container.getValue();if(value.length>0){var document=container.node.ownerDocument;var wrapper=document.createElement('html2canvaswrapper');var properties=['lineHeight','textAlign','fontFamily','fontWeight','fontSize','color','paddingLeft','paddingTop','paddingRight','paddingBottom','width','height','borderLeftStyle','borderTopStyle','borderLeftWidth','borderTopWidth','boxSizing','whiteSpace','wordWrap'];properties.forEach(function(property){try{wrapper.style[property]=container.css(property);}catch(e){// Older IE has issues with \"border\"\n\tlog(\"html2canvas: Parse: Exception caught in renderFormValue: \"+e.message);}});var bounds=container.parseBounds();wrapper.style.position=\"fixed\";wrapper.style.left=bounds.left+\"px\";wrapper.style.top=bounds.top+\"px\";wrapper.textContent=value;document.body.appendChild(wrapper);this.paintText(new TextContainer(wrapper.firstChild,container));document.body.removeChild(wrapper);}};NodeParser.prototype.paintText=function(container){container.applyTextTransform();var characters=punycode.ucs2.decode(container.node.data);var textList=(!this.options.letterRendering||noLetterSpacing(container))&&!hasUnicode(container.node.data)?getWords(characters):characters.map(function(character){return punycode.ucs2.encode([character]);});var weight=container.parent.fontWeight();var size=container.parent.css('fontSize');var family=container.parent.css('fontFamily');var shadows=container.parent.parseTextShadows();this.renderer.font(container.parent.color('color'),container.parent.css('fontStyle'),container.parent.css('fontVariant'),weight,size,family);if(shadows.length){// TODO: support multiple text shadows\n\tthis.renderer.fontShadow(shadows[0].color,shadows[0].offsetX,shadows[0].offsetY,shadows[0].blur);}else{this.renderer.clearShadow();}this.renderer.clip(container.parent.clip,function(){textList.map(this.parseTextBounds(container),this).forEach(function(bounds,index){if(bounds){this.renderer.text(textList[index],bounds.left,bounds.bottom);this.renderTextDecoration(container.parent,bounds,this.fontMetrics.getMetrics(family,size));}},this);},this);};NodeParser.prototype.renderTextDecoration=function(container,bounds,metrics){switch(container.css(\"textDecoration\").split(\" \")[0]){case\"underline\":// Draws a line at the baseline of the font\n\t// TODO As some browsers display the line as more than 1px if the font-size is big, need to take that into account both in position and size\n\tthis.renderer.rectangle(bounds.left,Math.round(bounds.top+metrics.baseline+metrics.lineWidth),bounds.width,1,container.color(\"color\"));break;case\"overline\":this.renderer.rectangle(bounds.left,Math.round(bounds.top),bounds.width,1,container.color(\"color\"));break;case\"line-through\":// TODO try and find exact position for line-through\n\tthis.renderer.rectangle(bounds.left,Math.ceil(bounds.top+metrics.middle+metrics.lineWidth),bounds.width,1,container.color(\"color\"));break;}};var borderColorTransforms={inset:[[\"darken\",0.60],[\"darken\",0.10],[\"darken\",0.10],[\"darken\",0.60]]};NodeParser.prototype.parseBorders=function(container){var nodeBounds=container.parseBounds();var radius=getBorderRadiusData(container);var borders=[\"Top\",\"Right\",\"Bottom\",\"Left\"].map(function(side,index){var style=container.css('border'+side+'Style');var color=container.color('border'+side+'Color');if(style===\"inset\"&&color.isBlack()){color=new Color([255,255,255,color.a]);// this is wrong, but\n\t}var colorTransform=borderColorTransforms[style]?borderColorTransforms[style][index]:null;return{width:container.cssInt('border'+side+'Width'),color:colorTransform?color[colorTransform[0]](colorTransform[1]):color,args:null};});var borderPoints=calculateCurvePoints(nodeBounds,radius,borders);return{clip:this.parseBackgroundClip(container,borderPoints,borders,radius,nodeBounds),borders:calculateBorders(borders,nodeBounds,borderPoints,radius)};};function calculateBorders(borders,nodeBounds,borderPoints,radius){return borders.map(function(border,borderSide){if(border.width>0){var bx=nodeBounds.left;var by=nodeBounds.top;var bw=nodeBounds.width;var bh=nodeBounds.height-borders[2].width;switch(borderSide){case 0:// top border\n\tbh=borders[0].width;border.args=drawSide({c1:[bx,by],c2:[bx+bw,by],c3:[bx+bw-borders[1].width,by+bh],c4:[bx+borders[3].width,by+bh]},radius[0],radius[1],borderPoints.topLeftOuter,borderPoints.topLeftInner,borderPoints.topRightOuter,borderPoints.topRightInner);break;case 1:// right border\n\tbx=nodeBounds.left+nodeBounds.width-borders[1].width;bw=borders[1].width;border.args=drawSide({c1:[bx+bw,by],c2:[bx+bw,by+bh+borders[2].width],c3:[bx,by+bh],c4:[bx,by+borders[0].width]},radius[1],radius[2],borderPoints.topRightOuter,borderPoints.topRightInner,borderPoints.bottomRightOuter,borderPoints.bottomRightInner);break;case 2:// bottom border\n\tby=by+nodeBounds.height-borders[2].width;bh=borders[2].width;border.args=drawSide({c1:[bx+bw,by+bh],c2:[bx,by+bh],c3:[bx+borders[3].width,by],c4:[bx+bw-borders[3].width,by]},radius[2],radius[3],borderPoints.bottomRightOuter,borderPoints.bottomRightInner,borderPoints.bottomLeftOuter,borderPoints.bottomLeftInner);break;case 3:// left border\n\tbw=borders[3].width;border.args=drawSide({c1:[bx,by+bh+borders[2].width],c2:[bx,by],c3:[bx+bw,by+borders[0].width],c4:[bx+bw,by+bh]},radius[3],radius[0],borderPoints.bottomLeftOuter,borderPoints.bottomLeftInner,borderPoints.topLeftOuter,borderPoints.topLeftInner);break;}}return border;});}NodeParser.prototype.parseBackgroundClip=function(container,borderPoints,borders,radius,bounds){var backgroundClip=container.css('backgroundClip'),borderArgs=[];switch(backgroundClip){case\"content-box\":case\"padding-box\":parseCorner(borderArgs,radius[0],radius[1],borderPoints.topLeftInner,borderPoints.topRightInner,bounds.left+borders[3].width,bounds.top+borders[0].width);parseCorner(borderArgs,radius[1],radius[2],borderPoints.topRightInner,borderPoints.bottomRightInner,bounds.left+bounds.width-borders[1].width,bounds.top+borders[0].width);parseCorner(borderArgs,radius[2],radius[3],borderPoints.bottomRightInner,borderPoints.bottomLeftInner,bounds.left+bounds.width-borders[1].width,bounds.top+bounds.height-borders[2].width);parseCorner(borderArgs,radius[3],radius[0],borderPoints.bottomLeftInner,borderPoints.topLeftInner,bounds.left+borders[3].width,bounds.top+bounds.height-borders[2].width);break;default:parseCorner(borderArgs,radius[0],radius[1],borderPoints.topLeftOuter,borderPoints.topRightOuter,bounds.left,bounds.top);parseCorner(borderArgs,radius[1],radius[2],borderPoints.topRightOuter,borderPoints.bottomRightOuter,bounds.left+bounds.width,bounds.top);parseCorner(borderArgs,radius[2],radius[3],borderPoints.bottomRightOuter,borderPoints.bottomLeftOuter,bounds.left+bounds.width,bounds.top+bounds.height);parseCorner(borderArgs,radius[3],radius[0],borderPoints.bottomLeftOuter,borderPoints.topLeftOuter,bounds.left,bounds.top+bounds.height);break;}return borderArgs;};function getCurvePoints(x,y,r1,r2){var kappa=4*((Math.sqrt(2)-1)/3);var ox=r1*kappa,// control point offset horizontal\n\toy=r2*kappa,// control point offset vertical\n\txm=x+r1,// x-middle\n\tym=y+r2;// y-middle\n\treturn{topLeft:bezierCurve({x:x,y:ym},{x:x,y:ym-oy},{x:xm-ox,y:y},{x:xm,y:y}),topRight:bezierCurve({x:x,y:y},{x:x+ox,y:y},{x:xm,y:ym-oy},{x:xm,y:ym}),bottomRight:bezierCurve({x:xm,y:y},{x:xm,y:y+oy},{x:x+ox,y:ym},{x:x,y:ym}),bottomLeft:bezierCurve({x:xm,y:ym},{x:xm-ox,y:ym},{x:x,y:y+oy},{x:x,y:y})};}function calculateCurvePoints(bounds,borderRadius,borders){var x=bounds.left,y=bounds.top,width=bounds.width,height=bounds.height,tlh=borderRadius[0][0]<width/2?borderRadius[0][0]:width/2,tlv=borderRadius[0][1]<height/2?borderRadius[0][1]:height/2,trh=borderRadius[1][0]<width/2?borderRadius[1][0]:width/2,trv=borderRadius[1][1]<height/2?borderRadius[1][1]:height/2,brh=borderRadius[2][0]<width/2?borderRadius[2][0]:width/2,brv=borderRadius[2][1]<height/2?borderRadius[2][1]:height/2,blh=borderRadius[3][0]<width/2?borderRadius[3][0]:width/2,blv=borderRadius[3][1]<height/2?borderRadius[3][1]:height/2;var topWidth=width-trh,rightHeight=height-brv,bottomWidth=width-brh,leftHeight=height-blv;return{topLeftOuter:getCurvePoints(x,y,tlh,tlv).topLeft.subdivide(0.5),topLeftInner:getCurvePoints(x+borders[3].width,y+borders[0].width,Math.max(0,tlh-borders[3].width),Math.max(0,tlv-borders[0].width)).topLeft.subdivide(0.5),topRightOuter:getCurvePoints(x+topWidth,y,trh,trv).topRight.subdivide(0.5),topRightInner:getCurvePoints(x+Math.min(topWidth,width+borders[3].width),y+borders[0].width,topWidth>width+borders[3].width?0:trh-borders[3].width,trv-borders[0].width).topRight.subdivide(0.5),bottomRightOuter:getCurvePoints(x+bottomWidth,y+rightHeight,brh,brv).bottomRight.subdivide(0.5),bottomRightInner:getCurvePoints(x+Math.min(bottomWidth,width-borders[3].width),y+Math.min(rightHeight,height+borders[0].width),Math.max(0,brh-borders[1].width),brv-borders[2].width).bottomRight.subdivide(0.5),bottomLeftOuter:getCurvePoints(x,y+leftHeight,blh,blv).bottomLeft.subdivide(0.5),bottomLeftInner:getCurvePoints(x+borders[3].width,y+leftHeight,Math.max(0,blh-borders[3].width),blv-borders[2].width).bottomLeft.subdivide(0.5)};}function bezierCurve(start,startControl,endControl,end){var lerp=function lerp(a,b,t){return{x:a.x+(b.x-a.x)*t,y:a.y+(b.y-a.y)*t};};return{start:start,startControl:startControl,endControl:endControl,end:end,subdivide:function subdivide(t){var ab=lerp(start,startControl,t),bc=lerp(startControl,endControl,t),cd=lerp(endControl,end,t),abbc=lerp(ab,bc,t),bccd=lerp(bc,cd,t),dest=lerp(abbc,bccd,t);return[bezierCurve(start,ab,abbc,dest),bezierCurve(dest,bccd,cd,end)];},curveTo:function curveTo(borderArgs){borderArgs.push([\"bezierCurve\",startControl.x,startControl.y,endControl.x,endControl.y,end.x,end.y]);},curveToReversed:function curveToReversed(borderArgs){borderArgs.push([\"bezierCurve\",endControl.x,endControl.y,startControl.x,startControl.y,start.x,start.y]);}};}function drawSide(borderData,radius1,radius2,outer1,inner1,outer2,inner2){var borderArgs=[];if(radius1[0]>0||radius1[1]>0){borderArgs.push([\"line\",outer1[1].start.x,outer1[1].start.y]);outer1[1].curveTo(borderArgs);}else{borderArgs.push([\"line\",borderData.c1[0],borderData.c1[1]]);}if(radius2[0]>0||radius2[1]>0){borderArgs.push([\"line\",outer2[0].start.x,outer2[0].start.y]);outer2[0].curveTo(borderArgs);borderArgs.push([\"line\",inner2[0].end.x,inner2[0].end.y]);inner2[0].curveToReversed(borderArgs);}else{borderArgs.push([\"line\",borderData.c2[0],borderData.c2[1]]);borderArgs.push([\"line\",borderData.c3[0],borderData.c3[1]]);}if(radius1[0]>0||radius1[1]>0){borderArgs.push([\"line\",inner1[1].end.x,inner1[1].end.y]);inner1[1].curveToReversed(borderArgs);}else{borderArgs.push([\"line\",borderData.c4[0],borderData.c4[1]]);}return borderArgs;}function parseCorner(borderArgs,radius1,radius2,corner1,corner2,x,y){if(radius1[0]>0||radius1[1]>0){borderArgs.push([\"line\",corner1[0].start.x,corner1[0].start.y]);corner1[0].curveTo(borderArgs);corner1[1].curveTo(borderArgs);}else{borderArgs.push([\"line\",x,y]);}if(radius2[0]>0||radius2[1]>0){borderArgs.push([\"line\",corner2[0].start.x,corner2[0].start.y]);}}function negativeZIndex(container){return container.cssInt(\"zIndex\")<0;}function positiveZIndex(container){return container.cssInt(\"zIndex\")>0;}function zIndex0(container){return container.cssInt(\"zIndex\")===0;}function inlineLevel(container){return[\"inline\",\"inline-block\",\"inline-table\"].indexOf(container.css(\"display\"))!==-1;}function isStackingContext(container){return container instanceof StackingContext;}function hasText(container){return container.node.data.trim().length>0;}function noLetterSpacing(container){return /^(normal|none|0px)$/.test(container.parent.css(\"letterSpacing\"));}function getBorderRadiusData(container){return[\"TopLeft\",\"TopRight\",\"BottomRight\",\"BottomLeft\"].map(function(side){var value=container.css('border'+side+'Radius');var arr=value.split(\" \");if(arr.length<=1){arr[1]=arr[0];}return arr.map(asInt);});}function renderableNode(node){return node.nodeType===Node.TEXT_NODE||node.nodeType===Node.ELEMENT_NODE;}function isPositionedForStacking(container){var position=container.css(\"position\");var zIndex=[\"absolute\",\"relative\",\"fixed\"].indexOf(position)!==-1?container.css(\"zIndex\"):\"auto\";return zIndex!==\"auto\";}function isPositioned(container){return container.css(\"position\")!==\"static\";}function isFloating(container){return container.css(\"float\")!==\"none\";}function isInlineBlock(container){return[\"inline-block\",\"inline-table\"].indexOf(container.css(\"display\"))!==-1;}function not(callback){var context=this;return function(){return!callback.apply(context,arguments);};}function isElement(container){return container.node.nodeType===Node.ELEMENT_NODE;}function isPseudoElement(container){return container.isPseudoElement===true;}function isTextNode(container){return container.node.nodeType===Node.TEXT_NODE;}function zIndexSort(contexts){return function(a,b){return a.cssInt(\"zIndex\")+contexts.indexOf(a)/contexts.length-(b.cssInt(\"zIndex\")+contexts.indexOf(b)/contexts.length);};}function hasOpacity(container){return container.getOpacity()<1;}function asInt(value){return parseInt(value,10);}function getWidth(border){return border.width;}function nonIgnoredElement(nodeContainer){return nodeContainer.node.nodeType!==Node.ELEMENT_NODE||[\"SCRIPT\",\"HEAD\",\"TITLE\",\"OBJECT\",\"BR\",\"OPTION\"].indexOf(nodeContainer.node.nodeName)===-1;}function flatten(arrays){return[].concat.apply([],arrays);}function stripQuotes(content){var first=content.substr(0,1);return first===content.substr(content.length-1)&&first.match(/'|\"/)?content.substr(1,content.length-2):content;}function getWords(characters){var words=[],i=0,onWordBoundary=false,word;while(characters.length){if(isWordBoundary(characters[i])===onWordBoundary){word=characters.splice(0,i);if(word.length){words.push(punycode.ucs2.encode(word));}onWordBoundary=!onWordBoundary;i=0;}else{i++;}if(i>=characters.length){word=characters.splice(0,i);if(word.length){words.push(punycode.ucs2.encode(word));}}}return words;}function isWordBoundary(characterCode){return[32,// <space>\n\t13,// \\r\n\t10,// \\n\n\t9,// \\t\n\t45// -\n\t].indexOf(characterCode)!==-1;}function hasUnicode(string){return /[^\\u0000-\\u00ff]/.test(string);}module.exports=NodeParser;},{\"./color\":3,\"./fontmetrics\":7,\"./log\":13,\"./nodecontainer\":14,\"./pseudoelementcontainer\":18,\"./stackingcontext\":21,\"./textcontainer\":25,\"./utils\":26,\"punycode\":1}],16:[function(_dereq_,module,exports){var XHR=_dereq_('./xhr');var utils=_dereq_('./utils');var log=_dereq_('./log');var createWindowClone=_dereq_('./clone');var decode64=utils.decode64;function Proxy(src,proxyUrl,document){var supportsCORS='withCredentials'in new XMLHttpRequest();if(!proxyUrl){return Promise.reject(\"No proxy configured\");}var callback=createCallback(supportsCORS);var url=createProxyUrl(proxyUrl,src,callback);return supportsCORS?XHR(url):jsonp(document,url,callback).then(function(response){return decode64(response.content);});}var proxyCount=0;function ProxyURL(src,proxyUrl,document){var supportsCORSImage='crossOrigin'in new Image();var callback=createCallback(supportsCORSImage);var url=createProxyUrl(proxyUrl,src,callback);return supportsCORSImage?Promise.resolve(url):jsonp(document,url,callback).then(function(response){return\"data:\"+response.type+\";base64,\"+response.content;});}function jsonp(document,url,callback){return new Promise(function(resolve,reject){var s=document.createElement(\"script\");var cleanup=function cleanup(){delete window.html2canvas.proxy[callback];document.body.removeChild(s);};window.html2canvas.proxy[callback]=function(response){cleanup();resolve(response);};s.src=url;s.onerror=function(e){cleanup();reject(e);};document.body.appendChild(s);});}function createCallback(useCORS){return!useCORS?\"html2canvas_\"+Date.now()+\"_\"+ ++proxyCount+\"_\"+Math.round(Math.random()*100000):\"\";}function createProxyUrl(proxyUrl,src,callback){return proxyUrl+\"?url=\"+encodeURIComponent(src)+(callback.length?\"&callback=html2canvas.proxy.\"+callback:\"\");}function documentFromHTML(src){return function(html){var parser=new DOMParser(),doc;try{doc=parser.parseFromString(html,\"text/html\");}catch(e){log(\"DOMParser not supported, falling back to createHTMLDocument\");doc=document.implementation.createHTMLDocument(\"\");try{doc.open();doc.write(html);doc.close();}catch(ee){log(\"createHTMLDocument write not supported, falling back to document.body.innerHTML\");doc.body.innerHTML=html;// ie9 doesnt support writing to documentElement\n\t}}var b=doc.querySelector(\"base\");if(!b||!b.href.host){var base=doc.createElement(\"base\");base.href=src;doc.head.insertBefore(base,doc.head.firstChild);}return doc;};}function loadUrlDocument(src,proxy,document,width,height,options){return new Proxy(src,proxy,window.document).then(documentFromHTML(src)).then(function(doc){return createWindowClone(doc,document,width,height,options,0,0);});}exports.Proxy=Proxy;exports.ProxyURL=ProxyURL;exports.loadUrlDocument=loadUrlDocument;},{\"./clone\":2,\"./log\":13,\"./utils\":26,\"./xhr\":28}],17:[function(_dereq_,module,exports){var ProxyURL=_dereq_('./proxy').ProxyURL;function ProxyImageContainer(src,proxy){var link=document.createElement(\"a\");link.href=src;src=link.href;this.src=src;this.image=new Image();var self=this;this.promise=new Promise(function(resolve,reject){self.image.crossOrigin=\"Anonymous\";self.image.onload=resolve;self.image.onerror=reject;new ProxyURL(src,proxy,document).then(function(url){self.image.src=url;})['catch'](reject);});}module.exports=ProxyImageContainer;},{\"./proxy\":16}],18:[function(_dereq_,module,exports){var NodeContainer=_dereq_('./nodecontainer');function PseudoElementContainer(node,parent,type){NodeContainer.call(this,node,parent);this.isPseudoElement=true;this.before=type===\":before\";}PseudoElementContainer.prototype.cloneTo=function(stack){PseudoElementContainer.prototype.cloneTo.call(this,stack);stack.isPseudoElement=true;stack.before=this.before;};PseudoElementContainer.prototype=Object.create(NodeContainer.prototype);PseudoElementContainer.prototype.appendToDOM=function(){if(this.before){this.parent.node.insertBefore(this.node,this.parent.node.firstChild);}else{this.parent.node.appendChild(this.node);}this.parent.node.className+=\" \"+this.getHideClass();};PseudoElementContainer.prototype.cleanDOM=function(){this.node.parentNode.removeChild(this.node);this.parent.node.className=this.parent.node.className.replace(this.getHideClass(),\"\");};PseudoElementContainer.prototype.getHideClass=function(){return this[\"PSEUDO_HIDE_ELEMENT_CLASS_\"+(this.before?\"BEFORE\":\"AFTER\")];};PseudoElementContainer.prototype.PSEUDO_HIDE_ELEMENT_CLASS_BEFORE=\"___html2canvas___pseudoelement_before\";PseudoElementContainer.prototype.PSEUDO_HIDE_ELEMENT_CLASS_AFTER=\"___html2canvas___pseudoelement_after\";module.exports=PseudoElementContainer;},{\"./nodecontainer\":14}],19:[function(_dereq_,module,exports){var log=_dereq_('./log');function Renderer(width,height,images,options,document){this.width=width;this.height=height;this.images=images;this.options=options;this.document=document;}Renderer.prototype.renderImage=function(container,bounds,borderData,imageContainer){var paddingLeft=container.cssInt('paddingLeft'),paddingTop=container.cssInt('paddingTop'),paddingRight=container.cssInt('paddingRight'),paddingBottom=container.cssInt('paddingBottom'),borders=borderData.borders;var width=bounds.width-(borders[1].width+borders[3].width+paddingLeft+paddingRight);var height=bounds.height-(borders[0].width+borders[2].width+paddingTop+paddingBottom);this.drawImage(imageContainer,0,0,imageContainer.image.width||width,imageContainer.image.height||height,bounds.left+paddingLeft+borders[3].width,bounds.top+paddingTop+borders[0].width,width,height);};Renderer.prototype.renderBackground=function(container,bounds,borderData){if(bounds.height>0&&bounds.width>0){this.renderBackgroundColor(container,bounds);this.renderBackgroundImage(container,bounds,borderData);}};Renderer.prototype.renderBackgroundColor=function(container,bounds){var color=container.color(\"backgroundColor\");if(!color.isTransparent()){this.rectangle(bounds.left,bounds.top,bounds.width,bounds.height,color);}};Renderer.prototype.renderBorders=function(borders){borders.forEach(this.renderBorder,this);};Renderer.prototype.renderBorder=function(data){if(!data.color.isTransparent()&&data.args!==null){this.drawShape(data.args,data.color);}};Renderer.prototype.renderBackgroundImage=function(container,bounds,borderData){var backgroundImages=container.parseBackgroundImages();backgroundImages.reverse().forEach(function(backgroundImage,index,arr){switch(backgroundImage.method){case\"url\":var image=this.images.get(backgroundImage.args[0]);if(image){this.renderBackgroundRepeating(container,bounds,image,arr.length-(index+1),borderData);}else{log(\"Error loading background-image\",backgroundImage.args[0]);}break;case\"linear-gradient\":case\"gradient\":var gradientImage=this.images.get(backgroundImage.value);if(gradientImage){this.renderBackgroundGradient(gradientImage,bounds,borderData);}else{log(\"Error loading background-image\",backgroundImage.args[0]);}break;case\"none\":break;default:log(\"Unknown background-image type\",backgroundImage.args[0]);}},this);};Renderer.prototype.renderBackgroundRepeating=function(container,bounds,imageContainer,index,borderData){var size=container.parseBackgroundSize(bounds,imageContainer.image,index);var position=container.parseBackgroundPosition(bounds,imageContainer.image,index,size);var repeat=container.parseBackgroundRepeat(index);switch(repeat){case\"repeat-x\":case\"repeat no-repeat\":this.backgroundRepeatShape(imageContainer,position,size,bounds,bounds.left+borderData[3],bounds.top+position.top+borderData[0],99999,size.height,borderData);break;case\"repeat-y\":case\"no-repeat repeat\":this.backgroundRepeatShape(imageContainer,position,size,bounds,bounds.left+position.left+borderData[3],bounds.top+borderData[0],size.width,99999,borderData);break;case\"no-repeat\":this.backgroundRepeatShape(imageContainer,position,size,bounds,bounds.left+position.left+borderData[3],bounds.top+position.top+borderData[0],size.width,size.height,borderData);break;default:this.renderBackgroundRepeat(imageContainer,position,size,{top:bounds.top,left:bounds.left},borderData[3],borderData[0]);break;}};module.exports=Renderer;},{\"./log\":13}],20:[function(_dereq_,module,exports){var Renderer=_dereq_('../renderer');var LinearGradientContainer=_dereq_('../lineargradientcontainer');var log=_dereq_('../log');function CanvasRenderer(width,height){Renderer.apply(this,arguments);this.canvas=this.options.canvas||this.document.createElement(\"canvas\");if(!this.options.canvas){this.canvas.width=width;this.canvas.height=height;}this.ctx=this.canvas.getContext(\"2d\");this.taintCtx=this.document.createElement(\"canvas\").getContext(\"2d\");this.ctx.textBaseline=\"bottom\";this.variables={};log(\"Initialized CanvasRenderer with size\",width,\"x\",height);}CanvasRenderer.prototype=Object.create(Renderer.prototype);CanvasRenderer.prototype.setFillStyle=function(fillStyle){this.ctx.fillStyle=(typeof fillStyle===\"undefined\"?\"undefined\":_typeof(fillStyle))===\"object\"&&!!fillStyle.isColor?fillStyle.toString():fillStyle;return this.ctx;};CanvasRenderer.prototype.rectangle=function(left,top,width,height,color){this.setFillStyle(color).fillRect(left,top,width,height);};CanvasRenderer.prototype.circle=function(left,top,size,color){this.setFillStyle(color);this.ctx.beginPath();this.ctx.arc(left+size/2,top+size/2,size/2,0,Math.PI*2,true);this.ctx.closePath();this.ctx.fill();};CanvasRenderer.prototype.circleStroke=function(left,top,size,color,stroke,strokeColor){this.circle(left,top,size,color);this.ctx.strokeStyle=strokeColor.toString();this.ctx.stroke();};CanvasRenderer.prototype.drawShape=function(shape,color){this.shape(shape);this.setFillStyle(color).fill();};CanvasRenderer.prototype.taints=function(imageContainer){if(imageContainer.tainted===null){this.taintCtx.drawImage(imageContainer.image,0,0);try{this.taintCtx.getImageData(0,0,1,1);imageContainer.tainted=false;}catch(e){this.taintCtx=document.createElement(\"canvas\").getContext(\"2d\");imageContainer.tainted=true;}}return imageContainer.tainted;};CanvasRenderer.prototype.drawImage=function(imageContainer,sx,sy,sw,sh,dx,dy,dw,dh){if(!this.taints(imageContainer)||this.options.allowTaint){this.ctx.drawImage(imageContainer.image,sx,sy,sw,sh,dx,dy,dw,dh);}};CanvasRenderer.prototype.clip=function(shapes,callback,context){this.ctx.save();shapes.filter(hasEntries).forEach(function(shape){this.shape(shape).clip();},this);callback.call(context);this.ctx.restore();};CanvasRenderer.prototype.shape=function(shape){this.ctx.beginPath();shape.forEach(function(point,index){if(point[0]===\"rect\"){this.ctx.rect.apply(this.ctx,point.slice(1));}else{this.ctx[index===0?\"moveTo\":point[0]+\"To\"].apply(this.ctx,point.slice(1));}},this);this.ctx.closePath();return this.ctx;};CanvasRenderer.prototype.font=function(color,style,variant,weight,size,family){this.setFillStyle(color).font=[style,variant,weight,size,family].join(\" \").split(\",\")[0];};CanvasRenderer.prototype.fontShadow=function(color,offsetX,offsetY,blur){this.setVariable(\"shadowColor\",color.toString()).setVariable(\"shadowOffsetY\",offsetX).setVariable(\"shadowOffsetX\",offsetY).setVariable(\"shadowBlur\",blur);};CanvasRenderer.prototype.clearShadow=function(){this.setVariable(\"shadowColor\",\"rgba(0,0,0,0)\");};CanvasRenderer.prototype.setOpacity=function(opacity){this.ctx.globalAlpha=opacity;};CanvasRenderer.prototype.setTransform=function(transform){this.ctx.translate(transform.origin[0],transform.origin[1]);this.ctx.transform.apply(this.ctx,transform.matrix);this.ctx.translate(-transform.origin[0],-transform.origin[1]);};CanvasRenderer.prototype.setVariable=function(property,value){if(this.variables[property]!==value){this.variables[property]=this.ctx[property]=value;}return this;};CanvasRenderer.prototype.text=function(text,left,bottom){this.ctx.fillText(text,left,bottom);};CanvasRenderer.prototype.backgroundRepeatShape=function(imageContainer,backgroundPosition,size,bounds,left,top,width,height,borderData){var shape=[[\"line\",Math.round(left),Math.round(top)],[\"line\",Math.round(left+width),Math.round(top)],[\"line\",Math.round(left+width),Math.round(height+top)],[\"line\",Math.round(left),Math.round(height+top)]];this.clip([shape],function(){this.renderBackgroundRepeat(imageContainer,backgroundPosition,size,bounds,borderData[3],borderData[0]);},this);};CanvasRenderer.prototype.renderBackgroundRepeat=function(imageContainer,backgroundPosition,size,bounds,borderLeft,borderTop){var offsetX=Math.round(bounds.left+backgroundPosition.left+borderLeft),offsetY=Math.round(bounds.top+backgroundPosition.top+borderTop);this.setFillStyle(this.ctx.createPattern(this.resizeImage(imageContainer,size),\"repeat\"));this.ctx.translate(offsetX,offsetY);this.ctx.fill();this.ctx.translate(-offsetX,-offsetY);};CanvasRenderer.prototype.renderBackgroundGradient=function(gradientImage,bounds){if(gradientImage instanceof LinearGradientContainer){var gradient=this.ctx.createLinearGradient(bounds.left+bounds.width*gradientImage.x0,bounds.top+bounds.height*gradientImage.y0,bounds.left+bounds.width*gradientImage.x1,bounds.top+bounds.height*gradientImage.y1);gradientImage.colorStops.forEach(function(colorStop){gradient.addColorStop(colorStop.stop,colorStop.color.toString());});this.rectangle(bounds.left,bounds.top,bounds.width,bounds.height,gradient);}};CanvasRenderer.prototype.resizeImage=function(imageContainer,size){var image=imageContainer.image;if(image.width===size.width&&image.height===size.height){return image;}var ctx,canvas=document.createElement('canvas');canvas.width=size.width;canvas.height=size.height;ctx=canvas.getContext(\"2d\");ctx.drawImage(image,0,0,image.width,image.height,0,0,size.width,size.height);return canvas;};function hasEntries(array){return array.length>0;}module.exports=CanvasRenderer;},{\"../lineargradientcontainer\":12,\"../log\":13,\"../renderer\":19}],21:[function(_dereq_,module,exports){var NodeContainer=_dereq_('./nodecontainer');function StackingContext(hasOwnStacking,opacity,element,parent){NodeContainer.call(this,element,parent);this.ownStacking=hasOwnStacking;this.contexts=[];this.children=[];this.opacity=(this.parent?this.parent.stack.opacity:1)*opacity;}StackingContext.prototype=Object.create(NodeContainer.prototype);StackingContext.prototype.getParentStack=function(context){var parentStack=this.parent?this.parent.stack:null;return parentStack?parentStack.ownStacking?parentStack:parentStack.getParentStack(context):context.stack;};module.exports=StackingContext;},{\"./nodecontainer\":14}],22:[function(_dereq_,module,exports){function Support(document){this.rangeBounds=this.testRangeBounds(document);this.cors=this.testCORS();this.svg=this.testSVG();}Support.prototype.testRangeBounds=function(document){var range,testElement,rangeBounds,rangeHeight,support=false;if(document.createRange){range=document.createRange();if(range.getBoundingClientRect){testElement=document.createElement('boundtest');testElement.style.height=\"123px\";testElement.style.display=\"block\";document.body.appendChild(testElement);range.selectNode(testElement);rangeBounds=range.getBoundingClientRect();rangeHeight=rangeBounds.height;if(rangeHeight===123){support=true;}document.body.removeChild(testElement);}}return support;};Support.prototype.testCORS=function(){return typeof new Image().crossOrigin!==\"undefined\";};Support.prototype.testSVG=function(){var img=new Image();var canvas=document.createElement(\"canvas\");var ctx=canvas.getContext(\"2d\");img.src=\"data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg'></svg>\";try{ctx.drawImage(img,0,0);canvas.toDataURL();}catch(e){return false;}return true;};module.exports=Support;},{}],23:[function(_dereq_,module,exports){var XHR=_dereq_('./xhr');var decode64=_dereq_('./utils').decode64;function SVGContainer(src){this.src=src;this.image=null;var self=this;this.promise=this.hasFabric().then(function(){return self.isInline(src)?Promise.resolve(self.inlineFormatting(src)):XHR(src);}).then(function(svg){return new Promise(function(resolve){window.html2canvas.svg.fabric.loadSVGFromString(svg,self.createCanvas.call(self,resolve));});});}SVGContainer.prototype.hasFabric=function(){return!window.html2canvas.svg||!window.html2canvas.svg.fabric?Promise.reject(new Error(\"html2canvas.svg.js is not loaded, cannot render svg\")):Promise.resolve();};SVGContainer.prototype.inlineFormatting=function(src){return /^data:image\\/svg\\+xml;base64,/.test(src)?this.decode64(this.removeContentType(src)):this.removeContentType(src);};SVGContainer.prototype.removeContentType=function(src){return src.replace(/^data:image\\/svg\\+xml(;base64)?,/,'');};SVGContainer.prototype.isInline=function(src){return /^data:image\\/svg\\+xml/i.test(src);};SVGContainer.prototype.createCanvas=function(resolve){var self=this;return function(objects,options){var canvas=new window.html2canvas.svg.fabric.StaticCanvas('c');self.image=canvas.lowerCanvasEl;canvas.setWidth(options.width).setHeight(options.height).add(window.html2canvas.svg.fabric.util.groupSVGElements(objects,options)).renderAll();resolve(canvas.lowerCanvasEl);};};SVGContainer.prototype.decode64=function(str){return typeof window.atob===\"function\"?window.atob(str):decode64(str);};module.exports=SVGContainer;},{\"./utils\":26,\"./xhr\":28}],24:[function(_dereq_,module,exports){var SVGContainer=_dereq_('./svgcontainer');function SVGNodeContainer(node,_native){this.src=node;this.image=null;var self=this;this.promise=_native?new Promise(function(resolve,reject){self.image=new Image();self.image.onload=resolve;self.image.onerror=reject;self.image.src=\"data:image/svg+xml,\"+new XMLSerializer().serializeToString(node);if(self.image.complete===true){resolve(self.image);}}):this.hasFabric().then(function(){return new Promise(function(resolve){window.html2canvas.svg.fabric.parseSVGDocument(node,self.createCanvas.call(self,resolve));});});}SVGNodeContainer.prototype=Object.create(SVGContainer.prototype);module.exports=SVGNodeContainer;},{\"./svgcontainer\":23}],25:[function(_dereq_,module,exports){var NodeContainer=_dereq_('./nodecontainer');function TextContainer(node,parent){NodeContainer.call(this,node,parent);}TextContainer.prototype=Object.create(NodeContainer.prototype);TextContainer.prototype.applyTextTransform=function(){this.node.data=this.transform(this.parent.css(\"textTransform\"));};TextContainer.prototype.transform=function(transform){var text=this.node.data;switch(transform){case\"lowercase\":return text.toLowerCase();case\"capitalize\":return text.replace(/(^|\\s|:|-|\\(|\\))([a-z])/g,capitalize);case\"uppercase\":return text.toUpperCase();default:return text;}};function capitalize(m,p1,p2){if(m.length>0){return p1+p2.toUpperCase();}}module.exports=TextContainer;},{\"./nodecontainer\":14}],26:[function(_dereq_,module,exports){exports.smallImage=function smallImage(){return\"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7\";};exports.bind=function(callback,context){return function(){return callback.apply(context,arguments);};};/*\n\t * base64-arraybuffer\n\t * https://github.com/niklasvh/base64-arraybuffer\n\t *\n\t * Copyright (c) 2012 Niklas von Hertzen\n\t * Licensed under the MIT license.\n\t */exports.decode64=function(base64){var chars=\"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\";var len=base64.length,i,encoded1,encoded2,encoded3,encoded4,byte1,byte2,byte3;var output=\"\";for(i=0;i<len;i+=4){encoded1=chars.indexOf(base64[i]);encoded2=chars.indexOf(base64[i+1]);encoded3=chars.indexOf(base64[i+2]);encoded4=chars.indexOf(base64[i+3]);byte1=encoded1<<2|encoded2>>4;byte2=(encoded2&15)<<4|encoded3>>2;byte3=(encoded3&3)<<6|encoded4;if(encoded3===64){output+=String.fromCharCode(byte1);}else if(encoded4===64||encoded4===-1){output+=String.fromCharCode(byte1,byte2);}else{output+=String.fromCharCode(byte1,byte2,byte3);}}return output;};exports.getBounds=function(node){if(node.getBoundingClientRect){var clientRect=node.getBoundingClientRect();var width=node.offsetWidth==null?clientRect.width:node.offsetWidth;return{top:clientRect.top,bottom:clientRect.bottom||clientRect.top+clientRect.height,right:clientRect.left+width,left:clientRect.left,width:width,height:node.offsetHeight==null?clientRect.height:node.offsetHeight};}return{};};exports.offsetBounds=function(node){var parent=node.offsetParent?exports.offsetBounds(node.offsetParent):{top:0,left:0};return{top:node.offsetTop+parent.top,bottom:node.offsetTop+node.offsetHeight+parent.top,right:node.offsetLeft+parent.left+node.offsetWidth,left:node.offsetLeft+parent.left,width:node.offsetWidth,height:node.offsetHeight};};exports.parseBackgrounds=function(backgroundImage){var whitespace=' \\r\\n\\t',method,definition,prefix,prefix_i,block,results=[],mode=0,numParen=0,quote,args;var appendResult=function appendResult(){if(method){if(definition.substr(0,1)==='\"'){definition=definition.substr(1,definition.length-2);}if(definition){args.push(definition);}if(method.substr(0,1)==='-'&&(prefix_i=method.indexOf('-',1)+1)>0){prefix=method.substr(0,prefix_i);method=method.substr(prefix_i);}results.push({prefix:prefix,method:method.toLowerCase(),value:block,args:args,image:null});}args=[];method=prefix=definition=block='';};args=[];method=prefix=definition=block='';backgroundImage.split(\"\").forEach(function(c){if(mode===0&&whitespace.indexOf(c)>-1){return;}switch(c){case'\"':if(!quote){quote=c;}else if(quote===c){quote=null;}break;case'(':if(quote){break;}else if(mode===0){mode=1;block+=c;return;}else{numParen++;}break;case')':if(quote){break;}else if(mode===1){if(numParen===0){mode=0;block+=c;appendResult();return;}else{numParen--;}}break;case',':if(quote){break;}else if(mode===0){appendResult();return;}else if(mode===1){if(numParen===0&&!method.match(/^url$/i)){args.push(definition);definition='';block+=c;return;}}break;}block+=c;if(mode===0){method+=c;}else{definition+=c;}});appendResult();return results;};},{}],27:[function(_dereq_,module,exports){var GradientContainer=_dereq_('./gradientcontainer');function WebkitGradientContainer(imageData){GradientContainer.apply(this,arguments);this.type=imageData.args[0]===\"linear\"?GradientContainer.TYPES.LINEAR:GradientContainer.TYPES.RADIAL;}WebkitGradientContainer.prototype=Object.create(GradientContainer.prototype);module.exports=WebkitGradientContainer;},{\"./gradientcontainer\":9}],28:[function(_dereq_,module,exports){function XHR(url){return new Promise(function(resolve,reject){var xhr=new XMLHttpRequest();xhr.open('GET',url);xhr.onload=function(){if(xhr.status===200){resolve(xhr.responseText);}else{reject(new Error(xhr.statusText));}};xhr.onerror=function(){reject(new Error(\"Network Error\"));};xhr.send();});}module.exports=XHR;},{}]},{},[4])(4);});\n\t/* WEBPACK VAR INJECTION */}.call(exports, (function() { return this; }())))\n\n/***/ },\n/* 2 */\n/***/ function(module, exports) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\t/**\n\t * base class for all object in the library\n\t * @class Baseobject\n\t */\n\tvar BaseObject = function () {\n\t  function BaseObject() {\n\t    _classCallCheck(this, BaseObject);\n\t  }\n\t\n\t  _createClass(BaseObject, [{\n\t    key: 'getName',\n\t\n\t    /**\n\t     * virtual function for returning class name\n\t     * @returns {string}\n\t     */\n\t    value: function getName() {\n\t      return '';\n\t    }\n\t\n\t    /**\n\t     * returns if current mode is debugging mode\n\t     * @returns {bool}\n\t     */\n\t\n\t  }, {\n\t    key: 'isDebug',\n\t    value: function isDebug() {\n\t      return this._debugMode;\n\t    }\n\t\n\t    /**\n\t     * logs message and object for debugging purpose\n\t     * @param {string} message\n\t     * @param {Array<any>} args\n\t     */\n\t\n\t  }, {\n\t    key: 'log',\n\t    value: function log(message) {\n\t      var _console;\n\t\n\t      if (!this.isDebug()) {\n\t        return;\n\t      }\n\t\n\t      for (var _len = arguments.length, args = Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n\t        args[_key - 1] = arguments[_key];\n\t      }\n\t\n\t      (_console = console).log.apply(_console, [this.getName() + ': ' + message].concat(args));\n\t    }\n\t  }]);\n\t\n\t  return BaseObject;\n\t}();\n\t\n\texports.default = BaseObject;\n\tmodule.exports = exports['default'];\n\n/***/ },\n/* 3 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tvar _baseObject = __webpack_require__(2);\n\t\n\tvar _baseObject2 = _interopRequireDefault(_baseObject);\n\t\n\tvar _rect = __webpack_require__(4);\n\t\n\tvar _rect2 = _interopRequireDefault(_rect);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\t\n\tfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\t\n\t/**\n\t * State enabled class to manage grey canvas on top of html page for cropping\n\t * @class CanvasState\n\t */\n\tvar CanvasState = function (_BaseObject) {\n\t  _inherits(CanvasState, _BaseObject);\n\t\n\t  /**\n\t   * object constructor\n\t   * @param {HTMLDocument} doc\n\t   * @param {HTMLElement} canvas - canvas DOM element\n\t   */\n\t  function CanvasState(doc, canvas) {\n\t    var onSelectionChange = arguments.length <= 2 || arguments[2] === undefined ? function () {} : arguments[2];\n\t    var debugMode = arguments.length <= 3 || arguments[3] === undefined ? true : arguments[3];\n\t\n\t    _classCallCheck(this, CanvasState);\n\t\n\t    var _this = _possibleConstructorReturn(this, (CanvasState.__proto__ || Object.getPrototypeOf(CanvasState)).call(this));\n\t\n\t    _this._onMouseDown = _this._onMouseDown.bind(_this);\n\t    _this._onMouseMove = _this._onMouseMove.bind(_this);\n\t    _this._onMouseUp = _this._onMouseUp.bind(_this);\n\t    _this._onTouch = _this._onTouch.bind(_this);\n\t    _this._onSelectionChange = onSelectionChange;\n\t\n\t    _this._document = doc;\n\t    _this._canvas = canvas;\n\t    _this._width = canvas.width;\n\t    _this._height = canvas.height;\n\t    _this._ctx = canvas.getContext('2d');\n\t    _this._debugMode = debugMode;\n\t\n\t    var html = _this._document.body.parentNode;\n\t\n\t    _this._htmlTop = html.offsetTop;\n\t    _this._htmlLeft = html.offsetLeft;\n\t\n\t    _this._valid = false; // when set to false, the canvas will redraw everything\n\t    _this._shape = null; // the rectangle shape\n\t    _this._dragging = false; // Keep track of when we are dragging\n\t    _this._dragoffx = 0; // See mousedown and mousemove events for explanation\n\t    _this._dragoffy = 0;\n\t\n\t    _this.log('initialized');\n\t\n\t    _this._initRect();\n\t    _this._initEvents();\n\t    _this._onSelectionChange(_this._shape._w, _this._shape._h);\n\t\n\t    _this._interval = 30;\n\t    setInterval(function () {\n\t      _this.draw();\n\t    }, _this._interval);\n\t    return _this;\n\t  }\n\t\n\t  /**\n\t   * returns class name\n\t   * @returns {string}\n\t   */\n\t\n\t\n\t  _createClass(CanvasState, [{\n\t    key: 'getName',\n\t    value: function getName() {\n\t      return 'CanvasState';\n\t    }\n\t  }, {\n\t    key: '_onMouseDown',\n\t    value: function _onMouseDown(e) {\n\t      var _shape = this._shape;\n\t\n\t      var mouse = this.getMouse(e);\n\t      var mx = mouse.x;\n\t      var my = mouse.y;\n\t      this._valid = false;\n\t      if (_shape.contains(mx, my)) {\n\t        this._dragoffx = mx - _shape._x;\n\t        this._dragoffy = my - _shape._y;\n\t        this._dragging = true;\n\t\n\t        this.log('mouse down detected. starting drag', mx, my);\n\t      }\n\t\n\t      this._currentHandle = this._shape.getHoverSelectionHandle(mouse.x, mouse.y);\n\t    }\n\t  }, {\n\t    key: '_onMouseMove',\n\t    value: function _onMouseMove(e) {\n\t      var _shape = this._shape;\n\t      var _canvas = this._canvas;\n\t\n\t      var mouse = this.getMouse(e);\n\t      var oldx = _shape._x;\n\t      var oldy = _shape._y;\n\t      var mx = mouse.x;\n\t      var my = mouse.y;\n\t      var handleIndex = _shape.getHoverSelectionHandle(mx, my);\n\t      switch (handleIndex) {\n\t        case 0:\n\t          _canvas.style.cursor = 'nw-resize';\n\t          break;\n\t        case 1:\n\t          _canvas.style.cursor = 'n-resize';\n\t          break;\n\t        case 2:\n\t          _canvas.style.cursor = 'ne-resize';\n\t          break;\n\t        case 3:\n\t          _canvas.style.cursor = 'w-resize';\n\t          break;\n\t        case 4:\n\t          _canvas.style.cursor = 'e-resize';\n\t          break;\n\t        case 5:\n\t          _canvas.style.cursor = 'sw-resize';\n\t          break;\n\t        case 6:\n\t          _canvas.style.cursor = 's-resize';\n\t          break;\n\t        case 7:\n\t          _canvas.style.cursor = 'se-resize';\n\t          break;\n\t        default:\n\t          _canvas.style.cursor = 'auto';\n\t      }\n\t\n\t      if (this._currentHandle !== false) {\n\t        // Handles resizing\n\t        switch (this._currentHandle) {\n\t          case 0:\n\t            _shape._x = mx;\n\t            _shape._y = my;\n\t            _shape._w += oldx - mx;\n\t            _shape._h += oldy - my;\n\t            break;\n\t          case 1:\n\t            _shape._y = my;\n\t            _shape._h += oldy - my;\n\t            break;\n\t          case 2:\n\t            _shape._y = my;\n\t            _shape._w = mx - oldx;\n\t            _shape._h += oldy - my;\n\t            break;\n\t          case 3:\n\t            _shape._x = mx;\n\t            _shape._w += oldx - mx;\n\t            break;\n\t          case 4:\n\t            _shape._w = mx - oldx;\n\t            break;\n\t          case 5:\n\t            _shape._x = mx;\n\t            _shape._w += oldx - mx;\n\t            _shape._h = my - oldy;\n\t            break;\n\t          case 6:\n\t            _shape._h = my - oldy;\n\t            break;\n\t          case 7:\n\t            _shape._w = mx - oldx;\n\t            _shape._h = my - oldy;\n\t            break;\n\t          default:\n\t            break;\n\t        }\n\t\n\t        this._onSelectionChange(_shape._w, _shape._h);\n\t        this._valid = false;\n\t      } else if (this._dragging) {\n\t        // We don't want to drag the object by its top-left corner, we want to drag it\n\t        // from where we clicked. Thats why we saved the offset and use it here\n\t        this._shape._x = mouse.x - this._dragoffx;\n\t        this._shape._y = mouse.y - this._dragoffy;\n\t        this._valid = false; // Something's dragging so we must redraw\n\t\n\t        // this.log('moving the rect', mouse.x, mouse.y);\n\t      }\n\t    }\n\t  }, {\n\t    key: '_onMouseUp',\n\t    value: function _onMouseUp() {\n\t      this._dragging = false;\n\t      this._currentHandle = false;\n\t    }\n\t\n\t    /**\n\t     * dispatches mouse events on touch\n\t     */\n\t\n\t  }, {\n\t    key: '_onTouch',\n\t    value: function _onTouch(evt) {\n\t      evt.preventDefault(); // prevents touch event to disable scrolling on mobile devices\n\t      if (evt.touches.length > 1 || evt.type === 'touchend' && evt.touches.length > 0) {\n\t        return;\n\t      }\n\t\n\t      var newEvt = this._document.createEvent('MouseEvents');\n\t      var target = evt.target || evt.srcElement || evt.originalTarget;\n\t      var type = null;\n\t      var touch = null;\n\t\n\t      switch (evt.type) {\n\t        case 'touchstart':\n\t          type = 'mousedown';\n\t          touch = evt.changedTouches[0];\n\t          break;\n\t        case 'touchmove':\n\t          type = 'mousemove';\n\t          touch = evt.changedTouches[0];\n\t          break;\n\t        case 'touchend':\n\t          type = 'mouseup';\n\t          touch = evt.changedTouches[0];\n\t          break;\n\t        default:\n\t          break;\n\t      }\n\t\n\t      if (type === 'mousemove' && !this._dragging) {\n\t        // touchmove occurs without mouse down. thus dispatching mousedown is required.\n\t        newEvt.initMouseEvent('mousedown', true, true, target.ownerDocument.defaultView, 0, touch.screenX, touch.screenY, touch.clientX, touch.clientY, evt.ctrlKey, evt.altKey, evt.shiftKey, evt.metaKey, 0, null);\n\t        target.dispatchEvent(newEvt);\n\t      }\n\t\n\t      newEvt.initMouseEvent(type, true, true, target.ownerDocument.defaultView, 0, touch.screenX, touch.screenY, touch.clientX, touch.clientY, evt.ctrlKey, evt.altKey, evt.shiftKey, evt.metaKey, 0, null);\n\t\n\t      target.dispatchEvent(newEvt);\n\t    }\n\t\n\t    /**\n\t     * attaches event handlers to canvas\n\t     * @private\n\t     */\n\t\n\t  }, {\n\t    key: '_initEvents',\n\t    value: function _initEvents() {\n\t      var _canvas = this._canvas;\n\t      // fixes a problem where double clicking causesShape text to get selected on the canvas\n\t\n\t      _canvas.addEventListener('selectstart', function (e) {\n\t        e.preventDefault();\n\t        return false;\n\t      }, false);\n\t\n\t      // up, down, and move are for dragging\n\t      _canvas.addEventListener('mousedown', this._onMouseDown, true);\n\t      _canvas.addEventListener('mousemove', this._onMouseMove, true);\n\t      _canvas.addEventListener('mouseup', this._onMouseUp, true);\n\t\n\t      _canvas.addEventListener('tapstart', this._onTouch, true);\n\t      _canvas.addEventListener('touchmove', this._onTouch, true);\n\t      _canvas.addEventListener('touchend', this._onTouch, true);\n\t\n\t      this.log('initialized events');\n\t    }\n\t\n\t    /**\n\t     * creates a movable rectangle and attach to canvas\n\t     * @private\n\t     */\n\t\n\t  }, {\n\t    key: '_initRect',\n\t    value: function _initRect() {\n\t      this._shape = new _rect2.default(this._width / 4, this._height / 4, this._width / 2, this._height / 2, 'rgba(0, 200, 0, 0.5)', 20, false // debug mode is set as false\n\t      );\n\t      this._valid = false;\n\t    }\n\t\n\t    /**\n\t     * Returns shape positions\n\t     * @returns {{x, y, w, h}}\n\t     */\n\t\n\t  }, {\n\t    key: 'getSelection',\n\t    value: function getSelection() {\n\t      var _shape2 = this._shape;\n\t      var _x = _shape2._x;\n\t      var _y = _shape2._y;\n\t      var _w = _shape2._w;\n\t      var _h = _shape2._h;\n\t\n\t\n\t      return { x: _x, y: _y, w: _w, h: _h };\n\t    }\n\t\n\t    /**\n\t     * clears the canvas for next draw\n\t     */\n\t\n\t  }, {\n\t    key: 'clear',\n\t    value: function clear() {\n\t      this._ctx.clearRect(0, 0, this._width, this._height);\n\t    }\n\t\n\t    /**\n\t     * while draw is called as often as the INTERVAL variable demands,\n\t     * it only ever does something if the canvas gets invalidated by our code\n\t     */\n\t\n\t  }, {\n\t    key: 'draw',\n\t    value: function draw() {\n\t      // if our state is invalid, redraw and validate!\n\t      if (!this._valid) {\n\t        this.log('starting draw');\n\t        var _ctx = this._ctx;\n\t        var _shape = this._shape;\n\t\n\t        this.clear();\n\t\n\t        // fill outside of the rectangle\n\t        _ctx.fillStyle = 'rgba(0,0,0,.8)';\n\t        _ctx.beginPath();\n\t        _ctx.rect(_shape._x, _shape._y, _shape._w, _shape._h);\n\t        _ctx.rect(this._width, 0, -this._width, this._height);\n\t        _ctx.fill();\n\t\n\t        // draw shape\n\t        _shape.draw(_ctx);\n\t\n\t        this._valid = true;\n\t\n\t        this.log('shape drew', _shape._x, _shape._y, _shape._w, _shape._h);\n\t      }\n\t    }\n\t\n\t    /**\n\t     * returns offset for the element\n\t     * @param {DOMElement} element\n\t     * @returns {{x: number, y: number}}\n\t     */\n\t\n\t  }, {\n\t    key: 'getOffset',\n\t    value: function getOffset(element) {\n\t      var el = element;\n\t      var offsetX = 0;\n\t      var offsetY = 0;\n\t\n\t      // Compute the total offset\n\t      if (el.offsetParent !== undefined) {\n\t        do {\n\t          offsetX += el.offsetLeft;\n\t          offsetY += el.offsetTop;\n\t          el = el.offsetParent;\n\t        } while (el);\n\t      }\n\t\n\t      // Also add the <html> offsets in case there's a position:fixed bar\n\t      offsetX += this._htmlLeft;\n\t      offsetY += this._htmlTop;\n\t\n\t      // should handle scrolled position in offset\n\t      offsetX += this._document.body.scrollLeft;\n\t      offsetY += this._document.body.scrollTop;\n\t\n\t      return {\n\t        x: offsetX,\n\t        y: offsetY\n\t      };\n\t    }\n\t\n\t    /**\n\t     * creates an object with x and y defined, set to the mouse position relative to the state's canvas\n\t     * If you wanna be super-correct this can be tricky, we have to worry about padding and borders\n\t     * @param {Event} e\n\t     * @returns {{x: number, y: number}}\n\t     */\n\t\n\t  }, {\n\t    key: 'getMouse',\n\t    value: function getMouse(e) {\n\t      var offset = this.getOffset(this._canvas);\n\t\n\t      var mx = e.pageX - offset.x;\n\t      var my = e.pageY - offset.y;\n\t\n\t      return { x: mx, y: my };\n\t    }\n\t  }]);\n\t\n\t  return CanvasState;\n\t}(_baseObject2.default);\n\t\n\texports.default = CanvasState;\n\tmodule.exports = exports['default'];\n\n/***/ },\n/* 4 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tvar _baseObject = __webpack_require__(2);\n\t\n\tvar _baseObject2 = _interopRequireDefault(_baseObject);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\t\n\tfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\t\n\t/**\n\t * Rectangle for highlighting the cropping area\n\t * @class Rect\n\t */\n\tvar Rect = function (_BaseObject) {\n\t  _inherits(Rect, _BaseObject);\n\t\n\t  /**\n\t   * object constructor\n\t   * @param {number} x - left position of shape\n\t   * @param {number} y - top position of shape\n\t   * @param {number} w - width\n\t   * @param {number} h - height\n\t   * @param {string} fill - background color of the shape\n\t   * @param {number} selectionBoxSize - width/height of selection handle\n\t   * @param {bool} debugMode\n\t   */\n\t  function Rect(x, y, w, h, fill) {\n\t    var selectionBoxSize = arguments.length <= 5 || arguments[5] === undefined ? 6 : arguments[5];\n\t    var debugMode = arguments.length <= 6 || arguments[6] === undefined ? true : arguments[6];\n\t\n\t    _classCallCheck(this, Rect);\n\t\n\t    var _this = _possibleConstructorReturn(this, (Rect.__proto__ || Object.getPrototypeOf(Rect)).call(this));\n\t\n\t    _this._selectionHandles = [];\n\t    _this._selectionBoxSize = selectionBoxSize;\n\t    for (var i = 0; i < 8; i += 1) {\n\t      _this._selectionHandles.push({ x: 0, y: 0 });\n\t    }\n\t\n\t    _this._x = x || 0;\n\t    _this._y = y || 0;\n\t    _this._w = w || 1;\n\t    _this._h = h || 1;\n\t    _this._fill = fill || '#AAAAAA';\n\t    _this._debugMode = debugMode;\n\t\n\t    _this.log('initialized');\n\t    return _this;\n\t  }\n\t\n\t  /**\n\t   * returns class name\n\t   * @returns {string}\n\t   */\n\t\n\t\n\t  _createClass(Rect, [{\n\t    key: 'getName',\n\t    value: function getName() {\n\t      return 'Rect';\n\t    }\n\t\n\t    /**\n\t     * draws the shape\n\t     * @param {CanvasContext} ctx\n\t     */\n\t\n\t  }, {\n\t    key: 'draw',\n\t    value: function draw(ctx) {\n\t      var _x = this._x;\n\t      var _y = this._y;\n\t      var _w = this._w;\n\t      var _h = this._h;\n\t      var _fill = this._fill;\n\t      var _selectionHandles = this._selectionHandles;\n\t      var _selectionBoxSize = this._selectionBoxSize;\n\t\n\t      ctx.fillStyle = _fill; // eslint-disable-line\n\t      ctx.strokeStyle = 'white'; // eslint-disable-line\n\t      ctx.lineWidth = 1; // eslint-disable-line\n\t      ctx.setLineDash([7, 7]);\n\t      ctx.strokeRect(_x, _y, _w, _h);\n\t\n\t      var half = _selectionBoxSize / 2;\n\t\n\t      // top left, middle, right\n\t      _selectionHandles[0].x = _x - half;\n\t      _selectionHandles[0].y = _y - half;\n\t\n\t      _selectionHandles[1].x = _x + _w / 2 - half;\n\t      _selectionHandles[1].y = _y - half;\n\t\n\t      _selectionHandles[2].x = _x + _w - half;\n\t      _selectionHandles[2].y = _y - half;\n\t\n\t      // middle left\n\t      _selectionHandles[3].x = _x - half;\n\t      _selectionHandles[3].y = _y + _h / 2 - half;\n\t\n\t      // middle right\n\t      _selectionHandles[4].x = _x + _w - half;\n\t      _selectionHandles[4].y = _y + _h / 2 - half;\n\t\n\t      // bottom left, middle, right\n\t      _selectionHandles[6].x = _x + _w / 2 - half;\n\t      _selectionHandles[6].y = _y + _h - half;\n\t\n\t      _selectionHandles[5].x = _x - half;\n\t      _selectionHandles[5].y = _y + _h - half;\n\t\n\t      _selectionHandles[7].x = _x + _w - half;\n\t      _selectionHandles[7].y = _y + _h - half;\n\t\n\t      this.log('drawing selection boxes');\n\t      ctx.fillStyle = 'white'; // eslint-disable-line\n\t      _selectionHandles.forEach(function (cur) {\n\t        ctx.fillRect(cur.x, cur.y, _selectionBoxSize, _selectionBoxSize);\n\t      });\n\t\n\t      this.log('filling the rectangle', _x, _y, _w, _h);\n\t    }\n\t\n\t    /**\n\t     * checks if point is inside the shape\n\t     * @param {number} mx\n\t     * @param {number} my\n\t     * @returns {bool}\n\t     */\n\t\n\t  }, {\n\t    key: 'contains',\n\t    value: function contains(mx, my) {\n\t      var _x = this._x;\n\t      var _y = this._y;\n\t      var _w = this._w;\n\t      var _h = this._h;\n\t\n\t      return _x <= mx && _x + _w >= mx && _y <= my && _y + _h >= my;\n\t    }\n\t\n\t    /**\n\t     * returns selection handle if point is inside\n\t     * @param {number} mx\n\t     * @param {number} my\n\t     * @returns {?number}\n\t     */\n\t\n\t  }, {\n\t    key: 'getHoverSelectionHandle',\n\t    value: function getHoverSelectionHandle(mx, my) {\n\t      var _selectionHandles = this._selectionHandles;\n\t      var _selectionBoxSize = this._selectionBoxSize;\n\t\n\t      for (var i = 0; i < _selectionHandles.length; i += 1) {\n\t        var handle = _selectionHandles[i];\n\t        if (handle.x <= mx && handle.x + _selectionBoxSize >= mx && handle.y <= my && handle.y + _selectionBoxSize >= my) {\n\t          return i;\n\t        }\n\t      }\n\t\n\t      return false;\n\t    }\n\t  }]);\n\t\n\t  return Rect;\n\t}(_baseObject2.default);\n\t\n\texports.default = Rect;\n\tmodule.exports = exports['default'];\n\n/***/ },\n/* 5 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\texports.selectStyles = exports.sendBtnStyles = exports.progressDivStyles = exports.actionDivStyles = exports.infoDivStyles = exports.modalWindowStyles = exports.overlayStyles = undefined;\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tvar _baseObject = __webpack_require__(2);\n\t\n\tvar _baseObject2 = _interopRequireDefault(_baseObject);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\t\n\tfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\t\n\tvar overlayStyles = exports.overlayStyles = {\n\t  position: 'fixed',\n\t  left: '0',\n\t  top: '0',\n\t  bottom: '0',\n\t  right: '0',\n\t  'z-index': '9999998',\n\t  display: 'flex',\n\t  'justify-content': 'center',\n\t  'align-items': 'center',\n\t  'background-color': 'rgba(0,0,0,.7)'\n\t};\n\t\n\tvar modalWindowStyles = exports.modalWindowStyles = {\n\t  'background-color': 'white',\n\t  display: 'flex',\n\t  color: 'black',\n\t  'justify-content': 'center',\n\t  'align-items': 'center',\n\t  'flex-direction': 'column',\n\t  'box-shadow': '5px 5px 5px #000'\n\t};\n\t\n\tvar infoDivStyles = exports.infoDivStyles = {\n\t  'margin-top': '5px',\n\t  'font-size': '12px',\n\t  color: 'black'\n\t};\n\t\n\tvar actionDivStyles = exports.actionDivStyles = {\n\t  'margin-top': '10px',\n\t  display: 'flex',\n\t  'justify-content': 'center',\n\t  'align-items': 'center',\n\t  'flex-direction': 'row'\n\t};\n\t\n\tvar progressDivStyles = exports.progressDivStyles = {\n\t  'margin-top': '10px'\n\t};\n\t\n\tvar sendBtnStyles = exports.sendBtnStyles = {\n\t  'margin-right': '10px'\n\t};\n\t\n\tvar selectStyles = exports.selectStyles = {\n\t  'margin-right': '10px'\n\t};\n\t\n\t/**\n\t * Modal window for preview cropped image before compressing and sending to server.\n\t * @class PreviewModal\n\t */\n\t\n\tvar PreviewModal = function (_BaseObject) {\n\t  _inherits(PreviewModal, _BaseObject);\n\t\n\t  /**\n\t   * object constructor\n\t   * @param {HTMLDocument} doc\n\t   * @param {HTMLDOMElement} canvas\n\t   * @param {string} serverURL\n\t   */\n\t  function PreviewModal(doc, canvas, serverURL) {\n\t    _classCallCheck(this, PreviewModal);\n\t\n\t    var _this = _possibleConstructorReturn(this, (PreviewModal.__proto__ || Object.getPrototypeOf(PreviewModal)).call(this));\n\t\n\t    _this._document = doc;\n\t    _this._canvas = canvas;\n\t    _this._serverURL = serverURL;\n\t    _this._width = doc.body.clientWidth;\n\t    _this._height = doc.body.clientHeight;\n\t    _this._compressionRatio = 1;\n\t    _this._fileFormat = 'image/jpeg';\n\t    _this._debugMode = true;\n\t\n\t    var overlayDiv = _this._document.createElement('div');\n\t    _this._overlayDiv = overlayDiv;\n\t    _this._applyStyles(overlayDiv, overlayStyles);\n\t\n\t    var modalWindow = _this._document.createElement('div');\n\t    modalWindow.style.width = _this._width / 1.5;\n\t    modalWindow.style.height = _this._height / 1.5;\n\t    _this._applyStyles(modalWindow, modalWindowStyles);\n\t\n\t    var infoDiv = _this._document.createElement('div');\n\t    _this._infoDiv = infoDiv;\n\t    _this._applyStyles(infoDiv, infoDivStyles);\n\t\n\t    var actionDiv = _this._document.createElement('div');\n\t    _this._actionDiv = actionDiv;\n\t    _this._applyStyles(actionDiv, actionDivStyles);\n\t\n\t    var sendBtn = _this._document.createElement('button');\n\t    sendBtn.appendChild(_this._document.createTextNode('Submit Image'));\n\t    _this._sendBtn = sendBtn;\n\t    sendBtn.onclick = _this.sendImage.bind(_this);\n\t    _this._applyStyles(sendBtn, sendBtnStyles);\n\t\n\t    var cancelBtn = _this._document.createElement('button');\n\t    _this._cancelBtn = cancelBtn;\n\t    cancelBtn.appendChild(_this._document.createTextNode('Cancel'));\n\t    cancelBtn.onclick = _this.removeModal.bind(_this);\n\t\n\t    var fileFormatSelect = _this._document.createElement('select');\n\t    _this._fileFormatSelect = fileFormatSelect;\n\t    _this._applyStyles(fileFormatSelect, selectStyles);\n\t    fileFormatSelect.innerHTML = '\\n      <option value=\"image/jpeg\" selected>image/jpeg</option>\\n      <option value=\"image/gif\">image/gif</option>\\n    ';\n\t    fileFormatSelect.onchange = _this.updateImage.bind(_this);\n\t\n\t    var compressionRatioSelect = _this._document.createElement('select');\n\t    _this._compressionRatioSelect = compressionRatioSelect;\n\t    _this._applyStyles(compressionRatioSelect, selectStyles);\n\t    compressionRatioSelect.innerHTML = '\\n      <option value=\"1\" selected>100%</option>\\n      <option value=\"0.9\">90%</option>\\n      <option value=\"0.8\">80%</option>\\n      <option value=\"0.7\">70%</option>\\n      <option value=\"0.6\">60%</option>\\n      <option value=\"0.5\">50%</option>\\n      <option value=\"0.4\">40%</option>\\n      <option value=\"0.3\">30%</option>\\n      <option value=\"0.2\">20%</option>\\n      <option value=\"0.1\">10%</option>\\n    ';\n\t    compressionRatioSelect.onchange = _this.updateImage.bind(_this);\n\t\n\t    var progressDiv = _this._document.createElement('div');\n\t    progressDiv.innerHTML = 'Not uploaded yet';\n\t    _this._progressDiv = progressDiv;\n\t    _this._applyStyles(progressDiv, progressDivStyles);\n\t\n\t    var img = _this._document.createElement('img');\n\t    _this._img = img;\n\t    img.style['max-width'] = _this._width / 2;\n\t    img.style['max-height'] = _this._height / 2;\n\t    _this.updateImage();\n\t\n\t    actionDiv.appendChild(fileFormatSelect);\n\t    actionDiv.appendChild(compressionRatioSelect);\n\t    actionDiv.appendChild(sendBtn);\n\t    actionDiv.appendChild(progressDiv);\n\t    actionDiv.appendChild(cancelBtn);\n\t    modalWindow.appendChild(img);\n\t    modalWindow.appendChild(infoDiv);\n\t    modalWindow.appendChild(actionDiv);\n\t    modalWindow.appendChild(progressDiv);\n\t    overlayDiv.appendChild(modalWindow);\n\t    _this._document.body.appendChild(overlayDiv);\n\t    return _this;\n\t  }\n\t\n\t  /**\n\t   * returns class name\n\t   * @returns {string}\n\t   */\n\t\n\t\n\t  _createClass(PreviewModal, [{\n\t    key: 'getName',\n\t    value: function getName() {\n\t      return 'PreviewModal';\n\t    }\n\t\n\t    /**\n\t     * apply styles to dom element\n\t     * @param {HTMLDOMElement} element\n\t     * @param {Object} styles\n\t     * @private\n\t     */\n\t\n\t  }, {\n\t    key: '_applyStyles',\n\t    value: function _applyStyles(element, styles) {\n\t      Object.keys(styles).forEach(function (key) {\n\t        element.style[key] = styles[key]; // eslint-disable-line\n\t      });\n\t    }\n\t\n\t    /**\n\t     * removes preview modal window\n\t     */\n\t\n\t  }, {\n\t    key: 'removeModal',\n\t    value: function removeModal() {\n\t      if (this._overlayDiv) {\n\t        this._document.body.removeChild(this._overlayDiv);\n\t        this._overlayDiv = null;\n\t      }\n\t    }\n\t\n\t    /**\n\t     * sends image to server\n\t     */\n\t\n\t  }, {\n\t    key: 'sendImage',\n\t    value: function sendImage() {\n\t      var _this2 = this;\n\t\n\t      var formData = new FormData();\n\t      formData.append('image', this.getImage());\n\t      formData.append('type', this._fileFormat);\n\t      var xhr = new XMLHttpRequest();\n\t      xhr.addEventListener('load', function () {\n\t        _this2.log('finished uploading');\n\t      });\n\t\n\t      xhr.addEventListener('progress', function (e) {\n\t        if (e.lengthComputable) {\n\t          var percentage = Math.round(e.loaded / e.total * 100);\n\t          _this2.log(percentage + '% complete');\n\t          _this2._progressDiv.innerHTML = percentage + '% complete';\n\t        }\n\t      });\n\t      xhr.addEventListener('error', function () {\n\t        _this2.log('uploading failed');\n\t      });\n\t      xhr.addEventListener('abort', function () {\n\t        _this2.log('uploading aborted');\n\t      });\n\t      xhr.open('POST', this._serverURL, true);\n\t      xhr.send(formData);\n\t    }\n\t\n\t    /**\n\t     * return image from canvas and calculate size\n\t     * @returns {ImageData}\n\t     */\n\t\n\t  }, {\n\t    key: 'getImage',\n\t    value: function getImage() {\n\t      var _canvas = this._canvas;\n\t\n\t      var dataURL = _canvas.toDataURL(this._fileFormat, this._compressionRatio);\n\t      var header = 'data:' + this._fileFormat + ';base64,';\n\t      var fileSize = Math.round((dataURL.length - header.length) * 3 / 4 / 100) / 10;\n\t      this._infoDiv.innerHTML = 'w: ' + _canvas.width + ' h: ' + _canvas.height + ' size: ' + fileSize + 'KB';\n\t      return dataURL;\n\t    }\n\t\n\t    /**\n\t     * update image preview\n\t     */\n\t\n\t  }, {\n\t    key: 'updateImage',\n\t    value: function updateImage() {\n\t      if (!this._img) {\n\t        return;\n\t      }\n\t\n\t      this._fileFormat = this._fileFormatSelect.value;\n\t      this._compressionRatio = this._compressionRatioSelect.value * 1;\n\t\n\t      this._img.src = this.getImage();\n\t    }\n\t  }]);\n\t\n\t  return PreviewModal;\n\t}(_baseObject2.default);\n\t\n\texports.default = PreviewModal;\n\n/***/ }\n/******/ ])\n});\n;\n\n\n/** WEBPACK FOOTER **\n ** HtmlCrop.min.js\n **/"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n/** WEBPACK FOOTER **\n ** webpack/bootstrap be71e92647ce8c0ad117\n **/","import html2canvas from 'html2canvas';\nimport BaseObject from './base-object';\nimport CanvasState from './canvas-state';\nimport PreviewModal from './preview-modal';\n\nconst defaultOptions = {\n  key: {\n    ctrlKey: false,\n    shiftKey: true,\n    key: 'F7'\n  },\n  serverURL: '',\n  startButton: true,\n  debug: true\n};\n\nexport default class HtmlCrop extends BaseObject {\n  /**\n   * object constructor\n   * @param {HTMLDocument} doc\n   * @param {Object} options\n   */\n  constructor(doc, options = {}) {\n    super();\n\n    this._document = doc;\n    this.options = Object.assign({}, defaultOptions, options);\n    this._debugMode = options.debug;\n    this.log('initialized');\n\n    // bind this context into keydown event here\n    // because it needs to be removed later\n    this._onKeyDown = this._onKeyDown.bind(this);\n\n    this.reset();\n  }\n\n  /**\n   * resets to starting state\n   */\n  reset() {\n    this._listenHotKey();\n\n    if (this.options.startButton) {\n      this._attachStartButton();\n    }\n  }\n\n  /**\n   * starts cropping the page\n   */\n  startCropping() {\n    if (this._started) {\n      return;\n    }\n\n    this._started = true;\n    this._disableScroll();\n\n    html2canvas(this._document.html).then((canvas) => {\n      this._canvas = canvas;\n\n      const selectionCanvas = this._document.createElement('canvas');\n      this._selectionCanvas = selectionCanvas;\n      selectionCanvas.width = canvas.width;\n      selectionCanvas.height = canvas.height;\n      selectionCanvas.style.position = 'fixed';\n      selectionCanvas.style.left = '0';\n      selectionCanvas.style.top = '0';\n      selectionCanvas.style['z-index'] = 9999997;\n\n      this._document.body.appendChild(selectionCanvas);\n\n      // debug mode is set as false because of lots of logging\n      this._attachCaptureButton();\n      this._canvasState = new CanvasState(this._document, selectionCanvas, this._renderSelection.bind(this), true);\n\n      // removes start button and event listener to avoid multiple cropping instances\n      if (this._startButton) {\n        this._document.body.removeChild(this._startButton);\n      }\n      this._document.removeEventListener('keydown', this._onKeyDown);\n    });\n  }\n\n  /**\n   * ends cropping\n   */\n  endCropping() {\n    if (!this._started) {\n      return;\n    }\n\n    this._started = false;\n    if (this._captureButton) {\n      this._document.body.removeChild(this._captureButton);\n      this._document.body.removeChild(this._cancelButton);\n      this._document.body.removeChild(this._infoDiv);\n    }\n\n    if (this._selectionCanvas) {\n      this._document.body.removeChild(this._selectionCanvas);\n    }\n\n    this.reset();\n  }\n\n  /**\n   * returns class name\n   * @returns {string}\n   */\n  getName() {\n    return 'HtmlCrop';\n  }\n\n  /**\n   * attaches listener which triggers cropping\n   */\n  _listenHotKey() {\n    this._document.addEventListener('keydown', this._onKeyDown);\n  }\n\n  /**\n   * attaches start cropping button\n   */\n  _attachStartButton() {\n    const { _document } = this;\n    const button = _document.createElement('button');\n    const textNode = _document.createTextNode('Start Cropping');\n    button.appendChild(textNode);\n    button.style.position = 'fixed';\n    button.style.right = '30px';\n    button.style.bottom = '30px';\n    button.style['z-index'] = 9999997;\n    button.onclick = this.startCropping.bind(this);\n\n    this._startButton = button;\n    _document.body.appendChild(button);\n  }\n\n  /**\n   * attaches button to capture\n   * @private\n   */\n  _attachCaptureButton() {\n    const { _document } = this;\n    const captureBtn = _document.createElement('button');\n    let textNode = _document.createTextNode('Capture');\n    captureBtn.appendChild(textNode);\n    captureBtn.style.position = 'fixed';\n    captureBtn.style.right = '30px';\n    captureBtn.style.bottom = '30px';\n    captureBtn.style['z-index'] = 9999997;\n    captureBtn.onclick = this._onCapture.bind(this);\n\n    this._captureButton = captureBtn;\n    _document.body.appendChild(captureBtn);\n\n    // appends cancel button on the left side of capture button\n    const cancelBtn = _document.createElement('button');\n    textNode = _document.createTextNode('Cancel');\n    cancelBtn.appendChild(textNode);\n    cancelBtn.style.position = 'fixed';\n    cancelBtn.style.right = '100px';\n    cancelBtn.style.bottom = '30px';\n    cancelBtn.style['z-index'] = 9999997;\n    cancelBtn.onclick = this.endCropping.bind(this);\n\n    this._cancelButton = cancelBtn;\n    _document.body.appendChild(cancelBtn);\n\n    // appends div for width and height of selection here as well\n    const infoDiv = _document.createElement('div');\n    infoDiv.style.position = 'fixed';\n    infoDiv.style.right = '30px';\n    infoDiv.style.bottom = '60px';\n    infoDiv.style.color = 'white';\n    infoDiv.style['z-index'] = 9999997;\n    this._infoDiv = infoDiv;\n    _document.body.appendChild(infoDiv);\n  }\n\n  /**\n   * renders modal window for previewing and compressing\n   * @param {HTMLDOMElement} canvas canvas contains cropped image\n   * @private\n   */\n  _renderPreviewModal(canvas) {\n    this._previewModal = new PreviewModal(this._document, canvas, this.options.serverURL);\n  }\n\n  /**\n   * renders width and height of selection\n   */\n  _renderSelection(w, h) {\n    this._infoDiv.innerHTML = `w: ${Math.round(w)}, h: ${Math.round(h)}`;\n  }\n\n  /*\n   * handles key down for hot key capturing\n   * @param {KeyboardEvent} event\n   */\n  _onKeyDown(event) {\n    const {\n      key,\n      ctrlKey,\n      shiftKey\n    } = event;\n    const {\n      key: keyOptions\n    } = this.options;\n\n    this.log(`keydown detected: ctrl=${ctrlKey} shift=${shiftKey} key=${key}`);\n\n    if (key === keyOptions.key && ctrlKey === keyOptions.ctrlKey && keyOptions.shiftKey) {\n      this.log('key down matches with setting. starts cropping');\n      this.startCropping();\n    }\n  }\n\n  /**\n   * capture button click handler\n   * @private\n   */\n  _onCapture() {\n    const ctx = this._canvas.getContext('2d');\n    const selection = this._canvasState.getSelection();\n    const imgData = ctx.getImageData(selection.x, selection.y, selection.w, selection.h);\n\n    const newCanvas = this._document.createElement('canvas');\n    newCanvas.width = selection.w;\n    newCanvas.height = selection.h;\n    const newCtx = newCanvas.getContext('2d');\n    newCtx.putImageData(imgData, 0, 0);\n\n    this._enableScroll();\n\n    this._renderPreviewModal(newCanvas);\n    this.endCropping();\n  }\n\n  /**\n   * disables scrolling temporaily\n   * @private\n   */\n  _disableScroll() {\n    const preventDefault = (e = {}) => {\n      if (e.preventDefault) {\n        e.preventDefault();\n      }\n      e.returnValue = false; // eslint-disable-line\n    };\n\n    // disable scrolling with keys\n    // left: 37, up: 38, right: 39, down: 40,\n    // spacebar: 32, pageup: 33, pagedown: 34, end: 35, home: 36\n    const preventDefaultForScrollKeys = (e) => {\n      const keys = [32, 33, 34, 35, 36, 37, 38, 39, 40];\n      if (keys.indexOf(e.keyCode) !== -1) {\n        preventDefault(e);\n        return false;\n      }\n      return true;\n    };\n\n    this._document.onkeydown = preventDefaultForScrollKeys;\n    this._document.onmousewheel = preventDefault;\n  }\n\n  /**\n   * enables scrolling\n   * @private\n   */\n  _enableScroll() {\n    this._document.onkeydown = null;\n    this._document.onmousewheel = null;\n  }\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/index.js\n **/","/*\n  html2canvas 0.5.0-beta4 <http://html2canvas.hertzen.com>\n  Copyright (c) 2016 Niklas von Hertzen\n\n  Released under  License\n*/\n\n(function(f){if(typeof exports===\"object\"&&typeof module!==\"undefined\"){module.exports=f()}else if(typeof define===\"function\"&&define.amd){define([],f)}else{var g;if(typeof window!==\"undefined\"){g=window}else if(typeof global!==\"undefined\"){g=global}else if(typeof self!==\"undefined\"){g=self}else{g=this}g.html2canvas = f()}})(function(){var define,module,exports;return (function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(_dereq_,module,exports){\n(function (global){\n/*! https://mths.be/punycode v1.4.0 by @mathias */\n;(function(root) {\n\n\t/** Detect free variables */\n\tvar freeExports = typeof exports == 'object' && exports &&\n\t\t!exports.nodeType && exports;\n\tvar freeModule = typeof module == 'object' && module &&\n\t\t!module.nodeType && module;\n\tvar freeGlobal = typeof global == 'object' && global;\n\tif (\n\t\tfreeGlobal.global === freeGlobal ||\n\t\tfreeGlobal.window === freeGlobal ||\n\t\tfreeGlobal.self === freeGlobal\n\t) {\n\t\troot = freeGlobal;\n\t}\n\n\t/**\n\t * The `punycode` object.\n\t * @name punycode\n\t * @type Object\n\t */\n\tvar punycode,\n\n\t/** Highest positive signed 32-bit float value */\n\tmaxInt = 2147483647, // aka. 0x7FFFFFFF or 2^31-1\n\n\t/** Bootstring parameters */\n\tbase = 36,\n\ttMin = 1,\n\ttMax = 26,\n\tskew = 38,\n\tdamp = 700,\n\tinitialBias = 72,\n\tinitialN = 128, // 0x80\n\tdelimiter = '-', // '\\x2D'\n\n\t/** Regular expressions */\n\tregexPunycode = /^xn--/,\n\tregexNonASCII = /[^\\x20-\\x7E]/, // unprintable ASCII chars + non-ASCII chars\n\tregexSeparators = /[\\x2E\\u3002\\uFF0E\\uFF61]/g, // RFC 3490 separators\n\n\t/** Error messages */\n\terrors = {\n\t\t'overflow': 'Overflow: input needs wider integers to process',\n\t\t'not-basic': 'Illegal input >= 0x80 (not a basic code point)',\n\t\t'invalid-input': 'Invalid input'\n\t},\n\n\t/** Convenience shortcuts */\n\tbaseMinusTMin = base - tMin,\n\tfloor = Math.floor,\n\tstringFromCharCode = String.fromCharCode,\n\n\t/** Temporary variable */\n\tkey;\n\n\t/*--------------------------------------------------------------------------*/\n\n\t/**\n\t * A generic error utility function.\n\t * @private\n\t * @param {String} type The error type.\n\t * @returns {Error} Throws a `RangeError` with the applicable error message.\n\t */\n\tfunction error(type) {\n\t\tthrow new RangeError(errors[type]);\n\t}\n\n\t/**\n\t * A generic `Array#map` utility function.\n\t * @private\n\t * @param {Array} array The array to iterate over.\n\t * @param {Function} callback The function that gets called for every array\n\t * item.\n\t * @returns {Array} A new array of values returned by the callback function.\n\t */\n\tfunction map(array, fn) {\n\t\tvar length = array.length;\n\t\tvar result = [];\n\t\twhile (length--) {\n\t\t\tresult[length] = fn(array[length]);\n\t\t}\n\t\treturn result;\n\t}\n\n\t/**\n\t * A simple `Array#map`-like wrapper to work with domain name strings or email\n\t * addresses.\n\t * @private\n\t * @param {String} domain The domain name or email address.\n\t * @param {Function} callback The function that gets called for every\n\t * character.\n\t * @returns {Array} A new string of characters returned by the callback\n\t * function.\n\t */\n\tfunction mapDomain(string, fn) {\n\t\tvar parts = string.split('@');\n\t\tvar result = '';\n\t\tif (parts.length > 1) {\n\t\t\t// In email addresses, only the domain name should be punycoded. Leave\n\t\t\t// the local part (i.e. everything up to `@`) intact.\n\t\t\tresult = parts[0] + '@';\n\t\t\tstring = parts[1];\n\t\t}\n\t\t// Avoid `split(regex)` for IE8 compatibility. See #17.\n\t\tstring = string.replace(regexSeparators, '\\x2E');\n\t\tvar labels = string.split('.');\n\t\tvar encoded = map(labels, fn).join('.');\n\t\treturn result + encoded;\n\t}\n\n\t/**\n\t * Creates an array containing the numeric code points of each Unicode\n\t * character in the string. While JavaScript uses UCS-2 internally,\n\t * this function will convert a pair of surrogate halves (each of which\n\t * UCS-2 exposes as separate characters) into a single code point,\n\t * matching UTF-16.\n\t * @see `punycode.ucs2.encode`\n\t * @see <https://mathiasbynens.be/notes/javascript-encoding>\n\t * @memberOf punycode.ucs2\n\t * @name decode\n\t * @param {String} string The Unicode input string (UCS-2).\n\t * @returns {Array} The new array of code points.\n\t */\n\tfunction ucs2decode(string) {\n\t\tvar output = [],\n\t\t    counter = 0,\n\t\t    length = string.length,\n\t\t    value,\n\t\t    extra;\n\t\twhile (counter < length) {\n\t\t\tvalue = string.charCodeAt(counter++);\n\t\t\tif (value >= 0xD800 && value <= 0xDBFF && counter < length) {\n\t\t\t\t// high surrogate, and there is a next character\n\t\t\t\textra = string.charCodeAt(counter++);\n\t\t\t\tif ((extra & 0xFC00) == 0xDC00) { // low surrogate\n\t\t\t\t\toutput.push(((value & 0x3FF) << 10) + (extra & 0x3FF) + 0x10000);\n\t\t\t\t} else {\n\t\t\t\t\t// unmatched surrogate; only append this code unit, in case the next\n\t\t\t\t\t// code unit is the high surrogate of a surrogate pair\n\t\t\t\t\toutput.push(value);\n\t\t\t\t\tcounter--;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\toutput.push(value);\n\t\t\t}\n\t\t}\n\t\treturn output;\n\t}\n\n\t/**\n\t * Creates a string based on an array of numeric code points.\n\t * @see `punycode.ucs2.decode`\n\t * @memberOf punycode.ucs2\n\t * @name encode\n\t * @param {Array} codePoints The array of numeric code points.\n\t * @returns {String} The new Unicode string (UCS-2).\n\t */\n\tfunction ucs2encode(array) {\n\t\treturn map(array, function(value) {\n\t\t\tvar output = '';\n\t\t\tif (value > 0xFFFF) {\n\t\t\t\tvalue -= 0x10000;\n\t\t\t\toutput += stringFromCharCode(value >>> 10 & 0x3FF | 0xD800);\n\t\t\t\tvalue = 0xDC00 | value & 0x3FF;\n\t\t\t}\n\t\t\toutput += stringFromCharCode(value);\n\t\t\treturn output;\n\t\t}).join('');\n\t}\n\n\t/**\n\t * Converts a basic code point into a digit/integer.\n\t * @see `digitToBasic()`\n\t * @private\n\t * @param {Number} codePoint The basic numeric code point value.\n\t * @returns {Number} The numeric value of a basic code point (for use in\n\t * representing integers) in the range `0` to `base - 1`, or `base` if\n\t * the code point does not represent a value.\n\t */\n\tfunction basicToDigit(codePoint) {\n\t\tif (codePoint - 48 < 10) {\n\t\t\treturn codePoint - 22;\n\t\t}\n\t\tif (codePoint - 65 < 26) {\n\t\t\treturn codePoint - 65;\n\t\t}\n\t\tif (codePoint - 97 < 26) {\n\t\t\treturn codePoint - 97;\n\t\t}\n\t\treturn base;\n\t}\n\n\t/**\n\t * Converts a digit/integer into a basic code point.\n\t * @see `basicToDigit()`\n\t * @private\n\t * @param {Number} digit The numeric value of a basic code point.\n\t * @returns {Number} The basic code point whose value (when used for\n\t * representing integers) is `digit`, which needs to be in the range\n\t * `0` to `base - 1`. If `flag` is non-zero, the uppercase form is\n\t * used; else, the lowercase form is used. The behavior is undefined\n\t * if `flag` is non-zero and `digit` has no uppercase form.\n\t */\n\tfunction digitToBasic(digit, flag) {\n\t\t//  0..25 map to ASCII a..z or A..Z\n\t\t// 26..35 map to ASCII 0..9\n\t\treturn digit + 22 + 75 * (digit < 26) - ((flag != 0) << 5);\n\t}\n\n\t/**\n\t * Bias adaptation function as per section 3.4 of RFC 3492.\n\t * https://tools.ietf.org/html/rfc3492#section-3.4\n\t * @private\n\t */\n\tfunction adapt(delta, numPoints, firstTime) {\n\t\tvar k = 0;\n\t\tdelta = firstTime ? floor(delta / damp) : delta >> 1;\n\t\tdelta += floor(delta / numPoints);\n\t\tfor (/* no initialization */; delta > baseMinusTMin * tMax >> 1; k += base) {\n\t\t\tdelta = floor(delta / baseMinusTMin);\n\t\t}\n\t\treturn floor(k + (baseMinusTMin + 1) * delta / (delta + skew));\n\t}\n\n\t/**\n\t * Converts a Punycode string of ASCII-only symbols to a string of Unicode\n\t * symbols.\n\t * @memberOf punycode\n\t * @param {String} input The Punycode string of ASCII-only symbols.\n\t * @returns {String} The resulting string of Unicode symbols.\n\t */\n\tfunction decode(input) {\n\t\t// Don't use UCS-2\n\t\tvar output = [],\n\t\t    inputLength = input.length,\n\t\t    out,\n\t\t    i = 0,\n\t\t    n = initialN,\n\t\t    bias = initialBias,\n\t\t    basic,\n\t\t    j,\n\t\t    index,\n\t\t    oldi,\n\t\t    w,\n\t\t    k,\n\t\t    digit,\n\t\t    t,\n\t\t    /** Cached calculation results */\n\t\t    baseMinusT;\n\n\t\t// Handle the basic code points: let `basic` be the number of input code\n\t\t// points before the last delimiter, or `0` if there is none, then copy\n\t\t// the first basic code points to the output.\n\n\t\tbasic = input.lastIndexOf(delimiter);\n\t\tif (basic < 0) {\n\t\t\tbasic = 0;\n\t\t}\n\n\t\tfor (j = 0; j < basic; ++j) {\n\t\t\t// if it's not a basic code point\n\t\t\tif (input.charCodeAt(j) >= 0x80) {\n\t\t\t\terror('not-basic');\n\t\t\t}\n\t\t\toutput.push(input.charCodeAt(j));\n\t\t}\n\n\t\t// Main decoding loop: start just after the last delimiter if any basic code\n\t\t// points were copied; start at the beginning otherwise.\n\n\t\tfor (index = basic > 0 ? basic + 1 : 0; index < inputLength; /* no final expression */) {\n\n\t\t\t// `index` is the index of the next character to be consumed.\n\t\t\t// Decode a generalized variable-length integer into `delta`,\n\t\t\t// which gets added to `i`. The overflow checking is easier\n\t\t\t// if we increase `i` as we go, then subtract off its starting\n\t\t\t// value at the end to obtain `delta`.\n\t\t\tfor (oldi = i, w = 1, k = base; /* no condition */; k += base) {\n\n\t\t\t\tif (index >= inputLength) {\n\t\t\t\t\terror('invalid-input');\n\t\t\t\t}\n\n\t\t\t\tdigit = basicToDigit(input.charCodeAt(index++));\n\n\t\t\t\tif (digit >= base || digit > floor((maxInt - i) / w)) {\n\t\t\t\t\terror('overflow');\n\t\t\t\t}\n\n\t\t\t\ti += digit * w;\n\t\t\t\tt = k <= bias ? tMin : (k >= bias + tMax ? tMax : k - bias);\n\n\t\t\t\tif (digit < t) {\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\n\t\t\t\tbaseMinusT = base - t;\n\t\t\t\tif (w > floor(maxInt / baseMinusT)) {\n\t\t\t\t\terror('overflow');\n\t\t\t\t}\n\n\t\t\t\tw *= baseMinusT;\n\n\t\t\t}\n\n\t\t\tout = output.length + 1;\n\t\t\tbias = adapt(i - oldi, out, oldi == 0);\n\n\t\t\t// `i` was supposed to wrap around from `out` to `0`,\n\t\t\t// incrementing `n` each time, so we'll fix that now:\n\t\t\tif (floor(i / out) > maxInt - n) {\n\t\t\t\terror('overflow');\n\t\t\t}\n\n\t\t\tn += floor(i / out);\n\t\t\ti %= out;\n\n\t\t\t// Insert `n` at position `i` of the output\n\t\t\toutput.splice(i++, 0, n);\n\n\t\t}\n\n\t\treturn ucs2encode(output);\n\t}\n\n\t/**\n\t * Converts a string of Unicode symbols (e.g. a domain name label) to a\n\t * Punycode string of ASCII-only symbols.\n\t * @memberOf punycode\n\t * @param {String} input The string of Unicode symbols.\n\t * @returns {String} The resulting Punycode string of ASCII-only symbols.\n\t */\n\tfunction encode(input) {\n\t\tvar n,\n\t\t    delta,\n\t\t    handledCPCount,\n\t\t    basicLength,\n\t\t    bias,\n\t\t    j,\n\t\t    m,\n\t\t    q,\n\t\t    k,\n\t\t    t,\n\t\t    currentValue,\n\t\t    output = [],\n\t\t    /** `inputLength` will hold the number of code points in `input`. */\n\t\t    inputLength,\n\t\t    /** Cached calculation results */\n\t\t    handledCPCountPlusOne,\n\t\t    baseMinusT,\n\t\t    qMinusT;\n\n\t\t// Convert the input in UCS-2 to Unicode\n\t\tinput = ucs2decode(input);\n\n\t\t// Cache the length\n\t\tinputLength = input.length;\n\n\t\t// Initialize the state\n\t\tn = initialN;\n\t\tdelta = 0;\n\t\tbias = initialBias;\n\n\t\t// Handle the basic code points\n\t\tfor (j = 0; j < inputLength; ++j) {\n\t\t\tcurrentValue = input[j];\n\t\t\tif (currentValue < 0x80) {\n\t\t\t\toutput.push(stringFromCharCode(currentValue));\n\t\t\t}\n\t\t}\n\n\t\thandledCPCount = basicLength = output.length;\n\n\t\t// `handledCPCount` is the number of code points that have been handled;\n\t\t// `basicLength` is the number of basic code points.\n\n\t\t// Finish the basic string - if it is not empty - with a delimiter\n\t\tif (basicLength) {\n\t\t\toutput.push(delimiter);\n\t\t}\n\n\t\t// Main encoding loop:\n\t\twhile (handledCPCount < inputLength) {\n\n\t\t\t// All non-basic code points < n have been handled already. Find the next\n\t\t\t// larger one:\n\t\t\tfor (m = maxInt, j = 0; j < inputLength; ++j) {\n\t\t\t\tcurrentValue = input[j];\n\t\t\t\tif (currentValue >= n && currentValue < m) {\n\t\t\t\t\tm = currentValue;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Increase `delta` enough to advance the decoder's <n,i> state to <m,0>,\n\t\t\t// but guard against overflow\n\t\t\thandledCPCountPlusOne = handledCPCount + 1;\n\t\t\tif (m - n > floor((maxInt - delta) / handledCPCountPlusOne)) {\n\t\t\t\terror('overflow');\n\t\t\t}\n\n\t\t\tdelta += (m - n) * handledCPCountPlusOne;\n\t\t\tn = m;\n\n\t\t\tfor (j = 0; j < inputLength; ++j) {\n\t\t\t\tcurrentValue = input[j];\n\n\t\t\t\tif (currentValue < n && ++delta > maxInt) {\n\t\t\t\t\terror('overflow');\n\t\t\t\t}\n\n\t\t\t\tif (currentValue == n) {\n\t\t\t\t\t// Represent delta as a generalized variable-length integer\n\t\t\t\t\tfor (q = delta, k = base; /* no condition */; k += base) {\n\t\t\t\t\t\tt = k <= bias ? tMin : (k >= bias + tMax ? tMax : k - bias);\n\t\t\t\t\t\tif (q < t) {\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tqMinusT = q - t;\n\t\t\t\t\t\tbaseMinusT = base - t;\n\t\t\t\t\t\toutput.push(\n\t\t\t\t\t\t\tstringFromCharCode(digitToBasic(t + qMinusT % baseMinusT, 0))\n\t\t\t\t\t\t);\n\t\t\t\t\t\tq = floor(qMinusT / baseMinusT);\n\t\t\t\t\t}\n\n\t\t\t\t\toutput.push(stringFromCharCode(digitToBasic(q, 0)));\n\t\t\t\t\tbias = adapt(delta, handledCPCountPlusOne, handledCPCount == basicLength);\n\t\t\t\t\tdelta = 0;\n\t\t\t\t\t++handledCPCount;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t++delta;\n\t\t\t++n;\n\n\t\t}\n\t\treturn output.join('');\n\t}\n\n\t/**\n\t * Converts a Punycode string representing a domain name or an email address\n\t * to Unicode. Only the Punycoded parts of the input will be converted, i.e.\n\t * it doesn't matter if you call it on a string that has already been\n\t * converted to Unicode.\n\t * @memberOf punycode\n\t * @param {String} input The Punycoded domain name or email address to\n\t * convert to Unicode.\n\t * @returns {String} The Unicode representation of the given Punycode\n\t * string.\n\t */\n\tfunction toUnicode(input) {\n\t\treturn mapDomain(input, function(string) {\n\t\t\treturn regexPunycode.test(string)\n\t\t\t\t? decode(string.slice(4).toLowerCase())\n\t\t\t\t: string;\n\t\t});\n\t}\n\n\t/**\n\t * Converts a Unicode string representing a domain name or an email address to\n\t * Punycode. Only the non-ASCII parts of the domain name will be converted,\n\t * i.e. it doesn't matter if you call it with a domain that's already in\n\t * ASCII.\n\t * @memberOf punycode\n\t * @param {String} input The domain name or email address to convert, as a\n\t * Unicode string.\n\t * @returns {String} The Punycode representation of the given domain name or\n\t * email address.\n\t */\n\tfunction toASCII(input) {\n\t\treturn mapDomain(input, function(string) {\n\t\t\treturn regexNonASCII.test(string)\n\t\t\t\t? 'xn--' + encode(string)\n\t\t\t\t: string;\n\t\t});\n\t}\n\n\t/*--------------------------------------------------------------------------*/\n\n\t/** Define the public API */\n\tpunycode = {\n\t\t/**\n\t\t * A string representing the current Punycode.js version number.\n\t\t * @memberOf punycode\n\t\t * @type String\n\t\t */\n\t\t'version': '1.3.2',\n\t\t/**\n\t\t * An object of methods to convert from JavaScript's internal character\n\t\t * representation (UCS-2) to Unicode code points, and back.\n\t\t * @see <https://mathiasbynens.be/notes/javascript-encoding>\n\t\t * @memberOf punycode\n\t\t * @type Object\n\t\t */\n\t\t'ucs2': {\n\t\t\t'decode': ucs2decode,\n\t\t\t'encode': ucs2encode\n\t\t},\n\t\t'decode': decode,\n\t\t'encode': encode,\n\t\t'toASCII': toASCII,\n\t\t'toUnicode': toUnicode\n\t};\n\n\t/** Expose `punycode` */\n\t// Some AMD build optimizers, like r.js, check for specific condition patterns\n\t// like the following:\n\tif (\n\t\ttypeof define == 'function' &&\n\t\ttypeof define.amd == 'object' &&\n\t\tdefine.amd\n\t) {\n\t\tdefine('punycode', function() {\n\t\t\treturn punycode;\n\t\t});\n\t} else if (freeExports && freeModule) {\n\t\tif (module.exports == freeExports) {\n\t\t\t// in Node.js, io.js, or RingoJS v0.8.0+\n\t\t\tfreeModule.exports = punycode;\n\t\t} else {\n\t\t\t// in Narwhal or RingoJS v0.7.0-\n\t\t\tfor (key in punycode) {\n\t\t\t\tpunycode.hasOwnProperty(key) && (freeExports[key] = punycode[key]);\n\t\t\t}\n\t\t}\n\t} else {\n\t\t// in Rhino or a web browser\n\t\troot.punycode = punycode;\n\t}\n\n}(this));\n\n}).call(this,typeof global !== \"undefined\" ? global : typeof self !== \"undefined\" ? self : typeof window !== \"undefined\" ? window : {})\n},{}],2:[function(_dereq_,module,exports){\nvar log = _dereq_('./log');\n\nfunction restoreOwnerScroll(ownerDocument, x, y) {\n    if (ownerDocument.defaultView && (x !== ownerDocument.defaultView.pageXOffset || y !== ownerDocument.defaultView.pageYOffset)) {\n        ownerDocument.defaultView.scrollTo(x, y);\n    }\n}\n\nfunction cloneCanvasContents(canvas, clonedCanvas) {\n    try {\n        if (clonedCanvas) {\n            clonedCanvas.width = canvas.width;\n            clonedCanvas.height = canvas.height;\n            clonedCanvas.getContext(\"2d\").putImageData(canvas.getContext(\"2d\").getImageData(0, 0, canvas.width, canvas.height), 0, 0);\n        }\n    } catch(e) {\n        log(\"Unable to copy canvas content from\", canvas, e);\n    }\n}\n\nfunction cloneNode(node, javascriptEnabled) {\n    var clone = node.nodeType === 3 ? document.createTextNode(node.nodeValue) : node.cloneNode(false);\n\n    var child = node.firstChild;\n    while(child) {\n        if (javascriptEnabled === true || child.nodeType !== 1 || child.nodeName !== 'SCRIPT') {\n            clone.appendChild(cloneNode(child, javascriptEnabled));\n        }\n        child = child.nextSibling;\n    }\n\n    if (node.nodeType === 1) {\n        clone._scrollTop = node.scrollTop;\n        clone._scrollLeft = node.scrollLeft;\n        if (node.nodeName === \"CANVAS\") {\n            cloneCanvasContents(node, clone);\n        } else if (node.nodeName === \"TEXTAREA\" || node.nodeName === \"SELECT\") {\n            clone.value = node.value;\n        }\n    }\n\n    return clone;\n}\n\nfunction initNode(node) {\n    if (node.nodeType === 1) {\n        node.scrollTop = node._scrollTop;\n        node.scrollLeft = node._scrollLeft;\n\n        var child = node.firstChild;\n        while(child) {\n            initNode(child);\n            child = child.nextSibling;\n        }\n    }\n}\n\nmodule.exports = function(ownerDocument, containerDocument, width, height, options, x ,y) {\n    var documentElement = cloneNode(ownerDocument.documentElement, options.javascriptEnabled);\n    var container = containerDocument.createElement(\"iframe\");\n\n    container.className = \"html2canvas-container\";\n    container.style.visibility = \"hidden\";\n    container.style.position = \"fixed\";\n    container.style.left = \"-10000px\";\n    container.style.top = \"0px\";\n    container.style.border = \"0\";\n    container.width = width;\n    container.height = height;\n    container.scrolling = \"no\"; // ios won't scroll without it\n    containerDocument.body.appendChild(container);\n\n    return new Promise(function(resolve) {\n        var documentClone = container.contentWindow.document;\n\n        /* Chrome doesn't detect relative background-images assigned in inline <style> sheets when fetched through getComputedStyle\n         if window url is about:blank, we can assign the url to current by writing onto the document\n         */\n        container.contentWindow.onload = container.onload = function() {\n            var interval = setInterval(function() {\n                if (documentClone.body.childNodes.length > 0) {\n                    initNode(documentClone.documentElement);\n                    clearInterval(interval);\n                    if (options.type === \"view\") {\n                        container.contentWindow.scrollTo(x, y);\n                        if ((/(iPad|iPhone|iPod)/g).test(navigator.userAgent) && (container.contentWindow.scrollY !== y || container.contentWindow.scrollX !== x)) {\n                            documentClone.documentElement.style.top = (-y) + \"px\";\n                            documentClone.documentElement.style.left = (-x) + \"px\";\n                            documentClone.documentElement.style.position = 'absolute';\n                        }\n                    }\n                    resolve(container);\n                }\n            }, 50);\n        };\n\n        documentClone.open();\n        documentClone.write(\"<!DOCTYPE html><html></html>\");\n        // Chrome scrolls the parent document for some reason after the write to the cloned window???\n        restoreOwnerScroll(ownerDocument, x, y);\n        documentClone.replaceChild(documentClone.adoptNode(documentElement), documentClone.documentElement);\n        documentClone.close();\n    });\n};\n\n},{\"./log\":13}],3:[function(_dereq_,module,exports){\n// http://dev.w3.org/csswg/css-color/\n\nfunction Color(value) {\n    this.r = 0;\n    this.g = 0;\n    this.b = 0;\n    this.a = null;\n    var result = this.fromArray(value) ||\n        this.namedColor(value) ||\n        this.rgb(value) ||\n        this.rgba(value) ||\n        this.hex6(value) ||\n        this.hex3(value);\n}\n\nColor.prototype.darken = function(amount) {\n    var a = 1 - amount;\n    return  new Color([\n        Math.round(this.r * a),\n        Math.round(this.g * a),\n        Math.round(this.b * a),\n        this.a\n    ]);\n};\n\nColor.prototype.isTransparent = function() {\n    return this.a === 0;\n};\n\nColor.prototype.isBlack = function() {\n    return this.r === 0 && this.g === 0 && this.b === 0;\n};\n\nColor.prototype.fromArray = function(array) {\n    if (Array.isArray(array)) {\n        this.r = Math.min(array[0], 255);\n        this.g = Math.min(array[1], 255);\n        this.b = Math.min(array[2], 255);\n        if (array.length > 3) {\n            this.a = array[3];\n        }\n    }\n\n    return (Array.isArray(array));\n};\n\nvar _hex3 = /^#([a-f0-9]{3})$/i;\n\nColor.prototype.hex3 = function(value) {\n    var match = null;\n    if ((match = value.match(_hex3)) !== null) {\n        this.r = parseInt(match[1][0] + match[1][0], 16);\n        this.g = parseInt(match[1][1] + match[1][1], 16);\n        this.b = parseInt(match[1][2] + match[1][2], 16);\n    }\n    return match !== null;\n};\n\nvar _hex6 = /^#([a-f0-9]{6})$/i;\n\nColor.prototype.hex6 = function(value) {\n    var match = null;\n    if ((match = value.match(_hex6)) !== null) {\n        this.r = parseInt(match[1].substring(0, 2), 16);\n        this.g = parseInt(match[1].substring(2, 4), 16);\n        this.b = parseInt(match[1].substring(4, 6), 16);\n    }\n    return match !== null;\n};\n\n\nvar _rgb = /^rgb\\(\\s*(\\d{1,3})\\s*,\\s*(\\d{1,3})\\s*,\\s*(\\d{1,3})\\s*\\)$/;\n\nColor.prototype.rgb = function(value) {\n    var match = null;\n    if ((match = value.match(_rgb)) !== null) {\n        this.r = Number(match[1]);\n        this.g = Number(match[2]);\n        this.b = Number(match[3]);\n    }\n    return match !== null;\n};\n\nvar _rgba = /^rgba\\(\\s*(\\d{1,3})\\s*,\\s*(\\d{1,3})\\s*,\\s*(\\d{1,3})\\s*,\\s*(\\d?\\.?\\d+)\\s*\\)$/;\n\nColor.prototype.rgba = function(value) {\n    var match = null;\n    if ((match = value.match(_rgba)) !== null) {\n        this.r = Number(match[1]);\n        this.g = Number(match[2]);\n        this.b = Number(match[3]);\n        this.a = Number(match[4]);\n    }\n    return match !== null;\n};\n\nColor.prototype.toString = function() {\n    return this.a !== null && this.a !== 1 ?\n    \"rgba(\" + [this.r, this.g, this.b, this.a].join(\",\") + \")\" :\n    \"rgb(\" + [this.r, this.g, this.b].join(\",\") + \")\";\n};\n\nColor.prototype.namedColor = function(value) {\n    value = value.toLowerCase();\n    var color = colors[value];\n    if (color) {\n        this.r = color[0];\n        this.g = color[1];\n        this.b = color[2];\n    } else if (value === \"transparent\") {\n        this.r = this.g = this.b = this.a = 0;\n        return true;\n    }\n\n    return !!color;\n};\n\nColor.prototype.isColor = true;\n\n// JSON.stringify([].slice.call($$('.named-color-table tr'), 1).map(function(row) { return [row.childNodes[3].textContent, row.childNodes[5].textContent.trim().split(\",\").map(Number)] }).reduce(function(data, row) {data[row[0]] = row[1]; return data}, {}))\nvar colors = {\n    \"aliceblue\": [240, 248, 255],\n    \"antiquewhite\": [250, 235, 215],\n    \"aqua\": [0, 255, 255],\n    \"aquamarine\": [127, 255, 212],\n    \"azure\": [240, 255, 255],\n    \"beige\": [245, 245, 220],\n    \"bisque\": [255, 228, 196],\n    \"black\": [0, 0, 0],\n    \"blanchedalmond\": [255, 235, 205],\n    \"blue\": [0, 0, 255],\n    \"blueviolet\": [138, 43, 226],\n    \"brown\": [165, 42, 42],\n    \"burlywood\": [222, 184, 135],\n    \"cadetblue\": [95, 158, 160],\n    \"chartreuse\": [127, 255, 0],\n    \"chocolate\": [210, 105, 30],\n    \"coral\": [255, 127, 80],\n    \"cornflowerblue\": [100, 149, 237],\n    \"cornsilk\": [255, 248, 220],\n    \"crimson\": [220, 20, 60],\n    \"cyan\": [0, 255, 255],\n    \"darkblue\": [0, 0, 139],\n    \"darkcyan\": [0, 139, 139],\n    \"darkgoldenrod\": [184, 134, 11],\n    \"darkgray\": [169, 169, 169],\n    \"darkgreen\": [0, 100, 0],\n    \"darkgrey\": [169, 169, 169],\n    \"darkkhaki\": [189, 183, 107],\n    \"darkmagenta\": [139, 0, 139],\n    \"darkolivegreen\": [85, 107, 47],\n    \"darkorange\": [255, 140, 0],\n    \"darkorchid\": [153, 50, 204],\n    \"darkred\": [139, 0, 0],\n    \"darksalmon\": [233, 150, 122],\n    \"darkseagreen\": [143, 188, 143],\n    \"darkslateblue\": [72, 61, 139],\n    \"darkslategray\": [47, 79, 79],\n    \"darkslategrey\": [47, 79, 79],\n    \"darkturquoise\": [0, 206, 209],\n    \"darkviolet\": [148, 0, 211],\n    \"deeppink\": [255, 20, 147],\n    \"deepskyblue\": [0, 191, 255],\n    \"dimgray\": [105, 105, 105],\n    \"dimgrey\": [105, 105, 105],\n    \"dodgerblue\": [30, 144, 255],\n    \"firebrick\": [178, 34, 34],\n    \"floralwhite\": [255, 250, 240],\n    \"forestgreen\": [34, 139, 34],\n    \"fuchsia\": [255, 0, 255],\n    \"gainsboro\": [220, 220, 220],\n    \"ghostwhite\": [248, 248, 255],\n    \"gold\": [255, 215, 0],\n    \"goldenrod\": [218, 165, 32],\n    \"gray\": [128, 128, 128],\n    \"green\": [0, 128, 0],\n    \"greenyellow\": [173, 255, 47],\n    \"grey\": [128, 128, 128],\n    \"honeydew\": [240, 255, 240],\n    \"hotpink\": [255, 105, 180],\n    \"indianred\": [205, 92, 92],\n    \"indigo\": [75, 0, 130],\n    \"ivory\": [255, 255, 240],\n    \"khaki\": [240, 230, 140],\n    \"lavender\": [230, 230, 250],\n    \"lavenderblush\": [255, 240, 245],\n    \"lawngreen\": [124, 252, 0],\n    \"lemonchiffon\": [255, 250, 205],\n    \"lightblue\": [173, 216, 230],\n    \"lightcoral\": [240, 128, 128],\n    \"lightcyan\": [224, 255, 255],\n    \"lightgoldenrodyellow\": [250, 250, 210],\n    \"lightgray\": [211, 211, 211],\n    \"lightgreen\": [144, 238, 144],\n    \"lightgrey\": [211, 211, 211],\n    \"lightpink\": [255, 182, 193],\n    \"lightsalmon\": [255, 160, 122],\n    \"lightseagreen\": [32, 178, 170],\n    \"lightskyblue\": [135, 206, 250],\n    \"lightslategray\": [119, 136, 153],\n    \"lightslategrey\": [119, 136, 153],\n    \"lightsteelblue\": [176, 196, 222],\n    \"lightyellow\": [255, 255, 224],\n    \"lime\": [0, 255, 0],\n    \"limegreen\": [50, 205, 50],\n    \"linen\": [250, 240, 230],\n    \"magenta\": [255, 0, 255],\n    \"maroon\": [128, 0, 0],\n    \"mediumaquamarine\": [102, 205, 170],\n    \"mediumblue\": [0, 0, 205],\n    \"mediumorchid\": [186, 85, 211],\n    \"mediumpurple\": [147, 112, 219],\n    \"mediumseagreen\": [60, 179, 113],\n    \"mediumslateblue\": [123, 104, 238],\n    \"mediumspringgreen\": [0, 250, 154],\n    \"mediumturquoise\": [72, 209, 204],\n    \"mediumvioletred\": [199, 21, 133],\n    \"midnightblue\": [25, 25, 112],\n    \"mintcream\": [245, 255, 250],\n    \"mistyrose\": [255, 228, 225],\n    \"moccasin\": [255, 228, 181],\n    \"navajowhite\": [255, 222, 173],\n    \"navy\": [0, 0, 128],\n    \"oldlace\": [253, 245, 230],\n    \"olive\": [128, 128, 0],\n    \"olivedrab\": [107, 142, 35],\n    \"orange\": [255, 165, 0],\n    \"orangered\": [255, 69, 0],\n    \"orchid\": [218, 112, 214],\n    \"palegoldenrod\": [238, 232, 170],\n    \"palegreen\": [152, 251, 152],\n    \"paleturquoise\": [175, 238, 238],\n    \"palevioletred\": [219, 112, 147],\n    \"papayawhip\": [255, 239, 213],\n    \"peachpuff\": [255, 218, 185],\n    \"peru\": [205, 133, 63],\n    \"pink\": [255, 192, 203],\n    \"plum\": [221, 160, 221],\n    \"powderblue\": [176, 224, 230],\n    \"purple\": [128, 0, 128],\n    \"rebeccapurple\": [102, 51, 153],\n    \"red\": [255, 0, 0],\n    \"rosybrown\": [188, 143, 143],\n    \"royalblue\": [65, 105, 225],\n    \"saddlebrown\": [139, 69, 19],\n    \"salmon\": [250, 128, 114],\n    \"sandybrown\": [244, 164, 96],\n    \"seagreen\": [46, 139, 87],\n    \"seashell\": [255, 245, 238],\n    \"sienna\": [160, 82, 45],\n    \"silver\": [192, 192, 192],\n    \"skyblue\": [135, 206, 235],\n    \"slateblue\": [106, 90, 205],\n    \"slategray\": [112, 128, 144],\n    \"slategrey\": [112, 128, 144],\n    \"snow\": [255, 250, 250],\n    \"springgreen\": [0, 255, 127],\n    \"steelblue\": [70, 130, 180],\n    \"tan\": [210, 180, 140],\n    \"teal\": [0, 128, 128],\n    \"thistle\": [216, 191, 216],\n    \"tomato\": [255, 99, 71],\n    \"turquoise\": [64, 224, 208],\n    \"violet\": [238, 130, 238],\n    \"wheat\": [245, 222, 179],\n    \"white\": [255, 255, 255],\n    \"whitesmoke\": [245, 245, 245],\n    \"yellow\": [255, 255, 0],\n    \"yellowgreen\": [154, 205, 50]\n};\n\nmodule.exports = Color;\n\n},{}],4:[function(_dereq_,module,exports){\nvar Support = _dereq_('./support');\nvar CanvasRenderer = _dereq_('./renderers/canvas');\nvar ImageLoader = _dereq_('./imageloader');\nvar NodeParser = _dereq_('./nodeparser');\nvar NodeContainer = _dereq_('./nodecontainer');\nvar log = _dereq_('./log');\nvar utils = _dereq_('./utils');\nvar createWindowClone = _dereq_('./clone');\nvar loadUrlDocument = _dereq_('./proxy').loadUrlDocument;\nvar getBounds = utils.getBounds;\n\nvar html2canvasNodeAttribute = \"data-html2canvas-node\";\nvar html2canvasCloneIndex = 0;\n\nfunction html2canvas(nodeList, options) {\n    var index = html2canvasCloneIndex++;\n    options = options || {};\n    if (options.logging) {\n        log.options.logging = true;\n        log.options.start = Date.now();\n    }\n\n    options.async = typeof(options.async) === \"undefined\" ? true : options.async;\n    options.allowTaint = typeof(options.allowTaint) === \"undefined\" ? false : options.allowTaint;\n    options.removeContainer = typeof(options.removeContainer) === \"undefined\" ? true : options.removeContainer;\n    options.javascriptEnabled = typeof(options.javascriptEnabled) === \"undefined\" ? false : options.javascriptEnabled;\n    options.imageTimeout = typeof(options.imageTimeout) === \"undefined\" ? 10000 : options.imageTimeout;\n    options.renderer = typeof(options.renderer) === \"function\" ? options.renderer : CanvasRenderer;\n    options.strict = !!options.strict;\n\n    if (typeof(nodeList) === \"string\") {\n        if (typeof(options.proxy) !== \"string\") {\n            return Promise.reject(\"Proxy must be used when rendering url\");\n        }\n        var width = options.width != null ? options.width : window.innerWidth;\n        var height = options.height != null ? options.height : window.innerHeight;\n        return loadUrlDocument(absoluteUrl(nodeList), options.proxy, document, width, height, options).then(function(container) {\n            return renderWindow(container.contentWindow.document.documentElement, container, options, width, height);\n        });\n    }\n\n    var node = ((nodeList === undefined) ? [document.documentElement] : ((nodeList.length) ? nodeList : [nodeList]))[0];\n    node.setAttribute(html2canvasNodeAttribute + index, index);\n    return renderDocument(node.ownerDocument, options, node.ownerDocument.defaultView.innerWidth, node.ownerDocument.defaultView.innerHeight, index).then(function(canvas) {\n        if (typeof(options.onrendered) === \"function\") {\n            log(\"options.onrendered is deprecated, html2canvas returns a Promise containing the canvas\");\n            options.onrendered(canvas);\n        }\n        return canvas;\n    });\n}\n\nhtml2canvas.CanvasRenderer = CanvasRenderer;\nhtml2canvas.NodeContainer = NodeContainer;\nhtml2canvas.log = log;\nhtml2canvas.utils = utils;\n\nvar html2canvasExport = (typeof(document) === \"undefined\" || typeof(Object.create) !== \"function\" || typeof(document.createElement(\"canvas\").getContext) !== \"function\") ? function() {\n    return Promise.reject(\"No canvas support\");\n} : html2canvas;\n\nmodule.exports = html2canvasExport;\n\nif (typeof(define) === 'function' && define.amd) {\n    define('html2canvas', [], function() {\n        return html2canvasExport;\n    });\n}\n\nfunction renderDocument(document, options, windowWidth, windowHeight, html2canvasIndex) {\n    return createWindowClone(document, document, windowWidth, windowHeight, options, document.defaultView.pageXOffset, document.defaultView.pageYOffset).then(function(container) {\n        log(\"Document cloned\");\n        var attributeName = html2canvasNodeAttribute + html2canvasIndex;\n        var selector = \"[\" + attributeName + \"='\" + html2canvasIndex + \"']\";\n        document.querySelector(selector).removeAttribute(attributeName);\n        var clonedWindow = container.contentWindow;\n        var node = clonedWindow.document.querySelector(selector);\n        var oncloneHandler = (typeof(options.onclone) === \"function\") ? Promise.resolve(options.onclone(clonedWindow.document)) : Promise.resolve(true);\n        return oncloneHandler.then(function() {\n            return renderWindow(node, container, options, windowWidth, windowHeight);\n        });\n    });\n}\n\nfunction renderWindow(node, container, options, windowWidth, windowHeight) {\n    var clonedWindow = container.contentWindow;\n    var support = new Support(clonedWindow.document);\n    var imageLoader = new ImageLoader(options, support);\n    var bounds = getBounds(node);\n    var width = options.type === \"view\" ? windowWidth : documentWidth(clonedWindow.document);\n    var height = options.type === \"view\" ? windowHeight : documentHeight(clonedWindow.document);\n    var renderer = new options.renderer(width, height, imageLoader, options, document);\n    var parser = new NodeParser(node, renderer, support, imageLoader, options);\n    return parser.ready.then(function() {\n        log(\"Finished rendering\");\n        var canvas;\n\n        if (options.type === \"view\") {\n            canvas = crop(renderer.canvas, {width: renderer.canvas.width, height: renderer.canvas.height, top: 0, left: 0, x: 0, y: 0});\n        } else if (node === clonedWindow.document.body || node === clonedWindow.document.documentElement || options.canvas != null) {\n            canvas = renderer.canvas;\n        } else {\n            canvas = crop(renderer.canvas, {width:  options.width != null ? options.width : bounds.width, height: options.height != null ? options.height : bounds.height, top: bounds.top, left: bounds.left, x: 0, y: 0});\n        }\n\n        cleanupContainer(container, options);\n        return canvas;\n    });\n}\n\nfunction cleanupContainer(container, options) {\n    if (options.removeContainer) {\n        container.parentNode.removeChild(container);\n        log(\"Cleaned up container\");\n    }\n}\n\nfunction crop(canvas, bounds) {\n    var croppedCanvas = document.createElement(\"canvas\");\n    var x1 = Math.min(canvas.width - 1, Math.max(0, bounds.left));\n    var x2 = Math.min(canvas.width, Math.max(1, bounds.left + bounds.width));\n    var y1 = Math.min(canvas.height - 1, Math.max(0, bounds.top));\n    var y2 = Math.min(canvas.height, Math.max(1, bounds.top + bounds.height));\n    croppedCanvas.width = bounds.width;\n    croppedCanvas.height =  bounds.height;\n    var width = x2-x1;\n    var height = y2-y1;\n    log(\"Cropping canvas at:\", \"left:\", bounds.left, \"top:\", bounds.top, \"width:\", width, \"height:\", height);\n    log(\"Resulting crop with width\", bounds.width, \"and height\", bounds.height, \"with x\", x1, \"and y\", y1);\n    croppedCanvas.getContext(\"2d\").drawImage(canvas, x1, y1, width, height, bounds.x, bounds.y, width, height);\n    return croppedCanvas;\n}\n\nfunction documentWidth (doc) {\n    return Math.max(\n        Math.max(doc.body.scrollWidth, doc.documentElement.scrollWidth),\n        Math.max(doc.body.offsetWidth, doc.documentElement.offsetWidth),\n        Math.max(doc.body.clientWidth, doc.documentElement.clientWidth)\n    );\n}\n\nfunction documentHeight (doc) {\n    return Math.max(\n        Math.max(doc.body.scrollHeight, doc.documentElement.scrollHeight),\n        Math.max(doc.body.offsetHeight, doc.documentElement.offsetHeight),\n        Math.max(doc.body.clientHeight, doc.documentElement.clientHeight)\n    );\n}\n\nfunction absoluteUrl(url) {\n    var link = document.createElement(\"a\");\n    link.href = url;\n    link.href = link.href;\n    return link;\n}\n\n},{\"./clone\":2,\"./imageloader\":11,\"./log\":13,\"./nodecontainer\":14,\"./nodeparser\":15,\"./proxy\":16,\"./renderers/canvas\":20,\"./support\":22,\"./utils\":26}],5:[function(_dereq_,module,exports){\nvar log = _dereq_('./log');\nvar smallImage = _dereq_('./utils').smallImage;\n\nfunction DummyImageContainer(src) {\n    this.src = src;\n    log(\"DummyImageContainer for\", src);\n    if (!this.promise || !this.image) {\n        log(\"Initiating DummyImageContainer\");\n        DummyImageContainer.prototype.image = new Image();\n        var image = this.image;\n        DummyImageContainer.prototype.promise = new Promise(function(resolve, reject) {\n            image.onload = resolve;\n            image.onerror = reject;\n            image.src = smallImage();\n            if (image.complete === true) {\n                resolve(image);\n            }\n        });\n    }\n}\n\nmodule.exports = DummyImageContainer;\n\n},{\"./log\":13,\"./utils\":26}],6:[function(_dereq_,module,exports){\nvar smallImage = _dereq_('./utils').smallImage;\n\nfunction Font(family, size) {\n    var container = document.createElement('div'),\n        img = document.createElement('img'),\n        span = document.createElement('span'),\n        sampleText = 'Hidden Text',\n        baseline,\n        middle;\n\n    container.style.visibility = \"hidden\";\n    container.style.fontFamily = family;\n    container.style.fontSize = size;\n    container.style.margin = 0;\n    container.style.padding = 0;\n\n    document.body.appendChild(container);\n\n    img.src = smallImage();\n    img.width = 1;\n    img.height = 1;\n\n    img.style.margin = 0;\n    img.style.padding = 0;\n    img.style.verticalAlign = \"baseline\";\n\n    span.style.fontFamily = family;\n    span.style.fontSize = size;\n    span.style.margin = 0;\n    span.style.padding = 0;\n\n    span.appendChild(document.createTextNode(sampleText));\n    container.appendChild(span);\n    container.appendChild(img);\n    baseline = (img.offsetTop - span.offsetTop) + 1;\n\n    container.removeChild(span);\n    container.appendChild(document.createTextNode(sampleText));\n\n    container.style.lineHeight = \"normal\";\n    img.style.verticalAlign = \"super\";\n\n    middle = (img.offsetTop-container.offsetTop) + 1;\n\n    document.body.removeChild(container);\n\n    this.baseline = baseline;\n    this.lineWidth = 1;\n    this.middle = middle;\n}\n\nmodule.exports = Font;\n\n},{\"./utils\":26}],7:[function(_dereq_,module,exports){\nvar Font = _dereq_('./font');\n\nfunction FontMetrics() {\n    this.data = {};\n}\n\nFontMetrics.prototype.getMetrics = function(family, size) {\n    if (this.data[family + \"-\" + size] === undefined) {\n        this.data[family + \"-\" + size] = new Font(family, size);\n    }\n    return this.data[family + \"-\" + size];\n};\n\nmodule.exports = FontMetrics;\n\n},{\"./font\":6}],8:[function(_dereq_,module,exports){\nvar utils = _dereq_('./utils');\nvar getBounds = utils.getBounds;\nvar loadUrlDocument = _dereq_('./proxy').loadUrlDocument;\n\nfunction FrameContainer(container, sameOrigin, options) {\n    this.image = null;\n    this.src = container;\n    var self = this;\n    var bounds = getBounds(container);\n    this.promise = (!sameOrigin ? this.proxyLoad(options.proxy, bounds, options) : new Promise(function(resolve) {\n        if (container.contentWindow.document.URL === \"about:blank\" || container.contentWindow.document.documentElement == null) {\n            container.contentWindow.onload = container.onload = function() {\n                resolve(container);\n            };\n        } else {\n            resolve(container);\n        }\n    })).then(function(container) {\n        var html2canvas = _dereq_('./core');\n        return html2canvas(container.contentWindow.document.documentElement, {type: 'view', width: container.width, height: container.height, proxy: options.proxy, javascriptEnabled: options.javascriptEnabled, removeContainer: options.removeContainer, allowTaint: options.allowTaint, imageTimeout: options.imageTimeout / 2});\n    }).then(function(canvas) {\n        return self.image = canvas;\n    });\n}\n\nFrameContainer.prototype.proxyLoad = function(proxy, bounds, options) {\n    var container = this.src;\n    return loadUrlDocument(container.src, proxy, container.ownerDocument, bounds.width, bounds.height, options);\n};\n\nmodule.exports = FrameContainer;\n\n},{\"./core\":4,\"./proxy\":16,\"./utils\":26}],9:[function(_dereq_,module,exports){\nfunction GradientContainer(imageData) {\n    this.src = imageData.value;\n    this.colorStops = [];\n    this.type = null;\n    this.x0 = 0.5;\n    this.y0 = 0.5;\n    this.x1 = 0.5;\n    this.y1 = 0.5;\n    this.promise = Promise.resolve(true);\n}\n\nGradientContainer.TYPES = {\n    LINEAR: 1,\n    RADIAL: 2\n};\n\n// TODO: support hsl[a], negative %/length values\n// TODO: support <angle> (e.g. -?\\d{1,3}(?:\\.\\d+)deg, etc. : https://developer.mozilla.org/docs/Web/CSS/angle )\nGradientContainer.REGEXP_COLORSTOP = /^\\s*(rgba?\\(\\s*\\d{1,3},\\s*\\d{1,3},\\s*\\d{1,3}(?:,\\s*[0-9\\.]+)?\\s*\\)|[a-z]{3,20}|#[a-f0-9]{3,6})(?:\\s+(\\d{1,3}(?:\\.\\d+)?)(%|px)?)?(?:\\s|$)/i;\n\nmodule.exports = GradientContainer;\n\n},{}],10:[function(_dereq_,module,exports){\nfunction ImageContainer(src, cors) {\n    this.src = src;\n    this.image = new Image();\n    var self = this;\n    this.tainted = null;\n    this.promise = new Promise(function(resolve, reject) {\n        self.image.onload = resolve;\n        self.image.onerror = reject;\n        if (cors) {\n            self.image.crossOrigin = \"anonymous\";\n        }\n        self.image.src = src;\n        if (self.image.complete === true) {\n            resolve(self.image);\n        }\n    });\n}\n\nmodule.exports = ImageContainer;\n\n},{}],11:[function(_dereq_,module,exports){\nvar log = _dereq_('./log');\nvar ImageContainer = _dereq_('./imagecontainer');\nvar DummyImageContainer = _dereq_('./dummyimagecontainer');\nvar ProxyImageContainer = _dereq_('./proxyimagecontainer');\nvar FrameContainer = _dereq_('./framecontainer');\nvar SVGContainer = _dereq_('./svgcontainer');\nvar SVGNodeContainer = _dereq_('./svgnodecontainer');\nvar LinearGradientContainer = _dereq_('./lineargradientcontainer');\nvar WebkitGradientContainer = _dereq_('./webkitgradientcontainer');\nvar bind = _dereq_('./utils').bind;\n\nfunction ImageLoader(options, support) {\n    this.link = null;\n    this.options = options;\n    this.support = support;\n    this.origin = this.getOrigin(window.location.href);\n}\n\nImageLoader.prototype.findImages = function(nodes) {\n    var images = [];\n    nodes.reduce(function(imageNodes, container) {\n        switch(container.node.nodeName) {\n        case \"IMG\":\n            return imageNodes.concat([{\n                args: [container.node.src],\n                method: \"url\"\n            }]);\n        case \"svg\":\n        case \"IFRAME\":\n            return imageNodes.concat([{\n                args: [container.node],\n                method: container.node.nodeName\n            }]);\n        }\n        return imageNodes;\n    }, []).forEach(this.addImage(images, this.loadImage), this);\n    return images;\n};\n\nImageLoader.prototype.findBackgroundImage = function(images, container) {\n    container.parseBackgroundImages().filter(this.hasImageBackground).forEach(this.addImage(images, this.loadImage), this);\n    return images;\n};\n\nImageLoader.prototype.addImage = function(images, callback) {\n    return function(newImage) {\n        newImage.args.forEach(function(image) {\n            if (!this.imageExists(images, image)) {\n                images.splice(0, 0, callback.call(this, newImage));\n                log('Added image #' + (images.length), typeof(image) === \"string\" ? image.substring(0, 100) : image);\n            }\n        }, this);\n    };\n};\n\nImageLoader.prototype.hasImageBackground = function(imageData) {\n    return imageData.method !== \"none\";\n};\n\nImageLoader.prototype.loadImage = function(imageData) {\n    if (imageData.method === \"url\") {\n        var src = imageData.args[0];\n        if (this.isSVG(src) && !this.support.svg && !this.options.allowTaint) {\n            return new SVGContainer(src);\n        } else if (src.match(/data:image\\/.*;base64,/i)) {\n            return new ImageContainer(src.replace(/url\\(['\"]{0,}|['\"]{0,}\\)$/ig, ''), false);\n        } else if (this.isSameOrigin(src) || this.options.allowTaint === true || this.isSVG(src)) {\n            return new ImageContainer(src, false);\n        } else if (this.support.cors && !this.options.allowTaint && this.options.useCORS) {\n            return new ImageContainer(src, true);\n        } else if (this.options.proxy) {\n            return new ProxyImageContainer(src, this.options.proxy);\n        } else {\n            return new DummyImageContainer(src);\n        }\n    } else if (imageData.method === \"linear-gradient\") {\n        return new LinearGradientContainer(imageData);\n    } else if (imageData.method === \"gradient\") {\n        return new WebkitGradientContainer(imageData);\n    } else if (imageData.method === \"svg\") {\n        return new SVGNodeContainer(imageData.args[0], this.support.svg);\n    } else if (imageData.method === \"IFRAME\") {\n        return new FrameContainer(imageData.args[0], this.isSameOrigin(imageData.args[0].src), this.options);\n    } else {\n        return new DummyImageContainer(imageData);\n    }\n};\n\nImageLoader.prototype.isSVG = function(src) {\n    return src.substring(src.length - 3).toLowerCase() === \"svg\" || SVGContainer.prototype.isInline(src);\n};\n\nImageLoader.prototype.imageExists = function(images, src) {\n    return images.some(function(image) {\n        return image.src === src;\n    });\n};\n\nImageLoader.prototype.isSameOrigin = function(url) {\n    return (this.getOrigin(url) === this.origin);\n};\n\nImageLoader.prototype.getOrigin = function(url) {\n    var link = this.link || (this.link = document.createElement(\"a\"));\n    link.href = url;\n    link.href = link.href; // IE9, LOL! - http://jsfiddle.net/niklasvh/2e48b/\n    return link.protocol + link.hostname + link.port;\n};\n\nImageLoader.prototype.getPromise = function(container) {\n    return this.timeout(container, this.options.imageTimeout)['catch'](function() {\n        var dummy = new DummyImageContainer(container.src);\n        return dummy.promise.then(function(image) {\n            container.image = image;\n        });\n    });\n};\n\nImageLoader.prototype.get = function(src) {\n    var found = null;\n    return this.images.some(function(img) {\n        return (found = img).src === src;\n    }) ? found : null;\n};\n\nImageLoader.prototype.fetch = function(nodes) {\n    this.images = nodes.reduce(bind(this.findBackgroundImage, this), this.findImages(nodes));\n    this.images.forEach(function(image, index) {\n        image.promise.then(function() {\n            log(\"Succesfully loaded image #\"+ (index+1), image);\n        }, function(e) {\n            log(\"Failed loading image #\"+ (index+1), image, e);\n        });\n    });\n    this.ready = Promise.all(this.images.map(this.getPromise, this));\n    log(\"Finished searching images\");\n    return this;\n};\n\nImageLoader.prototype.timeout = function(container, timeout) {\n    var timer;\n    var promise = Promise.race([container.promise, new Promise(function(res, reject) {\n        timer = setTimeout(function() {\n            log(\"Timed out loading image\", container);\n            reject(container);\n        }, timeout);\n    })]).then(function(container) {\n        clearTimeout(timer);\n        return container;\n    });\n    promise['catch'](function() {\n        clearTimeout(timer);\n    });\n    return promise;\n};\n\nmodule.exports = ImageLoader;\n\n},{\"./dummyimagecontainer\":5,\"./framecontainer\":8,\"./imagecontainer\":10,\"./lineargradientcontainer\":12,\"./log\":13,\"./proxyimagecontainer\":17,\"./svgcontainer\":23,\"./svgnodecontainer\":24,\"./utils\":26,\"./webkitgradientcontainer\":27}],12:[function(_dereq_,module,exports){\nvar GradientContainer = _dereq_('./gradientcontainer');\nvar Color = _dereq_('./color');\n\nfunction LinearGradientContainer(imageData) {\n    GradientContainer.apply(this, arguments);\n    this.type = GradientContainer.TYPES.LINEAR;\n\n    var hasDirection = LinearGradientContainer.REGEXP_DIRECTION.test( imageData.args[0] ) ||\n        !GradientContainer.REGEXP_COLORSTOP.test( imageData.args[0] );\n\n    if (hasDirection) {\n        imageData.args[0].split(/\\s+/).reverse().forEach(function(position, index) {\n            switch(position) {\n            case \"left\":\n                this.x0 = 0;\n                this.x1 = 1;\n                break;\n            case \"top\":\n                this.y0 = 0;\n                this.y1 = 1;\n                break;\n            case \"right\":\n                this.x0 = 1;\n                this.x1 = 0;\n                break;\n            case \"bottom\":\n                this.y0 = 1;\n                this.y1 = 0;\n                break;\n            case \"to\":\n                var y0 = this.y0;\n                var x0 = this.x0;\n                this.y0 = this.y1;\n                this.x0 = this.x1;\n                this.x1 = x0;\n                this.y1 = y0;\n                break;\n            case \"center\":\n                break; // centered by default\n            // Firefox internally converts position keywords to percentages:\n            // http://www.w3.org/TR/2010/WD-CSS2-20101207/colors.html#propdef-background-position\n            default: // percentage or absolute length\n                // TODO: support absolute start point positions (e.g., use bounds to convert px to a ratio)\n                var ratio = parseFloat(position, 10) * 1e-2;\n                if (isNaN(ratio)) { // invalid or unhandled value\n                    break;\n                }\n                if (index === 0) {\n                    this.y0 = ratio;\n                    this.y1 = 1 - this.y0;\n                } else {\n                    this.x0 = ratio;\n                    this.x1 = 1 - this.x0;\n                }\n                break;\n            }\n        }, this);\n    } else {\n        this.y0 = 0;\n        this.y1 = 1;\n    }\n\n    this.colorStops = imageData.args.slice(hasDirection ? 1 : 0).map(function(colorStop) {\n        var colorStopMatch = colorStop.match(GradientContainer.REGEXP_COLORSTOP);\n        var value = +colorStopMatch[2];\n        var unit = value === 0 ? \"%\" : colorStopMatch[3]; // treat \"0\" as \"0%\"\n        return {\n            color: new Color(colorStopMatch[1]),\n            // TODO: support absolute stop positions (e.g., compute gradient line length & convert px to ratio)\n            stop: unit === \"%\" ? value / 100 : null\n        };\n    });\n\n    if (this.colorStops[0].stop === null) {\n        this.colorStops[0].stop = 0;\n    }\n\n    if (this.colorStops[this.colorStops.length - 1].stop === null) {\n        this.colorStops[this.colorStops.length - 1].stop = 1;\n    }\n\n    // calculates and fills-in explicit stop positions when omitted from rule\n    this.colorStops.forEach(function(colorStop, index) {\n        if (colorStop.stop === null) {\n            this.colorStops.slice(index).some(function(find, count) {\n                if (find.stop !== null) {\n                    colorStop.stop = ((find.stop - this.colorStops[index - 1].stop) / (count + 1)) + this.colorStops[index - 1].stop;\n                    return true;\n                } else {\n                    return false;\n                }\n            }, this);\n        }\n    }, this);\n}\n\nLinearGradientContainer.prototype = Object.create(GradientContainer.prototype);\n\n// TODO: support <angle> (e.g. -?\\d{1,3}(?:\\.\\d+)deg, etc. : https://developer.mozilla.org/docs/Web/CSS/angle )\nLinearGradientContainer.REGEXP_DIRECTION = /^\\s*(?:to|left|right|top|bottom|center|\\d{1,3}(?:\\.\\d+)?%?)(?:\\s|$)/i;\n\nmodule.exports = LinearGradientContainer;\n\n},{\"./color\":3,\"./gradientcontainer\":9}],13:[function(_dereq_,module,exports){\nvar logger = function() {\n    if (logger.options.logging && window.console && window.console.log) {\n        Function.prototype.bind.call(window.console.log, (window.console)).apply(window.console, [(Date.now() - logger.options.start) + \"ms\", \"html2canvas:\"].concat([].slice.call(arguments, 0)));\n    }\n};\n\nlogger.options = {logging: false};\nmodule.exports = logger;\n\n},{}],14:[function(_dereq_,module,exports){\nvar Color = _dereq_('./color');\nvar utils = _dereq_('./utils');\nvar getBounds = utils.getBounds;\nvar parseBackgrounds = utils.parseBackgrounds;\nvar offsetBounds = utils.offsetBounds;\n\nfunction NodeContainer(node, parent) {\n    this.node = node;\n    this.parent = parent;\n    this.stack = null;\n    this.bounds = null;\n    this.borders = null;\n    this.clip = [];\n    this.backgroundClip = [];\n    this.offsetBounds = null;\n    this.visible = null;\n    this.computedStyles = null;\n    this.colors = {};\n    this.styles = {};\n    this.backgroundImages = null;\n    this.transformData = null;\n    this.transformMatrix = null;\n    this.isPseudoElement = false;\n    this.opacity = null;\n}\n\nNodeContainer.prototype.cloneTo = function(stack) {\n    stack.visible = this.visible;\n    stack.borders = this.borders;\n    stack.bounds = this.bounds;\n    stack.clip = this.clip;\n    stack.backgroundClip = this.backgroundClip;\n    stack.computedStyles = this.computedStyles;\n    stack.styles = this.styles;\n    stack.backgroundImages = this.backgroundImages;\n    stack.opacity = this.opacity;\n};\n\nNodeContainer.prototype.getOpacity = function() {\n    return this.opacity === null ? (this.opacity = this.cssFloat('opacity')) : this.opacity;\n};\n\nNodeContainer.prototype.assignStack = function(stack) {\n    this.stack = stack;\n    stack.children.push(this);\n};\n\nNodeContainer.prototype.isElementVisible = function() {\n    return this.node.nodeType === Node.TEXT_NODE ? this.parent.visible : (\n        this.css('display') !== \"none\" &&\n        this.css('visibility') !== \"hidden\" &&\n        !this.node.hasAttribute(\"data-html2canvas-ignore\") &&\n        (this.node.nodeName !== \"INPUT\" || this.node.getAttribute(\"type\") !== \"hidden\")\n    );\n};\n\nNodeContainer.prototype.css = function(attribute) {\n    if (!this.computedStyles) {\n        this.computedStyles = this.isPseudoElement ? this.parent.computedStyle(this.before ? \":before\" : \":after\") : this.computedStyle(null);\n    }\n\n    return this.styles[attribute] || (this.styles[attribute] = this.computedStyles[attribute]);\n};\n\nNodeContainer.prototype.prefixedCss = function(attribute) {\n    var prefixes = [\"webkit\", \"moz\", \"ms\", \"o\"];\n    var value = this.css(attribute);\n    if (value === undefined) {\n        prefixes.some(function(prefix) {\n            value = this.css(prefix + attribute.substr(0, 1).toUpperCase() + attribute.substr(1));\n            return value !== undefined;\n        }, this);\n    }\n    return value === undefined ? null : value;\n};\n\nNodeContainer.prototype.computedStyle = function(type) {\n    return this.node.ownerDocument.defaultView.getComputedStyle(this.node, type);\n};\n\nNodeContainer.prototype.cssInt = function(attribute) {\n    var value = parseInt(this.css(attribute), 10);\n    return (isNaN(value)) ? 0 : value; // borders in old IE are throwing 'medium' for demo.html\n};\n\nNodeContainer.prototype.color = function(attribute) {\n    return this.colors[attribute] || (this.colors[attribute] = new Color(this.css(attribute)));\n};\n\nNodeContainer.prototype.cssFloat = function(attribute) {\n    var value = parseFloat(this.css(attribute));\n    return (isNaN(value)) ? 0 : value;\n};\n\nNodeContainer.prototype.fontWeight = function() {\n    var weight = this.css(\"fontWeight\");\n    switch(parseInt(weight, 10)){\n    case 401:\n        weight = \"bold\";\n        break;\n    case 400:\n        weight = \"normal\";\n        break;\n    }\n    return weight;\n};\n\nNodeContainer.prototype.parseClip = function() {\n    var matches = this.css('clip').match(this.CLIP);\n    if (matches) {\n        return {\n            top: parseInt(matches[1], 10),\n            right: parseInt(matches[2], 10),\n            bottom: parseInt(matches[3], 10),\n            left: parseInt(matches[4], 10)\n        };\n    }\n    return null;\n};\n\nNodeContainer.prototype.parseBackgroundImages = function() {\n    return this.backgroundImages || (this.backgroundImages = parseBackgrounds(this.css(\"backgroundImage\")));\n};\n\nNodeContainer.prototype.cssList = function(property, index) {\n    var value = (this.css(property) || '').split(',');\n    value = value[index || 0] || value[0] || 'auto';\n    value = value.trim().split(' ');\n    if (value.length === 1) {\n        value = [value[0], isPercentage(value[0]) ? 'auto' : value[0]];\n    }\n    return value;\n};\n\nNodeContainer.prototype.parseBackgroundSize = function(bounds, image, index) {\n    var size = this.cssList(\"backgroundSize\", index);\n    var width, height;\n\n    if (isPercentage(size[0])) {\n        width = bounds.width * parseFloat(size[0]) / 100;\n    } else if (/contain|cover/.test(size[0])) {\n        var targetRatio = bounds.width / bounds.height, currentRatio = image.width / image.height;\n        return (targetRatio < currentRatio ^ size[0] === 'contain') ?  {width: bounds.height * currentRatio, height: bounds.height} : {width: bounds.width, height: bounds.width / currentRatio};\n    } else {\n        width = parseInt(size[0], 10);\n    }\n\n    if (size[0] === 'auto' && size[1] === 'auto') {\n        height = image.height;\n    } else if (size[1] === 'auto') {\n        height = width / image.width * image.height;\n    } else if (isPercentage(size[1])) {\n        height =  bounds.height * parseFloat(size[1]) / 100;\n    } else {\n        height = parseInt(size[1], 10);\n    }\n\n    if (size[0] === 'auto') {\n        width = height / image.height * image.width;\n    }\n\n    return {width: width, height: height};\n};\n\nNodeContainer.prototype.parseBackgroundPosition = function(bounds, image, index, backgroundSize) {\n    var position = this.cssList('backgroundPosition', index);\n    var left, top;\n\n    if (isPercentage(position[0])){\n        left = (bounds.width - (backgroundSize || image).width) * (parseFloat(position[0]) / 100);\n    } else {\n        left = parseInt(position[0], 10);\n    }\n\n    if (position[1] === 'auto') {\n        top = left / image.width * image.height;\n    } else if (isPercentage(position[1])){\n        top =  (bounds.height - (backgroundSize || image).height) * parseFloat(position[1]) / 100;\n    } else {\n        top = parseInt(position[1], 10);\n    }\n\n    if (position[0] === 'auto') {\n        left = top / image.height * image.width;\n    }\n\n    return {left: left, top: top};\n};\n\nNodeContainer.prototype.parseBackgroundRepeat = function(index) {\n    return this.cssList(\"backgroundRepeat\", index)[0];\n};\n\nNodeContainer.prototype.parseTextShadows = function() {\n    var textShadow = this.css(\"textShadow\");\n    var results = [];\n\n    if (textShadow && textShadow !== 'none') {\n        var shadows = textShadow.match(this.TEXT_SHADOW_PROPERTY);\n        for (var i = 0; shadows && (i < shadows.length); i++) {\n            var s = shadows[i].match(this.TEXT_SHADOW_VALUES);\n            results.push({\n                color: new Color(s[0]),\n                offsetX: s[1] ? parseFloat(s[1].replace('px', '')) : 0,\n                offsetY: s[2] ? parseFloat(s[2].replace('px', '')) : 0,\n                blur: s[3] ? s[3].replace('px', '') : 0\n            });\n        }\n    }\n    return results;\n};\n\nNodeContainer.prototype.parseTransform = function() {\n    if (!this.transformData) {\n        if (this.hasTransform()) {\n            var offset = this.parseBounds();\n            var origin = this.prefixedCss(\"transformOrigin\").split(\" \").map(removePx).map(asFloat);\n            origin[0] += offset.left;\n            origin[1] += offset.top;\n            this.transformData = {\n                origin: origin,\n                matrix: this.parseTransformMatrix()\n            };\n        } else {\n            this.transformData = {\n                origin: [0, 0],\n                matrix: [1, 0, 0, 1, 0, 0]\n            };\n        }\n    }\n    return this.transformData;\n};\n\nNodeContainer.prototype.parseTransformMatrix = function() {\n    if (!this.transformMatrix) {\n        var transform = this.prefixedCss(\"transform\");\n        var matrix = transform ? parseMatrix(transform.match(this.MATRIX_PROPERTY)) : null;\n        this.transformMatrix = matrix ? matrix : [1, 0, 0, 1, 0, 0];\n    }\n    return this.transformMatrix;\n};\n\nNodeContainer.prototype.parseBounds = function() {\n    return this.bounds || (this.bounds = this.hasTransform() ? offsetBounds(this.node) : getBounds(this.node));\n};\n\nNodeContainer.prototype.hasTransform = function() {\n    return this.parseTransformMatrix().join(\",\") !== \"1,0,0,1,0,0\" || (this.parent && this.parent.hasTransform());\n};\n\nNodeContainer.prototype.getValue = function() {\n    var value = this.node.value || \"\";\n    if (this.node.tagName === \"SELECT\") {\n        value = selectionValue(this.node);\n    } else if (this.node.type === \"password\") {\n        value = Array(value.length + 1).join('\\u2022'); // jshint ignore:line\n    }\n    return value.length === 0 ? (this.node.placeholder || \"\") : value;\n};\n\nNodeContainer.prototype.MATRIX_PROPERTY = /(matrix|matrix3d)\\((.+)\\)/;\nNodeContainer.prototype.TEXT_SHADOW_PROPERTY = /((rgba|rgb)\\([^\\)]+\\)(\\s-?\\d+px){0,})/g;\nNodeContainer.prototype.TEXT_SHADOW_VALUES = /(-?\\d+px)|(#.+)|(rgb\\(.+\\))|(rgba\\(.+\\))/g;\nNodeContainer.prototype.CLIP = /^rect\\((\\d+)px,? (\\d+)px,? (\\d+)px,? (\\d+)px\\)$/;\n\nfunction selectionValue(node) {\n    var option = node.options[node.selectedIndex || 0];\n    return option ? (option.text || \"\") : \"\";\n}\n\nfunction parseMatrix(match) {\n    if (match && match[1] === \"matrix\") {\n        return match[2].split(\",\").map(function(s) {\n            return parseFloat(s.trim());\n        });\n    } else if (match && match[1] === \"matrix3d\") {\n        var matrix3d = match[2].split(\",\").map(function(s) {\n          return parseFloat(s.trim());\n        });\n        return [matrix3d[0], matrix3d[1], matrix3d[4], matrix3d[5], matrix3d[12], matrix3d[13]];\n    }\n}\n\nfunction isPercentage(value) {\n    return value.toString().indexOf(\"%\") !== -1;\n}\n\nfunction removePx(str) {\n    return str.replace(\"px\", \"\");\n}\n\nfunction asFloat(str) {\n    return parseFloat(str);\n}\n\nmodule.exports = NodeContainer;\n\n},{\"./color\":3,\"./utils\":26}],15:[function(_dereq_,module,exports){\nvar log = _dereq_('./log');\nvar punycode = _dereq_('punycode');\nvar NodeContainer = _dereq_('./nodecontainer');\nvar TextContainer = _dereq_('./textcontainer');\nvar PseudoElementContainer = _dereq_('./pseudoelementcontainer');\nvar FontMetrics = _dereq_('./fontmetrics');\nvar Color = _dereq_('./color');\nvar StackingContext = _dereq_('./stackingcontext');\nvar utils = _dereq_('./utils');\nvar bind = utils.bind;\nvar getBounds = utils.getBounds;\nvar parseBackgrounds = utils.parseBackgrounds;\nvar offsetBounds = utils.offsetBounds;\n\nfunction NodeParser(element, renderer, support, imageLoader, options) {\n    log(\"Starting NodeParser\");\n    this.renderer = renderer;\n    this.options = options;\n    this.range = null;\n    this.support = support;\n    this.renderQueue = [];\n    this.stack = new StackingContext(true, 1, element.ownerDocument, null);\n    var parent = new NodeContainer(element, null);\n    if (options.background) {\n        renderer.rectangle(0, 0, renderer.width, renderer.height, new Color(options.background));\n    }\n    if (element === element.ownerDocument.documentElement) {\n        // http://www.w3.org/TR/css3-background/#special-backgrounds\n        var canvasBackground = new NodeContainer(parent.color('backgroundColor').isTransparent() ? element.ownerDocument.body : element.ownerDocument.documentElement, null);\n        renderer.rectangle(0, 0, renderer.width, renderer.height, canvasBackground.color('backgroundColor'));\n    }\n    parent.visibile = parent.isElementVisible();\n    this.createPseudoHideStyles(element.ownerDocument);\n    this.disableAnimations(element.ownerDocument);\n    this.nodes = flatten([parent].concat(this.getChildren(parent)).filter(function(container) {\n        return container.visible = container.isElementVisible();\n    }).map(this.getPseudoElements, this));\n    this.fontMetrics = new FontMetrics();\n    log(\"Fetched nodes, total:\", this.nodes.length);\n    log(\"Calculate overflow clips\");\n    this.calculateOverflowClips();\n    log(\"Start fetching images\");\n    this.images = imageLoader.fetch(this.nodes.filter(isElement));\n    this.ready = this.images.ready.then(bind(function() {\n        log(\"Images loaded, starting parsing\");\n        log(\"Creating stacking contexts\");\n        this.createStackingContexts();\n        log(\"Sorting stacking contexts\");\n        this.sortStackingContexts(this.stack);\n        this.parse(this.stack);\n        log(\"Render queue created with \" + this.renderQueue.length + \" items\");\n        return new Promise(bind(function(resolve) {\n            if (!options.async) {\n                this.renderQueue.forEach(this.paint, this);\n                resolve();\n            } else if (typeof(options.async) === \"function\") {\n                options.async.call(this, this.renderQueue, resolve);\n            } else if (this.renderQueue.length > 0){\n                this.renderIndex = 0;\n                this.asyncRenderer(this.renderQueue, resolve);\n            } else {\n                resolve();\n            }\n        }, this));\n    }, this));\n}\n\nNodeParser.prototype.calculateOverflowClips = function() {\n    this.nodes.forEach(function(container) {\n        if (isElement(container)) {\n            if (isPseudoElement(container)) {\n                container.appendToDOM();\n            }\n            container.borders = this.parseBorders(container);\n            var clip = (container.css('overflow') === \"hidden\") ? [container.borders.clip] : [];\n            var cssClip = container.parseClip();\n            if (cssClip && [\"absolute\", \"fixed\"].indexOf(container.css('position')) !== -1) {\n                clip.push([[\"rect\",\n                        container.bounds.left + cssClip.left,\n                        container.bounds.top + cssClip.top,\n                        cssClip.right - cssClip.left,\n                        cssClip.bottom - cssClip.top\n                ]]);\n            }\n            container.clip = hasParentClip(container) ? container.parent.clip.concat(clip) : clip;\n            container.backgroundClip = (container.css('overflow') !== \"hidden\") ? container.clip.concat([container.borders.clip]) : container.clip;\n            if (isPseudoElement(container)) {\n                container.cleanDOM();\n            }\n        } else if (isTextNode(container)) {\n            container.clip = hasParentClip(container) ? container.parent.clip : [];\n        }\n        if (!isPseudoElement(container)) {\n            container.bounds = null;\n        }\n    }, this);\n};\n\nfunction hasParentClip(container) {\n    return container.parent && container.parent.clip.length;\n}\n\nNodeParser.prototype.asyncRenderer = function(queue, resolve, asyncTimer) {\n    asyncTimer = asyncTimer || Date.now();\n    this.paint(queue[this.renderIndex++]);\n    if (queue.length === this.renderIndex) {\n        resolve();\n    } else if (asyncTimer + 20 > Date.now()) {\n        this.asyncRenderer(queue, resolve, asyncTimer);\n    } else {\n        setTimeout(bind(function() {\n            this.asyncRenderer(queue, resolve);\n        }, this), 0);\n    }\n};\n\nNodeParser.prototype.createPseudoHideStyles = function(document) {\n    this.createStyles(document, '.' + PseudoElementContainer.prototype.PSEUDO_HIDE_ELEMENT_CLASS_BEFORE + ':before { content: \"\" !important; display: none !important; }' +\n        '.' + PseudoElementContainer.prototype.PSEUDO_HIDE_ELEMENT_CLASS_AFTER + ':after { content: \"\" !important; display: none !important; }');\n};\n\nNodeParser.prototype.disableAnimations = function(document) {\n    this.createStyles(document, '* { -webkit-animation: none !important; -moz-animation: none !important; -o-animation: none !important; animation: none !important; ' +\n        '-webkit-transition: none !important; -moz-transition: none !important; -o-transition: none !important; transition: none !important;}');\n};\n\nNodeParser.prototype.createStyles = function(document, styles) {\n    var hidePseudoElements = document.createElement('style');\n    hidePseudoElements.innerHTML = styles;\n    document.body.appendChild(hidePseudoElements);\n};\n\nNodeParser.prototype.getPseudoElements = function(container) {\n    var nodes = [[container]];\n    if (container.node.nodeType === Node.ELEMENT_NODE) {\n        var before = this.getPseudoElement(container, \":before\");\n        var after = this.getPseudoElement(container, \":after\");\n\n        if (before) {\n            nodes.push(before);\n        }\n\n        if (after) {\n            nodes.push(after);\n        }\n    }\n    return flatten(nodes);\n};\n\nfunction toCamelCase(str) {\n    return str.replace(/(\\-[a-z])/g, function(match){\n        return match.toUpperCase().replace('-','');\n    });\n}\n\nNodeParser.prototype.getPseudoElement = function(container, type) {\n    var style = container.computedStyle(type);\n    if(!style || !style.content || style.content === \"none\" || style.content === \"-moz-alt-content\" || style.display === \"none\") {\n        return null;\n    }\n\n    var content = stripQuotes(style.content);\n    var isImage = content.substr(0, 3) === 'url';\n    var pseudoNode = document.createElement(isImage ? 'img' : 'html2canvaspseudoelement');\n    var pseudoContainer = new PseudoElementContainer(pseudoNode, container, type);\n\n    for (var i = style.length-1; i >= 0; i--) {\n        var property = toCamelCase(style.item(i));\n        pseudoNode.style[property] = style[property];\n    }\n\n    pseudoNode.className = PseudoElementContainer.prototype.PSEUDO_HIDE_ELEMENT_CLASS_BEFORE + \" \" + PseudoElementContainer.prototype.PSEUDO_HIDE_ELEMENT_CLASS_AFTER;\n\n    if (isImage) {\n        pseudoNode.src = parseBackgrounds(content)[0].args[0];\n        return [pseudoContainer];\n    } else {\n        var text = document.createTextNode(content);\n        pseudoNode.appendChild(text);\n        return [pseudoContainer, new TextContainer(text, pseudoContainer)];\n    }\n};\n\n\nNodeParser.prototype.getChildren = function(parentContainer) {\n    return flatten([].filter.call(parentContainer.node.childNodes, renderableNode).map(function(node) {\n        var container = [node.nodeType === Node.TEXT_NODE ? new TextContainer(node, parentContainer) : new NodeContainer(node, parentContainer)].filter(nonIgnoredElement);\n        return node.nodeType === Node.ELEMENT_NODE && container.length && node.tagName !== \"TEXTAREA\" ? (container[0].isElementVisible() ? container.concat(this.getChildren(container[0])) : []) : container;\n    }, this));\n};\n\nNodeParser.prototype.newStackingContext = function(container, hasOwnStacking) {\n    var stack = new StackingContext(hasOwnStacking, container.getOpacity(), container.node, container.parent);\n    container.cloneTo(stack);\n    var parentStack = hasOwnStacking ? stack.getParentStack(this) : stack.parent.stack;\n    parentStack.contexts.push(stack);\n    container.stack = stack;\n};\n\nNodeParser.prototype.createStackingContexts = function() {\n    this.nodes.forEach(function(container) {\n        if (isElement(container) && (this.isRootElement(container) || hasOpacity(container) || isPositionedForStacking(container) || this.isBodyWithTransparentRoot(container) || container.hasTransform())) {\n            this.newStackingContext(container, true);\n        } else if (isElement(container) && ((isPositioned(container) && zIndex0(container)) || isInlineBlock(container) || isFloating(container))) {\n            this.newStackingContext(container, false);\n        } else {\n            container.assignStack(container.parent.stack);\n        }\n    }, this);\n};\n\nNodeParser.prototype.isBodyWithTransparentRoot = function(container) {\n    return container.node.nodeName === \"BODY\" && container.parent.color('backgroundColor').isTransparent();\n};\n\nNodeParser.prototype.isRootElement = function(container) {\n    return container.parent === null;\n};\n\nNodeParser.prototype.sortStackingContexts = function(stack) {\n    stack.contexts.sort(zIndexSort(stack.contexts.slice(0)));\n    stack.contexts.forEach(this.sortStackingContexts, this);\n};\n\nNodeParser.prototype.parseTextBounds = function(container) {\n    return function(text, index, textList) {\n        if (container.parent.css(\"textDecoration\").substr(0, 4) !== \"none\" || text.trim().length !== 0) {\n            if (this.support.rangeBounds && !container.parent.hasTransform()) {\n                var offset = textList.slice(0, index).join(\"\").length;\n                return this.getRangeBounds(container.node, offset, text.length);\n            } else if (container.node && typeof(container.node.data) === \"string\") {\n                var replacementNode = container.node.splitText(text.length);\n                var bounds = this.getWrapperBounds(container.node, container.parent.hasTransform());\n                container.node = replacementNode;\n                return bounds;\n            }\n        } else if(!this.support.rangeBounds || container.parent.hasTransform()){\n            container.node = container.node.splitText(text.length);\n        }\n        return {};\n    };\n};\n\nNodeParser.prototype.getWrapperBounds = function(node, transform) {\n    var wrapper = node.ownerDocument.createElement('html2canvaswrapper');\n    var parent = node.parentNode,\n        backupText = node.cloneNode(true);\n\n    wrapper.appendChild(node.cloneNode(true));\n    parent.replaceChild(wrapper, node);\n    var bounds = transform ? offsetBounds(wrapper) : getBounds(wrapper);\n    parent.replaceChild(backupText, wrapper);\n    return bounds;\n};\n\nNodeParser.prototype.getRangeBounds = function(node, offset, length) {\n    var range = this.range || (this.range = node.ownerDocument.createRange());\n    range.setStart(node, offset);\n    range.setEnd(node, offset + length);\n    return range.getBoundingClientRect();\n};\n\nfunction ClearTransform() {}\n\nNodeParser.prototype.parse = function(stack) {\n    // http://www.w3.org/TR/CSS21/visuren.html#z-index\n    var negativeZindex = stack.contexts.filter(negativeZIndex); // 2. the child stacking contexts with negative stack levels (most negative first).\n    var descendantElements = stack.children.filter(isElement);\n    var descendantNonFloats = descendantElements.filter(not(isFloating));\n    var nonInlineNonPositionedDescendants = descendantNonFloats.filter(not(isPositioned)).filter(not(inlineLevel)); // 3 the in-flow, non-inline-level, non-positioned descendants.\n    var nonPositionedFloats = descendantElements.filter(not(isPositioned)).filter(isFloating); // 4. the non-positioned floats.\n    var inFlow = descendantNonFloats.filter(not(isPositioned)).filter(inlineLevel); // 5. the in-flow, inline-level, non-positioned descendants, including inline tables and inline blocks.\n    var stackLevel0 = stack.contexts.concat(descendantNonFloats.filter(isPositioned)).filter(zIndex0); // 6. the child stacking contexts with stack level 0 and the positioned descendants with stack level 0.\n    var text = stack.children.filter(isTextNode).filter(hasText);\n    var positiveZindex = stack.contexts.filter(positiveZIndex); // 7. the child stacking contexts with positive stack levels (least positive first).\n    negativeZindex.concat(nonInlineNonPositionedDescendants).concat(nonPositionedFloats)\n        .concat(inFlow).concat(stackLevel0).concat(text).concat(positiveZindex).forEach(function(container) {\n            this.renderQueue.push(container);\n            if (isStackingContext(container)) {\n                this.parse(container);\n                this.renderQueue.push(new ClearTransform());\n            }\n        }, this);\n};\n\nNodeParser.prototype.paint = function(container) {\n    try {\n        if (container instanceof ClearTransform) {\n            this.renderer.ctx.restore();\n        } else if (isTextNode(container)) {\n            if (isPseudoElement(container.parent)) {\n                container.parent.appendToDOM();\n            }\n            this.paintText(container);\n            if (isPseudoElement(container.parent)) {\n                container.parent.cleanDOM();\n            }\n        } else {\n            this.paintNode(container);\n        }\n    } catch(e) {\n        log(e);\n        if (this.options.strict) {\n            throw e;\n        }\n    }\n};\n\nNodeParser.prototype.paintNode = function(container) {\n    if (isStackingContext(container)) {\n        this.renderer.setOpacity(container.opacity);\n        this.renderer.ctx.save();\n        if (container.hasTransform()) {\n            this.renderer.setTransform(container.parseTransform());\n        }\n    }\n\n    if (container.node.nodeName === \"INPUT\" && container.node.type === \"checkbox\") {\n        this.paintCheckbox(container);\n    } else if (container.node.nodeName === \"INPUT\" && container.node.type === \"radio\") {\n        this.paintRadio(container);\n    } else {\n        this.paintElement(container);\n    }\n};\n\nNodeParser.prototype.paintElement = function(container) {\n    var bounds = container.parseBounds();\n    this.renderer.clip(container.backgroundClip, function() {\n        this.renderer.renderBackground(container, bounds, container.borders.borders.map(getWidth));\n    }, this);\n\n    this.renderer.clip(container.clip, function() {\n        this.renderer.renderBorders(container.borders.borders);\n    }, this);\n\n    this.renderer.clip(container.backgroundClip, function() {\n        switch (container.node.nodeName) {\n        case \"svg\":\n        case \"IFRAME\":\n            var imgContainer = this.images.get(container.node);\n            if (imgContainer) {\n                this.renderer.renderImage(container, bounds, container.borders, imgContainer);\n            } else {\n                log(\"Error loading <\" + container.node.nodeName + \">\", container.node);\n            }\n            break;\n        case \"IMG\":\n            var imageContainer = this.images.get(container.node.src);\n            if (imageContainer) {\n                this.renderer.renderImage(container, bounds, container.borders, imageContainer);\n            } else {\n                log(\"Error loading <img>\", container.node.src);\n            }\n            break;\n        case \"CANVAS\":\n            this.renderer.renderImage(container, bounds, container.borders, {image: container.node});\n            break;\n        case \"SELECT\":\n        case \"INPUT\":\n        case \"TEXTAREA\":\n            this.paintFormValue(container);\n            break;\n        }\n    }, this);\n};\n\nNodeParser.prototype.paintCheckbox = function(container) {\n    var b = container.parseBounds();\n\n    var size = Math.min(b.width, b.height);\n    var bounds = {width: size - 1, height: size - 1, top: b.top, left: b.left};\n    var r = [3, 3];\n    var radius = [r, r, r, r];\n    var borders = [1,1,1,1].map(function(w) {\n        return {color: new Color('#A5A5A5'), width: w};\n    });\n\n    var borderPoints = calculateCurvePoints(bounds, radius, borders);\n\n    this.renderer.clip(container.backgroundClip, function() {\n        this.renderer.rectangle(bounds.left + 1, bounds.top + 1, bounds.width - 2, bounds.height - 2, new Color(\"#DEDEDE\"));\n        this.renderer.renderBorders(calculateBorders(borders, bounds, borderPoints, radius));\n        if (container.node.checked) {\n            this.renderer.font(new Color('#424242'), 'normal', 'normal', 'bold', (size - 3) + \"px\", 'arial');\n            this.renderer.text(\"\\u2714\", bounds.left + size / 6, bounds.top + size - 1);\n        }\n    }, this);\n};\n\nNodeParser.prototype.paintRadio = function(container) {\n    var bounds = container.parseBounds();\n\n    var size = Math.min(bounds.width, bounds.height) - 2;\n\n    this.renderer.clip(container.backgroundClip, function() {\n        this.renderer.circleStroke(bounds.left + 1, bounds.top + 1, size, new Color('#DEDEDE'), 1, new Color('#A5A5A5'));\n        if (container.node.checked) {\n            this.renderer.circle(Math.ceil(bounds.left + size / 4) + 1, Math.ceil(bounds.top + size / 4) + 1, Math.floor(size / 2), new Color('#424242'));\n        }\n    }, this);\n};\n\nNodeParser.prototype.paintFormValue = function(container) {\n    var value = container.getValue();\n    if (value.length > 0) {\n        var document = container.node.ownerDocument;\n        var wrapper = document.createElement('html2canvaswrapper');\n        var properties = ['lineHeight', 'textAlign', 'fontFamily', 'fontWeight', 'fontSize', 'color',\n            'paddingLeft', 'paddingTop', 'paddingRight', 'paddingBottom',\n            'width', 'height', 'borderLeftStyle', 'borderTopStyle', 'borderLeftWidth', 'borderTopWidth',\n            'boxSizing', 'whiteSpace', 'wordWrap'];\n\n        properties.forEach(function(property) {\n            try {\n                wrapper.style[property] = container.css(property);\n            } catch(e) {\n                // Older IE has issues with \"border\"\n                log(\"html2canvas: Parse: Exception caught in renderFormValue: \" + e.message);\n            }\n        });\n        var bounds = container.parseBounds();\n        wrapper.style.position = \"fixed\";\n        wrapper.style.left = bounds.left + \"px\";\n        wrapper.style.top = bounds.top + \"px\";\n        wrapper.textContent = value;\n        document.body.appendChild(wrapper);\n        this.paintText(new TextContainer(wrapper.firstChild, container));\n        document.body.removeChild(wrapper);\n    }\n};\n\nNodeParser.prototype.paintText = function(container) {\n    container.applyTextTransform();\n    var characters = punycode.ucs2.decode(container.node.data);\n    var textList = (!this.options.letterRendering || noLetterSpacing(container)) && !hasUnicode(container.node.data) ? getWords(characters) : characters.map(function(character) {\n        return punycode.ucs2.encode([character]);\n    });\n\n    var weight = container.parent.fontWeight();\n    var size = container.parent.css('fontSize');\n    var family = container.parent.css('fontFamily');\n    var shadows = container.parent.parseTextShadows();\n\n    this.renderer.font(container.parent.color('color'), container.parent.css('fontStyle'), container.parent.css('fontVariant'), weight, size, family);\n    if (shadows.length) {\n        // TODO: support multiple text shadows\n        this.renderer.fontShadow(shadows[0].color, shadows[0].offsetX, shadows[0].offsetY, shadows[0].blur);\n    } else {\n        this.renderer.clearShadow();\n    }\n\n    this.renderer.clip(container.parent.clip, function() {\n        textList.map(this.parseTextBounds(container), this).forEach(function(bounds, index) {\n            if (bounds) {\n                this.renderer.text(textList[index], bounds.left, bounds.bottom);\n                this.renderTextDecoration(container.parent, bounds, this.fontMetrics.getMetrics(family, size));\n            }\n        }, this);\n    }, this);\n};\n\nNodeParser.prototype.renderTextDecoration = function(container, bounds, metrics) {\n    switch(container.css(\"textDecoration\").split(\" \")[0]) {\n    case \"underline\":\n        // Draws a line at the baseline of the font\n        // TODO As some browsers display the line as more than 1px if the font-size is big, need to take that into account both in position and size\n        this.renderer.rectangle(bounds.left, Math.round(bounds.top + metrics.baseline + metrics.lineWidth), bounds.width, 1, container.color(\"color\"));\n        break;\n    case \"overline\":\n        this.renderer.rectangle(bounds.left, Math.round(bounds.top), bounds.width, 1, container.color(\"color\"));\n        break;\n    case \"line-through\":\n        // TODO try and find exact position for line-through\n        this.renderer.rectangle(bounds.left, Math.ceil(bounds.top + metrics.middle + metrics.lineWidth), bounds.width, 1, container.color(\"color\"));\n        break;\n    }\n};\n\nvar borderColorTransforms = {\n    inset: [\n        [\"darken\", 0.60],\n        [\"darken\", 0.10],\n        [\"darken\", 0.10],\n        [\"darken\", 0.60]\n    ]\n};\n\nNodeParser.prototype.parseBorders = function(container) {\n    var nodeBounds = container.parseBounds();\n    var radius = getBorderRadiusData(container);\n    var borders = [\"Top\", \"Right\", \"Bottom\", \"Left\"].map(function(side, index) {\n        var style = container.css('border' + side + 'Style');\n        var color = container.color('border' + side + 'Color');\n        if (style === \"inset\" && color.isBlack()) {\n            color = new Color([255, 255, 255, color.a]); // this is wrong, but\n        }\n        var colorTransform = borderColorTransforms[style] ? borderColorTransforms[style][index] : null;\n        return {\n            width: container.cssInt('border' + side + 'Width'),\n            color: colorTransform ? color[colorTransform[0]](colorTransform[1]) : color,\n            args: null\n        };\n    });\n    var borderPoints = calculateCurvePoints(nodeBounds, radius, borders);\n\n    return {\n        clip: this.parseBackgroundClip(container, borderPoints, borders, radius, nodeBounds),\n        borders: calculateBorders(borders, nodeBounds, borderPoints, radius)\n    };\n};\n\nfunction calculateBorders(borders, nodeBounds, borderPoints, radius) {\n    return borders.map(function(border, borderSide) {\n        if (border.width > 0) {\n            var bx = nodeBounds.left;\n            var by = nodeBounds.top;\n            var bw = nodeBounds.width;\n            var bh = nodeBounds.height - (borders[2].width);\n\n            switch(borderSide) {\n            case 0:\n                // top border\n                bh = borders[0].width;\n                border.args = drawSide({\n                        c1: [bx, by],\n                        c2: [bx + bw, by],\n                        c3: [bx + bw - borders[1].width, by + bh],\n                        c4: [bx + borders[3].width, by + bh]\n                    }, radius[0], radius[1],\n                    borderPoints.topLeftOuter, borderPoints.topLeftInner, borderPoints.topRightOuter, borderPoints.topRightInner);\n                break;\n            case 1:\n                // right border\n                bx = nodeBounds.left + nodeBounds.width - (borders[1].width);\n                bw = borders[1].width;\n\n                border.args = drawSide({\n                        c1: [bx + bw, by],\n                        c2: [bx + bw, by + bh + borders[2].width],\n                        c3: [bx, by + bh],\n                        c4: [bx, by + borders[0].width]\n                    }, radius[1], radius[2],\n                    borderPoints.topRightOuter, borderPoints.topRightInner, borderPoints.bottomRightOuter, borderPoints.bottomRightInner);\n                break;\n            case 2:\n                // bottom border\n                by = (by + nodeBounds.height) - (borders[2].width);\n                bh = borders[2].width;\n                border.args = drawSide({\n                        c1: [bx + bw, by + bh],\n                        c2: [bx, by + bh],\n                        c3: [bx + borders[3].width, by],\n                        c4: [bx + bw - borders[3].width, by]\n                    }, radius[2], radius[3],\n                    borderPoints.bottomRightOuter, borderPoints.bottomRightInner, borderPoints.bottomLeftOuter, borderPoints.bottomLeftInner);\n                break;\n            case 3:\n                // left border\n                bw = borders[3].width;\n                border.args = drawSide({\n                        c1: [bx, by + bh + borders[2].width],\n                        c2: [bx, by],\n                        c3: [bx + bw, by + borders[0].width],\n                        c4: [bx + bw, by + bh]\n                    }, radius[3], radius[0],\n                    borderPoints.bottomLeftOuter, borderPoints.bottomLeftInner, borderPoints.topLeftOuter, borderPoints.topLeftInner);\n                break;\n            }\n        }\n        return border;\n    });\n}\n\nNodeParser.prototype.parseBackgroundClip = function(container, borderPoints, borders, radius, bounds) {\n    var backgroundClip = container.css('backgroundClip'),\n        borderArgs = [];\n\n    switch(backgroundClip) {\n    case \"content-box\":\n    case \"padding-box\":\n        parseCorner(borderArgs, radius[0], radius[1], borderPoints.topLeftInner, borderPoints.topRightInner, bounds.left + borders[3].width, bounds.top + borders[0].width);\n        parseCorner(borderArgs, radius[1], radius[2], borderPoints.topRightInner, borderPoints.bottomRightInner, bounds.left + bounds.width - borders[1].width, bounds.top + borders[0].width);\n        parseCorner(borderArgs, radius[2], radius[3], borderPoints.bottomRightInner, borderPoints.bottomLeftInner, bounds.left + bounds.width - borders[1].width, bounds.top + bounds.height - borders[2].width);\n        parseCorner(borderArgs, radius[3], radius[0], borderPoints.bottomLeftInner, borderPoints.topLeftInner, bounds.left + borders[3].width, bounds.top + bounds.height - borders[2].width);\n        break;\n\n    default:\n        parseCorner(borderArgs, radius[0], radius[1], borderPoints.topLeftOuter, borderPoints.topRightOuter, bounds.left, bounds.top);\n        parseCorner(borderArgs, radius[1], radius[2], borderPoints.topRightOuter, borderPoints.bottomRightOuter, bounds.left + bounds.width, bounds.top);\n        parseCorner(borderArgs, radius[2], radius[3], borderPoints.bottomRightOuter, borderPoints.bottomLeftOuter, bounds.left + bounds.width, bounds.top + bounds.height);\n        parseCorner(borderArgs, radius[3], radius[0], borderPoints.bottomLeftOuter, borderPoints.topLeftOuter, bounds.left, bounds.top + bounds.height);\n        break;\n    }\n\n    return borderArgs;\n};\n\nfunction getCurvePoints(x, y, r1, r2) {\n    var kappa = 4 * ((Math.sqrt(2) - 1) / 3);\n    var ox = (r1) * kappa, // control point offset horizontal\n        oy = (r2) * kappa, // control point offset vertical\n        xm = x + r1, // x-middle\n        ym = y + r2; // y-middle\n    return {\n        topLeft: bezierCurve({x: x, y: ym}, {x: x, y: ym - oy}, {x: xm - ox, y: y}, {x: xm, y: y}),\n        topRight: bezierCurve({x: x, y: y}, {x: x + ox,y: y}, {x: xm, y: ym - oy}, {x: xm, y: ym}),\n        bottomRight: bezierCurve({x: xm, y: y}, {x: xm, y: y + oy}, {x: x + ox, y: ym}, {x: x, y: ym}),\n        bottomLeft: bezierCurve({x: xm, y: ym}, {x: xm - ox, y: ym}, {x: x, y: y + oy}, {x: x, y:y})\n    };\n}\n\nfunction calculateCurvePoints(bounds, borderRadius, borders) {\n    var x = bounds.left,\n        y = bounds.top,\n        width = bounds.width,\n        height = bounds.height,\n\n        tlh = borderRadius[0][0] < width / 2 ? borderRadius[0][0] : width / 2,\n        tlv = borderRadius[0][1] < height / 2 ? borderRadius[0][1] : height / 2,\n        trh = borderRadius[1][0] < width / 2 ? borderRadius[1][0] : width / 2,\n        trv = borderRadius[1][1] < height / 2 ? borderRadius[1][1] : height / 2,\n        brh = borderRadius[2][0] < width / 2 ? borderRadius[2][0] : width / 2,\n        brv = borderRadius[2][1] < height / 2 ? borderRadius[2][1] : height / 2,\n        blh = borderRadius[3][0] < width / 2 ? borderRadius[3][0] : width / 2,\n        blv = borderRadius[3][1] < height / 2 ? borderRadius[3][1] : height / 2;\n\n    var topWidth = width - trh,\n        rightHeight = height - brv,\n        bottomWidth = width - brh,\n        leftHeight = height - blv;\n\n    return {\n        topLeftOuter: getCurvePoints(x, y, tlh, tlv).topLeft.subdivide(0.5),\n        topLeftInner: getCurvePoints(x + borders[3].width, y + borders[0].width, Math.max(0, tlh - borders[3].width), Math.max(0, tlv - borders[0].width)).topLeft.subdivide(0.5),\n        topRightOuter: getCurvePoints(x + topWidth, y, trh, trv).topRight.subdivide(0.5),\n        topRightInner: getCurvePoints(x + Math.min(topWidth, width + borders[3].width), y + borders[0].width, (topWidth > width + borders[3].width) ? 0 :trh - borders[3].width, trv - borders[0].width).topRight.subdivide(0.5),\n        bottomRightOuter: getCurvePoints(x + bottomWidth, y + rightHeight, brh, brv).bottomRight.subdivide(0.5),\n        bottomRightInner: getCurvePoints(x + Math.min(bottomWidth, width - borders[3].width), y + Math.min(rightHeight, height + borders[0].width), Math.max(0, brh - borders[1].width),  brv - borders[2].width).bottomRight.subdivide(0.5),\n        bottomLeftOuter: getCurvePoints(x, y + leftHeight, blh, blv).bottomLeft.subdivide(0.5),\n        bottomLeftInner: getCurvePoints(x + borders[3].width, y + leftHeight, Math.max(0, blh - borders[3].width), blv - borders[2].width).bottomLeft.subdivide(0.5)\n    };\n}\n\nfunction bezierCurve(start, startControl, endControl, end) {\n    var lerp = function (a, b, t) {\n        return {\n            x: a.x + (b.x - a.x) * t,\n            y: a.y + (b.y - a.y) * t\n        };\n    };\n\n    return {\n        start: start,\n        startControl: startControl,\n        endControl: endControl,\n        end: end,\n        subdivide: function(t) {\n            var ab = lerp(start, startControl, t),\n                bc = lerp(startControl, endControl, t),\n                cd = lerp(endControl, end, t),\n                abbc = lerp(ab, bc, t),\n                bccd = lerp(bc, cd, t),\n                dest = lerp(abbc, bccd, t);\n            return [bezierCurve(start, ab, abbc, dest), bezierCurve(dest, bccd, cd, end)];\n        },\n        curveTo: function(borderArgs) {\n            borderArgs.push([\"bezierCurve\", startControl.x, startControl.y, endControl.x, endControl.y, end.x, end.y]);\n        },\n        curveToReversed: function(borderArgs) {\n            borderArgs.push([\"bezierCurve\", endControl.x, endControl.y, startControl.x, startControl.y, start.x, start.y]);\n        }\n    };\n}\n\nfunction drawSide(borderData, radius1, radius2, outer1, inner1, outer2, inner2) {\n    var borderArgs = [];\n\n    if (radius1[0] > 0 || radius1[1] > 0) {\n        borderArgs.push([\"line\", outer1[1].start.x, outer1[1].start.y]);\n        outer1[1].curveTo(borderArgs);\n    } else {\n        borderArgs.push([ \"line\", borderData.c1[0], borderData.c1[1]]);\n    }\n\n    if (radius2[0] > 0 || radius2[1] > 0) {\n        borderArgs.push([\"line\", outer2[0].start.x, outer2[0].start.y]);\n        outer2[0].curveTo(borderArgs);\n        borderArgs.push([\"line\", inner2[0].end.x, inner2[0].end.y]);\n        inner2[0].curveToReversed(borderArgs);\n    } else {\n        borderArgs.push([\"line\", borderData.c2[0], borderData.c2[1]]);\n        borderArgs.push([\"line\", borderData.c3[0], borderData.c3[1]]);\n    }\n\n    if (radius1[0] > 0 || radius1[1] > 0) {\n        borderArgs.push([\"line\", inner1[1].end.x, inner1[1].end.y]);\n        inner1[1].curveToReversed(borderArgs);\n    } else {\n        borderArgs.push([\"line\", borderData.c4[0], borderData.c4[1]]);\n    }\n\n    return borderArgs;\n}\n\nfunction parseCorner(borderArgs, radius1, radius2, corner1, corner2, x, y) {\n    if (radius1[0] > 0 || radius1[1] > 0) {\n        borderArgs.push([\"line\", corner1[0].start.x, corner1[0].start.y]);\n        corner1[0].curveTo(borderArgs);\n        corner1[1].curveTo(borderArgs);\n    } else {\n        borderArgs.push([\"line\", x, y]);\n    }\n\n    if (radius2[0] > 0 || radius2[1] > 0) {\n        borderArgs.push([\"line\", corner2[0].start.x, corner2[0].start.y]);\n    }\n}\n\nfunction negativeZIndex(container) {\n    return container.cssInt(\"zIndex\") < 0;\n}\n\nfunction positiveZIndex(container) {\n    return container.cssInt(\"zIndex\") > 0;\n}\n\nfunction zIndex0(container) {\n    return container.cssInt(\"zIndex\") === 0;\n}\n\nfunction inlineLevel(container) {\n    return [\"inline\", \"inline-block\", \"inline-table\"].indexOf(container.css(\"display\")) !== -1;\n}\n\nfunction isStackingContext(container) {\n    return (container instanceof StackingContext);\n}\n\nfunction hasText(container) {\n    return container.node.data.trim().length > 0;\n}\n\nfunction noLetterSpacing(container) {\n    return (/^(normal|none|0px)$/.test(container.parent.css(\"letterSpacing\")));\n}\n\nfunction getBorderRadiusData(container) {\n    return [\"TopLeft\", \"TopRight\", \"BottomRight\", \"BottomLeft\"].map(function(side) {\n        var value = container.css('border' + side + 'Radius');\n        var arr = value.split(\" \");\n        if (arr.length <= 1) {\n            arr[1] = arr[0];\n        }\n        return arr.map(asInt);\n    });\n}\n\nfunction renderableNode(node) {\n    return (node.nodeType === Node.TEXT_NODE || node.nodeType === Node.ELEMENT_NODE);\n}\n\nfunction isPositionedForStacking(container) {\n    var position = container.css(\"position\");\n    var zIndex = ([\"absolute\", \"relative\", \"fixed\"].indexOf(position) !== -1) ? container.css(\"zIndex\") : \"auto\";\n    return zIndex !== \"auto\";\n}\n\nfunction isPositioned(container) {\n    return container.css(\"position\") !== \"static\";\n}\n\nfunction isFloating(container) {\n    return container.css(\"float\") !== \"none\";\n}\n\nfunction isInlineBlock(container) {\n    return [\"inline-block\", \"inline-table\"].indexOf(container.css(\"display\")) !== -1;\n}\n\nfunction not(callback) {\n    var context = this;\n    return function() {\n        return !callback.apply(context, arguments);\n    };\n}\n\nfunction isElement(container) {\n    return container.node.nodeType === Node.ELEMENT_NODE;\n}\n\nfunction isPseudoElement(container) {\n    return container.isPseudoElement === true;\n}\n\nfunction isTextNode(container) {\n    return container.node.nodeType === Node.TEXT_NODE;\n}\n\nfunction zIndexSort(contexts) {\n    return function(a, b) {\n        return (a.cssInt(\"zIndex\") + (contexts.indexOf(a) / contexts.length)) - (b.cssInt(\"zIndex\") + (contexts.indexOf(b) / contexts.length));\n    };\n}\n\nfunction hasOpacity(container) {\n    return container.getOpacity() < 1;\n}\n\nfunction asInt(value) {\n    return parseInt(value, 10);\n}\n\nfunction getWidth(border) {\n    return border.width;\n}\n\nfunction nonIgnoredElement(nodeContainer) {\n    return (nodeContainer.node.nodeType !== Node.ELEMENT_NODE || [\"SCRIPT\", \"HEAD\", \"TITLE\", \"OBJECT\", \"BR\", \"OPTION\"].indexOf(nodeContainer.node.nodeName) === -1);\n}\n\nfunction flatten(arrays) {\n    return [].concat.apply([], arrays);\n}\n\nfunction stripQuotes(content) {\n    var first = content.substr(0, 1);\n    return (first === content.substr(content.length - 1) && first.match(/'|\"/)) ? content.substr(1, content.length - 2) : content;\n}\n\nfunction getWords(characters) {\n    var words = [], i = 0, onWordBoundary = false, word;\n    while(characters.length) {\n        if (isWordBoundary(characters[i]) === onWordBoundary) {\n            word = characters.splice(0, i);\n            if (word.length) {\n                words.push(punycode.ucs2.encode(word));\n            }\n            onWordBoundary =! onWordBoundary;\n            i = 0;\n        } else {\n            i++;\n        }\n\n        if (i >= characters.length) {\n            word = characters.splice(0, i);\n            if (word.length) {\n                words.push(punycode.ucs2.encode(word));\n            }\n        }\n    }\n    return words;\n}\n\nfunction isWordBoundary(characterCode) {\n    return [\n        32, // <space>\n        13, // \\r\n        10, // \\n\n        9, // \\t\n        45 // -\n    ].indexOf(characterCode) !== -1;\n}\n\nfunction hasUnicode(string) {\n    return (/[^\\u0000-\\u00ff]/).test(string);\n}\n\nmodule.exports = NodeParser;\n\n},{\"./color\":3,\"./fontmetrics\":7,\"./log\":13,\"./nodecontainer\":14,\"./pseudoelementcontainer\":18,\"./stackingcontext\":21,\"./textcontainer\":25,\"./utils\":26,\"punycode\":1}],16:[function(_dereq_,module,exports){\nvar XHR = _dereq_('./xhr');\nvar utils = _dereq_('./utils');\nvar log = _dereq_('./log');\nvar createWindowClone = _dereq_('./clone');\nvar decode64 = utils.decode64;\n\nfunction Proxy(src, proxyUrl, document) {\n    var supportsCORS = ('withCredentials' in new XMLHttpRequest());\n    if (!proxyUrl) {\n        return Promise.reject(\"No proxy configured\");\n    }\n    var callback = createCallback(supportsCORS);\n    var url = createProxyUrl(proxyUrl, src, callback);\n\n    return supportsCORS ? XHR(url) : (jsonp(document, url, callback).then(function(response) {\n        return decode64(response.content);\n    }));\n}\nvar proxyCount = 0;\n\nfunction ProxyURL(src, proxyUrl, document) {\n    var supportsCORSImage = ('crossOrigin' in new Image());\n    var callback = createCallback(supportsCORSImage);\n    var url = createProxyUrl(proxyUrl, src, callback);\n    return (supportsCORSImage ? Promise.resolve(url) : jsonp(document, url, callback).then(function(response) {\n        return \"data:\" + response.type + \";base64,\" + response.content;\n    }));\n}\n\nfunction jsonp(document, url, callback) {\n    return new Promise(function(resolve, reject) {\n        var s = document.createElement(\"script\");\n        var cleanup = function() {\n            delete window.html2canvas.proxy[callback];\n            document.body.removeChild(s);\n        };\n        window.html2canvas.proxy[callback] = function(response) {\n            cleanup();\n            resolve(response);\n        };\n        s.src = url;\n        s.onerror = function(e) {\n            cleanup();\n            reject(e);\n        };\n        document.body.appendChild(s);\n    });\n}\n\nfunction createCallback(useCORS) {\n    return !useCORS ? \"html2canvas_\" + Date.now() + \"_\" + (++proxyCount) + \"_\" + Math.round(Math.random() * 100000) : \"\";\n}\n\nfunction createProxyUrl(proxyUrl, src, callback) {\n    return proxyUrl + \"?url=\" + encodeURIComponent(src) + (callback.length ? \"&callback=html2canvas.proxy.\" + callback : \"\");\n}\n\nfunction documentFromHTML(src) {\n    return function(html) {\n        var parser = new DOMParser(), doc;\n        try {\n            doc = parser.parseFromString(html, \"text/html\");\n        } catch(e) {\n            log(\"DOMParser not supported, falling back to createHTMLDocument\");\n            doc = document.implementation.createHTMLDocument(\"\");\n            try {\n                doc.open();\n                doc.write(html);\n                doc.close();\n            } catch(ee) {\n                log(\"createHTMLDocument write not supported, falling back to document.body.innerHTML\");\n                doc.body.innerHTML = html; // ie9 doesnt support writing to documentElement\n            }\n        }\n\n        var b = doc.querySelector(\"base\");\n        if (!b || !b.href.host) {\n            var base = doc.createElement(\"base\");\n            base.href = src;\n            doc.head.insertBefore(base, doc.head.firstChild);\n        }\n\n        return doc;\n    };\n}\n\nfunction loadUrlDocument(src, proxy, document, width, height, options) {\n    return new Proxy(src, proxy, window.document).then(documentFromHTML(src)).then(function(doc) {\n        return createWindowClone(doc, document, width, height, options, 0, 0);\n    });\n}\n\nexports.Proxy = Proxy;\nexports.ProxyURL = ProxyURL;\nexports.loadUrlDocument = loadUrlDocument;\n\n},{\"./clone\":2,\"./log\":13,\"./utils\":26,\"./xhr\":28}],17:[function(_dereq_,module,exports){\nvar ProxyURL = _dereq_('./proxy').ProxyURL;\n\nfunction ProxyImageContainer(src, proxy) {\n    var link = document.createElement(\"a\");\n    link.href = src;\n    src = link.href;\n    this.src = src;\n    this.image = new Image();\n    var self = this;\n    this.promise = new Promise(function(resolve, reject) {\n        self.image.crossOrigin = \"Anonymous\";\n        self.image.onload = resolve;\n        self.image.onerror = reject;\n\n        new ProxyURL(src, proxy, document).then(function(url) {\n            self.image.src = url;\n        })['catch'](reject);\n    });\n}\n\nmodule.exports = ProxyImageContainer;\n\n},{\"./proxy\":16}],18:[function(_dereq_,module,exports){\nvar NodeContainer = _dereq_('./nodecontainer');\n\nfunction PseudoElementContainer(node, parent, type) {\n    NodeContainer.call(this, node, parent);\n    this.isPseudoElement = true;\n    this.before = type === \":before\";\n}\n\nPseudoElementContainer.prototype.cloneTo = function(stack) {\n    PseudoElementContainer.prototype.cloneTo.call(this, stack);\n    stack.isPseudoElement = true;\n    stack.before = this.before;\n};\n\nPseudoElementContainer.prototype = Object.create(NodeContainer.prototype);\n\nPseudoElementContainer.prototype.appendToDOM = function() {\n    if (this.before) {\n        this.parent.node.insertBefore(this.node, this.parent.node.firstChild);\n    } else {\n        this.parent.node.appendChild(this.node);\n    }\n    this.parent.node.className += \" \" + this.getHideClass();\n};\n\nPseudoElementContainer.prototype.cleanDOM = function() {\n    this.node.parentNode.removeChild(this.node);\n    this.parent.node.className = this.parent.node.className.replace(this.getHideClass(), \"\");\n};\n\nPseudoElementContainer.prototype.getHideClass = function() {\n    return this[\"PSEUDO_HIDE_ELEMENT_CLASS_\" + (this.before ? \"BEFORE\" : \"AFTER\")];\n};\n\nPseudoElementContainer.prototype.PSEUDO_HIDE_ELEMENT_CLASS_BEFORE = \"___html2canvas___pseudoelement_before\";\nPseudoElementContainer.prototype.PSEUDO_HIDE_ELEMENT_CLASS_AFTER = \"___html2canvas___pseudoelement_after\";\n\nmodule.exports = PseudoElementContainer;\n\n},{\"./nodecontainer\":14}],19:[function(_dereq_,module,exports){\nvar log = _dereq_('./log');\n\nfunction Renderer(width, height, images, options, document) {\n    this.width = width;\n    this.height = height;\n    this.images = images;\n    this.options = options;\n    this.document = document;\n}\n\nRenderer.prototype.renderImage = function(container, bounds, borderData, imageContainer) {\n    var paddingLeft = container.cssInt('paddingLeft'),\n        paddingTop = container.cssInt('paddingTop'),\n        paddingRight = container.cssInt('paddingRight'),\n        paddingBottom = container.cssInt('paddingBottom'),\n        borders = borderData.borders;\n\n    var width = bounds.width - (borders[1].width + borders[3].width + paddingLeft + paddingRight);\n    var height = bounds.height - (borders[0].width + borders[2].width + paddingTop + paddingBottom);\n    this.drawImage(\n        imageContainer,\n        0,\n        0,\n        imageContainer.image.width || width,\n        imageContainer.image.height || height,\n        bounds.left + paddingLeft + borders[3].width,\n        bounds.top + paddingTop + borders[0].width,\n        width,\n        height\n    );\n};\n\nRenderer.prototype.renderBackground = function(container, bounds, borderData) {\n    if (bounds.height > 0 && bounds.width > 0) {\n        this.renderBackgroundColor(container, bounds);\n        this.renderBackgroundImage(container, bounds, borderData);\n    }\n};\n\nRenderer.prototype.renderBackgroundColor = function(container, bounds) {\n    var color = container.color(\"backgroundColor\");\n    if (!color.isTransparent()) {\n        this.rectangle(bounds.left, bounds.top, bounds.width, bounds.height, color);\n    }\n};\n\nRenderer.prototype.renderBorders = function(borders) {\n    borders.forEach(this.renderBorder, this);\n};\n\nRenderer.prototype.renderBorder = function(data) {\n    if (!data.color.isTransparent() && data.args !== null) {\n        this.drawShape(data.args, data.color);\n    }\n};\n\nRenderer.prototype.renderBackgroundImage = function(container, bounds, borderData) {\n    var backgroundImages = container.parseBackgroundImages();\n    backgroundImages.reverse().forEach(function(backgroundImage, index, arr) {\n        switch(backgroundImage.method) {\n        case \"url\":\n            var image = this.images.get(backgroundImage.args[0]);\n            if (image) {\n                this.renderBackgroundRepeating(container, bounds, image, arr.length - (index+1), borderData);\n            } else {\n                log(\"Error loading background-image\", backgroundImage.args[0]);\n            }\n            break;\n        case \"linear-gradient\":\n        case \"gradient\":\n            var gradientImage = this.images.get(backgroundImage.value);\n            if (gradientImage) {\n                this.renderBackgroundGradient(gradientImage, bounds, borderData);\n            } else {\n                log(\"Error loading background-image\", backgroundImage.args[0]);\n            }\n            break;\n        case \"none\":\n            break;\n        default:\n            log(\"Unknown background-image type\", backgroundImage.args[0]);\n        }\n    }, this);\n};\n\nRenderer.prototype.renderBackgroundRepeating = function(container, bounds, imageContainer, index, borderData) {\n    var size = container.parseBackgroundSize(bounds, imageContainer.image, index);\n    var position = container.parseBackgroundPosition(bounds, imageContainer.image, index, size);\n    var repeat = container.parseBackgroundRepeat(index);\n    switch (repeat) {\n    case \"repeat-x\":\n    case \"repeat no-repeat\":\n        this.backgroundRepeatShape(imageContainer, position, size, bounds, bounds.left + borderData[3], bounds.top + position.top + borderData[0], 99999, size.height, borderData);\n        break;\n    case \"repeat-y\":\n    case \"no-repeat repeat\":\n        this.backgroundRepeatShape(imageContainer, position, size, bounds, bounds.left + position.left + borderData[3], bounds.top + borderData[0], size.width, 99999, borderData);\n        break;\n    case \"no-repeat\":\n        this.backgroundRepeatShape(imageContainer, position, size, bounds, bounds.left + position.left + borderData[3], bounds.top + position.top + borderData[0], size.width, size.height, borderData);\n        break;\n    default:\n        this.renderBackgroundRepeat(imageContainer, position, size, {top: bounds.top, left: bounds.left}, borderData[3], borderData[0]);\n        break;\n    }\n};\n\nmodule.exports = Renderer;\n\n},{\"./log\":13}],20:[function(_dereq_,module,exports){\nvar Renderer = _dereq_('../renderer');\nvar LinearGradientContainer = _dereq_('../lineargradientcontainer');\nvar log = _dereq_('../log');\n\nfunction CanvasRenderer(width, height) {\n    Renderer.apply(this, arguments);\n    this.canvas = this.options.canvas || this.document.createElement(\"canvas\");\n    if (!this.options.canvas) {\n        this.canvas.width = width;\n        this.canvas.height = height;\n    }\n    this.ctx = this.canvas.getContext(\"2d\");\n    this.taintCtx = this.document.createElement(\"canvas\").getContext(\"2d\");\n    this.ctx.textBaseline = \"bottom\";\n    this.variables = {};\n    log(\"Initialized CanvasRenderer with size\", width, \"x\", height);\n}\n\nCanvasRenderer.prototype = Object.create(Renderer.prototype);\n\nCanvasRenderer.prototype.setFillStyle = function(fillStyle) {\n    this.ctx.fillStyle = typeof(fillStyle) === \"object\" && !!fillStyle.isColor ? fillStyle.toString() : fillStyle;\n    return this.ctx;\n};\n\nCanvasRenderer.prototype.rectangle = function(left, top, width, height, color) {\n    this.setFillStyle(color).fillRect(left, top, width, height);\n};\n\nCanvasRenderer.prototype.circle = function(left, top, size, color) {\n    this.setFillStyle(color);\n    this.ctx.beginPath();\n    this.ctx.arc(left + size / 2, top + size / 2, size / 2, 0, Math.PI*2, true);\n    this.ctx.closePath();\n    this.ctx.fill();\n};\n\nCanvasRenderer.prototype.circleStroke = function(left, top, size, color, stroke, strokeColor) {\n    this.circle(left, top, size, color);\n    this.ctx.strokeStyle = strokeColor.toString();\n    this.ctx.stroke();\n};\n\nCanvasRenderer.prototype.drawShape = function(shape, color) {\n    this.shape(shape);\n    this.setFillStyle(color).fill();\n};\n\nCanvasRenderer.prototype.taints = function(imageContainer) {\n    if (imageContainer.tainted === null) {\n        this.taintCtx.drawImage(imageContainer.image, 0, 0);\n        try {\n            this.taintCtx.getImageData(0, 0, 1, 1);\n            imageContainer.tainted = false;\n        } catch(e) {\n            this.taintCtx = document.createElement(\"canvas\").getContext(\"2d\");\n            imageContainer.tainted = true;\n        }\n    }\n\n    return imageContainer.tainted;\n};\n\nCanvasRenderer.prototype.drawImage = function(imageContainer, sx, sy, sw, sh, dx, dy, dw, dh) {\n    if (!this.taints(imageContainer) || this.options.allowTaint) {\n        this.ctx.drawImage(imageContainer.image, sx, sy, sw, sh, dx, dy, dw, dh);\n    }\n};\n\nCanvasRenderer.prototype.clip = function(shapes, callback, context) {\n    this.ctx.save();\n    shapes.filter(hasEntries).forEach(function(shape) {\n        this.shape(shape).clip();\n    }, this);\n    callback.call(context);\n    this.ctx.restore();\n};\n\nCanvasRenderer.prototype.shape = function(shape) {\n    this.ctx.beginPath();\n    shape.forEach(function(point, index) {\n        if (point[0] === \"rect\") {\n            this.ctx.rect.apply(this.ctx, point.slice(1));\n        } else {\n            this.ctx[(index === 0) ? \"moveTo\" : point[0] + \"To\" ].apply(this.ctx, point.slice(1));\n        }\n    }, this);\n    this.ctx.closePath();\n    return this.ctx;\n};\n\nCanvasRenderer.prototype.font = function(color, style, variant, weight, size, family) {\n    this.setFillStyle(color).font = [style, variant, weight, size, family].join(\" \").split(\",\")[0];\n};\n\nCanvasRenderer.prototype.fontShadow = function(color, offsetX, offsetY, blur) {\n    this.setVariable(\"shadowColor\", color.toString())\n        .setVariable(\"shadowOffsetY\", offsetX)\n        .setVariable(\"shadowOffsetX\", offsetY)\n        .setVariable(\"shadowBlur\", blur);\n};\n\nCanvasRenderer.prototype.clearShadow = function() {\n    this.setVariable(\"shadowColor\", \"rgba(0,0,0,0)\");\n};\n\nCanvasRenderer.prototype.setOpacity = function(opacity) {\n    this.ctx.globalAlpha = opacity;\n};\n\nCanvasRenderer.prototype.setTransform = function(transform) {\n    this.ctx.translate(transform.origin[0], transform.origin[1]);\n    this.ctx.transform.apply(this.ctx, transform.matrix);\n    this.ctx.translate(-transform.origin[0], -transform.origin[1]);\n};\n\nCanvasRenderer.prototype.setVariable = function(property, value) {\n    if (this.variables[property] !== value) {\n        this.variables[property] = this.ctx[property] = value;\n    }\n\n    return this;\n};\n\nCanvasRenderer.prototype.text = function(text, left, bottom) {\n    this.ctx.fillText(text, left, bottom);\n};\n\nCanvasRenderer.prototype.backgroundRepeatShape = function(imageContainer, backgroundPosition, size, bounds, left, top, width, height, borderData) {\n    var shape = [\n        [\"line\", Math.round(left), Math.round(top)],\n        [\"line\", Math.round(left + width), Math.round(top)],\n        [\"line\", Math.round(left + width), Math.round(height + top)],\n        [\"line\", Math.round(left), Math.round(height + top)]\n    ];\n    this.clip([shape], function() {\n        this.renderBackgroundRepeat(imageContainer, backgroundPosition, size, bounds, borderData[3], borderData[0]);\n    }, this);\n};\n\nCanvasRenderer.prototype.renderBackgroundRepeat = function(imageContainer, backgroundPosition, size, bounds, borderLeft, borderTop) {\n    var offsetX = Math.round(bounds.left + backgroundPosition.left + borderLeft), offsetY = Math.round(bounds.top + backgroundPosition.top + borderTop);\n    this.setFillStyle(this.ctx.createPattern(this.resizeImage(imageContainer, size), \"repeat\"));\n    this.ctx.translate(offsetX, offsetY);\n    this.ctx.fill();\n    this.ctx.translate(-offsetX, -offsetY);\n};\n\nCanvasRenderer.prototype.renderBackgroundGradient = function(gradientImage, bounds) {\n    if (gradientImage instanceof LinearGradientContainer) {\n        var gradient = this.ctx.createLinearGradient(\n            bounds.left + bounds.width * gradientImage.x0,\n            bounds.top + bounds.height * gradientImage.y0,\n            bounds.left +  bounds.width * gradientImage.x1,\n            bounds.top +  bounds.height * gradientImage.y1);\n        gradientImage.colorStops.forEach(function(colorStop) {\n            gradient.addColorStop(colorStop.stop, colorStop.color.toString());\n        });\n        this.rectangle(bounds.left, bounds.top, bounds.width, bounds.height, gradient);\n    }\n};\n\nCanvasRenderer.prototype.resizeImage = function(imageContainer, size) {\n    var image = imageContainer.image;\n    if(image.width === size.width && image.height === size.height) {\n        return image;\n    }\n\n    var ctx, canvas = document.createElement('canvas');\n    canvas.width = size.width;\n    canvas.height = size.height;\n    ctx = canvas.getContext(\"2d\");\n    ctx.drawImage(image, 0, 0, image.width, image.height, 0, 0, size.width, size.height );\n    return canvas;\n};\n\nfunction hasEntries(array) {\n    return array.length > 0;\n}\n\nmodule.exports = CanvasRenderer;\n\n},{\"../lineargradientcontainer\":12,\"../log\":13,\"../renderer\":19}],21:[function(_dereq_,module,exports){\nvar NodeContainer = _dereq_('./nodecontainer');\n\nfunction StackingContext(hasOwnStacking, opacity, element, parent) {\n    NodeContainer.call(this, element, parent);\n    this.ownStacking = hasOwnStacking;\n    this.contexts = [];\n    this.children = [];\n    this.opacity = (this.parent ? this.parent.stack.opacity : 1) * opacity;\n}\n\nStackingContext.prototype = Object.create(NodeContainer.prototype);\n\nStackingContext.prototype.getParentStack = function(context) {\n    var parentStack = (this.parent) ? this.parent.stack : null;\n    return parentStack ? (parentStack.ownStacking ? parentStack : parentStack.getParentStack(context)) : context.stack;\n};\n\nmodule.exports = StackingContext;\n\n},{\"./nodecontainer\":14}],22:[function(_dereq_,module,exports){\nfunction Support(document) {\n    this.rangeBounds = this.testRangeBounds(document);\n    this.cors = this.testCORS();\n    this.svg = this.testSVG();\n}\n\nSupport.prototype.testRangeBounds = function(document) {\n    var range, testElement, rangeBounds, rangeHeight, support = false;\n\n    if (document.createRange) {\n        range = document.createRange();\n        if (range.getBoundingClientRect) {\n            testElement = document.createElement('boundtest');\n            testElement.style.height = \"123px\";\n            testElement.style.display = \"block\";\n            document.body.appendChild(testElement);\n\n            range.selectNode(testElement);\n            rangeBounds = range.getBoundingClientRect();\n            rangeHeight = rangeBounds.height;\n\n            if (rangeHeight === 123) {\n                support = true;\n            }\n            document.body.removeChild(testElement);\n        }\n    }\n\n    return support;\n};\n\nSupport.prototype.testCORS = function() {\n    return typeof((new Image()).crossOrigin) !== \"undefined\";\n};\n\nSupport.prototype.testSVG = function() {\n    var img = new Image();\n    var canvas = document.createElement(\"canvas\");\n    var ctx =  canvas.getContext(\"2d\");\n    img.src = \"data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg'></svg>\";\n\n    try {\n        ctx.drawImage(img, 0, 0);\n        canvas.toDataURL();\n    } catch(e) {\n        return false;\n    }\n    return true;\n};\n\nmodule.exports = Support;\n\n},{}],23:[function(_dereq_,module,exports){\nvar XHR = _dereq_('./xhr');\nvar decode64 = _dereq_('./utils').decode64;\n\nfunction SVGContainer(src) {\n    this.src = src;\n    this.image = null;\n    var self = this;\n\n    this.promise = this.hasFabric().then(function() {\n        return (self.isInline(src) ? Promise.resolve(self.inlineFormatting(src)) : XHR(src));\n    }).then(function(svg) {\n        return new Promise(function(resolve) {\n            window.html2canvas.svg.fabric.loadSVGFromString(svg, self.createCanvas.call(self, resolve));\n        });\n    });\n}\n\nSVGContainer.prototype.hasFabric = function() {\n    return !window.html2canvas.svg || !window.html2canvas.svg.fabric ? Promise.reject(new Error(\"html2canvas.svg.js is not loaded, cannot render svg\")) : Promise.resolve();\n};\n\nSVGContainer.prototype.inlineFormatting = function(src) {\n    return (/^data:image\\/svg\\+xml;base64,/.test(src)) ? this.decode64(this.removeContentType(src)) : this.removeContentType(src);\n};\n\nSVGContainer.prototype.removeContentType = function(src) {\n    return src.replace(/^data:image\\/svg\\+xml(;base64)?,/,'');\n};\n\nSVGContainer.prototype.isInline = function(src) {\n    return (/^data:image\\/svg\\+xml/i.test(src));\n};\n\nSVGContainer.prototype.createCanvas = function(resolve) {\n    var self = this;\n    return function (objects, options) {\n        var canvas = new window.html2canvas.svg.fabric.StaticCanvas('c');\n        self.image = canvas.lowerCanvasEl;\n        canvas\n            .setWidth(options.width)\n            .setHeight(options.height)\n            .add(window.html2canvas.svg.fabric.util.groupSVGElements(objects, options))\n            .renderAll();\n        resolve(canvas.lowerCanvasEl);\n    };\n};\n\nSVGContainer.prototype.decode64 = function(str) {\n    return (typeof(window.atob) === \"function\") ? window.atob(str) : decode64(str);\n};\n\nmodule.exports = SVGContainer;\n\n},{\"./utils\":26,\"./xhr\":28}],24:[function(_dereq_,module,exports){\nvar SVGContainer = _dereq_('./svgcontainer');\n\nfunction SVGNodeContainer(node, _native) {\n    this.src = node;\n    this.image = null;\n    var self = this;\n\n    this.promise = _native ? new Promise(function(resolve, reject) {\n        self.image = new Image();\n        self.image.onload = resolve;\n        self.image.onerror = reject;\n        self.image.src = \"data:image/svg+xml,\" + (new XMLSerializer()).serializeToString(node);\n        if (self.image.complete === true) {\n            resolve(self.image);\n        }\n    }) : this.hasFabric().then(function() {\n        return new Promise(function(resolve) {\n            window.html2canvas.svg.fabric.parseSVGDocument(node, self.createCanvas.call(self, resolve));\n        });\n    });\n}\n\nSVGNodeContainer.prototype = Object.create(SVGContainer.prototype);\n\nmodule.exports = SVGNodeContainer;\n\n},{\"./svgcontainer\":23}],25:[function(_dereq_,module,exports){\nvar NodeContainer = _dereq_('./nodecontainer');\n\nfunction TextContainer(node, parent) {\n    NodeContainer.call(this, node, parent);\n}\n\nTextContainer.prototype = Object.create(NodeContainer.prototype);\n\nTextContainer.prototype.applyTextTransform = function() {\n    this.node.data = this.transform(this.parent.css(\"textTransform\"));\n};\n\nTextContainer.prototype.transform = function(transform) {\n    var text = this.node.data;\n    switch(transform){\n        case \"lowercase\":\n            return text.toLowerCase();\n        case \"capitalize\":\n            return text.replace(/(^|\\s|:|-|\\(|\\))([a-z])/g, capitalize);\n        case \"uppercase\":\n            return text.toUpperCase();\n        default:\n            return text;\n    }\n};\n\nfunction capitalize(m, p1, p2) {\n    if (m.length > 0) {\n        return p1 + p2.toUpperCase();\n    }\n}\n\nmodule.exports = TextContainer;\n\n},{\"./nodecontainer\":14}],26:[function(_dereq_,module,exports){\nexports.smallImage = function smallImage() {\n    return \"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7\";\n};\n\nexports.bind = function(callback, context) {\n    return function() {\n        return callback.apply(context, arguments);\n    };\n};\n\n/*\n * base64-arraybuffer\n * https://github.com/niklasvh/base64-arraybuffer\n *\n * Copyright (c) 2012 Niklas von Hertzen\n * Licensed under the MIT license.\n */\n\nexports.decode64 = function(base64) {\n    var chars = \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\";\n    var len = base64.length, i, encoded1, encoded2, encoded3, encoded4, byte1, byte2, byte3;\n\n    var output = \"\";\n\n    for (i = 0; i < len; i+=4) {\n        encoded1 = chars.indexOf(base64[i]);\n        encoded2 = chars.indexOf(base64[i+1]);\n        encoded3 = chars.indexOf(base64[i+2]);\n        encoded4 = chars.indexOf(base64[i+3]);\n\n        byte1 = (encoded1 << 2) | (encoded2 >> 4);\n        byte2 = ((encoded2 & 15) << 4) | (encoded3 >> 2);\n        byte3 = ((encoded3 & 3) << 6) | encoded4;\n        if (encoded3 === 64) {\n            output += String.fromCharCode(byte1);\n        } else if (encoded4 === 64 || encoded4 === -1) {\n            output += String.fromCharCode(byte1, byte2);\n        } else{\n            output += String.fromCharCode(byte1, byte2, byte3);\n        }\n    }\n\n    return output;\n};\n\nexports.getBounds = function(node) {\n    if (node.getBoundingClientRect) {\n        var clientRect = node.getBoundingClientRect();\n        var width = node.offsetWidth == null ? clientRect.width : node.offsetWidth;\n        return {\n            top: clientRect.top,\n            bottom: clientRect.bottom || (clientRect.top + clientRect.height),\n            right: clientRect.left + width,\n            left: clientRect.left,\n            width:  width,\n            height: node.offsetHeight == null ? clientRect.height : node.offsetHeight\n        };\n    }\n    return {};\n};\n\nexports.offsetBounds = function(node) {\n    var parent = node.offsetParent ? exports.offsetBounds(node.offsetParent) : {top: 0, left: 0};\n\n    return {\n        top: node.offsetTop + parent.top,\n        bottom: node.offsetTop + node.offsetHeight + parent.top,\n        right: node.offsetLeft + parent.left + node.offsetWidth,\n        left: node.offsetLeft + parent.left,\n        width: node.offsetWidth,\n        height: node.offsetHeight\n    };\n};\n\nexports.parseBackgrounds = function(backgroundImage) {\n    var whitespace = ' \\r\\n\\t',\n        method, definition, prefix, prefix_i, block, results = [],\n        mode = 0, numParen = 0, quote, args;\n    var appendResult = function() {\n        if(method) {\n            if (definition.substr(0, 1) === '\"') {\n                definition = definition.substr(1, definition.length - 2);\n            }\n            if (definition) {\n                args.push(definition);\n            }\n            if (method.substr(0, 1) === '-' && (prefix_i = method.indexOf('-', 1 ) + 1) > 0) {\n                prefix = method.substr(0, prefix_i);\n                method = method.substr(prefix_i);\n            }\n            results.push({\n                prefix: prefix,\n                method: method.toLowerCase(),\n                value: block,\n                args: args,\n                image: null\n            });\n        }\n        args = [];\n        method = prefix = definition = block = '';\n    };\n    args = [];\n    method = prefix = definition = block = '';\n    backgroundImage.split(\"\").forEach(function(c) {\n        if (mode === 0 && whitespace.indexOf(c) > -1) {\n            return;\n        }\n        switch(c) {\n        case '\"':\n            if(!quote) {\n                quote = c;\n            } else if(quote === c) {\n                quote = null;\n            }\n            break;\n        case '(':\n            if(quote) {\n                break;\n            } else if(mode === 0) {\n                mode = 1;\n                block += c;\n                return;\n            } else {\n                numParen++;\n            }\n            break;\n        case ')':\n            if (quote) {\n                break;\n            } else if(mode === 1) {\n                if(numParen === 0) {\n                    mode = 0;\n                    block += c;\n                    appendResult();\n                    return;\n                } else {\n                    numParen--;\n                }\n            }\n            break;\n\n        case ',':\n            if (quote) {\n                break;\n            } else if(mode === 0) {\n                appendResult();\n                return;\n            } else if (mode === 1) {\n                if (numParen === 0 && !method.match(/^url$/i)) {\n                    args.push(definition);\n                    definition = '';\n                    block += c;\n                    return;\n                }\n            }\n            break;\n        }\n\n        block += c;\n        if (mode === 0) {\n            method += c;\n        } else {\n            definition += c;\n        }\n    });\n\n    appendResult();\n    return results;\n};\n\n},{}],27:[function(_dereq_,module,exports){\nvar GradientContainer = _dereq_('./gradientcontainer');\n\nfunction WebkitGradientContainer(imageData) {\n    GradientContainer.apply(this, arguments);\n    this.type = imageData.args[0] === \"linear\" ? GradientContainer.TYPES.LINEAR : GradientContainer.TYPES.RADIAL;\n}\n\nWebkitGradientContainer.prototype = Object.create(GradientContainer.prototype);\n\nmodule.exports = WebkitGradientContainer;\n\n},{\"./gradientcontainer\":9}],28:[function(_dereq_,module,exports){\nfunction XHR(url) {\n    return new Promise(function(resolve, reject) {\n        var xhr = new XMLHttpRequest();\n        xhr.open('GET', url);\n\n        xhr.onload = function() {\n            if (xhr.status === 200) {\n                resolve(xhr.responseText);\n            } else {\n                reject(new Error(xhr.statusText));\n            }\n        };\n\n        xhr.onerror = function() {\n            reject(new Error(\"Network Error\"));\n        };\n\n        xhr.send();\n    });\n}\n\nmodule.exports = XHR;\n\n},{}]},{},[4])(4)\n});\n\n\n/** WEBPACK FOOTER **\n ** ./~/html2canvas/dist/html2canvas.js\n **/","/**\n * base class for all object in the library\n * @class Baseobject\n */\nexport default class BaseObject {\n  /**\n   * virtual function for returning class name\n   * @returns {string}\n   */\n  getName() {\n    return '';\n  }\n\n  /**\n   * returns if current mode is debugging mode\n   * @returns {bool}\n   */\n  isDebug() {\n    return this._debugMode;\n  }\n\n  /**\n   * logs message and object for debugging purpose\n   * @param {string} message\n   * @param {Array<any>} args\n   */\n  log(message, ...args) {\n    if (!this.isDebug()) {\n      return;\n    }\n\n    console.log(`${this.getName()}: ${message}`, ...args);\n  }\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/base-object.js\n **/","import BaseObject from './base-object';\nimport Rect from './rect';\n\n/**\n * State enabled class to manage grey canvas on top of html page for cropping\n * @class CanvasState\n */\nexport default class CanvasState extends BaseObject {\n  /**\n   * object constructor\n   * @param {HTMLDocument} doc\n   * @param {HTMLElement} canvas - canvas DOM element\n   */\n  constructor(doc, canvas, onSelectionChange = () => {}, debugMode = true) {\n    super();\n\n    this._onMouseDown = this._onMouseDown.bind(this);\n    this._onMouseMove = this._onMouseMove.bind(this);\n    this._onMouseUp = this._onMouseUp.bind(this);\n    this._onTouch = this._onTouch.bind(this);\n    this._onSelectionChange = onSelectionChange;\n\n    this._document = doc;\n    this._canvas = canvas;\n    this._width = canvas.width;\n    this._height = canvas.height;\n    this._ctx = canvas.getContext('2d');\n    this._debugMode = debugMode;\n\n    const html = this._document.body.parentNode;\n\n    this._htmlTop = html.offsetTop;\n    this._htmlLeft = html.offsetLeft;\n\n    this._valid = false; // when set to false, the canvas will redraw everything\n    this._shape = null;  // the rectangle shape\n    this._dragging = false; // Keep track of when we are dragging\n    this._dragoffx = 0; // See mousedown and mousemove events for explanation\n    this._dragoffy = 0;\n\n    this.log('initialized');\n\n    this._initRect();\n    this._initEvents();\n    this._onSelectionChange(this._shape._w, this._shape._h);\n\n    this._interval = 30;\n    setInterval(() => {\n      this.draw();\n    }, this._interval);\n  }\n\n  /**\n   * returns class name\n   * @returns {string}\n   */\n  getName() {\n    return 'CanvasState';\n  }\n\n  _onMouseDown(e) {\n    const { _shape } = this;\n    const mouse = this.getMouse(e);\n    const mx = mouse.x;\n    const my = mouse.y;\n    this._valid = false;\n    if (_shape.contains(mx, my)) {\n      this._dragoffx = mx - _shape._x;\n      this._dragoffy = my - _shape._y;\n      this._dragging = true;\n\n      this.log('mouse down detected. starting drag', mx, my);\n    }\n\n    this._currentHandle = this._shape.getHoverSelectionHandle(mouse.x, mouse.y);\n  }\n\n  _onMouseMove(e) {\n    const { _shape, _canvas } = this;\n    const mouse = this.getMouse(e);\n    const oldx = _shape._x;\n    const oldy = _shape._y;\n    const mx = mouse.x;\n    const my = mouse.y;\n    const handleIndex = _shape.getHoverSelectionHandle(mx, my);\n    switch (handleIndex) {\n      case 0:\n        _canvas.style.cursor = 'nw-resize';\n        break;\n      case 1:\n        _canvas.style.cursor = 'n-resize';\n        break;\n      case 2:\n        _canvas.style.cursor = 'ne-resize';\n        break;\n      case 3:\n        _canvas.style.cursor = 'w-resize';\n        break;\n      case 4:\n        _canvas.style.cursor = 'e-resize';\n        break;\n      case 5:\n        _canvas.style.cursor = 'sw-resize';\n        break;\n      case 6:\n        _canvas.style.cursor = 's-resize';\n        break;\n      case 7:\n        _canvas.style.cursor = 'se-resize';\n        break;\n      default:\n        _canvas.style.cursor = 'auto';\n    }\n\n    if (this._currentHandle !== false) {\n      // Handles resizing\n      switch (this._currentHandle) {\n        case 0:\n          _shape._x = mx;\n          _shape._y = my;\n          _shape._w += oldx - mx;\n          _shape._h += oldy - my;\n          break;\n        case 1:\n          _shape._y = my;\n          _shape._h += oldy - my;\n          break;\n        case 2:\n          _shape._y = my;\n          _shape._w = mx - oldx;\n          _shape._h += oldy - my;\n          break;\n        case 3:\n          _shape._x = mx;\n          _shape._w += oldx - mx;\n          break;\n        case 4:\n          _shape._w = mx - oldx;\n          break;\n        case 5:\n          _shape._x = mx;\n          _shape._w += oldx - mx;\n          _shape._h = my - oldy;\n          break;\n        case 6:\n          _shape._h = my - oldy;\n          break;\n        case 7:\n          _shape._w = mx - oldx;\n          _shape._h = my - oldy;\n          break;\n        default:\n          break;\n      }\n\n      this._onSelectionChange(_shape._w, _shape._h);\n      this._valid = false;\n    } else if (this._dragging) {\n      // We don't want to drag the object by its top-left corner, we want to drag it\n      // from where we clicked. Thats why we saved the offset and use it here\n      this._shape._x = mouse.x - this._dragoffx;\n      this._shape._y = mouse.y - this._dragoffy;\n      this._valid = false; // Something's dragging so we must redraw\n\n      // this.log('moving the rect', mouse.x, mouse.y);\n    }\n  }\n\n  _onMouseUp() {\n    this._dragging = false;\n    this._currentHandle = false;\n  }\n\n  /**\n   * dispatches mouse events on touch\n   */\n  _onTouch(evt) {\n    evt.preventDefault(); // prevents touch event to disable scrolling on mobile devices\n    if (evt.touches.length > 1 || (evt.type === 'touchend' && evt.touches.length > 0)) {\n      return;\n    }\n\n    const newEvt = this._document.createEvent('MouseEvents');\n    const target = evt.target || evt.srcElement || evt.originalTarget;\n    let type = null;\n    let touch = null;\n\n    switch (evt.type) {\n      case 'touchstart':\n        type = 'mousedown';\n        touch = evt.changedTouches[0];\n        break;\n      case 'touchmove':\n        type = 'mousemove';\n        touch = evt.changedTouches[0];\n        break;\n      case 'touchend':\n        type = 'mouseup';\n        touch = evt.changedTouches[0];\n        break;\n      default:\n        break;\n    }\n\n    if (type === 'mousemove' && !this._dragging) {\n      // touchmove occurs without mouse down. thus dispatching mousedown is required.\n      newEvt.initMouseEvent('mousedown', true, true, target.ownerDocument.defaultView, 0,\n        touch.screenX, touch.screenY, touch.clientX, touch.clientY,\n        evt.ctrlKey, evt.altKey, evt.shiftKey, evt.metaKey, 0, null);\n      target.dispatchEvent(newEvt);\n    }\n\n    newEvt.initMouseEvent(type, true, true, target.ownerDocument.defaultView, 0,\n      touch.screenX, touch.screenY, touch.clientX, touch.clientY,\n      evt.ctrlKey, evt.altKey, evt.shiftKey, evt.metaKey, 0, null);\n\n    target.dispatchEvent(newEvt);\n  }\n\n  /**\n   * attaches event handlers to canvas\n   * @private\n   */\n  _initEvents() {\n    const { _canvas } = this;\n    // fixes a problem where double clicking causesShape text to get selected on the canvas\n    _canvas.addEventListener('selectstart', (e) => {\n      e.preventDefault();\n      return false;\n    }, false);\n\n    // up, down, and move are for dragging\n    _canvas.addEventListener('mousedown', this._onMouseDown, true);\n    _canvas.addEventListener('mousemove', this._onMouseMove, true);\n    _canvas.addEventListener('mouseup', this._onMouseUp, true);\n\n    _canvas.addEventListener('tapstart', this._onTouch, true);\n    _canvas.addEventListener('touchmove', this._onTouch, true);\n    _canvas.addEventListener('touchend', this._onTouch, true);\n\n    this.log('initialized events');\n  }\n\n  /**\n   * creates a movable rectangle and attach to canvas\n   * @private\n   */\n  _initRect() {\n    this._shape = new Rect(\n      this._width / 4,\n      this._height / 4,\n      this._width / 2,\n      this._height / 2,\n      'rgba(0, 200, 0, 0.5)',\n      20,\n      false // debug mode is set as false\n    );\n    this._valid = false;\n  }\n\n  /**\n   * Returns shape positions\n   * @returns {{x, y, w, h}}\n   */\n  getSelection() {\n    const { _x, _y, _w, _h } = this._shape;\n\n    return { x: _x, y: _y, w: _w, h: _h };\n  }\n\n  /**\n   * clears the canvas for next draw\n   */\n  clear() {\n    this._ctx.clearRect(0, 0, this._width, this._height);\n  }\n\n  /**\n   * while draw is called as often as the INTERVAL variable demands,\n   * it only ever does something if the canvas gets invalidated by our code\n   */\n  draw() {\n    // if our state is invalid, redraw and validate!\n    if (!this._valid) {\n      this.log('starting draw');\n      const { _ctx, _shape } = this;\n      this.clear();\n\n      // fill outside of the rectangle\n      _ctx.fillStyle = 'rgba(0,0,0,.8)';\n      _ctx.beginPath();\n      _ctx.rect(_shape._x, _shape._y, _shape._w, _shape._h);\n      _ctx.rect(this._width, 0, -this._width, this._height);\n      _ctx.fill();\n\n      // draw shape\n      _shape.draw(_ctx);\n\n      this._valid = true;\n\n      this.log('shape drew', _shape._x, _shape._y, _shape._w, _shape._h);\n    }\n  }\n\n  /**\n   * returns offset for the element\n   * @param {DOMElement} element\n   * @returns {{x: number, y: number}}\n   */\n  getOffset(element) {\n    let el = element;\n    let offsetX = 0;\n    let offsetY = 0;\n\n    // Compute the total offset\n    if (el.offsetParent !== undefined) {\n      do {\n        offsetX += el.offsetLeft;\n        offsetY += el.offsetTop;\n        el = el.offsetParent;\n      } while (el);\n    }\n\n    // Also add the <html> offsets in case there's a position:fixed bar\n    offsetX += this._htmlLeft;\n    offsetY += this._htmlTop;\n\n    // should handle scrolled position in offset\n    offsetX += this._document.body.scrollLeft;\n    offsetY += this._document.body.scrollTop;\n\n    return {\n      x: offsetX,\n      y: offsetY\n    };\n  }\n\n  /**\n   * creates an object with x and y defined, set to the mouse position relative to the state's canvas\n   * If you wanna be super-correct this can be tricky, we have to worry about padding and borders\n   * @param {Event} e\n   * @returns {{x: number, y: number}}\n   */\n  getMouse(e) {\n    const offset = this.getOffset(this._canvas);\n\n    const mx = e.pageX - offset.x;\n    const my = e.pageY - offset.y;\n\n    return { x: mx, y: my };\n  }\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/canvas-state.js\n **/","import BaseObject from './base-object';\n\n/**\n * Rectangle for highlighting the cropping area\n * @class Rect\n */\nexport default class Rect extends BaseObject {\n  /**\n   * object constructor\n   * @param {number} x - left position of shape\n   * @param {number} y - top position of shape\n   * @param {number} w - width\n   * @param {number} h - height\n   * @param {string} fill - background color of the shape\n   * @param {number} selectionBoxSize - width/height of selection handle\n   * @param {bool} debugMode\n   */\n  constructor(x, y, w, h, fill, selectionBoxSize = 6, debugMode = true) {\n    super();\n\n    this._selectionHandles = [];\n    this._selectionBoxSize = selectionBoxSize;\n    for (let i = 0; i < 8; i += 1) {\n      this._selectionHandles.push({ x: 0, y: 0 });\n    }\n\n    this._x = x || 0;\n    this._y = y || 0;\n    this._w = w || 1;\n    this._h = h || 1;\n    this._fill = fill || '#AAAAAA';\n    this._debugMode = debugMode;\n\n    this.log('initialized');\n  }\n\n  /**\n   * returns class name\n   * @returns {string}\n   */\n  getName() {\n    return 'Rect';\n  }\n\n  /**\n   * draws the shape\n   * @param {CanvasContext} ctx\n   */\n  draw(ctx) {\n    const { _x, _y, _w, _h, _fill, _selectionHandles, _selectionBoxSize } = this;\n    ctx.fillStyle = _fill; // eslint-disable-line\n    ctx.strokeStyle = 'white'; // eslint-disable-line\n    ctx.lineWidth = 1; // eslint-disable-line\n    ctx.setLineDash([7, 7]);\n    ctx.strokeRect(_x, _y, _w, _h);\n\n    const half = _selectionBoxSize / 2;\n\n    // top left, middle, right\n    _selectionHandles[0].x = _x - half;\n    _selectionHandles[0].y = _y - half;\n\n    _selectionHandles[1].x = _x + _w / 2 - half;\n    _selectionHandles[1].y = _y - half;\n\n    _selectionHandles[2].x = _x + _w - half;\n    _selectionHandles[2].y = _y - half;\n\n    // middle left\n    _selectionHandles[3].x = _x - half;\n    _selectionHandles[3].y = _y + _h / 2 - half;\n\n    // middle right\n    _selectionHandles[4].x = _x + _w - half;\n    _selectionHandles[4].y = _y + _h / 2 - half;\n\n    // bottom left, middle, right\n    _selectionHandles[6].x = _x + _w / 2 - half;\n    _selectionHandles[6].y = _y + _h - half;\n\n    _selectionHandles[5].x = _x - half;\n    _selectionHandles[5].y = _y + _h - half;\n\n    _selectionHandles[7].x = _x + _w - half;\n    _selectionHandles[7].y = _y + _h - half;\n\n    this.log('drawing selection boxes');\n    ctx.fillStyle = 'white'; // eslint-disable-line\n    _selectionHandles.forEach((cur) => {\n      ctx.fillRect(cur.x, cur.y, _selectionBoxSize, _selectionBoxSize);\n    });\n\n    this.log('filling the rectangle', _x, _y, _w, _h);\n  }\n\n  /**\n   * checks if point is inside the shape\n   * @param {number} mx\n   * @param {number} my\n   * @returns {bool}\n   */\n  contains(mx, my) {\n    const { _x, _y, _w, _h } = this;\n    return (_x <= mx) && (_x + _w >= mx) &&\n      (_y <= my) && (_y + _h >= my);\n  }\n\n  /**\n   * returns selection handle if point is inside\n   * @param {number} mx\n   * @param {number} my\n   * @returns {?number}\n   */\n  getHoverSelectionHandle(mx, my) {\n    const { _selectionHandles, _selectionBoxSize } = this;\n    for (let i = 0; i < _selectionHandles.length; i += 1) {\n      const handle = _selectionHandles[i];\n      if (\n        (handle.x <= mx) &&\n        (handle.x + _selectionBoxSize >= mx) &&\n        (handle.y <= my) &&\n        (handle.y + _selectionBoxSize >= my)\n      ) {\n        return i;\n      }\n    }\n\n    return false;\n  }\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/rect.js\n **/","import BaseObject from './base-object';\n\nexport const overlayStyles = {\n  position: 'fixed',\n  left: '0',\n  top: '0',\n  bottom: '0',\n  right: '0',\n  'z-index': '9999998',\n  display: 'flex',\n  'justify-content': 'center',\n  'align-items': 'center',\n  'background-color': 'rgba(0,0,0,.7)'\n};\n\nexport const modalWindowStyles = {\n  'background-color': 'white',\n  display: 'flex',\n  color: 'black',\n  'justify-content': 'center',\n  'align-items': 'center',\n  'flex-direction': 'column',\n  'box-shadow': '5px 5px 5px #000'\n};\n\nexport const infoDivStyles = {\n  'margin-top': '5px',\n  'font-size': '12px',\n  color: 'black'\n};\n\nexport const actionDivStyles = {\n  'margin-top': '10px',\n  display: 'flex',\n  'justify-content': 'center',\n  'align-items': 'center',\n  'flex-direction': 'row'\n};\n\nexport const progressDivStyles = {\n  'margin-top': '10px'\n};\n\nexport const sendBtnStyles = {\n  'margin-right': '10px'\n};\n\nexport const selectStyles = {\n  'margin-right': '10px'\n};\n\n/**\n * Modal window for preview cropped image before compressing and sending to server.\n * @class PreviewModal\n */\nexport default class PreviewModal extends BaseObject {\n  /**\n   * object constructor\n   * @param {HTMLDocument} doc\n   * @param {HTMLDOMElement} canvas\n   * @param {string} serverURL\n   */\n  constructor(doc, canvas, serverURL) {\n    super();\n\n    this._document = doc;\n    this._canvas = canvas;\n    this._serverURL = serverURL;\n    this._width = doc.body.clientWidth;\n    this._height = doc.body.clientHeight;\n    this._compressionRatio = 1;\n    this._fileFormat = 'image/jpeg';\n    this._debugMode = true;\n\n    const overlayDiv = this._document.createElement('div');\n    this._overlayDiv = overlayDiv;\n    this._applyStyles(overlayDiv, overlayStyles);\n\n    const modalWindow = this._document.createElement('div');\n    modalWindow.style.width = this._width / 1.5;\n    modalWindow.style.height = this._height / 1.5;\n    this._applyStyles(modalWindow, modalWindowStyles);\n\n    const infoDiv = this._document.createElement('div');\n    this._infoDiv = infoDiv;\n    this._applyStyles(infoDiv, infoDivStyles);\n\n    const actionDiv = this._document.createElement('div');\n    this._actionDiv = actionDiv;\n    this._applyStyles(actionDiv, actionDivStyles);\n\n    const sendBtn = this._document.createElement('button');\n    sendBtn.appendChild(this._document.createTextNode('Submit Image'));\n    this._sendBtn = sendBtn;\n    sendBtn.onclick = this.sendImage.bind(this);\n    this._applyStyles(sendBtn, sendBtnStyles);\n\n    const cancelBtn = this._document.createElement('button');\n    this._cancelBtn = cancelBtn;\n    cancelBtn.appendChild(this._document.createTextNode('Cancel'));\n    cancelBtn.onclick = this.removeModal.bind(this);\n\n    const fileFormatSelect = this._document.createElement('select');\n    this._fileFormatSelect = fileFormatSelect;\n    this._applyStyles(fileFormatSelect, selectStyles);\n    fileFormatSelect.innerHTML = `\n      <option value=\"image/jpeg\" selected>image/jpeg</option>\n      <option value=\"image/gif\">image/gif</option>\n    `;\n    fileFormatSelect.onchange = this.updateImage.bind(this);\n\n    const compressionRatioSelect = this._document.createElement('select');\n    this._compressionRatioSelect = compressionRatioSelect;\n    this._applyStyles(compressionRatioSelect, selectStyles);\n    compressionRatioSelect.innerHTML = `\n      <option value=\"1\" selected>100%</option>\n      <option value=\"0.9\">90%</option>\n      <option value=\"0.8\">80%</option>\n      <option value=\"0.7\">70%</option>\n      <option value=\"0.6\">60%</option>\n      <option value=\"0.5\">50%</option>\n      <option value=\"0.4\">40%</option>\n      <option value=\"0.3\">30%</option>\n      <option value=\"0.2\">20%</option>\n      <option value=\"0.1\">10%</option>\n    `;\n    compressionRatioSelect.onchange = this.updateImage.bind(this);\n\n    const progressDiv = this._document.createElement('div');\n    progressDiv.innerHTML = 'Not uploaded yet';\n    this._progressDiv = progressDiv;\n    this._applyStyles(progressDiv, progressDivStyles);\n\n    const img = this._document.createElement('img');\n    this._img = img;\n    img.style['max-width'] = this._width / 2;\n    img.style['max-height'] = this._height / 2;\n    this.updateImage();\n\n    actionDiv.appendChild(fileFormatSelect);\n    actionDiv.appendChild(compressionRatioSelect);\n    actionDiv.appendChild(sendBtn);\n    actionDiv.appendChild(progressDiv);\n    actionDiv.appendChild(cancelBtn);\n    modalWindow.appendChild(img);\n    modalWindow.appendChild(infoDiv);\n    modalWindow.appendChild(actionDiv);\n    modalWindow.appendChild(progressDiv);\n    overlayDiv.appendChild(modalWindow);\n    this._document.body.appendChild(overlayDiv);\n  }\n\n  /**\n   * returns class name\n   * @returns {string}\n   */\n  getName() {\n    return 'PreviewModal';\n  }\n\n  /**\n   * apply styles to dom element\n   * @param {HTMLDOMElement} element\n   * @param {Object} styles\n   * @private\n   */\n  _applyStyles(element, styles) {\n    Object.keys(styles).forEach((key) => {\n      element.style[key] = styles[key]; // eslint-disable-line\n    });\n  }\n\n  /**\n   * removes preview modal window\n   */\n  removeModal() {\n    if (this._overlayDiv) {\n      this._document.body.removeChild(this._overlayDiv);\n      this._overlayDiv = null;\n    }\n  }\n\n  /**\n   * sends image to server\n   */\n  sendImage() {\n    const formData = new FormData();\n    formData.append('image', this.getImage());\n    formData.append('type', this._fileFormat);\n    const xhr = new XMLHttpRequest();\n    xhr.addEventListener('load', () => {\n      this.log('finished uploading');\n    });\n\n    xhr.addEventListener('progress', (e) => {\n      if (e.lengthComputable) {\n        const percentage = Math.round((e.loaded / e.total) * 100);\n        this.log(`${percentage}% complete`);\n        this._progressDiv.innerHTML = `${percentage}% complete`;\n      }\n    });\n    xhr.addEventListener('error', () => {\n      this.log('uploading failed');\n    });\n    xhr.addEventListener('abort', () => {\n      this.log('uploading aborted');\n    });\n    xhr.open('POST', this._serverURL, true);\n    xhr.send(formData);\n  }\n\n  /**\n   * return image from canvas and calculate size\n   * @returns {ImageData}\n   */\n  getImage() {\n    const { _canvas } = this;\n    const dataURL = _canvas.toDataURL(this._fileFormat, this._compressionRatio);\n    const header = `data:${this._fileFormat};base64,`;\n    const fileSize = Math.round((dataURL.length - header.length) * 3 / 4 / 100) / 10;\n    this._infoDiv.innerHTML = `w: ${_canvas.width} h: ${_canvas.height} size: ${fileSize}KB`;\n    return dataURL;\n  }\n\n  /**\n   * update image preview\n   */\n  updateImage() {\n    if (!this._img) {\n      return;\n    }\n\n    this._fileFormat = this._fileFormatSelect.value;\n    this._compressionRatio = this._compressionRatioSelect.value * 1;\n\n    this._img.src = this.getImage();\n  }\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/preview-modal.js\n **/"],"sourceRoot":""}